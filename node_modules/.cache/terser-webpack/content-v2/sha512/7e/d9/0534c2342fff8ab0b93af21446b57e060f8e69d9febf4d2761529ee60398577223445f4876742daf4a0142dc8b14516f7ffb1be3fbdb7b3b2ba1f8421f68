{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{\"9XlO\":function(e,t,r){\"use strict\";r.r(t);var a=r(\"pO5D\"),i=(r(\"wSAH\"),r(\"f/qv\")),s=r(\"6S2I\"),n=(r(\"zqDF\"),r(\"WbKI\")),o=r(\"+opI\"),l=r(\"04ZG\"),c=r(\"zlDU\"),u=r(\"4EHJ\"),p=(r(\"ju1D\"),r(\"9AIY\"),r(\"9MzC\")),d=r(\"Ehki\"),y=r(\"qRWG\"),b=r(\"975N\"),h=r(\"Lqtk\"),m=r(\"0pea\"),f=r(\"xk++\"),g=r(\"kglp\"),O=r(\"bJda\"),S=r(\"WZb1\"),v=r(\"OvF4\"),j=r(\"qNUd\"),w=r(\"ofM5\"),_=r(\"8prj\"),P=r(\"DKHk\"),L=r(\"ag7Y\");let J=class extends L.a{constructor(){super(...arguments),this.extent=null,this.height=null,this.href=null,this.opacity=1,this.rotation=0,this.scale=null,this.visible=!0,this.width=null}};Object(a.a)([Object(n.b)({type:v.a})],J.prototype,\"extent\",void 0),Object(a.a)([Object(n.b)()],J.prototype,\"height\",void 0),Object(a.a)([Object(n.b)()],J.prototype,\"href\",void 0),Object(a.a)([Object(n.b)()],J.prototype,\"opacity\",void 0),Object(a.a)([Object(n.b)()],J.prototype,\"rotation\",void 0),Object(a.a)([Object(n.b)()],J.prototype,\"scale\",void 0),Object(a.a)([Object(n.b)()],J.prototype,\"visible\",void 0),Object(a.a)([Object(n.b)()],J.prototype,\"width\",void 0),J=Object(a.a)([Object(l.a)(\"esri.layer.support.MapImage\")],J);var x=J;let N=class extends L.a{constructor(e){super(e),this.itemId=null,this.url=null}};Object(a.a)([Object(n.b)({type:String,json:{read:{source:\"itemID\"},write:{target:\"itemID\"}}})],N.prototype,\"itemId\",void 0),Object(a.a)([Object(n.b)({type:String,json:{write:!0}})],N.prototype,\"url\",void 0),N=Object(a.a)([Object(l.a)(\"esri.tasks.support.DataFile\")],N);var D=N;const G=new o.a({esriJobCancelled:\"job-cancelled\",esriJobCancelling:\"job-cancelling\",esriJobDeleted:\"job-deleted\",esriJobDeleting:\"job-deleting\",esriJobTimedOut:\"job-timed-out\",esriJobExecuting:\"job-executing\",esriJobFailed:\"job-failed\",esriJobNew:\"job-new\",esriJobSubmitted:\"job-submitted\",esriJobSucceeded:\"job-succeeded\",esriJobWaiting:\"job-waiting\"});let M=class extends L.a{constructor(e){super(e),this.jobId=null,this.jobStatus=null,this.messages=null}};Object(a.a)([Object(n.b)()],M.prototype,\"jobId\",void 0),Object(a.a)([Object(n.b)({json:{read:G.read}})],M.prototype,\"jobStatus\",void 0),Object(a.a)([Object(n.b)({type:[P.a]})],M.prototype,\"messages\",void 0),M=Object(a.a)([Object(l.a)(\"esri.tasks.support.JobInfo\")],M);var I=M;const V=new o.a({esriMeters:\"meters\",esriFeet:\"feet\",esriKilometers:\"kilometers\",esriMiles:\"miles\",esriNauticalMiles:\"nautical-miles\",esriYards:\"yards\"},{ignoreUnknown:!1});let T=class extends L.a{constructor(e){super(e),this.distance=0,this.units=null}};Object(a.a)([Object(n.b)({json:{write:!0}})],T.prototype,\"distance\",void 0),Object(a.a)([Object(n.b)({json:{read:V.read,write:V.write}})],T.prototype,\"units\",void 0),T=Object(a.a)([Object(l.a)(\"esri/tasks/support/LinearUnit\")],T);var k=T;const F=new o.a({GPBoolean:\"boolean\",GPDataFile:\"data-file\",GPDate:\"date\",GPDouble:\"double\",GPFeatureRecordSetLayer:\"feature-record-set-layer\",GPField:\"field\",GPLinearUnit:\"linear-unit\",GPLong:\"long\",GPRasterData:\"raster-data\",GPRasterDataLayer:\"raster-data-layer\",GPRecordSet:\"record-set\",GPString:\"string\",\"GPMultiValue:GPBoolean\":\"multi-value\",\"GPMultiValue:GPDataFile\":\"multi-value\",\"GPMultiValue:GPDate\":\"multi-value\",\"GPMultiValue:GPDouble\":\"multi-value\",\"GPMultiValue:GPFeatureRecordSetLayer\":\"multi-value\",\"GPMultiValue:GPField\":\"multi-value\",\"GPMultiValue:GPLinearUnit\":\"multi-value\",\"GPMultiValue:GPLong\":\"multi-value\",\"GPMultiValue:GPRasterData\":\"multi-value\",\"GPMultiValue:GPRasterDataLayer\":\"multi-value\",\"GPMultiValue:GPRecordSet\":\"multi-value\",\"GPMultiValue:GPString\":\"multi-value\"});let R=class extends L.a{constructor(e){super(e),this.dataType=null,this.value=null}};Object(a.a)([Object(n.b)({json:{read:F.read,write:F.write}})],R.prototype,\"dataType\",void 0),Object(a.a)([Object(n.b)()],R.prototype,\"value\",void 0),R=Object(a.a)([Object(l.a)(\"esri.tasks.support.ParameterValue\")],R);var E=R;let C=class extends L.a{constructor(e){super(e),this.format=null,this.itemId=null,this.url=null}};Object(a.a)([Object(n.b)()],C.prototype,\"format\",void 0),Object(a.a)([Object(n.b)({json:{read:{source:\"itemID\"},write:{target:\"itemID\"}}})],C.prototype,\"itemId\",void 0),Object(a.a)([Object(n.b)()],C.prototype,\"url\",void 0),C=Object(a.a)([Object(l.a)(\"esri/tasks/support/RasterData\")],C);var A=C;let U=class extends g.a{constructor(e){super(e),this._timers=new Map,this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}destroy(){this._timers.forEach(e=>{clearInterval(e)})}cancelJob(e,t){const{path:r}=this.parsedUrl,a={...this.requestOptions,...t,query:{f:\"json\"}};return this._clearTimer(e),Object(h.default)(`${r}/jobs/${e}/cancel`,a).then(e=>I.fromJSON(e.data))}checkJobStatus(e,t){const{path:r}=this.parsedUrl,a={...this.requestOptions,...t,query:{f:\"json\"}};return Object(h.default)(`${r}/jobs/${e}`,a).then(e=>I.fromJSON(e.data))}execute(e,t){return this._constructRequest(\"execute\",e,t).then(e=>{const t=e.data.messages||[];return{results:(e.data.results||[]).map(this._decode),messages:t.map(e=>P.a.fromJSON(e))}})}getResultData(e,t,r){const{returnFeatureCollection:a,returnM:i,returnZ:s,outSpatialReference:n,parsedUrl:o}=this,{path:l}=o,c=this._gpEncode({returnFeatureCollection:a||void 0,returnM:i||void 0,returnZ:s||void 0,outSR:n,returnType:\"data\",f:\"json\"},null),u={...this.requestOptions,...r,query:c};return Object(h.default)(`${l}/jobs/${e}/results/${t}`,u).then(e=>this._decode(e.data))}getResultImage(e,t,r,a){const{path:i}=this.parsedUrl,s={...r.toJSON(),f:\"json\"},n=this._gpEncode(s),o={...this.requestOptions,...a,query:n};return Object(h.default)(`${i}/jobs/${e}/results/${t}`,o).then(e=>this._decode(e.data))}async getResultMapImageLayer(e){const{path:t}=this.parsedUrl,a=t.indexOf(\"/GPServer/\"),i=`${t.substring(0,a)}/MapServer/jobs/${e}`;return new(0,(await Promise.all([r.e(0),r.e(31)]).then(r.bind(null,\"U/i9\"))).default)({url:i})}submitJob(e,t){return this._constructRequest(\"submitJob\",e,t).then(e=>I.fromJSON(e.data))}waitForJobCompletion(e,t={}){const{interval:r=1e3,signal:a,statusCallback:i}=t;return Object(p.c)((t,s)=>{Object(p.r)(a,()=>{this._clearTimer(e),s(Object(p.e)())}),this._clearTimer(e);const n=setInterval(()=>{this._timers.has(e)||s(Object(p.e)()),this._getJobStatus(e,this.requestOptions).then(r=>{const{jobStatus:a}=r;switch(a){case\"job-succeeded\":this._clearTimer(e),t(r);break;case\"job-submitted\":case\"job-executing\":case\"job-waiting\":case\"job-new\":i&&i(r);break;case\"job-cancelled\":case\"job-cancelling\":case\"job-deleted\":case\"job-deleting\":case\"job-timed-out\":case\"job-failed\":this._clearTimer(e),s(r);break;default:Object(O.a)(a)}})},r);this._timers.set(e,n)})}_clearTimer(e){this._timers.has(e)&&(clearInterval(this._timers.get(e)),this._timers.delete(e))}_constructRequest(e,t,r){const a={},i={},s=[];return this._collectGeometries(t,s,a),Object(j.a)(s).then(s=>{const{outSpatialReference:n,parsedUrl:o,processExtent:l,processSpatialReference:c,returnFeatureCollection:u,returnM:p,returnZ:d}=this,{path:y}=o;for(const e in a){const t=a[e];i[e]=s.slice(t[0],t[1])}const b=n?n.wkid||n:null,m=c?c.wkid||c:null,f=\"execute\"===e?{returnFeatureCollection:u||void 0,returnM:p||void 0,returnZ:d||void 0}:null,g={...l?{context:{extent:l,outSR:b,processSR:m}}:{\"env:outSR\":b,\"env:processSR\":m},...t,...f,f:\"json\"},O=this._gpEncode(g,null,i),S={...this.requestOptions,...r,query:O};return Object(h.default)(`${y}/${e}`,S)})}_collectGeometries(e,t,r){for(const a in e){const i=e[a];if(i&&\"object\"==typeof i&&i instanceof _.default){const{features:e}=i;r[a]=[t.length,t.length+e.length],e.forEach(e=>{t.push(e.geometry)})}}}_decode(e){const t=e.dataType,r=E.fromJSON(e);switch(t){case\"GPBoolean\":case\"GPDouble\":case\"GPLong\":case\"GPString\":return r;case\"GPDate\":r.value=new Date(r.value);break;case\"GPDataFile\":r.value=D.fromJSON(r.value);break;case\"GPLinearUnit\":r.value=k.fromJSON(r.value);break;case\"GPFeatureRecordSetLayer\":case\"GPRecordSet\":r.value=e.value.url?D.fromJSON(r.value):_.default.fromJSON(r.value);break;case\"GPRasterData\":case\"GPRasterDataLayer\":{const t=e.value.mapImage;r.value=t?x.fromJSON(t):A.fromJSON(r.value);break}case\"GPField\":r.value=w.a.fromJSON(r.value);break;case\"GPMultiValue:GPBoolean\":case\"GPMultiValue:GPDouble\":case\"GPMultiValue:GPLong\":case\"GPMultiValue:GPString\":return r;case\"GPMultiValue:GPDate\":r.value=r.value.map(e=>new Date(e));break;case\"GPMultiValue:GPDataFile\":r.value=r.value.map(e=>D.fromJSON(e));break;case\"GPMultiValue:GPLinearUnit\":r.value=r.value.map(e=>k.fromJSON(e));break;case\"GPMultiValue:GPFeatureRecordSetLayer\":case\"GPMultiValue:GPRecordSet\":r.value=r.value.map(e=>_.default.fromJSON(e));break;case\"GPMultiValue:GPRasterData\":case\"GPMultiValue:GPRasterDataLayer\":r.value=r.value.map(e=>e?x.fromJSON(e):A.fromJSON(r.value));break;case\"GPMultiValue:GPField\":r.value=r.value.map(e=>w.a.fromJSON(e))}return r}_gpEncode(e,t,r){for(const a in e){const t=e[a];Array.isArray(t)?e[a]=JSON.stringify(t.map(e=>this._gpEncode({item:e},!0).item,this)):t instanceof Date&&(e[a]=t.getTime())}return this._encode(e,t,r)}_getJobStatus(e,t){const{path:r}=this.parsedUrl,a=`${r}/jobs/${e}`,i={...this.requestOptions,...t,query:{f:\"json\"}};return Object(h.default)(a,i).then(e=>I.fromJSON(e.data))}};Object(a.a)([Object(n.b)({type:S.a})],U.prototype,\"outSpatialReference\",void 0),Object(a.a)([Object(n.b)({type:v.a})],U.prototype,\"processExtent\",void 0),Object(a.a)([Object(n.b)({type:S.a})],U.prototype,\"processSpatialReference\",void 0),Object(a.a)([Object(n.b)({nonNullable:!0})],U.prototype,\"returnFeatureCollection\",void 0),Object(a.a)([Object(n.b)({nonNullable:!0})],U.prototype,\"returnM\",void 0),Object(a.a)([Object(n.b)({nonNullable:!0})],U.prototype,\"returnZ\",void 0),U=Object(a.a)([Object(l.a)(\"esri/tasks/Geoprocessor\")],U);var q=U;const $=new o.a({PDF:\"pdf\",PNG32:\"png32\",PNG8:\"png8\",JPG:\"jpg\",GIF:\"gif\",EPS:\"eps\",SVG:\"svg\",SVGZ:\"svgz\"}),z=($.fromJSON.bind($),$.toJSON.bind($)),B=new o.a({MAP_ONLY:\"map-only\",\"A3 Landscape\":\"a3-landscape\",\"A3 Portrait\":\"a3-portrait\",\"A4 Landscape\":\"a4-landscape\",\"A4 Portrait\":\"a4-portrait\",\"Letter ANSI A Landscape\":\"letter-ansi-a-landscape\",\"Letter ANSI A Portrait\":\"letter-ansi-a-portrait\",\"Tabloid ANSI B Landscape\":\"tabloid-ansi-b-landscape\",\"Tabloid ANSI B Portrait\":\"tabloid-ansi-b-portrait\"}),W=(B.fromJSON.bind(B),B.toJSON.bind(B));function K(e,t){const{graphic:r,renderer:a,symbol:i}=t,s=i.type;if(\"text\"===s||\"shield-label-symbol\"===s||!(\"visualVariables\"in a)||!a.visualVariables)return;const n=a.getVisualVariablesForType(\"size\"),o=a.getVisualVariablesForType(\"color\"),l=a.getVisualVariablesForType(\"opacity\"),c=a.getVisualVariablesForType(\"rotation\"),u=n&&n[0],p=o&&o[0],d=l&&l[0],b=c&&c[0];if(u){const t=\"simple-marker\"===s?i.style:null,a=Object(m.e)(u,r,{shape:t});null!=a&&(\"simple-marker\"===s?e.size=Object(y.e)(a):\"picture-marker\"===s?(e.width=Object(y.e)(a),e.height=Object(y.e)(a)):\"simple-line\"===s?e.width=Object(y.e)(a):e.outline&&(e.outline.width=Object(y.e)(a)))}if(p){const t=Object(m.b)(p,r);(t&&\"simple-marker\"===s||\"simple-line\"===s||\"simple-fill\"===s)&&(e.color=t?t.toJSON():void 0)}if(d){const t=Object(m.c)(d,r);null!=t&&e.color&&(e.color[3]=Math.round(255*t))}b&&(e.angle=-Object(m.d)(a,r))}function Z(e){return e&&\"bing-maps\"===e.type}function H(e){return e&&\"csv\"===e.type}function Y(e){return e&&\"feature\"===e.type}function Q(e){return e&&\"geojson\"===e.type}function X(e){return e&&\"graphics\"===e.type}function ee(e){return e&&\"group\"===e.type}function te(e){return e&&\"esri.views.2d.layers.GroupLayerView2D\"===e.declaredClass}function re(e){return e&&\"imagery\"===e.type}function ae(e){return e&&\"kml\"===e.type}function ie(e){return e&&\"map-image\"===e.type}function se(e){return e&&\"map-notes\"===e.type}function ne(e){return e&&\"open-street-map\"===e.type}function oe(e){return e&&\"stream\"===e.type}function le(e){return e&&\"tile\"===e.type}function ce(e){return e&&\"vector-tile\"===e.type}function ue(e){return e&&\"web-tile\"===e.type}function pe(e){return e&&\"wms\"===e.type}function de(e){return e&&\"wmts\"===e.type}var ye=r(\"4gt3\"),be=r(\"/CmD\");const he=s.a.getLogger(\"esri.tasks.support.PrintTemplate\");function me(){Object(ye.b)(he,\"preserveScale\",{replacement:\"scalePreserved\",version:\"4.16\"})}let fe=class extends be.a{constructor(e){super(e),this.attributionVisible=!0,this.exportOptions={width:800,height:1100,dpi:96},this.forceFeatureAttributes=!1,this.format=\"png32\",this.label=null,this.layout=\"map-only\",this.layoutOptions=null,this.outScale=0,this.scalePreserved=!0,this.showLabels=!0}get preserveScale(){return me(),this.scalePreserved}set preserveScale(e){me(),this.scalePreserved=e}};Object(a.a)([Object(n.b)()],fe.prototype,\"attributionVisible\",void 0),Object(a.a)([Object(n.b)()],fe.prototype,\"exportOptions\",void 0),Object(a.a)([Object(n.b)()],fe.prototype,\"forceFeatureAttributes\",void 0),Object(a.a)([Object(n.b)()],fe.prototype,\"format\",void 0),Object(a.a)([Object(n.b)()],fe.prototype,\"label\",void 0),Object(a.a)([Object(n.b)()],fe.prototype,\"layout\",void 0),Object(a.a)([Object(n.b)()],fe.prototype,\"layoutOptions\",void 0),Object(a.a)([Object(n.b)()],fe.prototype,\"outScale\",void 0),Object(a.a)([Object(n.b)({dependsOn:[\"scalePreserved\"]})],fe.prototype,\"preserveScale\",null),Object(a.a)([Object(n.b)()],fe.prototype,\"scalePreserved\",void 0),Object(a.a)([Object(n.b)()],fe.prototype,\"showLabels\",void 0),fe=Object(a.a)([Object(l.a)(\"esri.tasks.support.PrintTemplate\")],fe);var ge=fe;const Oe={Feet:\"ft\",Kilometers:\"km\",Meters:\"m\",Miles:\"mi\"},Se=new o.a({esriFeet:\"Feet\",esriKilometers:\"Kilometers\",esriMeters:\"Meters\",esriMiles:\"Miles\"}),ve=new o.a({esriExecutionTypeSynchronous:\"sync\",esriExecutionTypeAsynchronous:\"async\"}),je=new f.a({returnGeometry:!0});function we(e){return e&&(e.path||\"image/svg+xml\"===e.contentType||e.url&&e.url.endsWith(\".svg\"))}let _e=class extends g.a{constructor(...e){super(...e),this._ssExtent=null,this._legendLayers=[],this._legendLayerNameMap={},this._gpServerUrl=null,this._cimVersion=null,this._is11xService=!1,this._gpMetadata=null,this.updateDelay=1e3}get _geoprocessor(){return new q({url:this.url})}get mode(){return this._gpMetadata&&this._gpMetadata.executionType?ve.fromJSON(this._gpMetadata.executionType):\"sync\"}execute(e,t){let r=this.url;const a=r.lastIndexOf(\"/GPServer/\");return a>0&&(r=r.slice(0,a+9)),Object(p.u)().then(()=>this._gpServerUrl===r?{data:this._gpMetadata}:(this._gpServerUrl=r,Object(h.default)(r,{query:{f:\"json\"}}))).then(t=>(this._gpMetadata=t.data,this._cimVersion=this._gpMetadata.cimVersion,this._is11xService=!!this._cimVersion,this._getGpPrintParams(e))).then(e=>{const r=e=>\"sync\"===this.mode?e.results&&e.results[0]&&e.results[0].value:this._geoprocessor.getResultData(e.jobId,\"Output_File\",t).then(e=>e.value);return\"async\"===this.mode?this._geoprocessor.submitJob(e,t).then(e=>this._geoprocessor.waitForJobCompletion(e.jobId,{interval:this.updateDelay}).then(r)):this._geoprocessor.execute(e,t).then(r)})}async _createOperationalLayers(e,t){const r=[],a={layerView:null,printTemplate:t,view:e};let i=0;t.scalePreserved&&(i=t.outScale||e.scale);const s=function(e,t){const r=e.allLayerViews.items;if(t===e.scale)return r.filter(e=>!e.suspended);const a=new Array;for(const i of r)te(i.parent)&&!a.includes(i.parent)||!i.visible||t&&\"isVisibleAtScale\"in i&&!i.isVisibleAtScale(t)||a.push(i);return a}(e,i);for(const n of s){const e=n.layer;if(!e.loaded||ee(e))continue;let t;a.layerView=n,t=Z(e)?this._createBingMapsLayerJSON(e):H(e)?await this._createCSVLayerJSON(e,a):Y(e)?await this._createFeatureLayerJSON(e,a):Q(e)?await this._createGeoJSONLayer(e,a):X(e)?await this._createGraphicsLayerJSON(e,a):re(e)?this._createImageryLayerJSON(e):ae(e)?await this._createKMLLayerJSON(e,a):ie(e)?this._createMapImageLayerJSON(e,a):se(e)?await this._createMapNotesLayerJSON(a):ne(e)?this._createOpenStreetMapLayerJSON():oe(e)?await this._createStreamLayerJSON(e,a):le(e)?this._createTileLayerJSON(e):ce(e)?await this._createVectorTileLayerJSON(e,a):ue(e)?this._createWebTileLayerJSON(e):pe(e)?this._createWMSLayerJSON(e):de(e)?this._createWMTSLayerJSON(e):await this._createScreenshotJSON(e,a),t&&(Array.isArray(t)?r.push(...t):(t.id=e.id,t.title=this._legendLayerNameMap[e.id]||e.title,t.opacity=e.opacity,t.minScale=e.minScale||0,t.maxScale=e.maxScale||0,r.push(t)))}if(i&&r.forEach(e=>{e.minScale=0,e.maxScale=0}),e.graphics&&e.graphics.length){const a=await this._createFeatureCollectionJSON(null,e.graphics,t);a&&r.push(a)}return r}_createBingMapsLayerJSON(e){return{culture:e.culture,key:e.key,type:\"BingMaps\"+(\"aerial\"===e.style?\"Aerial\":\"hybrid\"===e.style?\"Hybrid\":\"Road\")}}async _createCSVLayerJSON(e,{layerView:t,printTemplate:r}){let a;if(this._legendLayers&&this._legendLayers.push({id:e.id}),!this._is11xService){const a=await this._getGraphics(t);return this._createFeatureCollectionJSON(e,a,r)}return a={type:\"CSV\"},e.write(a,{origin:\"web-map\"}),delete a.popupInfo,delete a.layerType,a.showLabels=r.showLabels&&e.labelsVisible,a}async _createFeatureCollectionJSON(e,t,r){let a;const i={layerDefinition:{name:\"polygonLayer\",geometryType:\"esriGeometryPolygon\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPolygon\",features:[]}},s={layerDefinition:{name:\"polylineLayer\",geometryType:\"esriGeometryPolyline\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPolyline\",features:[]}},n={layerDefinition:{name:\"pointLayer\",geometryType:\"esriGeometryPoint\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPoint\",features:[]}},o={layerDefinition:{name:\"multipointLayer\",geometryType:\"esriGeometryMultipoint\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryMultipoint\",features:[]}},l={layerDefinition:{name:\"pointLayer\",geometryType:\"esriGeometryPoint\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPoint\",features:[]}};if(l.layerDefinition.name=\"textLayer\",delete l.layerDefinition.drawingInfo,e){if(\"esri.layers.FeatureLayer\"===e.declaredClass||\"esri.layers.StreamLayer\"===e.declaredClass?i.layerDefinition.name=s.layerDefinition.name=n.layerDefinition.name=o.layerDefinition.name=this._legendLayerNameMap[e.id]||e.get(\"arcgisProps.title\")||e.title:\"esri.layers.GraphicsLayer\"===e.declaredClass&&(t=e.graphics.items),e.renderer){const t=e.renderer.toJSON();i.layerDefinition.drawingInfo.renderer=t,s.layerDefinition.drawingInfo.renderer=t,n.layerDefinition.drawingInfo.renderer=t,o.layerDefinition.drawingInfo.renderer=t}if(r.showLabels&&e.labelsVisible&&\"function\"==typeof e.write){var c,u;const t=null==(c=e.write({},{origin:\"web-map\"}).layerDefinition)||null==(u=c.drawingInfo)?void 0:u.labelingInfo;t&&(a=!0,i.layerDefinition.drawingInfo.labelingInfo=t,s.layerDefinition.drawingInfo.labelingInfo=t,n.layerDefinition.drawingInfo.labelingInfo=t,o.layerDefinition.drawingInfo.labelingInfo=t)}}let p;null!=e&&e.renderer||a||(delete i.layerDefinition.drawingInfo,delete s.layerDefinition.drawingInfo,delete n.layerDefinition.drawingInfo,delete o.layerDefinition.drawingInfo);const y=e&&e.fields,b=e&&e.renderer;if(y&&b&&\"function\"==typeof b.collectRequiredFields){const e=new Set;await b.collectRequiredFields(e,y),p=Array.from(e)}if(y){const e=y.map(e=>e.toJSON());i.layerDefinition.fields=e,s.layerDefinition.fields=e,n.layerDefinition.fields=e,o.layerDefinition.fields=e}const h=t&&t.length;let m;for(let g=0;g<h;g++){const a=t[g]||t.getItemAt(g);if(!1===a.visible||!a.geometry)continue;if(m=a.toJSON(),m.hasOwnProperty(\"popupTemplate\")&&delete m.popupTemplate,m.geometry&&m.geometry.z&&delete m.geometry.z,m.symbol&&m.symbol.outline&&\"esriCLS\"===m.symbol.outline.type&&!this._is11xService)continue;!this._is11xService&&m.symbol&&m.symbol.outline&&m.symbol.outline.color&&m.symbol.outline.color[3]&&(m.symbol.outline.color[3]=255);const c=e&&e.renderer&&(\"valueExpression\"in e.renderer&&e.renderer.valueExpression||\"hasVisualVariables\"in e.renderer&&e.renderer.hasVisualVariables());if(!m.symbol&&e&&e.renderer&&c&&!this._is11xService){const t=e.renderer,r=await t.getSymbolAsync(a);if(!r)continue;m.symbol=r.toJSON(),\"hasVisualVariables\"in t&&t.hasVisualVariables()&&K(m.symbol,{renderer:t,graphic:a,symbol:r})}if(m.symbol&&(m.symbol.angle||delete m.symbol.angle,we(m.symbol)?m.symbol=await this._convertSvgToPictureMarkerSymbolJson(m.symbol):m.symbol.text&&delete m.attributes),(!r||!r.forceFeatureAttributes)&&p&&p.length){const e={};p.forEach(t=>{m.attributes&&m.attributes.hasOwnProperty(t)&&(e[t]=m.attributes[t])}),m.attributes=e}\"polygon\"===a.geometry.type?i.featureSet.features.push(m):\"polyline\"===a.geometry.type?s.featureSet.features.push(m):\"point\"===a.geometry.type?m.symbol&&m.symbol.text?l.featureSet.features.push(m):n.featureSet.features.push(m):\"multipoint\"===a.geometry.type?o.featureSet.features.push(m):\"extent\"===a.geometry.type&&(m.geometry=d.a.fromExtent(a.geometry).toJSON(),i.featureSet.features.push(m))}const f=[i,s,o,n,l].filter(e=>e.featureSet.features.length>0);for(const d of f){const e=d.featureSet.features.every(e=>e.symbol);!e||r&&r.forceFeatureAttributes||d.featureSet.features.forEach(e=>{delete e.attributes}),e&&delete d.layerDefinition.drawingInfo,d.layerDefinition.drawingInfo&&d.layerDefinition.drawingInfo.renderer&&await this._convertSvgRenderer(d.layerDefinition.drawingInfo.renderer)}return f.length?{featureCollection:{layers:f},showLabels:a}:null}async _createFeatureLayerJSON(e,t){var r,a;let i;this._legendLayers&&this._legendLayers.push({id:e.id});const s=e.renderer;if(e.featureReduction||s&&\"dot-density\"===s.type&&(!this._is11xService||parseFloat(this._cimVersion)<2.6))return this._createScreenshotJSON(e,t);const{layerView:n,printTemplate:o,view:l}=t,c=s&&(\"valueExpression\"in s&&s.valueExpression||\"hasVisualVariables\"in s&&s.hasVisualVariables()),u=\"feature-layer\"!==(null==(r=e.source)?void 0:r.type)&&\"ogc-feature\"!==(null==(a=e.source)?void 0:a.type);if(!this._is11xService&&c||e.featureReduction||u||!s||\"field\"in s&&null!=s.field&&(\"string\"!=typeof s.field||!e.getField(s.field))){const t=await this._getGraphics(n);i=await this._createFeatureCollectionJSON(e,t,o)}else{var p,d;if(i={id:(y=e.write()).id,title:y.title,opacity:y.opacity,minScale:y.minScale,maxScale:y.maxScale,url:y.url,layerDefinition:y.layerDefinition},i.showLabels=o.showLabels&&e.labelsVisible,this._setURLandToken(i,e),null!=(p=i.layerDefinition)&&null!=(d=p.drawingInfo)&&d.renderer&&(delete i.layerDefinition.minScale,delete i.layerDefinition.maxScale,await this._convertSvgRenderer(i.layerDefinition.drawingInfo.renderer),\"visualVariables\"in s&&s.visualVariables&&s.visualVariables[0])){const e=s.visualVariables[0];if(\"size\"===e.type&&e.maxSize&&\"number\"!=typeof e.maxSize&&e.minSize&&\"number\"!=typeof e.minSize){const t=Object(m.f)(e,l.scale);i.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=t.minSize,i.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=t.maxSize}}}var y;return i}async _createGeoJSONLayer(e,{layerView:t,printTemplate:r}){this._legendLayers&&this._legendLayers.push({id:e.id});const a=await this._getGraphics(t);return this._createFeatureCollectionJSON(e,a,r)}async _createGraphicsLayerJSON(e,{printTemplate:t}){return this._createFeatureCollectionJSON(e,null,t)}_createImageryLayerJSON(e){this._legendLayers&&this._legendLayers.push({id:e.id});const t={bandIds:e.bandIds,compressionQuality:e.compressionQuality,format:e.format,interpolation:e.interpolation};if((e.mosaicRule||e.definitionExpression)&&(t.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(this._is11xService)e.renderingRule&&(t.renderingRule=e.renderingRule.toJSON()),e.renderer&&(t.layerDefinition=t.layerDefinition||{},t.layerDefinition.drawingInfo=t.layerDefinition.drawingInfo||{},t.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{const r=e.exportImageServiceParameters.combineRendererWithRenderingRule();r&&(t.renderingRule=r.toJSON())}return this._setURLandToken(t,e),t}async _createKMLLayerJSON(e,t){const r=t.printTemplate;if(this._is11xService){const t={type:\"kml\"};return e.write(t,{origin:\"web-map\"}),delete t.layerType,t.url=Object(u.B)(e.url),t}{const a=[],i=t.layerView;i.allVisibleMapImages.forEach((t,r)=>{const i={id:`${e.id}_image${r}`,type:\"image\",title:e.id,minScale:e.minScale||0,maxScale:e.maxScale||0,opacity:e.opacity,extent:t.extent};\"data:image/png;base64,\"===t.href.substr(0,22)?i.imageData=t.href.substr(22):i.url=t.href,a.push(i)});const s=[...i.allVisiblePoints.items,...i.allVisiblePolylines.items,...i.allVisiblePolygons.items],n={id:e.id,...await this._createFeatureCollectionJSON(null,s,r)};return a.push(n),a}}_createMapImageLayerJSON(e,{view:t}){let r;const a={id:e.id,subLayerIds:[]};let i=[];const s=t.scale,n=e=>{if(e.visible&&(0===s||(0===e.minScale||s<=e.minScale)&&(0===e.maxScale||s>=e.maxScale)))if(e.sublayers)e.sublayers.forEach(n);else{const t=e.toExportImageJSON();i.unshift({id:e.id,name:e.title,layerDefinition:{drawingInfo:t.drawingInfo,definitionExpression:t.definitionExpression,source:t.source}}),a.subLayerIds.push(e.id)}};return e.sublayers&&e.sublayers.forEach(n),i.length&&(i=i.map(({id:e,name:t,layerDefinition:r})=>({id:e,name:t,layerDefinition:r})),r={layers:i,visibleLayers:a.subLayerIds},this._setURLandToken(r,e),this._legendLayers.push(a)),r}async _createMapNotesLayerJSON({layerView:e,printTemplate:t}){const r=[];for(const a of e.graphicsViews()){const e=await this._createFeatureCollectionJSON(a,a.graphics,t);e&&r.push(...e.featureCollection.layers)}return{featureCollection:{layers:r}}}_createOpenStreetMapLayerJSON(){return{type:\"OpenStreetMap\"}}async _createScreenshotJSON(e,{printTemplate:t,view:r}){const a={type:\"image\"},i={format:\"png\",ignoreBackground:!0,layers:[e],rotation:0},s=this._ssExtent||r.extent.clone();let n=96,o=!0,l=!0;if(t.exportOptions){const e=t.exportOptions;e.dpi>0&&(n=e.dpi),e.width>0&&(o=e.width%2==r.width%2),e.height>0&&(l=e.height%2==r.height%2)}if(\"map-only\"===t.layout&&t.scalePreserved&&(!t.outScale||t.outScale===r.scale)&&96===n&&(!o||!l)&&(i.area={x:0,y:0,width:r.width,height:r.height},o||(i.area.width-=1),l||(i.area.height-=1),!this._ssExtent)){const e=r.toMap(Object(y.b)(i.area.width,i.area.height));s.ymin=e.y,s.xmax=e.x,this._ssExtent=s}a.extent=s.clone()._normalize(!0).toJSON();const c=await r.takeScreenshot(i),p=Object(u.i)(c.dataUrl);return a.imageData=p.data,a}async _createStreamLayerJSON(e,{layerView:t,printTemplate:r}){this._legendLayers&&this._legendLayers.push({id:e.id});const a=await this._getGraphics(t);return this._createFeatureCollectionJSON(e,a,r)}_createTileLayerJSON(e){const t={customParameters:e.customParameters};return this._setURLandToken(t,e),t}async _createVectorTileLayerJSON(e,t){if(this._is11xService&&e.serviceUrl&&e.styleUrl){const t=b.b&&b.b.findCredential(e.styleUrl),r=b.b&&b.b.findCredential(e.serviceUrl);if(!t&&!r||\"2.1.0\"!==this._cimVersion){const a={type:\"VectorTileLayer\"};return a.styleUrl=Object(u.B)(e.styleUrl),t&&(a.token=t.token),r&&r.token!==a.token&&(a.additionalTokens=[{url:e.serviceUrl,token:r.token}]),a}}return this._createScreenshotJSON(e,t)}_createWebTileLayerJSON(e){const t={type:\"WebTiledLayer\",urlTemplate:e.urlTemplate.replace(/\\${/g,\"{\"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}_createWMSLayerJSON(e){let t;const r=[],a=e=>{e.visible&&(e.sublayers?e.sublayers.forEach(a):e.name&&r.unshift(e.name))};return e.sublayers&&e.sublayers.forEach(a),r.length&&(t={type:\"wms\",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:Object(u.B)(e.url),version:e.version}),t}_createWMTSLayerJSON(e){const t=e.activeLayer;return{type:\"wmts\",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:Object(u.B)(e.url)}}_setURLandToken(e,t){var r;if(!t.url)return;e.url=Object(u.B)(e.url||t.url);const a=null==(r=b.b)?void 0:r.findCredential(t.url);a&&(e.token=a.token)}async _convertSvgToPictureMarkerSymbolJson(e){this._canvas||(this._canvas=document.createElement(\"canvas\"));const t=1024;this._canvas.width=t,this._canvas.height=t;const r=this._canvas.getContext(\"2d\");let a,i;if(e.path){var s;const n=new Path2D(e.path);n.closePath(),r.fillStyle=Array.isArray(e.color)?`rgba(${e.color[0]},${e.color[1]},${e.color[2]},${e.color[3]/255})`:\"rgb(0,0,0)\",r.fill(n);const o=function(e,t=15){const r=e.canvas.width,a=e.canvas.height,i=e.getImageData(0,0,r,a).data;let s,n,o,l,c,u;e:for(n=a;n--;)for(s=r;s--;)if(i[4*(r*n+s)+3]>t){u=n;break e}if(!u)return null;e:for(s=r;s--;)for(n=u+1;n--;)if(i[4*(r*n+s)+3]>t){c=s;break e}e:for(s=0;s<=c;++s)for(n=u+1;n--;)if(i[4*(r*n+s)+3]>t){o=s;break e}e:for(n=0;n<=u;++n)for(s=o;s<=c;++s)if(i[4*(r*n+s)+3]>t){l=n;break e}return{x:o,y:l,width:c-o,height:u-l}}(r);if(!o)return null;r.clearRect(0,0,t,t);const l=Object(y.d)(e.size)/Math.max(o.width,o.height);r.scale(l,l);const c=t/l;if(r.translate(c/2-o.width/2-o.x,c/2-o.height/2-o.y),Array.isArray(e.color)&&r.fill(n),null!=(s=e.outline)&&s.width&&Array.isArray(e.outline.color)){const t=e.outline;r.lineWidth=Object(y.d)(t.width)/l,r.lineJoin=\"round\",r.strokeStyle=`rgba(${t.color[0]},${t.color[1]},${t.color[2]},${t.color[3]/255})`,r.stroke(n),o.width+=r.lineWidth,o.height+=r.lineWidth}o.width*=l,o.height*=l;const u=r.getImageData(512-o.width/2,512-o.height/2,Math.ceil(o.width),Math.ceil(o.height));a=u.width,i=u.height,r.canvas.width=a,r.canvas.height=i,r.putImageData(u,0,0)}else{const t=\"image/svg+xml\"===e.contentType?\"data:image/svg+xml;base64,\"+e.imageData:e.url,s=(await Object(h.default)(t,{responseType:\"image\"})).data;a=Object(y.d)(e.width),i=Object(y.d)(e.height),r.canvas.width=a,r.canvas.height=i,r.drawImage(s,0,0,r.canvas.width,r.canvas.height)}return{type:\"esriPMS\",imageData:r.canvas.toDataURL(\"image/png\").substr(22),angle:e.angle,contentType:\"image/png\",height:Object(y.e)(i),width:Object(y.e)(a),xoffset:e.xoffset,yoffset:e.yoffset}}async _convertSvgRenderer(e){const t=e.type;if(\"simple\"===t&&we(e.symbol))e.symbol=await this._convertSvgToPictureMarkerSymbolJson(e.symbol);else if(\"uniqueValue\"===t||\"classBreaks\"===t){we(e.defaultSymbol)&&(e.defaultSymbol=await this._convertSvgToPictureMarkerSymbolJson(e.defaultSymbol));const r=e[\"uniqueValue\"===t?\"uniqueValueInfos\":\"classBreakInfos\"];if(r)for(const e of r)we(e.symbol)&&(e.symbol=await this._convertSvgToPictureMarkerSymbolJson(e.symbol))}}_getGraphics(e){return e.queryFeatures(je).then(e=>e.features)}async _getPrintDefinition(e,t){const r=e.view;let a=r.spatialReference;const i={operationalLayers:await this._createOperationalLayers(r,t)};let s=this._ssExtent||e.extent||r.extent;return a&&a.isWrappable&&(s=s.clone()._normalize(!0),a=s.spatialReference),i.mapOptions={extent:s&&s.toJSON(),spatialReference:a&&a.toJSON(),showAttribution:t.attributionVisible},this._ssExtent=null,r.background&&(i.background=r.background.toJSON()),r.rotation&&(i.mapOptions.rotation=-r.rotation),t.scalePreserved&&(i.mapOptions.scale=t.outScale||r.scale),i}async _getGpPrintParams(e){const t=e.template||new ge;null==t.showLabels&&(t.showLabels=!0);const r=t.exportOptions;let a;const s=W(t.layout);r&&(a={dpi:r.dpi},\"map_only\"===s.toLowerCase()||\"\"===s)&&(a.outputSize=[r.width,r.height]);const n=t.layoutOptions;let o;if(n){let e,t;\"Miles\"===n.scalebarUnit||\"Kilometers\"===n.scalebarUnit?(e=\"Kilometers\",t=\"Miles\"):\"Meters\"!==n.scalebarUnit&&\"Feet\"!==n.scalebarUnit||(e=\"Meters\",t=\"Feet\"),o={titleText:n.titleText,authorText:n.authorText,copyrightText:n.copyrightText,customTextElements:n.customTextElements,scaleBarOptions:{metricUnit:Se.toJSON(e),metricLabel:Oe[e],nonMetricUnit:Se.toJSON(t),nonMetricLabel:Oe[t]}}}let l=null;n&&n.legendLayers&&(l=n.legendLayers.map(e=>{this._legendLayerNameMap[e.layerId]=e.title;const t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t}));const u=await this._getPrintDefinition(e,t);if(u.operationalLayers){const e=new RegExp(\"[\\\\u4E00-\\\\u9FFF\\\\u0E00-\\\\u0E7F\\\\u0900-\\\\u097F\\\\u3040-\\\\u309F\\\\u30A0-\\\\u30FF\\\\u31F0-\\\\u31FF]\"),t=/[\\u0600-\\u06FF]/,r=r=>{const a=r.text,i=r.font,s=i&&i.family&&i.family.toLowerCase();a&&i&&(\"arial\"===s||\"arial unicode ms\"===s)&&(i.family=e.test(a)?\"Arial Unicode MS\":\"Arial\",\"normal\"!==i.style&&t.test(a)&&(i.family=\"Arial Unicode MS\"))},a=()=>{throw new c.a(\"print-task:cim-symbol-unsupported\",\"CIMSymbol is not supported by a print service published from ArcMap\")};u.operationalLayers.forEach(e=>{var t,i,s;null!=(t=e.featureCollection)&&t.layers?e.featureCollection.layers.forEach(e=>{var t,i,s,n;if(null!=(t=e.layerDefinition)&&null!=(i=t.drawingInfo)&&null!=(s=i.renderer)&&s.symbol){const t=e.layerDefinition.drawingInfo.renderer;\"esriTS\"===t.symbol.type?r(t.symbol):\"CIMSymbolReference\"!==t.symbol.type||this._is11xService||a()}null!=(n=e.featureSet)&&n.features&&e.featureSet.features.forEach(e=>{e.symbol&&(\"esriTS\"===e.symbol.type?r(e.symbol):\"CIMSymbolReference\"!==e.symbol.type||this._is11xService||a())})}):!this._is11xService&&null!=(i=e.layerDefinition)&&null!=(s=i.drawingInfo)&&s.renderer&&JSON.stringify(e.layerDefinition.drawingInfo.renderer).includes('\"type\":\"CIMSymbolReference\"')&&a()})}e.outSpatialReference&&(u.mapOptions.spatialReference=e.outSpatialReference.toJSON()),Object(i.d)(u,{exportOptions:a,layoutOptions:o}),Object(i.d)(u.layoutOptions,{legendOptions:{operationalLayers:null!=l?l:this._legendLayers.slice()}}),this._legendLayers.length=0;const p={Web_Map_as_JSON:JSON.stringify(u),Format:z(t.format),Layout_Template:s};return e.extraParameters&&Object(i.d)(p,e.extraParameters),p}};Object(a.a)([Object(n.b)({dependsOn:[\"url\"]})],_e.prototype,\"_geoprocessor\",null),Object(a.a)([Object(n.b)()],_e.prototype,\"_gpMetadata\",void 0),Object(a.a)([Object(n.b)({dependsOn:[\"_gpMetadata\"],readOnly:!0})],_e.prototype,\"mode\",null),Object(a.a)([Object(n.b)()],_e.prototype,\"updateDelay\",void 0),_e=Object(a.a)([Object(l.a)(\"esri.tasks.PrintTask\")],_e),t.default=_e}}]);","name":"147.b4dfb11956a42da65caf.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[147],{\n\n/***/ \"9XlO\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"pO5D\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js\nvar has = __webpack_require__(\"wSAH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/lang.js\nvar lang = __webpack_require__(\"f/qv\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Logger.js\nvar Logger = __webpack_require__(\"6S2I\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/ensureType.js\nvar ensureType = __webpack_require__(\"zqDF\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js\nvar property = __webpack_require__(\"WbKI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/jsonMap.js\nvar jsonMap = __webpack_require__(\"+opI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js + 1 modules\nvar subclass = __webpack_require__(\"04ZG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Error.js\nvar Error = __webpack_require__(\"zlDU\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/urlUtils.js\nvar urlUtils = __webpack_require__(\"4EHJ\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/uuid.js\nvar uuid = __webpack_require__(\"ju1D\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/portal/support/resourceExtension.js\nvar resourceExtension = __webpack_require__(\"9AIY\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/promiseUtils.js\nvar promiseUtils = __webpack_require__(\"9MzC\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Polygon.js\nvar Polygon = __webpack_require__(\"Ehki\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/screenUtils.js\nvar screenUtils = __webpack_require__(\"qRWG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/kernel.js + 1 modules\nvar kernel = __webpack_require__(\"975N\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/request.js\nvar request = __webpack_require__(\"Lqtk\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/renderers/visualVariables/support/visualVariableUtils.js\nvar visualVariableUtils = __webpack_require__(\"0pea\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/tasks/support/Query.js\nvar Query = __webpack_require__(\"xk++\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/tasks/Task.js\nvar Task = __webpack_require__(\"kglp\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/compilerUtils.js\nvar compilerUtils = __webpack_require__(\"bJda\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/SpatialReference.js\nvar SpatialReference = __webpack_require__(\"WZb1\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Extent.js\nvar Extent = __webpack_require__(\"OvF4\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/normalizeUtils.js + 2 modules\nvar normalizeUtils = __webpack_require__(\"qNUd\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/Field.js\nvar Field = __webpack_require__(\"ofM5\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/tasks/support/FeatureSet.js\nvar FeatureSet = __webpack_require__(\"8prj\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/tasks/support/GPMessage.js\nvar GPMessage = __webpack_require__(\"DKHk\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/JSONSupport.js\nvar JSONSupport = __webpack_require__(\"ag7Y\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/MapImage.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet MapImage_p=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(){super(...arguments),this.extent=null,this.height=null,this.href=null,this.opacity=1,this.rotation=0,this.scale=null,this.visible=!0,this.width=null}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Extent[\"a\" /* default */]})],MapImage_p.prototype,\"extent\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],MapImage_p.prototype,\"height\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],MapImage_p.prototype,\"href\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],MapImage_p.prototype,\"opacity\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],MapImage_p.prototype,\"rotation\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],MapImage_p.prototype,\"scale\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],MapImage_p.prototype,\"visible\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],MapImage_p.prototype,\"width\",void 0),MapImage_p=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layer.support.MapImage\")],MapImage_p);var MapImage_i=MapImage_p;/* harmony default export */ var MapImage = (MapImage_i);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/DataFile.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet DataFile_e=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(r){super(r),this.itemId=null,this.url=null}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{read:{source:\"itemID\"},write:{target:\"itemID\"}}})],DataFile_e.prototype,\"itemId\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{write:!0}})],DataFile_e.prototype,\"url\",void 0),DataFile_e=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.tasks.support.DataFile\")],DataFile_e);var DataFile_p=DataFile_e;/* harmony default export */ var DataFile = (DataFile_p);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/JobInfo.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst JobInfo_p=new jsonMap[\"a\" /* JSONMap */]({esriJobCancelled:\"job-cancelled\",esriJobCancelling:\"job-cancelling\",esriJobDeleted:\"job-deleted\",esriJobDeleting:\"job-deleting\",esriJobTimedOut:\"job-timed-out\",esriJobExecuting:\"job-executing\",esriJobFailed:\"job-failed\",esriJobNew:\"job-new\",esriJobSubmitted:\"job-submitted\",esriJobSucceeded:\"job-succeeded\",esriJobWaiting:\"job-waiting\"});let JobInfo_c=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(o){super(o),this.jobId=null,this.jobStatus=null,this.messages=null}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],JobInfo_c.prototype,\"jobId\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:JobInfo_p.read}})],JobInfo_c.prototype,\"jobStatus\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[GPMessage[\"a\" /* default */]]})],JobInfo_c.prototype,\"messages\",void 0),JobInfo_c=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.tasks.support.JobInfo\")],JobInfo_c);var JobInfo_b=JobInfo_c;/* harmony default export */ var JobInfo = (JobInfo_b);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/LinearUnit.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst LinearUnit_i=new jsonMap[\"a\" /* JSONMap */]({esriMeters:\"meters\",esriFeet:\"feet\",esriKilometers:\"kilometers\",esriMiles:\"miles\",esriNauticalMiles:\"nautical-miles\",esriYards:\"yards\"},{ignoreUnknown:!1});let LinearUnit_p=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(r){super(r),this.distance=0,this.units=null}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],LinearUnit_p.prototype,\"distance\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:LinearUnit_i.read,write:LinearUnit_i.write}})],LinearUnit_p.prototype,\"units\",void 0),LinearUnit_p=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri/tasks/support/LinearUnit\")],LinearUnit_p);var LinearUnit_c=LinearUnit_p;/* harmony default export */ var LinearUnit = (LinearUnit_c);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/ParameterValue.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst ParameterValue_u=new jsonMap[\"a\" /* JSONMap */]({GPBoolean:\"boolean\",GPDataFile:\"data-file\",GPDate:\"date\",GPDouble:\"double\",GPFeatureRecordSetLayer:\"feature-record-set-layer\",GPField:\"field\",GPLinearUnit:\"linear-unit\",GPLong:\"long\",GPRasterData:\"raster-data\",GPRasterDataLayer:\"raster-data-layer\",GPRecordSet:\"record-set\",GPString:\"string\",\"GPMultiValue:GPBoolean\":\"multi-value\",\"GPMultiValue:GPDataFile\":\"multi-value\",\"GPMultiValue:GPDate\":\"multi-value\",\"GPMultiValue:GPDouble\":\"multi-value\",\"GPMultiValue:GPFeatureRecordSetLayer\":\"multi-value\",\"GPMultiValue:GPField\":\"multi-value\",\"GPMultiValue:GPLinearUnit\":\"multi-value\",\"GPMultiValue:GPLong\":\"multi-value\",\"GPMultiValue:GPRasterData\":\"multi-value\",\"GPMultiValue:GPRasterDataLayer\":\"multi-value\",\"GPMultiValue:GPRecordSet\":\"multi-value\",\"GPMultiValue:GPString\":\"multi-value\"});let ParameterValue_o=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(e){super(e),this.dataType=null,this.value=null}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:ParameterValue_u.read,write:ParameterValue_u.write}})],ParameterValue_o.prototype,\"dataType\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],ParameterValue_o.prototype,\"value\",void 0),ParameterValue_o=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.tasks.support.ParameterValue\")],ParameterValue_o);var ParameterValue_i=ParameterValue_o;/* harmony default export */ var ParameterValue = (ParameterValue_i);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/RasterData.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet RasterData_e=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(r){super(r),this.format=null,this.itemId=null,this.url=null}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],RasterData_e.prototype,\"format\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"itemID\"},write:{target:\"itemID\"}}})],RasterData_e.prototype,\"itemId\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],RasterData_e.prototype,\"url\",void 0),RasterData_e=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri/tasks/support/RasterData\")],RasterData_e);var RasterData_p=RasterData_e;/* harmony default export */ var RasterData = (RasterData_p);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/Geoprocessor.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet Geoprocessor_g=class extends Task[\"a\" /* default */]{constructor(e){super(e),this._timers=new Map,this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}destroy(){this._timers.forEach((e=>{clearInterval(e)}))}cancelJob(e,t){const{path:r}=this.parsedUrl,s={...this.requestOptions,...t,query:{f:\"json\"}};this._clearTimer(e);return Object(request[\"default\"])(`${r}/jobs/${e}/cancel`,s).then((e=>JobInfo.fromJSON(e.data)))}checkJobStatus(e,t){const{path:r}=this.parsedUrl,s={...this.requestOptions,...t,query:{f:\"json\"}};return Object(request[\"default\"])(`${r}/jobs/${e}`,s).then((e=>JobInfo.fromJSON(e.data)))}execute(e,t){return this._constructRequest(\"execute\",e,t).then((e=>{const t=e.data.results||[],r=e.data.messages||[];return{results:t.map(this._decode),messages:r.map((e=>GPMessage[\"a\" /* default */].fromJSON(e)))}}))}getResultData(e,t,r){const{returnFeatureCollection:s,returnM:a,returnZ:o,outSpatialReference:i,parsedUrl:u}=this,{path:n}=u,c={returnFeatureCollection:s||void 0,returnM:a||void 0,returnZ:o||void 0,outSR:i,returnType:\"data\",f:\"json\"},p=this._gpEncode(c,null),m={...this.requestOptions,...r,query:p};return Object(request[\"default\"])(`${n}/jobs/${e}/results/${t}`,m).then((e=>this._decode(e.data)))}getResultImage(e,t,r,s){const{path:a}=this.parsedUrl,o={...r.toJSON(),f:\"json\"},i=this._gpEncode(o),u={...this.requestOptions,...s,query:i};return Object(request[\"default\"])(`${a}/jobs/${e}/results/${t}`,u).then((e=>this._decode(e.data)))}async getResultMapImageLayer(e){const{path:t}=this.parsedUrl,r=t.indexOf(\"/GPServer/\"),s=`${t.substring(0,r)}/MapServer/jobs/${e}`;return new(0,(await Promise.all(/* import() */[__webpack_require__.e(0), __webpack_require__.e(31)]).then(__webpack_require__.bind(null, \"U/i9\"))).default)({url:s})}submitJob(e,t){return this._constructRequest(\"submitJob\",e,t).then((e=>JobInfo.fromJSON(e.data)))}waitForJobCompletion(e,r={}){const{interval:s=1e3,signal:u,statusCallback:n}=r;return Object(promiseUtils[\"c\" /* create */])(((r,a)=>{Object(promiseUtils[\"r\" /* onAbort */])(u,(()=>{this._clearTimer(e),a(Object(promiseUtils[\"e\" /* createAbortError */])())})),this._clearTimer(e);const l=setInterval((()=>{this._timers.has(e)||a(Object(promiseUtils[\"e\" /* createAbortError */])()),this._getJobStatus(e,this.requestOptions).then((s=>{const{jobStatus:o}=s;switch(o){case\"job-succeeded\":this._clearTimer(e),r(s);break;case\"job-submitted\":case\"job-executing\":case\"job-waiting\":case\"job-new\":n&&n(s);break;case\"job-cancelled\":case\"job-cancelling\":case\"job-deleted\":case\"job-deleting\":case\"job-timed-out\":case\"job-failed\":this._clearTimer(e),a(s);break;default:Object(compilerUtils[\"a\" /* neverReached */])(o)}}))}),s);this._timers.set(e,l)}))}_clearTimer(e){this._timers.has(e)&&(clearInterval(this._timers.get(e)),this._timers.delete(e))}_constructRequest(e,t,r){const s={},a={},o=[];return this._collectGeometries(t,o,s),Object(normalizeUtils[\"a\" /* normalizeCentralMeridian */])(o).then((o=>{const{outSpatialReference:i,parsedUrl:u,processExtent:n,processSpatialReference:c,returnFeatureCollection:p,returnM:m,returnZ:h}=this,{path:d}=u;for(const e in s){const t=s[e];a[e]=o.slice(t[0],t[1])}const f=i?i.wkid||i:null,b=c?c.wkid||c:null,j=\"execute\"===e?{returnFeatureCollection:p||void 0,returnM:m||void 0,returnZ:h||void 0}:null,S={...n?{context:{extent:n,outSR:f,processSR:b}}:{\"env:outSR\":f,\"env:processSR\":b},...t,...j,f:\"json\"},v=this._gpEncode(S,null,a),G={...this.requestOptions,...r,query:v};return Object(request[\"default\"])(`${d}/${e}`,G)}))}_collectGeometries(e,t,r){for(const s in e){const a=e[s];if(a&&\"object\"==typeof a&&a instanceof FeatureSet[\"default\"]){const{features:e}=a;r[s]=[t.length,t.length+e.length],e.forEach((e=>{t.push(e.geometry)}))}}}_decode(e){const t=e.dataType,r=ParameterValue.fromJSON(e);switch(t){case\"GPBoolean\":case\"GPDouble\":case\"GPLong\":case\"GPString\":return r;case\"GPDate\":r.value=new Date(r.value);break;case\"GPDataFile\":r.value=DataFile.fromJSON(r.value);break;case\"GPLinearUnit\":r.value=LinearUnit.fromJSON(r.value);break;case\"GPFeatureRecordSetLayer\":case\"GPRecordSet\":{const t=e.value.url;r.value=t?DataFile.fromJSON(r.value):FeatureSet[\"default\"].fromJSON(r.value);break}case\"GPRasterData\":case\"GPRasterDataLayer\":{const t=e.value.mapImage;r.value=t?MapImage.fromJSON(t):RasterData.fromJSON(r.value);break}case\"GPField\":r.value=Field[\"a\" /* default */].fromJSON(r.value);break;case\"GPMultiValue:GPBoolean\":case\"GPMultiValue:GPDouble\":case\"GPMultiValue:GPLong\":case\"GPMultiValue:GPString\":return r;case\"GPMultiValue:GPDate\":{const e=r.value;r.value=e.map((e=>new Date(e)));break}case\"GPMultiValue:GPDataFile\":r.value=r.value.map((e=>DataFile.fromJSON(e)));break;case\"GPMultiValue:GPLinearUnit\":r.value=r.value.map((e=>LinearUnit.fromJSON(e)));break;case\"GPMultiValue:GPFeatureRecordSetLayer\":case\"GPMultiValue:GPRecordSet\":r.value=r.value.map((e=>FeatureSet[\"default\"].fromJSON(e)));break;case\"GPMultiValue:GPRasterData\":case\"GPMultiValue:GPRasterDataLayer\":r.value=r.value.map((e=>e?MapImage.fromJSON(e):RasterData.fromJSON(r.value)));break;case\"GPMultiValue:GPField\":r.value=r.value.map((e=>Field[\"a\" /* default */].fromJSON(e)))}return r}_gpEncode(e,t,r){for(const t in e){const r=e[t];Array.isArray(r)?e[t]=JSON.stringify(r.map((e=>this._gpEncode({item:e},!0).item),this)):r instanceof Date&&(e[t]=r.getTime())}return this._encode(e,t,r)}_getJobStatus(e,t){const{path:r}=this.parsedUrl,s=`${r}/jobs/${e}`,a={...this.requestOptions,...t,query:{f:\"json\"}};return Object(request[\"default\"])(s,a).then((e=>JobInfo.fromJSON(e.data)))}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:SpatialReference[\"a\" /* default */]})],Geoprocessor_g.prototype,\"outSpatialReference\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Extent[\"a\" /* default */]})],Geoprocessor_g.prototype,\"processExtent\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:SpatialReference[\"a\" /* default */]})],Geoprocessor_g.prototype,\"processSpatialReference\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({nonNullable:!0})],Geoprocessor_g.prototype,\"returnFeatureCollection\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({nonNullable:!0})],Geoprocessor_g.prototype,\"returnM\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({nonNullable:!0})],Geoprocessor_g.prototype,\"returnZ\",void 0),Geoprocessor_g=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri/tasks/Geoprocessor\")],Geoprocessor_g);var P=Geoprocessor_g;/* harmony default export */ var Geoprocessor = (P);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/fileFormat.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst fileFormat_p=new jsonMap[\"a\" /* JSONMap */]({PDF:\"pdf\",PNG32:\"png32\",PNG8:\"png8\",JPG:\"jpg\",GIF:\"gif\",EPS:\"eps\",SVG:\"svg\",SVGZ:\"svgz\"}),fileFormat_n=fileFormat_p.fromJSON.bind(fileFormat_p),fileFormat_g=fileFormat_p.toJSON.bind(fileFormat_p);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/layoutTemplate.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst layoutTemplate_t=new jsonMap[\"a\" /* JSONMap */]({MAP_ONLY:\"map-only\",\"A3 Landscape\":\"a3-landscape\",\"A3 Portrait\":\"a3-portrait\",\"A4 Landscape\":\"a4-landscape\",\"A4 Portrait\":\"a4-portrait\",\"Letter ANSI A Landscape\":\"letter-ansi-a-landscape\",\"Letter ANSI A Portrait\":\"letter-ansi-a-portrait\",\"Tabloid ANSI B Landscape\":\"tabloid-ansi-b-landscape\",\"Tabloid ANSI B Portrait\":\"tabloid-ansi-b-portrait\"}),layoutTemplate_r=layoutTemplate_t.fromJSON.bind(layoutTemplate_t),layoutTemplate_o=layoutTemplate_t.toJSON.bind(layoutTemplate_t);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/printTaskUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction printTaskUtils_o(o,a){const{graphic:l,renderer:u,symbol:s}=a,y=s.type;if(\"text\"===y||\"shield-label-symbol\"===y||!(\"visualVariables\"in u)||!u.visualVariables)return;const f=u.getVisualVariablesForType(\"size\"),p=u.getVisualVariablesForType(\"color\"),c=u.getVisualVariablesForType(\"opacity\"),m=u.getVisualVariablesForType(\"rotation\"),g=f&&f[0],d=p&&p[0],b=c&&c[0],h=m&&m[0];if(g){const t=\"simple-marker\"===y?s.style:null,n=Object(visualVariableUtils[\"e\" /* getSize */])(g,l,{shape:t});null!=n&&(\"simple-marker\"===y?o.size=Object(screenUtils[\"e\" /* px2pt */])(n):\"picture-marker\"===y?(o.width=Object(screenUtils[\"e\" /* px2pt */])(n),o.height=Object(screenUtils[\"e\" /* px2pt */])(n)):\"simple-line\"===y?o.width=Object(screenUtils[\"e\" /* px2pt */])(n):o.outline&&(o.outline.width=Object(screenUtils[\"e\" /* px2pt */])(n)))}if(d){const e=Object(visualVariableUtils[\"b\" /* getColor */])(d,l);(e&&\"simple-marker\"===y||\"simple-line\"===y||\"simple-fill\"===y)&&(o.color=e?e.toJSON():void 0)}if(b){const e=Object(visualVariableUtils[\"c\" /* getOpacity */])(b,l);null!=e&&o.color&&(o.color[3]=Math.round(255*e))}h&&(o.angle=-Object(visualVariableUtils[\"d\" /* getRotationAngle */])(u,l))}function printTaskUtils_a(){return{layerDefinition:{name:\"multipointLayer\",geometryType:\"esriGeometryMultipoint\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryMultipoint\",features:[]}}}function printTaskUtils_l(){return{layerDefinition:{name:\"polygonLayer\",geometryType:\"esriGeometryPolygon\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPolygon\",features:[]}}}function printTaskUtils_u(){return{layerDefinition:{name:\"pointLayer\",geometryType:\"esriGeometryPoint\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPoint\",features:[]}}}function printTaskUtils_s(){return{layerDefinition:{name:\"polylineLayer\",geometryType:\"esriGeometryPolyline\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPolyline\",features:[]}}}function printTaskUtils_y(e,r=15){const t=e.canvas.width,n=e.canvas.height,i=e.getImageData(0,0,t,n).data;let o,a,l,u,s,y;e:for(a=n;a--;)for(o=t;o--;)if(i[4*(t*a+o)+3]>r){y=a;break e}if(!y)return null;e:for(o=t;o--;)for(a=y+1;a--;)if(i[4*(t*a+o)+3]>r){s=o;break e}e:for(o=0;o<=s;++o)for(a=y+1;a--;)if(i[4*(t*a+o)+3]>r){l=o;break e}e:for(a=0;a<=y;++a)for(o=l;o<=s;++o)if(i[4*(t*a+o)+3]>r){u=a;break e}return{x:l,y:u,width:s-l,height:y-u}}function printTaskUtils_f(e,r){const t=e.allLayerViews.items;if(r===e.scale)return t.filter((e=>!e.suspended));const n=new Array;for(const e of t)printTaskUtils_h(e.parent)&&!n.includes(e.parent)||!e.visible||r&&\"isVisibleAtScale\"in e&&!e.isVisibleAtScale(r)||n.push(e);return n}function printTaskUtils_p(e){return e&&\"bing-maps\"===e.type}function printTaskUtils_c(e){return e&&\"csv\"===e.type}function printTaskUtils_m(e){return e&&\"feature\"===e.type}function printTaskUtils_g(e){return e&&\"geojson\"===e.type}function printTaskUtils_d(e){return e&&\"graphics\"===e.type}function printTaskUtils_b(e){return e&&\"group\"===e.type}function printTaskUtils_h(e){return e&&\"esri.views.2d.layers.GroupLayerView2D\"===e.declaredClass}function w(e){return e&&\"imagery\"===e.type}function V(e){return e&&\"kml\"===e.type}function T(e){return e&&\"map-image\"===e.type}function printTaskUtils_v(e){return e&&\"map-notes\"===e.type}function k(e){return e&&\"open-street-map\"===e.type}function printTaskUtils_G(e){return e&&\"stream\"===e.type}function printTaskUtils_S(e){return e&&\"tile\"===e.type}function D(e){return e&&\"vector-tile\"===e.type}function L(e){return e&&\"web-tile\"===e.type}function printTaskUtils_P(e){return e&&\"wms\"===e.type}function I(e){return e&&\"wmts\"===e.type}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/deprecate.js\nvar deprecate = __webpack_require__(\"4gt3\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Accessor.js + 5 modules\nvar Accessor = __webpack_require__(\"/CmD\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/PrintTemplate.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst PrintTemplate_i=Logger[\"a\" /* default */].getLogger(\"esri.tasks.support.PrintTemplate\");function PrintTemplate_a(){Object(deprecate[\"b\" /* deprecatedProperty */])(PrintTemplate_i,\"preserveScale\",{replacement:\"scalePreserved\",version:\"4.16\"})}let PrintTemplate_c=class extends Accessor[\"a\" /* default */]{constructor(e){super(e),this.attributionVisible=!0,this.exportOptions={width:800,height:1100,dpi:96},this.forceFeatureAttributes=!1,this.format=\"png32\",this.label=null,this.layout=\"map-only\",this.layoutOptions=null,this.outScale=0,this.scalePreserved=!0,this.showLabels=!0}get preserveScale(){return PrintTemplate_a(),this.scalePreserved}set preserveScale(e){PrintTemplate_a(),this.scalePreserved=e}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"attributionVisible\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"exportOptions\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"forceFeatureAttributes\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"format\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"label\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"layout\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"layoutOptions\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"outScale\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({dependsOn:[\"scalePreserved\"]})],PrintTemplate_c.prototype,\"preserveScale\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"scalePreserved\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],PrintTemplate_c.prototype,\"showLabels\",void 0),PrintTemplate_c=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.tasks.support.PrintTemplate\")],PrintTemplate_c);var PrintTemplate_l=PrintTemplate_c;/* harmony default export */ var PrintTemplate = (PrintTemplate_l);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/PrintTask.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst q={Feet:\"ft\",Kilometers:\"km\",Meters:\"m\",Miles:\"mi\"},B=new jsonMap[\"a\" /* JSONMap */]({esriFeet:\"Feet\",esriKilometers:\"Kilometers\",esriMeters:\"Meters\",esriMiles:\"Miles\"}),K=new jsonMap[\"a\" /* JSONMap */]({esriExecutionTypeSynchronous:\"sync\",esriExecutionTypeAsynchronous:\"async\"}),Q=new Query[\"a\" /* default */]({returnGeometry:!0});function H(e){return e&&(e.path||\"image/svg+xml\"===e.contentType||e.url&&e.url.endsWith(\".svg\"))}let X=class extends Task[\"a\" /* default */]{constructor(...e){super(...e),this._ssExtent=null,this._legendLayers=[],this._legendLayerNameMap={},this._gpServerUrl=null,this._cimVersion=null,this._is11xService=!1,this._gpMetadata=null,this.updateDelay=1e3}get _geoprocessor(){return new Geoprocessor({url:this.url})}get mode(){return this._gpMetadata&&this._gpMetadata.executionType?K.fromJSON(this._gpMetadata.executionType):\"sync\"}execute(e,t){let r=this.url;const i=r.lastIndexOf(\"/GPServer/\");return i>0&&(r=r.slice(0,i+9)),Object(promiseUtils[\"u\" /* resolve */])().then((()=>this._gpServerUrl===r?{data:this._gpMetadata}:(this._gpServerUrl=r,Object(request[\"default\"])(r,{query:{f:\"json\"}})))).then((t=>(this._gpMetadata=t.data,this._cimVersion=this._gpMetadata.cimVersion,this._is11xService=!!this._cimVersion,this._getGpPrintParams(e)))).then((e=>{const r=e=>\"sync\"===this.mode?e.results&&e.results[0]&&e.results[0].value:this._geoprocessor.getResultData(e.jobId,\"Output_File\",t).then((e=>e.value));return\"async\"===this.mode?this._geoprocessor.submitJob(e,t).then((e=>this._geoprocessor.waitForJobCompletion(e.jobId,{interval:this.updateDelay}).then(r))):this._geoprocessor.execute(e,t).then(r)}))}async _createOperationalLayers(e,t){const r=[],i={layerView:null,printTemplate:t,view:e};let a=0;t.scalePreserved&&(a=t.outScale||e.scale);const s=printTaskUtils_f(e,a);for(const e of s){const t=e.layer;if(!t.loaded||printTaskUtils_b(t))continue;let a;i.layerView=e,a=printTaskUtils_p(t)?this._createBingMapsLayerJSON(t):printTaskUtils_c(t)?await this._createCSVLayerJSON(t,i):printTaskUtils_m(t)?await this._createFeatureLayerJSON(t,i):printTaskUtils_g(t)?await this._createGeoJSONLayer(t,i):printTaskUtils_d(t)?await this._createGraphicsLayerJSON(t,i):w(t)?this._createImageryLayerJSON(t):V(t)?await this._createKMLLayerJSON(t,i):T(t)?this._createMapImageLayerJSON(t,i):printTaskUtils_v(t)?await this._createMapNotesLayerJSON(i):k(t)?this._createOpenStreetMapLayerJSON():printTaskUtils_G(t)?await this._createStreamLayerJSON(t,i):printTaskUtils_S(t)?this._createTileLayerJSON(t):D(t)?await this._createVectorTileLayerJSON(t,i):L(t)?this._createWebTileLayerJSON(t):printTaskUtils_P(t)?this._createWMSLayerJSON(t):I(t)?this._createWMTSLayerJSON(t):await this._createScreenshotJSON(t,i),a&&(Array.isArray(a)?r.push(...a):(a.id=t.id,a.title=this._legendLayerNameMap[t.id]||t.title,a.opacity=t.opacity,a.minScale=t.minScale||0,a.maxScale=t.maxScale||0,r.push(a)))}if(a&&r.forEach((e=>{e.minScale=0,e.maxScale=0})),e.graphics&&e.graphics.length){const i=await this._createFeatureCollectionJSON(null,e.graphics,t);i&&r.push(i)}return r}_createBingMapsLayerJSON(e){return{culture:e.culture,key:e.key,type:\"BingMaps\"+(\"aerial\"===e.style?\"Aerial\":\"hybrid\"===e.style?\"Hybrid\":\"Road\")}}async _createCSVLayerJSON(e,{layerView:t,printTemplate:r}){let i;if(this._legendLayers&&this._legendLayers.push({id:e.id}),!this._is11xService){const i=await this._getGraphics(t);return this._createFeatureCollectionJSON(e,i,r)}return i={type:\"CSV\"},e.write(i,{origin:\"web-map\"}),delete i.popupInfo,delete i.layerType,i.showLabels=r.showLabels&&e.labelsVisible,i}async _createFeatureCollectionJSON(e,t,r){let i;const a=printTaskUtils_l(),s=printTaskUtils_s(),n=printTaskUtils_u(),o=printTaskUtils_a(),l=printTaskUtils_u();if(l.layerDefinition.name=\"textLayer\",delete l.layerDefinition.drawingInfo,e){if(\"esri.layers.FeatureLayer\"===e.declaredClass||\"esri.layers.StreamLayer\"===e.declaredClass?a.layerDefinition.name=s.layerDefinition.name=n.layerDefinition.name=o.layerDefinition.name=this._legendLayerNameMap[e.id]||e.get(\"arcgisProps.title\")||e.title:\"esri.layers.GraphicsLayer\"===e.declaredClass&&(t=e.graphics.items),e.renderer){const t=e.renderer.toJSON();a.layerDefinition.drawingInfo.renderer=t,s.layerDefinition.drawingInfo.renderer=t,n.layerDefinition.drawingInfo.renderer=t,o.layerDefinition.drawingInfo.renderer=t}if(r.showLabels&&e.labelsVisible&&\"function\"==typeof e.write){var u,y;const t=null==(u=e.write({},{origin:\"web-map\"}).layerDefinition)||null==(y=u.drawingInfo)?void 0:y.labelingInfo;t&&(i=!0,a.layerDefinition.drawingInfo.labelingInfo=t,s.layerDefinition.drawingInfo.labelingInfo=t,n.layerDefinition.drawingInfo.labelingInfo=t,o.layerDefinition.drawingInfo.labelingInfo=t)}}let p;null!=e&&e.renderer||i||(delete a.layerDefinition.drawingInfo,delete s.layerDefinition.drawingInfo,delete n.layerDefinition.drawingInfo,delete o.layerDefinition.drawingInfo);const m=e&&e.fields,d=e&&e.renderer;if(m&&d&&\"function\"==typeof d.collectRequiredFields){const e=new Set;await d.collectRequiredFields(e,m),p=Array.from(e)}if(m){const e=m.map((e=>e.toJSON()));a.layerDefinition.fields=e,s.layerDefinition.fields=e,n.layerDefinition.fields=e,o.layerDefinition.fields=e}const h=t&&t.length;let f;for(let i=0;i<h;i++){const u=t[i]||t.getItemAt(i);if(!1===u.visible||!u.geometry)continue;if(f=u.toJSON(),f.hasOwnProperty(\"popupTemplate\")&&delete f.popupTemplate,f.geometry&&f.geometry.z&&delete f.geometry.z,f.symbol&&f.symbol.outline&&\"esriCLS\"===f.symbol.outline.type&&!this._is11xService)continue;!this._is11xService&&f.symbol&&f.symbol.outline&&f.symbol.outline.color&&f.symbol.outline.color[3]&&(f.symbol.outline.color[3]=255);const y=e&&e.renderer&&(\"valueExpression\"in e.renderer&&e.renderer.valueExpression||\"hasVisualVariables\"in e.renderer&&e.renderer.hasVisualVariables());if(!f.symbol&&e&&e.renderer&&y&&!this._is11xService){const t=e.renderer,r=await t.getSymbolAsync(u);if(!r)continue;f.symbol=r.toJSON(),\"hasVisualVariables\"in t&&t.hasVisualVariables()&&printTaskUtils_o(f.symbol,{renderer:t,graphic:u,symbol:r})}if(f.symbol&&(f.symbol.angle||delete f.symbol.angle,H(f.symbol)?f.symbol=await this._convertSvgToPictureMarkerSymbolJson(f.symbol):f.symbol.text&&delete f.attributes),(!r||!r.forceFeatureAttributes)&&p&&p.length){const e={};p.forEach((t=>{f.attributes&&f.attributes.hasOwnProperty(t)&&(e[t]=f.attributes[t])})),f.attributes=e}\"polygon\"===u.geometry.type?a.featureSet.features.push(f):\"polyline\"===u.geometry.type?s.featureSet.features.push(f):\"point\"===u.geometry.type?f.symbol&&f.symbol.text?l.featureSet.features.push(f):n.featureSet.features.push(f):\"multipoint\"===u.geometry.type?o.featureSet.features.push(f):\"extent\"===u.geometry.type&&(f.geometry=Polygon[\"a\" /* default */].fromExtent(u.geometry).toJSON(),a.featureSet.features.push(f))}const g=[a,s,o,n,l].filter((e=>e.featureSet.features.length>0));for(const e of g){const t=e.featureSet.features.every((e=>e.symbol));!t||r&&r.forceFeatureAttributes||e.featureSet.features.forEach((e=>{delete e.attributes})),t&&delete e.layerDefinition.drawingInfo,e.layerDefinition.drawingInfo&&e.layerDefinition.drawingInfo.renderer&&await this._convertSvgRenderer(e.layerDefinition.drawingInfo.renderer)}return g.length?{featureCollection:{layers:g},showLabels:i}:null}async _createFeatureLayerJSON(e,t){var r,i;let a;this._legendLayers&&this._legendLayers.push({id:e.id});const s=e.renderer;if(e.featureReduction||s&&\"dot-density\"===s.type&&(!this._is11xService||parseFloat(this._cimVersion)<2.6))return this._createScreenshotJSON(e,t);const{layerView:n,printTemplate:o,view:l}=t,c=s&&(\"valueExpression\"in s&&s.valueExpression||\"hasVisualVariables\"in s&&s.hasVisualVariables()),u=\"feature-layer\"!==(null==(r=e.source)?void 0:r.type)&&\"ogc-feature\"!==(null==(i=e.source)?void 0:i.type);if(!this._is11xService&&c||e.featureReduction||u||!s||\"field\"in s&&null!=s.field&&(\"string\"!=typeof s.field||!e.getField(s.field))){const t=await this._getGraphics(n);a=await this._createFeatureCollectionJSON(e,t,o)}else{var y,p;if(a={id:(m=e.write()).id,title:m.title,opacity:m.opacity,minScale:m.minScale,maxScale:m.maxScale,url:m.url,layerDefinition:m.layerDefinition},a.showLabels=o.showLabels&&e.labelsVisible,this._setURLandToken(a,e),null!=(y=a.layerDefinition)&&null!=(p=y.drawingInfo)&&p.renderer&&(delete a.layerDefinition.minScale,delete a.layerDefinition.maxScale,await this._convertSvgRenderer(a.layerDefinition.drawingInfo.renderer),\"visualVariables\"in s&&s.visualVariables&&s.visualVariables[0])){const e=s.visualVariables[0];if(\"size\"===e.type&&e.maxSize&&\"number\"!=typeof e.maxSize&&e.minSize&&\"number\"!=typeof e.minSize){const t=Object(visualVariableUtils[\"f\" /* getSizeRangeAtScale */])(e,l.scale);a.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=t.minSize,a.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=t.maxSize}}}var m;return a}async _createGeoJSONLayer(e,{layerView:t,printTemplate:r}){this._legendLayers&&this._legendLayers.push({id:e.id});const i=await this._getGraphics(t);return this._createFeatureCollectionJSON(e,i,r)}async _createGraphicsLayerJSON(e,{printTemplate:t}){return this._createFeatureCollectionJSON(e,null,t)}_createImageryLayerJSON(e){this._legendLayers&&this._legendLayers.push({id:e.id});const t={bandIds:e.bandIds,compressionQuality:e.compressionQuality,format:e.format,interpolation:e.interpolation};if((e.mosaicRule||e.definitionExpression)&&(t.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(this._is11xService)e.renderingRule&&(t.renderingRule=e.renderingRule.toJSON()),e.renderer&&(t.layerDefinition=t.layerDefinition||{},t.layerDefinition.drawingInfo=t.layerDefinition.drawingInfo||{},t.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{const r=e.exportImageServiceParameters.combineRendererWithRenderingRule();r&&(t.renderingRule=r.toJSON())}return this._setURLandToken(t,e),t}async _createKMLLayerJSON(e,t){const r=t.printTemplate;if(this._is11xService){const t={type:\"kml\"};return e.write(t,{origin:\"web-map\"}),delete t.layerType,t.url=Object(urlUtils[\"B\" /* normalize */])(e.url),t}{const i=[],a=t.layerView;a.allVisibleMapImages.forEach(((t,r)=>{const a={id:`${e.id}_image${r}`,type:\"image\",title:e.id,minScale:e.minScale||0,maxScale:e.maxScale||0,opacity:e.opacity,extent:t.extent};\"data:image/png;base64,\"===t.href.substr(0,22)?a.imageData=t.href.substr(22):a.url=t.href,i.push(a)}));const s=[...a.allVisiblePoints.items,...a.allVisiblePolylines.items,...a.allVisiblePolygons.items],n={id:e.id,...await this._createFeatureCollectionJSON(null,s,r)};return i.push(n),i}}_createMapImageLayerJSON(e,{view:t}){let r;const i={id:e.id,subLayerIds:[]};let a=[];const s=t.scale,n=e=>{const t=0===s,r=0===e.minScale||s<=e.minScale,o=0===e.maxScale||s>=e.maxScale;if(e.visible&&(t||r&&o))if(e.sublayers)e.sublayers.forEach(n);else{const t=e.toExportImageJSON(),r={id:e.id,name:e.title,layerDefinition:{drawingInfo:t.drawingInfo,definitionExpression:t.definitionExpression,source:t.source}};a.unshift(r),i.subLayerIds.push(e.id)}};return e.sublayers&&e.sublayers.forEach(n),a.length&&(a=a.map((({id:e,name:t,layerDefinition:r})=>({id:e,name:t,layerDefinition:r}))),r={layers:a,visibleLayers:i.subLayerIds},this._setURLandToken(r,e),this._legendLayers.push(i)),r}async _createMapNotesLayerJSON({layerView:e,printTemplate:t}){const r=[];for(const i of e.graphicsViews()){const e=await this._createFeatureCollectionJSON(i,i.graphics,t);e&&r.push(...e.featureCollection.layers)}return{featureCollection:{layers:r}}}_createOpenStreetMapLayerJSON(){return{type:\"OpenStreetMap\"}}async _createScreenshotJSON(e,{printTemplate:t,view:r}){const i={type:\"image\"},a={format:\"png\",ignoreBackground:!0,layers:[e],rotation:0},s=this._ssExtent||r.extent.clone();let n=96,l=!0,c=!0;if(t.exportOptions){const e=t.exportOptions;e.dpi>0&&(n=e.dpi),e.width>0&&(l=e.width%2==r.width%2),e.height>0&&(c=e.height%2==r.height%2)}if(\"map-only\"===t.layout&&t.scalePreserved&&(!t.outScale||t.outScale===r.scale)&&96===n&&(!l||!c)&&(a.area={x:0,y:0,width:r.width,height:r.height},l||(a.area.width-=1),c||(a.area.height-=1),!this._ssExtent)){const e=r.toMap(Object(screenUtils[\"b\" /* createScreenPoint */])(a.area.width,a.area.height));s.ymin=e.y,s.xmax=e.x,this._ssExtent=s}i.extent=s.clone()._normalize(!0).toJSON();const y=await r.takeScreenshot(a),p=Object(urlUtils[\"i\" /* dataComponents */])(y.dataUrl);return i.imageData=p.data,i}async _createStreamLayerJSON(e,{layerView:t,printTemplate:r}){this._legendLayers&&this._legendLayers.push({id:e.id});const i=await this._getGraphics(t);return this._createFeatureCollectionJSON(e,i,r)}_createTileLayerJSON(e){const t={customParameters:e.customParameters};return this._setURLandToken(t,e),t}async _createVectorTileLayerJSON(e,t){if(this._is11xService&&e.serviceUrl&&e.styleUrl){const t=kernel[\"b\" /* id */]&&kernel[\"b\" /* id */].findCredential(e.styleUrl),r=kernel[\"b\" /* id */]&&kernel[\"b\" /* id */].findCredential(e.serviceUrl);if(!t&&!r||\"2.1.0\"!==this._cimVersion){const i={type:\"VectorTileLayer\"};return i.styleUrl=Object(urlUtils[\"B\" /* normalize */])(e.styleUrl),t&&(i.token=t.token),r&&r.token!==i.token&&(i.additionalTokens=[{url:e.serviceUrl,token:r.token}]),i}}return this._createScreenshotJSON(e,t)}_createWebTileLayerJSON(e){const t={type:\"WebTiledLayer\",urlTemplate:e.urlTemplate.replace(/\\${/g,\"{\"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}_createWMSLayerJSON(e){let t;const r=[],i=e=>{e.visible&&(e.sublayers?e.sublayers.forEach(i):e.name&&r.unshift(e.name))};return e.sublayers&&e.sublayers.forEach(i),r.length&&(t={type:\"wms\",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:Object(urlUtils[\"B\" /* normalize */])(e.url),version:e.version}),t}_createWMTSLayerJSON(e){const t=e.activeLayer;return{type:\"wmts\",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:Object(urlUtils[\"B\" /* normalize */])(e.url)}}_setURLandToken(e,t){var r;if(!t.url)return;e.url=Object(urlUtils[\"B\" /* normalize */])(e.url||t.url);const i=null==(r=kernel[\"b\" /* id */])?void 0:r.findCredential(t.url);i&&(e.token=i.token)}async _convertSvgToPictureMarkerSymbolJson(e){this._canvas||(this._canvas=document.createElement(\"canvas\"));const t=1024;this._canvas.width=t,this._canvas.height=t;const r=this._canvas.getContext(\"2d\");let i,a;if(e.path){var s;const n=new Path2D(e.path);n.closePath(),r.fillStyle=Array.isArray(e.color)?`rgba(${e.color[0]},${e.color[1]},${e.color[2]},${e.color[3]/255})`:\"rgb(0,0,0)\",r.fill(n);const o=printTaskUtils_y(r);if(!o)return null;r.clearRect(0,0,t,t);const l=Object(screenUtils[\"d\" /* pt2px */])(e.size)/Math.max(o.width,o.height);r.scale(l,l);const c=t/l,u=c/2-o.width/2-o.x,p=c/2-o.height/2-o.y;if(r.translate(u,p),Array.isArray(e.color)&&r.fill(n),null!=(s=e.outline)&&s.width&&Array.isArray(e.outline.color)){const t=e.outline;r.lineWidth=Object(screenUtils[\"d\" /* pt2px */])(t.width)/l,r.lineJoin=\"round\",r.strokeStyle=`rgba(${t.color[0]},${t.color[1]},${t.color[2]},${t.color[3]/255})`,r.stroke(n),o.width+=r.lineWidth,o.height+=r.lineWidth}o.width*=l,o.height*=l;const m=r.getImageData(512-o.width/2,512-o.height/2,Math.ceil(o.width),Math.ceil(o.height));i=m.width,a=m.height,r.canvas.width=i,r.canvas.height=a,r.putImageData(m,0,0)}else{const t=\"image/svg+xml\"===e.contentType?\"data:image/svg+xml;base64,\"+e.imageData:e.url,s=(await Object(request[\"default\"])(t,{responseType:\"image\"})).data;i=Object(screenUtils[\"d\" /* pt2px */])(e.width),a=Object(screenUtils[\"d\" /* pt2px */])(e.height),r.canvas.width=i,r.canvas.height=a,r.drawImage(s,0,0,r.canvas.width,r.canvas.height)}return{type:\"esriPMS\",imageData:r.canvas.toDataURL(\"image/png\").substr(22),angle:e.angle,contentType:\"image/png\",height:Object(screenUtils[\"e\" /* px2pt */])(a),width:Object(screenUtils[\"e\" /* px2pt */])(i),xoffset:e.xoffset,yoffset:e.yoffset}}async _convertSvgRenderer(e){const t=e.type;if(\"simple\"===t&&H(e.symbol))e.symbol=await this._convertSvgToPictureMarkerSymbolJson(e.symbol);else if(\"uniqueValue\"===t||\"classBreaks\"===t){H(e.defaultSymbol)&&(e.defaultSymbol=await this._convertSvgToPictureMarkerSymbolJson(e.defaultSymbol));const r=e[\"uniqueValue\"===t?\"uniqueValueInfos\":\"classBreakInfos\"];if(r)for(const e of r)H(e.symbol)&&(e.symbol=await this._convertSvgToPictureMarkerSymbolJson(e.symbol))}}_getGraphics(e){return e.queryFeatures(Q).then((e=>e.features))}async _getPrintDefinition(e,t){const r=e.view;let i=r.spatialReference;const a={operationalLayers:await this._createOperationalLayers(r,t)};let s=this._ssExtent||e.extent||r.extent;return i&&i.isWrappable&&(s=s.clone()._normalize(!0),i=s.spatialReference),a.mapOptions={extent:s&&s.toJSON(),spatialReference:i&&i.toJSON(),showAttribution:t.attributionVisible},this._ssExtent=null,r.background&&(a.background=r.background.toJSON()),r.rotation&&(a.mapOptions.rotation=-r.rotation),t.scalePreserved&&(a.mapOptions.scale=t.outScale||r.scale),a}async _getGpPrintParams(e){const r=e.template||new PrintTemplate;null==r.showLabels&&(r.showLabels=!0);const i=r.exportOptions;let a;const n=layoutTemplate_o(r.layout);if(i){if(a={dpi:i.dpi},\"map_only\"===n.toLowerCase()||\"\"===n){const e=i.width,t=i.height;a.outputSize=[e,t]}}const o=r.layoutOptions;let l;if(o){let e,t;\"Miles\"===o.scalebarUnit||\"Kilometers\"===o.scalebarUnit?(e=\"Kilometers\",t=\"Miles\"):\"Meters\"!==o.scalebarUnit&&\"Feet\"!==o.scalebarUnit||(e=\"Meters\",t=\"Feet\"),l={titleText:o.titleText,authorText:o.authorText,copyrightText:o.copyrightText,customTextElements:o.customTextElements,scaleBarOptions:{metricUnit:B.toJSON(e),metricLabel:q[e],nonMetricUnit:B.toJSON(t),nonMetricLabel:q[t]}}}let c=null;o&&o.legendLayers&&(c=o.legendLayers.map((e=>{this._legendLayerNameMap[e.layerId]=e.title;const t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t})));const u=await this._getPrintDefinition(e,r);if(u.operationalLayers){const e=new RegExp(\"[\\\\u4E00-\\\\u9FFF\\\\u0E00-\\\\u0E7F\\\\u0900-\\\\u097F\\\\u3040-\\\\u309F\\\\u30A0-\\\\u30FF\\\\u31F0-\\\\u31FF]\"),t=/[\\u0600-\\u06FF]/,r=r=>{const i=r.text,a=r.font,s=a&&a.family&&a.family.toLowerCase();i&&a&&(\"arial\"===s||\"arial unicode ms\"===s)&&(a.family=e.test(i)?\"Arial Unicode MS\":\"Arial\",\"normal\"!==a.style&&t.test(i)&&(a.family=\"Arial Unicode MS\"))},i=()=>{throw new Error[\"a\" /* default */](\"print-task:cim-symbol-unsupported\",\"CIMSymbol is not supported by a print service published from ArcMap\")};u.operationalLayers.forEach((e=>{var t,a,s;null!=(t=e.featureCollection)&&t.layers?e.featureCollection.layers.forEach((e=>{var t,a,s,n;if(null!=(t=e.layerDefinition)&&null!=(a=t.drawingInfo)&&null!=(s=a.renderer)&&s.symbol){const t=e.layerDefinition.drawingInfo.renderer;\"esriTS\"===t.symbol.type?r(t.symbol):\"CIMSymbolReference\"!==t.symbol.type||this._is11xService||i()}null!=(n=e.featureSet)&&n.features&&e.featureSet.features.forEach((e=>{e.symbol&&(\"esriTS\"===e.symbol.type?r(e.symbol):\"CIMSymbolReference\"!==e.symbol.type||this._is11xService||i())}))})):!this._is11xService&&null!=(a=e.layerDefinition)&&null!=(s=a.drawingInfo)&&s.renderer&&JSON.stringify(e.layerDefinition.drawingInfo.renderer).includes('\"type\":\"CIMSymbolReference\"')&&i()}))}e.outSpatialReference&&(u.mapOptions.spatialReference=e.outSpatialReference.toJSON()),Object(lang[\"d\" /* mixin */])(u,{exportOptions:a,layoutOptions:l}),Object(lang[\"d\" /* mixin */])(u.layoutOptions,{legendOptions:{operationalLayers:null!=c?c:this._legendLayers.slice()}}),this._legendLayers.length=0;const y={Web_Map_as_JSON:JSON.stringify(u),Format:fileFormat_g(r.format),Layout_Template:n};return e.extraParameters&&Object(lang[\"d\" /* mixin */])(y,e.extraParameters),y}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({dependsOn:[\"url\"]})],X.prototype,\"_geoprocessor\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],X.prototype,\"_gpMetadata\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({dependsOn:[\"_gpMetadata\"],readOnly:!0})],X.prototype,\"mode\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],X.prototype,\"updateDelay\",void 0),X=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.tasks.PrintTask\")],X);var Y=X;/* harmony default export */ var PrintTask = __webpack_exports__[\"default\"] = (Y);\n\n\n/***/ })\n\n}]);","inputSourceMap":null}