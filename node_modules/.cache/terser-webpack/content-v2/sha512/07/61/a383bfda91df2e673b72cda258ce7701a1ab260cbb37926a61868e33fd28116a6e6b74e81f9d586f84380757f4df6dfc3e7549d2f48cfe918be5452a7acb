{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{sDlQ:function(e,t,r){\"use strict\";r.r(t);var i,s=r(\"pO5D\"),a=(r(\"wSAH\"),r(\"f/qv\")),l=r(\"nR38\"),o=(r(\"6S2I\"),r(\"zqDF\"),r(\"WbKI\")),n=r(\"r88o\"),c=r(\"04ZG\"),u=r(\"Cduq\"),p=r(\"zlDU\"),d=r(\"4EHJ\"),m=(r(\"ju1D\"),r(\"9AIY\"),r(\"9MzC\")),y=r(\"OvF4\"),h=r(\"LE9a\"),f=r(\"Lqtk\"),b=r(\"r0DZ\"),g=r(\"pqNC\"),O=r(\"5pQd\"),w=r(\"uRH/\"),j=r(\"mXvl\"),v=r(\"DbUH\"),x=r(\"jhcG\"),I=r(\"WmKv\"),S=r(\"3/ME\"),M=r(\"OYGz\"),L=r(\"ncPp\"),T=r(\"ag7Y\");let E=i=class extends T.a{constructor(e){super(e),this.fullExtent=null,this.id=null,this.tileInfo=null}clone(){const e=new i;return this.hasOwnProperty(\"fullExtent\")&&(e.fullExtent=this.fullExtent&&this.fullExtent.clone()),this.hasOwnProperty(\"id\")&&(e.id=this.id),this.hasOwnProperty(\"tileInfo\")&&(e.tileInfo=this.tileInfo&&this.tileInfo.clone()),e}};Object(s.a)([Object(o.b)({type:y.a,json:{read:{source:\"fullExtent\"}}})],E.prototype,\"fullExtent\",void 0),Object(s.a)([Object(o.b)({type:String,json:{read:{source:\"id\"}}})],E.prototype,\"id\",void 0),Object(s.a)([Object(o.b)({type:S.a,json:{read:{source:\"tileInfo\"}}})],E.prototype,\"tileInfo\",void 0),E=i=Object(s.a)([Object(c.a)(\"esri.layer.support.TileMatrixSet\")],E);var P,F=E;let C=P=class extends T.a{constructor(e){super(e),this.id=null,this.title=null,this.description=null,this.legendUrl=null}clone(){const e=new P;return this.hasOwnProperty(\"description\")&&(e.description=this.description),this.hasOwnProperty(\"id\")&&(e.id=this.id),this.hasOwnProperty(\"isDefault\")&&(e.isDefault=this.isDefault),this.hasOwnProperty(\"keywords\")&&(e.keywords=this.keywords&&this.keywords.slice()),this.hasOwnProperty(\"legendUrl\")&&(e.legendUrl=this.legendUrl),this.hasOwnProperty(\"title\")&&(e.title=this.title),e}};Object(s.a)([Object(o.b)({json:{read:{source:\"id\"}}})],C.prototype,\"id\",void 0),Object(s.a)([Object(o.b)({json:{read:{source:\"title\"}}})],C.prototype,\"title\",void 0),Object(s.a)([Object(o.b)({json:{read:{source:\"abstract\"}}})],C.prototype,\"description\",void 0),Object(s.a)([Object(o.b)({json:{read:{source:\"legendUrl\"}}})],C.prototype,\"legendUrl\",void 0),Object(s.a)([Object(o.b)({json:{read:{source:\"isDefault\"}}})],C.prototype,\"isDefault\",void 0),Object(s.a)([Object(o.b)({json:{read:{source:\"keywords\"}}})],C.prototype,\"keywords\",void 0),C=P=Object(s.a)([Object(c.a)(\"esri.layer.support.WMTSStyle\")],C);var R,_=C;let V=R=class extends T.a{constructor(e){super(e),this.fullExtent=null,this.imageFormats=null,this.id=null,this.layer=null,this.styles=null,this.tileMatrixSetId=null,this.tileMatrixSets=null}get description(){return this._get(\"description\")}set description(e){this._set(\"description\",e)}readFullExtent(e,t){return(e=t.fullExtent)?y.a.fromJSON(e):null}get imageFormat(){let e=this._get(\"imageFormat\");return e||(e=this.imageFormats&&this.imageFormats.length?this.imageFormats[0]:\"\"),e}set imageFormat(e){const t=this.imageFormats;e&&(e.indexOf(\"image/\")>-1||t&&-1===t.indexOf(e))&&(-1===e.indexOf(\"image/\")&&(e=\"image/\"+e),t&&-1===t.indexOf(e))?console.error(\"The layer doesn't support the format of \"+e):this._set(\"imageFormat\",e)}get styleId(){let e=this._get(\"styleId\");return e||(e=this.styles&&this.styles.length?this.styles.getItemAt(0).id:\"\"),e}set styleId(e){this._set(\"styleId\",e)}get title(){return this._get(\"title\")}set title(e){this._set(\"title\",e)}get tileMatrixSet(){return this.tileMatrixSets?this.tileMatrixSets.find(e=>e.id===this.tileMatrixSetId):null}clone(){const e=new R;return this.hasOwnProperty(\"description\")&&(e.description=this.description),this.hasOwnProperty(\"imageFormats\")&&(e.imageFormats=this.imageFormats&&this.imageFormats.slice()),this.hasOwnProperty(\"imageFormat\")&&(e.imageFormat=this.imageFormat),this.hasOwnProperty(\"fullExtent\")&&(e.fullExtent=this.fullExtent&&this.fullExtent.clone()),this.hasOwnProperty(\"id\")&&(e.id=this.id),this.hasOwnProperty(\"layer\")&&(e.layer=this.layer),this.hasOwnProperty(\"styleId\")&&(e.styleId=this.styleId),this.hasOwnProperty(\"styles\")&&(e.styles=this.styles&&this.styles.clone()),this.hasOwnProperty(\"tileMatrixSetId\")&&(e.tileMatrixSetId=this.tileMatrixSetId),this.hasOwnProperty(\"tileMatrixSets\")&&(e.tileMatrixSets=this.tileMatrixSets.clone()),this.hasOwnProperty(\"title\")&&(e.title=this.title),e}};Object(s.a)([Object(o.b)()],V.prototype,\"description\",null),Object(s.a)([Object(o.b)()],V.prototype,\"fullExtent\",void 0),Object(s.a)([Object(n.a)(\"fullExtent\",[\"fullExtent\"])],V.prototype,\"readFullExtent\",null),Object(s.a)([Object(o.b)({dependsOn:[\"imageFormats\"]})],V.prototype,\"imageFormat\",null),Object(s.a)([Object(o.b)({json:{read:{source:\"formats\"}}})],V.prototype,\"imageFormats\",void 0),Object(s.a)([Object(o.b)()],V.prototype,\"id\",void 0),Object(s.a)([Object(o.b)()],V.prototype,\"layer\",void 0),Object(s.a)([Object(o.b)({dependsOn:[\"styles\"]})],V.prototype,\"styleId\",null),Object(s.a)([Object(o.b)({type:h.a.ofType(_),json:{read:{source:\"styles\"}}})],V.prototype,\"styles\",void 0),Object(s.a)([Object(o.b)({value:null,json:{write:{ignoreOrigin:!0}}})],V.prototype,\"title\",null),Object(s.a)([Object(o.b)()],V.prototype,\"tileMatrixSetId\",void 0),Object(s.a)([Object(o.b)({readOnly:!0,dependsOn:[\"tileMatrixSetId\"]})],V.prototype,\"tileMatrixSet\",null),Object(s.a)([Object(o.b)({type:h.a.ofType(F),json:{read:{source:\"tileMatrixSets\"}}})],V.prototype,\"tileMatrixSets\",void 0),V=R=Object(s.a)([Object(c.a)(\"esri.layers.support.WMTSSublayer\")],V);var A=V,U=r(\"LIH3\"),D=r(\"WZb1\"),W=r(\"SuVq\"),k=r(\"9pTf\");const N=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function B(e,t){const r=t.getElementsByTagName(e);return r&&r.length>0?r[0]:null}function K(e,t){return Array.prototype.slice.call(t.getElementsByTagName(e)).map(e=>e.textContent)}function H(e,t){return e.split(\">\").forEach(e=>{t&&(t=B(e,t))}),t&&t.textContent}function q(e,t,r,i){let s;return Array.prototype.slice.call(i.childNodes).some(i=>{if(i.nodeName.indexOf(e)>-1){const e=B(t,i),a=e&&e.textContent;if(a===r||r.split(\":\")&&r.split(\":\")[1]===a)return s=i,!0}return!1}),s}function G(e,t){const r=[],i=e.layerMap.get(t);if(!i)return;const s=Array.prototype.slice.call(i.getElementsByTagName(\"ResourceURL\")),a=i.getElementsByTagName(\"Dimension\");let l,o,n,c;return a.length&&(l=H(\"Identifier\",a[0]),o=K(\"Default\",a[0])||K(\"Value\",a[0])),a.length>1&&(n=H(\"Identifier\",a[1]),c=K(\"Default\",a[1])||K(\"Value\",a[1])),e.dimensionMap.set(t,{dimensions:o,dimensions2:c}),s.forEach(e=>{let t=e.getAttribute(\"template\");if(\"tile\"===e.getAttribute(\"resourceType\")){if(l&&o.length)if(t.indexOf(\"{\"+l+\"}\")>-1)t=t.replace(\"{\"+l+\"}\",\"{dimensionValue}\");else{const e=t.toLowerCase().indexOf(\"{\"+l.toLowerCase()+\"}\");e>-1&&(t=t.substring(0,e)+\"{dimensionValue}\"+t.substring(e+l.length+2))}if(n&&c.length)if(t.indexOf(\"{\"+n+\"}\")>-1)t=t.replace(\"{\"+n+\"}\",\"{dimensionValue2}\");else{const e=t.toLowerCase().indexOf(\"{\"+n.toLowerCase()+\"}\");e>-1&&(t=t.substring(0,e)+\"{dimensionValue2}\"+t.substring(e+n.length+2))}r.push({template:t,format:e.getAttribute(\"format\"),resourceType:\"tile\"})}}),r}function J(e,t,r,i){const s=H(\"Identifier\",e),a=H(\"ScaleDenominator\",e).split(\"E\").map(e=>Number(e));let l;l=a.length>1?a[0]*Math.pow(10,a[1]):a[0];const o=z(t,l,i);return l*=1.058267716535433,{level:r,levelValue:s,scale:l,resolution:o}}function z(e,t,r){let i;return i=U.a.hasOwnProperty(String(e))?U.a.values[U.a[e]]:\"default028mm\"===r?6370997*Math.PI/180:Object(k.f)(e).metersPerDegree,7*t/25e3/i}const Y={\"image/png\":\".png\",\"image/png8\":\".png\",\"image/png24\":\".png\",\"image/png32\":\".png\",\"image/jpg\":\".jpg\",\"image/jpeg\":\".jpeg\",\"image/gif\":\".gif\",\"image/bmp\":\".bmp\",\"image/tiff\":\".tif\",\"image/jpgpng\":\"\",\"image/jpegpng\":\"\",\"image/unknown\":\"\"},Q=new Set([\"version\",\"service\",\"request\",\"layer\",\"style\",\"format\",\"tilematrixset\",\"tilematrix\",\"tilerow\",\"tilecol\"]);let X=class extends(Object(j.a)(Object(x.a)(Object(I.a)(Object(w.a)(Object(v.a)(Object(O.a)(g.a))))))){constructor(...e){super(...e),this._sublayersHandles=new b.a,this.copyright=\"\",this.customParameters=null,this.customLayerParameters=null,this.fullExtent=null,this.operationalLayerType=\"WebTiledLayer\",this.resourceInfo=null,this.serviceMode=\"RESTful\",this.sublayers=null,this.type=\"wmts\",this.version=\"1.0.0\",this.watch(\"activeLayer\",(e,t)=>{t&&(t.layer=null),e&&(e.layer=this)},!0),this.watch(\"sublayers\",(e,t)=>{t&&(t.forEach(e=>{e.layer=null}),this._sublayersHandles.removeAll(),this._sublayersHandles=null),e&&(e.forEach(e=>{e.layer=this}),this._sublayersHandles||(this._sublayersHandles=new b.a),this._sublayersHandles.add([e.on(\"after-add\",({item:e})=>{e.layer=this}),e.on(\"after-remove\",({item:e})=>{e.layer=null})]))},!0)}normalizeCtorArgs(e,t){return\"string\"==typeof e?{url:e,...t}:e}load(e){if(\"KVP\"===this.serviceMode||\"RESTful\"===this.serviceMode)return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"WMTS\"]},e).then(()=>this._fetchService(e)).catch(e=>{throw new p.a(\"wmtslayer:unsupported-service-data\",\"Invalid response from the WMTS service.\",{error:e})})),Object(m.u)(this);console.error(\"WMTS mode could only be 'KVP' or 'RESTful'\")}get activeLayer(){return this._get(\"activeLayer\")}set activeLayer(e){this._set(\"activeLayer\",e)}readActiveLayerFromService(e,t,r){let i;return this.activeLayer?t.layers.some(e=>e.id===this.activeLayer.id&&(i=e,!0)):(this.activeLayer=new A,i=t.layers[0]),this.activeLayer.read(i,r),this.activeLayer}readActiveLayerFromItemOrWebDoc(e,t){const{templateUrl:r,wmtsInfo:i}=t,s=r?this._getLowerCasedUrlParams(r):null,a=i&&i.layerIdentifier;let l=null;const o=i&&i.tileMatrixSet;return o&&(Array.isArray(o)?o.length&&(l=o[0]):l=o),new A({id:a,imageFormat:s&&s.format,styleId:s&&s.style,tileMatrixSetId:l})}writeActiveLayer(e,t,r,i){const s=this.activeLayer;t.templateUrl=this.getUrlTemplate(s.id,s.tileMatrixSetId,s.imageFormat,s.styleId);const a=Object(l.b)(\"tileMatrixSet.tileInfo\",s);t.tileInfo=a?a.toJSON(i):null,t.wmtsInfo={...t.wmtsInfo,layerIdentifier:s.id,tileMatrixSet:s.tileMatrixSetId}}readCustomParameters(e,t){const r=t.wmtsInfo;return r?this._mergeParams(r.customParameters,r.url):null}get fullExtents(){const e=[];return this.activeLayer.tileMatrixSets.forEach(t=>{t.fullExtent&&e.push(t.fullExtent)}),e}readServiceMode(e,t){return t.templateUrl.indexOf(\"?\")>-1?\"KVP\":\"RESTful\"}readSublayersFromService(e,t,r){return function(e,t){return e.map(e=>{const r=new A;return r.read(e,t),r})}(t.layers,r)}get supportedSpatialReferences(){return this.activeLayer.tileMatrixSets.map(e=>e.tileInfo.spatialReference).toArray()}get title(){var e,t;return null!=(e=null==(t=this.activeLayer)?void 0:t.title)?e:\"Layer\"}set title(e){e?this._override(\"title\",e):this._clearOverride(\"title\")}get url(){return this._get(\"url\")}set url(e){e&&\"/\"===e.substr(-1)?this._set(\"url\",e.slice(0,-1)):this._set(\"url\",e)}createWebTileLayer(e){const t=this.getUrlTemplate(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId),r=this._getTileMatrixSetById(e.tileMatrixSetId).tileInfo,i=e.fullExtent,s=new M.a({layerIdentifier:e.id,tileMatrixSet:e.tileMatrixSetId,url:this.url});return this.customLayerParameters&&(s.customLayerParameters=this.customLayerParameters),this.customParameters&&(s.customParameters=this.customParameters),new L.default({fullExtent:i,urlTemplate:t,tileInfo:r,wmtsInfo:s})}fetchTile(e,t,r){const i=this.getTileUrl(e,t,r);return Object(f.default)(i,{responseType:\"image\"}).then(e=>e.data)}findSublayerById(e){return this.sublayers.find(t=>t.id===e)}getTileUrl(e,t,r){const i=this._getTileMatrixSetById(this.activeLayer.tileMatrixSetId).tileInfo.lods[e],s=i?i.levelValue?i.levelValue:\"\"+i.level:\"\"+e;let a=this.resourceInfo?\"\":function(e,t,r,i,s,a,l,o){const{dimensionMap:n}=e,c=G(e,t),u=n.get(t).dimensions&&n.get(t).dimensions[0],p=n.get(t).dimensions2&&n.get(t).dimensions2[0];let d=\"\";if(c&&c.length>0){let e=null;c.some(t=>t.format===i&&(e=t,!0)),e||(e=c[l%c.length]),d=e.template.replace(/\\{Style\\}/gi,s).replace(/\\{TileMatrixSet\\}/gi,r).replace(/\\{TileMatrix\\}/gi,a).replace(/\\{TileRow\\}/gi,\"\"+l).replace(/\\{TileCol\\}/gi,\"\"+o).replace(/\\{dimensionValue\\}/gi,u).replace(/\\{dimensionValue2\\}/gi,p)}return d}({dimensionMap:this.dimensionMap,layerMap:this.layerMap},this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId,s,t,r);return a||(a=this.getUrlTemplate(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId).replace(/\\{level\\}/gi,s).replace(/\\{row\\}/gi,\"\"+t).replace(/\\{col\\}/gi,\"\"+r)),a=this._appendCustomLayerParameters(a),a}getUrlTemplate(e,t,r,i){if(!this.resourceInfo){const r=function(e,t,r,i){const{dimensionMap:s}=e,a=G(e,t);let l=\"\";if(a&&a.length>0){const e=s.get(t).dimensions&&s.get(t).dimensions[0],o=s.get(t).dimensions2&&s.get(t).dimensions2[0];l=a[0].template,l.indexOf(\".xxx\")===l.length-4&&(l=l.slice(0,l.length-4)),l=l.replace(/\\{Style\\}/gi,i),l=l.replace(/\\{TileMatrixSet\\}/gi,r),l=l.replace(/\\{TileMatrix\\}/gi,\"{level}\"),l=l.replace(/\\{TileRow\\}/gi,\"{row}\"),l=l.replace(/\\{TileCol\\}/gi,\"{col}\"),l=l.replace(/\\{dimensionValue\\}/gi,e),l=l.replace(/\\{dimensionValue2\\}/gi,o)}return l}({dimensionMap:this.dimensionMap,layerMap:this.layerMap},e,t,i);if(r)return r}if(\"KVP\"===this.serviceMode)return this.url+\"?SERVICE=WMTS&VERSION=\"+this.version+\"&REQUEST=GetTile&LAYER=\"+e+\"&STYLE=\"+i+\"&FORMAT=\"+r+\"&TILEMATRIXSET=\"+t+\"&TILEMATRIX={level}&TILEROW={row}&TILECOL={col}\";if(\"RESTful\"===this.serviceMode){let s=\"\";return Y[r.toLowerCase()]&&(s=Y[r.toLowerCase()]),this.url+e+\"/\"+i+\"/\"+t+\"/{level}/{row}/{col}\"+s}return\"\"}async _fetchService(e){let t;if(this.resourceInfo)\"KVP\"===this.resourceInfo.serviceMode&&(this.url+=this.url.indexOf(\"?\")>-1?\"\":\"?\"),t={ssl:!1,data:this.resourceInfo};else try{t=await this._getCapabilities(this.serviceMode,e)}catch{const r=\"KVP\"===this.serviceMode?\"RESTful\":\"KVP\";try{t=await this._getCapabilities(r,e),this.serviceMode=r}catch(e){throw new p.a(\"wmtslayer:unsupported-service-data\",\"Services does not support RESTful or KVP service modes.\",{error:e})}}t.data=this.resourceInfo?function(e){return e.layers.forEach(e=>{e.tileMatrixSets.forEach(e=>{const t=e.tileInfo;96!==t.dpi&&(t.lods.forEach(r=>{r.scale=96*r.scale/t.dpi,r.resolution=z(t.spatialReference.wkid,90.71428571428571*r.scale/96,e.id)}),t.dpi=96)})}),e}(t.data):function(e,t){e=e.replace(/ows:/gi,\"\");const r=(new DOMParser).parseFromString(e,\"text/xml\").documentElement,i=new Map,s=new Map,a=B(\"Contents\",r);if(!a)throw new p.a(\"wmtslayer:wmts-capabilities-xml-is-not-valid\");const l=B(\"OperationsMetadata\",r),o=l&&l.querySelector(\"[name='GetTile']\"),n=o&&o.getElementsByTagName(\"Get\"),c=n&&Array.prototype.slice.call(n),u=t&&t.url&&t.url.indexOf(\"https\")>-1;let d,m,h=t.serviceMode,f=t&&t.url;if(c&&c.length&&c.some(e=>{const t=B(\"Constraint\",e);return!t||q(\"AllowedValues\",\"Value\",h,t)?(f=e.attributes[0].nodeValue,!0):(!t||q(\"AllowedValues\",\"Value\",\"RESTful\",t)||q(\"AllowedValues\",\"Value\",\"REST\",t)?m=e.attributes[0].nodeValue:t&&!q(\"AllowedValues\",\"Value\",\"KVP\",t)||(d=e.attributes[0].nodeValue),!1)}),!f)if(m)f=m,h=\"RESTful\";else if(d)f=d,h=\"KVP\";else{const e=B(\"ServiceMetadataURL\",r);f=e&&e.getAttribute(\"xlink:href\")}const b=f.indexOf(\"1.0.0/\");return-1===b&&\"RESTful\"===h?f+=\"/\":b>-1&&(f=f.substring(0,b)),\"KVP\"===h&&(f+=b>-1?\"\":\"?\"),u&&(f=f.replace(/^http:/i,\"https:\")),{copyright:H(\"ServiceIdentification>AccessConstraints\",r),layers:Array.prototype.slice.call(a.getElementsByTagName(\"Layer\")).map(e=>{const t=H(\"Identifier\",e);return i.set(t,e),function(e,t,r,i){const s=H(\"Abstract\",t),a=K(\"Format\",t),l=function(e){const t=B(\"WGS84BoundingBox\",e),r=t?H(\"LowerCorner\",t).split(\" \"):[\"-180\",\"-90\"],i=t?H(\"UpperCorner\",t).split(\" \"):[\"180\",\"90\"];return{xmin:parseFloat(r[0]),ymin:parseFloat(r[1]),xmax:parseFloat(i[0]),ymax:parseFloat(i[1]),spatialReference:{wkid:4326}}}(t),o=function(e,t){return Array.prototype.slice.call(e.getElementsByTagName(\"Style\")).map(e=>{const r=B(\"LegendURL\",e),i=B(\"Keywords\",e),s=i&&K(\"Keyword\",i);let a=r&&r.getAttribute(\"xlink:href\");return t&&(a=a&&a.replace(/^http:/i,\"https:\")),{abstract:H(\"Abstract\",e),id:H(\"Identifier\",e),isDefault:\"true\"===e.getAttribute(\"isDefault\"),keywords:s,legendUrl:a,title:H(\"Title\",e)}})}(t,i),n=H(\"Title\",t),c=function(e,t){return K(\"TileMatrixSet\",e).map(r=>function(e,t,r){const i=K(\"TileMatrix\",q(\"TileMatrixSetLink\",\"TileMatrixSet\",e,t)),s=q(\"TileMatrixSet\",\"Identifier\",e,r),a=function(e){let t=H(\"SupportedCRS\",e);t&&(t=t.toLowerCase());let r=parseInt(t.split(\":\").pop(),10);900913!==r&&3857!==r||(r=102100);let i=!1;t.indexOf(\"crs84\")>-1||t.indexOf(\"crs:84\")>-1?(r=4326,i=!0):t.indexOf(\"crs83\")>-1||t.indexOf(\"crs:83\")>-1?(r=4269,i=!0):(t.indexOf(\"crs27\")>-1||t.indexOf(\"crs:27\")>-1)&&(r=4267,i=!0);const s=new D.a({wkid:r}),a=H(\"TopLeftCorner\",B(\"TileMatrix\",e)).split(\" \"),l=a[0].split(\"E\").map(e=>Number(e)),o=a[1].split(\"E\").map(e=>Number(e));let n,c=l[0],u=o[0];l.length>1&&(c=l[0]*Math.pow(10,l[1])),o.length>1&&(u=o[0]*Math.pow(10,o[1]));const p=i&&4326===r&&90===c&&-180===u;return N.some((e,a)=>{const l=Number(t.split(\":\").pop());return l>=e[0]&&l<=e[1]||4326===r&&(!i||p)?(n=new W.a(u,c,s),!0):(a===N.length-1&&(n=new W.a(c,u,s)),!1)}),n}(s),l=a.spatialReference,o=l.wkid,n=B(\"TileMatrix\",s),c=[parseInt(H(\"TileWidth\",n),10),parseInt(H(\"TileHeight\",n),10)],u=[];i.length?i.forEach((t,r)=>{const i=q(\"TileMatrix\",\"Identifier\",t,s);u.push(J(i,o,r,e))}):Array.prototype.slice.call(s.getElementsByTagName(\"TileMatrix\")).forEach((t,r)=>{u.push(J(t,o,r,e))});const p=function(e,t,r,i){const s=B(\"BoundingBox\",e);let a,l,o,n,c,u;if(s&&(a=H(\"LowerCorner\",s).split(\" \"),l=H(\"UpperCorner\",s).split(\" \")),a&&a.length>1&&l&&l.length>1)o=parseFloat(a[0]),c=parseFloat(a[1]),n=parseFloat(l[0]),u=parseFloat(l[1]);else{const s=B(\"TileMatrix\",e),a=parseFloat(H(\"MatrixWidth\",s)),l=parseFloat(H(\"MatrixHeight\",s));o=t.x,u=t.y,n=o+a*r[0]*i.resolution,c=u-l*r[1]*i.resolution}return new y.a(o,c,n,u,t.spatialReference)}(s,a,c,u[0]);return{id:e,fullExtent:p.toJSON(),tileInfo:new S.a({dpi:96,spatialReference:l,size:c,origin:a,lods:u}).toJSON()}}(r,e,t))}(t,r);return{id:e,fullExtent:l,description:s,formats:a,styles:o,title:n,tileMatrixSets:c}}(t,e,a,u)}),tileUrl:f,serviceMode:h,layerMap:i,dimensionMap:s}}(t.data,{serviceMode:this.serviceMode,url:this.url}),t.data&&this.read(t.data,{origin:\"service\"})}async _getCapabilities(e,t){const r=this._getCapabilitiesUrl(e);return await Object(f.default)(r,{...t,responseType:\"text\"})}_getTileMatrixSetById(e){return this.findSublayerById(this.activeLayer.id).tileMatrixSets.find(t=>t.id===e)}_appendCustomParameters(e){if(this.customParameters)for(const t in this.customParameters)e+=(-1===e.indexOf(\"?\")?\"?\":\"&\")+t+\"=\"+encodeURIComponent(this.customParameters[t]);return e}_appendCustomLayerParameters(e){if(this.customLayerParameters||this.customParameters){const t={...Object(a.a)(this.customParameters||{}),...this.customLayerParameters};for(const r in t)e+=(-1===e.indexOf(\"?\")?\"?\":\"&\")+r+\"=\"+encodeURIComponent(t[r])}return e}_getCapabilitiesUrl(e){let t;return this.url=this.url.split(\"?\")[0],\"KVP\"===e?t=this.url+\"?request=GetCapabilities&service=WMTS&version=\"+this.version:\"RESTful\"===e&&(t=this.url+\"/\"+this.version+\"/WMTSCapabilities.xml\"),t=this._appendCustomParameters(t),t}_getLowerCasedUrlParams(e){if(!e)return null;const t=Object(d.I)(e).query;if(!t)return null;const r={};return Object.keys(t).forEach(e=>{r[e.toLowerCase()]=t[e]}),r}_mergeParams(e,t){const r=this._getLowerCasedUrlParams(t);if(r){const t=Object.keys(r);t.length&&(e=e?Object(a.a)(e):{},t.forEach(t=>{e.hasOwnProperty(t)||Q.has(t)||(e[t]=r[t])}))}return e}};Object(s.a)([Object(o.b)()],X.prototype,\"dimensionMap\",void 0),Object(s.a)([Object(o.b)()],X.prototype,\"layerMap\",void 0),Object(s.a)([Object(o.b)({type:A,dependsOn:[\"sublayers\"],json:{origins:{\"web-document\":{write:{ignoreOrigin:!0}}}}})],X.prototype,\"activeLayer\",null),Object(s.a)([Object(n.a)(\"service\",\"activeLayer\",[\"layers\"])],X.prototype,\"readActiveLayerFromService\",null),Object(s.a)([Object(n.a)([\"web-document\",\"portal-item\"],\"activeLayer\",[\"wmtsInfo\"])],X.prototype,\"readActiveLayerFromItemOrWebDoc\",null),Object(s.a)([Object(u.a)([\"web-document\",\"portal-item\"],\"activeLayer\",{templateUrl:{type:String},tileInfo:{type:S.a},\"wmtsInfo.layerIdentifier\":{type:String},\"wmtsInfo.tileMatrixSet\":{type:String}})],X.prototype,\"writeActiveLayer\",null),Object(s.a)([Object(o.b)({type:String,value:\"\",json:{write:!0}})],X.prototype,\"copyright\",void 0),Object(s.a)([Object(o.b)({type:[\"show\",\"hide\"]})],X.prototype,\"listMode\",void 0),Object(s.a)([Object(o.b)({json:{origins:{\"web-document\":{read:{source:[\"wmtsInfo.customParameters\",\"wmtsInfo.url\"]},write:{target:\"wmtsInfo.customParameters\"}},\"portal-item\":{read:{source:[\"wmtsInfo.customParameters\",\"wmtsInfo.url\"]},write:{target:\"wmtsInfo.customParameters\"}}}}})],X.prototype,\"customParameters\",void 0),Object(s.a)([Object(n.a)(\"web-document\",\"customParameters\"),Object(n.a)(\"portal-item\",\"customParameters\")],X.prototype,\"readCustomParameters\",null),Object(s.a)([Object(o.b)({json:{origins:{\"web-document\":{read:{source:\"wmtsInfo.customLayerParameters\"},write:{target:\"wmtsInfo.customLayerParameters\"}},\"portal-item\":{read:{source:\"wmtsInfo.customLayerParameters\"},write:{target:\"wmtsInfo.customLayerParameters\"}}}}})],X.prototype,\"customLayerParameters\",void 0),Object(s.a)([Object(o.b)({type:y.a,json:{write:{ignoreOrigin:!0},origins:{\"web-document\":{read:{source:\"fullExtent\"}},\"portal-item\":{read:{source:\"fullExtent\"}}}}})],X.prototype,\"fullExtent\",void 0),Object(s.a)([Object(o.b)({readOnly:!0,dependsOn:[\"activeLayer\"]})],X.prototype,\"fullExtents\",null),Object(s.a)([Object(o.b)({type:[\"WebTiledLayer\"]})],X.prototype,\"operationalLayerType\",void 0),Object(s.a)([Object(o.b)()],X.prototype,\"resourceInfo\",void 0),Object(s.a)([Object(o.b)()],X.prototype,\"serviceMode\",void 0),Object(s.a)([Object(n.a)([\"portal-item\",\"web-document\"],\"serviceMode\",[\"templateUrl\"])],X.prototype,\"readServiceMode\",null),Object(s.a)([Object(o.b)({type:h.a.ofType(A)})],X.prototype,\"sublayers\",void 0),Object(s.a)([Object(n.a)(\"service\",\"sublayers\",[\"layers\"])],X.prototype,\"readSublayersFromService\",null),Object(s.a)([Object(o.b)({readOnly:!0,dependsOn:[\"activeLayer\"]})],X.prototype,\"supportedSpatialReferences\",null),Object(s.a)([Object(o.b)({dependsOn:[\"activeLayer\"],json:{read:{source:\"title\"}}})],X.prototype,\"title\",null),Object(s.a)([Object(o.b)({json:{read:!1},readOnly:!0,value:\"wmts\"})],X.prototype,\"type\",void 0),Object(s.a)([Object(o.b)({json:{origins:{service:{read:{source:\"tileUrl\"}},\"web-document\":{read:{source:\"wmtsInfo.url\"},write:{target:\"wmtsInfo.url\"}},\"portal-item\":{read:{source:\"wmtsInfo.url\"},write:{target:\"wmtsInfo.url\"}}}}})],X.prototype,\"url\",null),Object(s.a)([Object(o.b)()],X.prototype,\"version\",void 0),X=Object(s.a)([Object(c.a)(\"esri.layers.WMTSLayer\")],X),t.default=X}}]);","name":"140.8da48647cf7d4736f395.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[140],{\n\n/***/ \"sDlQ\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"pO5D\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js\nvar has = __webpack_require__(\"wSAH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/lang.js\nvar lang = __webpack_require__(\"f/qv\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/object.js\nvar object = __webpack_require__(\"nR38\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Logger.js\nvar Logger = __webpack_require__(\"6S2I\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/ensureType.js\nvar ensureType = __webpack_require__(\"zqDF\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js\nvar property = __webpack_require__(\"WbKI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/reader.js\nvar reader = __webpack_require__(\"r88o\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js + 1 modules\nvar subclass = __webpack_require__(\"04ZG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/writer.js\nvar writer = __webpack_require__(\"Cduq\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Error.js\nvar Error = __webpack_require__(\"zlDU\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/urlUtils.js\nvar urlUtils = __webpack_require__(\"4EHJ\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/uuid.js\nvar uuid = __webpack_require__(\"ju1D\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/portal/support/resourceExtension.js\nvar resourceExtension = __webpack_require__(\"9AIY\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/promiseUtils.js\nvar promiseUtils = __webpack_require__(\"9MzC\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Extent.js\nvar Extent = __webpack_require__(\"OvF4\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Collection.js\nvar Collection = __webpack_require__(\"LE9a\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/request.js\nvar request = __webpack_require__(\"Lqtk\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Handles.js\nvar Handles = __webpack_require__(\"r0DZ\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/Layer.js\nvar Layer = __webpack_require__(\"pqNC\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/MultiOriginJSONSupport.js + 2 modules\nvar MultiOriginJSONSupport = __webpack_require__(\"5pQd\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/OperationalLayer.js + 1 modules\nvar OperationalLayer = __webpack_require__(\"uRH/\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/BlendLayer.js\nvar BlendLayer = __webpack_require__(\"mXvl\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/PortalLayer.js\nvar PortalLayer = __webpack_require__(\"DbUH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/RefreshableLayer.js\nvar RefreshableLayer = __webpack_require__(\"jhcG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/ScaleRangeLayer.js\nvar ScaleRangeLayer = __webpack_require__(\"WmKv\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/TileInfo.js\nvar TileInfo = __webpack_require__(\"3/ME\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/WMTSLayerInfo.js\nvar WMTSLayerInfo = __webpack_require__(\"OYGz\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/WebTileLayer.js\nvar WebTileLayer = __webpack_require__(\"ncPp\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/JSONSupport.js\nvar JSONSupport = __webpack_require__(\"ag7Y\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/TileMatrixSet.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nvar TileMatrixSet_p;let TileMatrixSet_l=TileMatrixSet_p=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(t){super(t),this.fullExtent=null,this.id=null,this.tileInfo=null}clone(){const t=new TileMatrixSet_p;return this.hasOwnProperty(\"fullExtent\")&&(t.fullExtent=this.fullExtent&&this.fullExtent.clone()),this.hasOwnProperty(\"id\")&&(t.id=this.id),this.hasOwnProperty(\"tileInfo\")&&(t.tileInfo=this.tileInfo&&this.tileInfo.clone()),t}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Extent[\"a\" /* default */],json:{read:{source:\"fullExtent\"}}})],TileMatrixSet_l.prototype,\"fullExtent\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{read:{source:\"id\"}}})],TileMatrixSet_l.prototype,\"id\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:TileInfo[\"a\" /* default */],json:{read:{source:\"tileInfo\"}}})],TileMatrixSet_l.prototype,\"tileInfo\",void 0),TileMatrixSet_l=TileMatrixSet_p=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layer.support.TileMatrixSet\")],TileMatrixSet_l);var TileMatrixSet_n=TileMatrixSet_l;/* harmony default export */ var TileMatrixSet = (TileMatrixSet_n);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/WMTSStyle.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nvar WMTSStyle_t;let WMTSStyle_i=WMTSStyle_t=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(r){super(r),this.id=null,this.title=null,this.description=null,this.legendUrl=null}clone(){const r=new WMTSStyle_t;return this.hasOwnProperty(\"description\")&&(r.description=this.description),this.hasOwnProperty(\"id\")&&(r.id=this.id),this.hasOwnProperty(\"isDefault\")&&(r.isDefault=this.isDefault),this.hasOwnProperty(\"keywords\")&&(r.keywords=this.keywords&&this.keywords.slice()),this.hasOwnProperty(\"legendUrl\")&&(r.legendUrl=this.legendUrl),this.hasOwnProperty(\"title\")&&(r.title=this.title),r}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"id\"}}})],WMTSStyle_i.prototype,\"id\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"title\"}}})],WMTSStyle_i.prototype,\"title\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"abstract\"}}})],WMTSStyle_i.prototype,\"description\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"legendUrl\"}}})],WMTSStyle_i.prototype,\"legendUrl\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"isDefault\"}}})],WMTSStyle_i.prototype,\"isDefault\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"keywords\"}}})],WMTSStyle_i.prototype,\"keywords\",void 0),WMTSStyle_i=WMTSStyle_t=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layer.support.WMTSStyle\")],WMTSStyle_i);var WMTSStyle_p=WMTSStyle_i;/* harmony default export */ var WMTSStyle = (WMTSStyle_p);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/WMTSSublayer.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nvar WMTSSublayer_p;let WMTSSublayer_m=WMTSSublayer_p=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(t){super(t),this.fullExtent=null,this.imageFormats=null,this.id=null,this.layer=null,this.styles=null,this.tileMatrixSetId=null,this.tileMatrixSets=null}get description(){return this._get(\"description\")}set description(t){this._set(\"description\",t)}readFullExtent(t,e){return(t=e.fullExtent)?Extent[\"a\" /* default */].fromJSON(t):null}get imageFormat(){let t=this._get(\"imageFormat\");return t||(t=this.imageFormats&&this.imageFormats.length?this.imageFormats[0]:\"\"),t}set imageFormat(t){const e=this.imageFormats;t&&(t.indexOf(\"image/\")>-1||e&&-1===e.indexOf(t))&&(-1===t.indexOf(\"image/\")&&(t=\"image/\"+t),e&&-1===e.indexOf(t))?console.error(\"The layer doesn't support the format of \"+t):this._set(\"imageFormat\",t)}get styleId(){let t=this._get(\"styleId\");return t||(t=this.styles&&this.styles.length?this.styles.getItemAt(0).id:\"\"),t}set styleId(t){this._set(\"styleId\",t)}get title(){return this._get(\"title\")}set title(t){this._set(\"title\",t)}get tileMatrixSet(){return this.tileMatrixSets?this.tileMatrixSets.find((t=>t.id===this.tileMatrixSetId)):null}clone(){const t=new WMTSSublayer_p;return this.hasOwnProperty(\"description\")&&(t.description=this.description),this.hasOwnProperty(\"imageFormats\")&&(t.imageFormats=this.imageFormats&&this.imageFormats.slice()),this.hasOwnProperty(\"imageFormat\")&&(t.imageFormat=this.imageFormat),this.hasOwnProperty(\"fullExtent\")&&(t.fullExtent=this.fullExtent&&this.fullExtent.clone()),this.hasOwnProperty(\"id\")&&(t.id=this.id),this.hasOwnProperty(\"layer\")&&(t.layer=this.layer),this.hasOwnProperty(\"styleId\")&&(t.styleId=this.styleId),this.hasOwnProperty(\"styles\")&&(t.styles=this.styles&&this.styles.clone()),this.hasOwnProperty(\"tileMatrixSetId\")&&(t.tileMatrixSetId=this.tileMatrixSetId),this.hasOwnProperty(\"tileMatrixSets\")&&(t.tileMatrixSets=this.tileMatrixSets.clone()),this.hasOwnProperty(\"title\")&&(t.title=this.title),t}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],WMTSSublayer_m.prototype,\"description\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],WMTSSublayer_m.prototype,\"fullExtent\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"fullExtent\",[\"fullExtent\"])],WMTSSublayer_m.prototype,\"readFullExtent\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({dependsOn:[\"imageFormats\"]})],WMTSSublayer_m.prototype,\"imageFormat\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"formats\"}}})],WMTSSublayer_m.prototype,\"imageFormats\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],WMTSSublayer_m.prototype,\"id\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],WMTSSublayer_m.prototype,\"layer\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({dependsOn:[\"styles\"]})],WMTSSublayer_m.prototype,\"styleId\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Collection[\"a\" /* default */].ofType(WMTSStyle),json:{read:{source:\"styles\"}}})],WMTSSublayer_m.prototype,\"styles\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({value:null,json:{write:{ignoreOrigin:!0}}})],WMTSSublayer_m.prototype,\"title\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],WMTSSublayer_m.prototype,\"tileMatrixSetId\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"tileMatrixSetId\"]})],WMTSSublayer_m.prototype,\"tileMatrixSet\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Collection[\"a\" /* default */].ofType(TileMatrixSet),json:{read:{source:\"tileMatrixSets\"}}})],WMTSSublayer_m.prototype,\"tileMatrixSets\",void 0),WMTSSublayer_m=WMTSSublayer_p=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layers.support.WMTSSublayer\")],WMTSSublayer_m);var h=WMTSSublayer_m;/* harmony default export */ var WMTSSublayer = (h);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/WKIDUnitConversion.js\nvar WKIDUnitConversion = __webpack_require__(\"LIH3\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/SpatialReference.js\nvar SpatialReference = __webpack_require__(\"WZb1\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Point.js + 2 modules\nvar Point = __webpack_require__(\"SuVq\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/projectionEllipsoid.js\nvar projectionEllipsoid = __webpack_require__(\"9pTf\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/wmtsUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst wmtsUtils_s=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function wmtsUtils_a(t,l){t=t.replace(/ows:/gi,\"\");const a=(new DOMParser).parseFromString(t,\"text/xml\").documentElement,p=new Map,d=new Map,g=c(\"Contents\",a);if(!g)throw new Error[\"a\" /* default */](\"wmtslayer:wmts-capabilities-xml-is-not-valid\");const x=c(\"OperationsMetadata\",a),y=x&&x.querySelector(\"[name='GetTile']\"),T=y&&y.getElementsByTagName(\"Get\"),w=T&&Array.prototype.slice.call(T),M=l&&l.url&&l.url.indexOf(\"https\")>-1;let E,S,V=l.serviceMode,b=l&&l.url;if(w&&w.length&&w.some((e=>{const t=c(\"Constraint\",e);return!t||wmtsUtils_f(\"AllowedValues\",\"Value\",V,t)?(b=e.attributes[0].nodeValue,!0):(!t||wmtsUtils_f(\"AllowedValues\",\"Value\",\"RESTful\",t)||wmtsUtils_f(\"AllowedValues\",\"Value\",\"REST\",t)?S=e.attributes[0].nodeValue:t&&!wmtsUtils_f(\"AllowedValues\",\"Value\",\"KVP\",t)||(E=e.attributes[0].nodeValue),!1)})),!b)if(S)b=S,V=\"RESTful\";else if(E)b=E,V=\"KVP\";else{const e=c(\"ServiceMetadataURL\",a);b=e&&e.getAttribute(\"xlink:href\")}const A=b.indexOf(\"1.0.0/\");-1===A&&\"RESTful\"===V?b+=\"/\":A>-1&&(b=b.substring(0,A)),\"KVP\"===V&&(b+=A>-1?\"\":\"?\"),M&&(b=b.replace(/^http:/i,\"https:\"));return{copyright:wmtsUtils_m(\"ServiceIdentification>AccessConstraints\",a),layers:Array.prototype.slice.call(g.getElementsByTagName(\"Layer\")).map((e=>{const t=wmtsUtils_m(\"Identifier\",e);return p.set(t,e),function(e,t,l,a){const p=wmtsUtils_m(\"Abstract\",t),d=wmtsUtils_u(\"Format\",t),g=function(e){const t=c(\"WGS84BoundingBox\",e),i=t?wmtsUtils_m(\"LowerCorner\",t).split(\" \"):[\"-180\",\"-90\"],n=t?wmtsUtils_m(\"UpperCorner\",t).split(\" \"):[\"180\",\"90\"];return{xmin:parseFloat(i[0]),ymin:parseFloat(i[1]),xmax:parseFloat(n[0]),ymax:parseFloat(n[1]),spatialReference:{wkid:4326}}}(t),x=function(e,t){return Array.prototype.slice.call(e.getElementsByTagName(\"Style\")).map((e=>{const i=c(\"LegendURL\",e),n=c(\"Keywords\",e),r=n&&wmtsUtils_u(\"Keyword\",n);let l=i&&i.getAttribute(\"xlink:href\");t&&(l=l&&l.replace(/^http:/i,\"https:\"));return{abstract:wmtsUtils_m(\"Abstract\",e),id:wmtsUtils_m(\"Identifier\",e),isDefault:\"true\"===e.getAttribute(\"isDefault\"),keywords:r,legendUrl:l,title:wmtsUtils_m(\"Title\",e)}}))}(t,a),y=wmtsUtils_m(\"Title\",t),T=function(e,t){return wmtsUtils_u(\"TileMatrixSet\",e).map((l=>function(e,t,l){const a=wmtsUtils_u(\"TileMatrix\",wmtsUtils_f(\"TileMatrixSetLink\",\"TileMatrixSet\",e,t)),p=wmtsUtils_f(\"TileMatrixSet\",\"Identifier\",e,l),d=function(e){let t=wmtsUtils_m(\"SupportedCRS\",e);t&&(t=t.toLowerCase());let r=parseInt(t.split(\":\").pop(),10);900913!==r&&3857!==r||(r=102100);let l=!1;t.indexOf(\"crs84\")>-1||t.indexOf(\"crs:84\")>-1?(r=4326,l=!0):t.indexOf(\"crs83\")>-1||t.indexOf(\"crs:83\")>-1?(r=4269,l=!0):(t.indexOf(\"crs27\")>-1||t.indexOf(\"crs:27\")>-1)&&(r=4267,l=!0);const o=new SpatialReference[\"a\" /* default */]({wkid:r}),a=wmtsUtils_m(\"TopLeftCorner\",c(\"TileMatrix\",e)).split(\" \"),p=a[0].split(\"E\").map((e=>Number(e))),u=a[1].split(\"E\").map((e=>Number(e)));let f,d=p[0],g=u[0];p.length>1&&(d=p[0]*Math.pow(10,p[1]));u.length>1&&(g=u[0]*Math.pow(10,u[1]));const x=l&&4326===r&&90===d&&-180===g;return wmtsUtils_s.some(((e,i)=>{const a=Number(t.split(\":\").pop());return a>=e[0]&&a<=e[1]||4326===r&&(!l||x)?(f=new Point[\"a\" /* default */](g,d,o),!0):(i===wmtsUtils_s.length-1&&(f=new Point[\"a\" /* default */](d,g,o)),!1)})),f}(p),g=d.spatialReference,x=g.wkid,y=c(\"TileMatrix\",p),T=[parseInt(wmtsUtils_m(\"TileWidth\",y),10),parseInt(wmtsUtils_m(\"TileHeight\",y),10)],w=[];if(a.length)a.forEach(((t,i)=>{const n=wmtsUtils_f(\"TileMatrix\",\"Identifier\",t,p);w.push(wmtsUtils_h(n,x,i,e))}));else{Array.prototype.slice.call(p.getElementsByTagName(\"TileMatrix\")).forEach(((t,i)=>{w.push(wmtsUtils_h(t,x,i,e))}))}const M=function(e,t,i,n){const l=c(\"BoundingBox\",e);let o,s,a,p,u,f;l&&(o=wmtsUtils_m(\"LowerCorner\",l).split(\" \"),s=wmtsUtils_m(\"UpperCorner\",l).split(\" \"));if(o&&o.length>1&&s&&s.length>1)a=parseFloat(o[0]),u=parseFloat(o[1]),p=parseFloat(s[0]),f=parseFloat(s[1]);else{const r=c(\"TileMatrix\",e),l=parseFloat(wmtsUtils_m(\"MatrixWidth\",r)),o=parseFloat(wmtsUtils_m(\"MatrixHeight\",r));a=t.x,f=t.y,p=a+l*i[0]*n.resolution,u=f-o*i[1]*n.resolution}return new Extent[\"a\" /* default */](a,u,p,f,t.spatialReference)}(p,d,T,w[0]);return{id:e,fullExtent:M.toJSON(),tileInfo:new TileInfo[\"a\" /* default */]({dpi:96,spatialReference:g,size:T,origin:d,lods:w}).toJSON()}}(l,e,t)))}(t,l);return{id:e,fullExtent:g,description:p,formats:d,styles:x,title:y,tileMatrixSets:T}}(t,e,g,M)})),tileUrl:b,serviceMode:V,layerMap:p,dimensionMap:d}}function wmtsUtils_p(e){return e.layers.forEach((e=>{e.tileMatrixSets.forEach((e=>{const t=e.tileInfo;96!==t.dpi&&(t.lods.forEach((i=>{i.scale=96*i.scale/t.dpi,i.resolution=wmtsUtils_y(t.spatialReference.wkid,90.71428571428571*i.scale/96,e.id)})),t.dpi=96)}))})),e}function c(e,t){const i=t.getElementsByTagName(e);return i&&i.length>0?i[0]:null}function wmtsUtils_u(e,t){return Array.prototype.slice.call(t.getElementsByTagName(e)).map((e=>e.textContent))}function wmtsUtils_m(e,t){return e.split(\">\").forEach((e=>{t&&(t=c(e,t))})),t&&t.textContent}function wmtsUtils_f(e,t,i,n){let r;return Array.prototype.slice.call(n.childNodes).some((n=>{if(n.nodeName.indexOf(e)>-1){const e=c(t,n),l=e&&e.textContent;if(l===i||i.split(\":\")&&i.split(\":\")[1]===l)return r=n,!0}return!1})),r}function wmtsUtils_d(e,t){const i=[],n=e.layerMap.get(t);if(!n)return;const r=Array.prototype.slice.call(n.getElementsByTagName(\"ResourceURL\")),l=n.getElementsByTagName(\"Dimension\");let o,s,a,p;return l.length&&(o=wmtsUtils_m(\"Identifier\",l[0]),s=wmtsUtils_u(\"Default\",l[0])||wmtsUtils_u(\"Value\",l[0])),l.length>1&&(a=wmtsUtils_m(\"Identifier\",l[1]),p=wmtsUtils_u(\"Default\",l[1])||wmtsUtils_u(\"Value\",l[1])),e.dimensionMap.set(t,{dimensions:s,dimensions2:p}),r.forEach((e=>{let t=e.getAttribute(\"template\");if(\"tile\"===e.getAttribute(\"resourceType\")){if(o&&s.length)if(t.indexOf(\"{\"+o+\"}\")>-1)t=t.replace(\"{\"+o+\"}\",\"{dimensionValue}\");else{const e=t.toLowerCase().indexOf(\"{\"+o.toLowerCase()+\"}\");e>-1&&(t=t.substring(0,e)+\"{dimensionValue}\"+t.substring(e+o.length+2))}if(a&&p.length)if(t.indexOf(\"{\"+a+\"}\")>-1)t=t.replace(\"{\"+a+\"}\",\"{dimensionValue2}\");else{const e=t.toLowerCase().indexOf(\"{\"+a.toLowerCase()+\"}\");e>-1&&(t=t.substring(0,e)+\"{dimensionValue2}\"+t.substring(e+a.length+2))}i.push({template:t,format:e.getAttribute(\"format\"),resourceType:\"tile\"})}})),i}function wmtsUtils_g(e,t,i,n,r,l,o,s){const{dimensionMap:a}=e,p=wmtsUtils_d(e,t),c=a.get(t).dimensions&&a.get(t).dimensions[0],u=a.get(t).dimensions2&&a.get(t).dimensions2[0];let m=\"\";if(p&&p.length>0){let e=null;p.some((t=>t.format===n&&(e=t,!0))),e||(e=p[o%p.length]),m=e.template.replace(/\\{Style\\}/gi,r).replace(/\\{TileMatrixSet\\}/gi,i).replace(/\\{TileMatrix\\}/gi,l).replace(/\\{TileRow\\}/gi,\"\"+o).replace(/\\{TileCol\\}/gi,\"\"+s).replace(/\\{dimensionValue\\}/gi,c).replace(/\\{dimensionValue2\\}/gi,u)}return m}function wmtsUtils_x(e,t,i,n){const{dimensionMap:r}=e,l=wmtsUtils_d(e,t);let o=\"\";if(l&&l.length>0){const e=r.get(t).dimensions&&r.get(t).dimensions[0],s=r.get(t).dimensions2&&r.get(t).dimensions2[0];o=l[0].template,o.indexOf(\".xxx\")===o.length-4&&(o=o.slice(0,o.length-4)),o=o.replace(/\\{Style\\}/gi,n),o=o.replace(/\\{TileMatrixSet\\}/gi,i),o=o.replace(/\\{TileMatrix\\}/gi,\"{level}\"),o=o.replace(/\\{TileRow\\}/gi,\"{row}\"),o=o.replace(/\\{TileCol\\}/gi,\"{col}\"),o=o.replace(/\\{dimensionValue\\}/gi,e),o=o.replace(/\\{dimensionValue2\\}/gi,s)}return o}function wmtsUtils_h(e,t,i,n){const r=wmtsUtils_m(\"Identifier\",e),l=wmtsUtils_m(\"ScaleDenominator\",e).split(\"E\").map((e=>Number(e)));let o;o=l.length>1?l[0]*Math.pow(10,l[1]):l[0];const s=wmtsUtils_y(t,o,n);return o*=1.058267716535433,{level:i,levelValue:r,scale:o,resolution:s}}function wmtsUtils_y(e,i,n){let r;return r=WKIDUnitConversion[\"a\" /* default */].hasOwnProperty(String(e))?WKIDUnitConversion[\"a\" /* default */].values[WKIDUnitConversion[\"a\" /* default */][e]]:\"default028mm\"===n?6370997*Math.PI/180:Object(projectionEllipsoid[\"f\" /* getReferenceEllipsoidFromWKID */])(e).metersPerDegree,7*i/25e3/r}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/WMTSLayer.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst WMTSLayer_E={\"image/png\":\".png\",\"image/png8\":\".png\",\"image/png24\":\".png\",\"image/png32\":\".png\",\"image/jpg\":\".jpg\",\"image/jpeg\":\".jpeg\",\"image/gif\":\".gif\",\"image/bmp\":\".bmp\",\"image/tiff\":\".tif\",\"image/jpgpng\":\"\",\"image/jpegpng\":\"\",\"image/unknown\":\"\"},_=new Set([\"version\",\"service\",\"request\",\"layer\",\"style\",\"format\",\"tilematrixset\",\"tilematrix\",\"tilerow\",\"tilecol\"]);let O=class extends(Object(BlendLayer[\"a\" /* BlendLayer */])(Object(RefreshableLayer[\"a\" /* RefreshableLayer */])(Object(ScaleRangeLayer[\"a\" /* ScaleRangeLayer */])(Object(OperationalLayer[\"a\" /* OperationalLayer */])(Object(PortalLayer[\"a\" /* PortalLayer */])(Object(MultiOriginJSONSupport[\"a\" /* MultiOriginJSONMixin */])(Layer[\"a\" /* default */]))))))){constructor(...e){super(...e),this._sublayersHandles=new Handles[\"a\" /* default */],this.copyright=\"\",this.customParameters=null,this.customLayerParameters=null,this.fullExtent=null,this.operationalLayerType=\"WebTiledLayer\",this.resourceInfo=null,this.serviceMode=\"RESTful\",this.sublayers=null,this.type=\"wmts\",this.version=\"1.0.0\",this.watch(\"activeLayer\",((e,t)=>{t&&(t.layer=null),e&&(e.layer=this)}),!0),this.watch(\"sublayers\",((e,t)=>{t&&(t.forEach((e=>{e.layer=null})),this._sublayersHandles.removeAll(),this._sublayersHandles=null),e&&(e.forEach((e=>{e.layer=this})),this._sublayersHandles||(this._sublayersHandles=new Handles[\"a\" /* default */]),this._sublayersHandles.add([e.on(\"after-add\",(({item:e})=>{e.layer=this})),e.on(\"after-remove\",(({item:e})=>{e.layer=null}))]))}),!0)}normalizeCtorArgs(e,t){return\"string\"==typeof e?{url:e,...t}:e}load(e){if(\"KVP\"===this.serviceMode||\"RESTful\"===this.serviceMode)return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"WMTS\"]},e).then((()=>this._fetchService(e))).catch((e=>{throw new Error[\"a\" /* default */](\"wmtslayer:unsupported-service-data\",\"Invalid response from the WMTS service.\",{error:e})}))),Object(promiseUtils[\"u\" /* resolve */])(this);console.error(\"WMTS mode could only be 'KVP' or 'RESTful'\")}get activeLayer(){return this._get(\"activeLayer\")}set activeLayer(e){this._set(\"activeLayer\",e)}readActiveLayerFromService(e,t,r){let s;return this.activeLayer?t.layers.some((e=>e.id===this.activeLayer.id&&(s=e,!0))):(this.activeLayer=new WMTSSublayer,s=t.layers[0]),this.activeLayer.read(s,r),this.activeLayer}readActiveLayerFromItemOrWebDoc(e,t){const{templateUrl:r,wmtsInfo:s}=t,i=r?this._getLowerCasedUrlParams(r):null,a=s&&s.layerIdentifier;let o=null;const l=s&&s.tileMatrixSet;l&&(Array.isArray(l)?l.length&&(o=l[0]):o=l);const n=i&&i.format,m=i&&i.style;return new WMTSSublayer({id:a,imageFormat:n,styleId:m,tileMatrixSetId:o})}writeActiveLayer(e,t,s,i){const a=this.activeLayer;t.templateUrl=this.getUrlTemplate(a.id,a.tileMatrixSetId,a.imageFormat,a.styleId);const o=Object(object[\"b\" /* getDeepValue */])(\"tileMatrixSet.tileInfo\",a);t.tileInfo=o?o.toJSON(i):null,t.wmtsInfo={...t.wmtsInfo,layerIdentifier:a.id,tileMatrixSet:a.tileMatrixSetId}}readCustomParameters(e,t){const r=t.wmtsInfo;return r?this._mergeParams(r.customParameters,r.url):null}get fullExtents(){const e=[];return this.activeLayer.tileMatrixSets.forEach((t=>{t.fullExtent&&e.push(t.fullExtent)})),e}readServiceMode(e,t){return t.templateUrl.indexOf(\"?\")>-1?\"KVP\":\"RESTful\"}readSublayersFromService(e,t,r){return function(e,t){return e.map((e=>{const r=new WMTSSublayer;return r.read(e,t),r}))}(t.layers,r)}get supportedSpatialReferences(){return this.activeLayer.tileMatrixSets.map((e=>e.tileInfo.spatialReference)).toArray()}get title(){var e,t;return null!=(e=null==(t=this.activeLayer)?void 0:t.title)?e:\"Layer\"}set title(e){e?this._override(\"title\",e):this._clearOverride(\"title\")}get url(){return this._get(\"url\")}set url(e){e&&\"/\"===e.substr(-1)?this._set(\"url\",e.slice(0,-1)):this._set(\"url\",e)}createWebTileLayer(e){const t=this.getUrlTemplate(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId),r=this._getTileMatrixSetById(e.tileMatrixSetId).tileInfo,s=e.fullExtent,i=new WMTSLayerInfo[\"a\" /* default */]({layerIdentifier:e.id,tileMatrixSet:e.tileMatrixSetId,url:this.url});return this.customLayerParameters&&(i.customLayerParameters=this.customLayerParameters),this.customParameters&&(i.customParameters=this.customParameters),new WebTileLayer[\"default\"]({fullExtent:s,urlTemplate:t,tileInfo:r,wmtsInfo:i})}fetchTile(e,t,r){const s=this.getTileUrl(e,t,r);return Object(request[\"default\"])(s,{responseType:\"image\"}).then((e=>e.data))}findSublayerById(e){return this.sublayers.find((t=>t.id===e))}getTileUrl(e,t,r){const s=this._getTileMatrixSetById(this.activeLayer.tileMatrixSetId).tileInfo.lods[e],i=s?s.levelValue?s.levelValue:`${s.level}`:`${e}`;let a=this.resourceInfo?\"\":wmtsUtils_g({dimensionMap:this.dimensionMap,layerMap:this.layerMap},this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId,i,t,r);if(!a){a=this.getUrlTemplate(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId).replace(/\\{level\\}/gi,i).replace(/\\{row\\}/gi,`${t}`).replace(/\\{col\\}/gi,`${r}`)}return a=this._appendCustomLayerParameters(a),a}getUrlTemplate(e,t,r,s){if(!this.resourceInfo){const r=wmtsUtils_x({dimensionMap:this.dimensionMap,layerMap:this.layerMap},e,t,s);if(r)return r}if(\"KVP\"===this.serviceMode)return this.url+\"?SERVICE=WMTS&VERSION=\"+this.version+\"&REQUEST=GetTile&LAYER=\"+e+\"&STYLE=\"+s+\"&FORMAT=\"+r+\"&TILEMATRIXSET=\"+t+\"&TILEMATRIX={level}&TILEROW={row}&TILECOL={col}\";if(\"RESTful\"===this.serviceMode){let i=\"\";return WMTSLayer_E[r.toLowerCase()]&&(i=WMTSLayer_E[r.toLowerCase()]),this.url+e+\"/\"+s+\"/\"+t+\"/{level}/{row}/{col}\"+i}return\"\"}async _fetchService(e){let t;if(this.resourceInfo)\"KVP\"===this.resourceInfo.serviceMode&&(this.url+=this.url.indexOf(\"?\")>-1?\"\":\"?\"),t={ssl:!1,data:this.resourceInfo};else try{t=await this._getCapabilities(this.serviceMode,e)}catch{const r=\"KVP\"===this.serviceMode?\"RESTful\":\"KVP\";try{t=await this._getCapabilities(r,e),this.serviceMode=r}catch(e){throw new Error[\"a\" /* default */](\"wmtslayer:unsupported-service-data\",\"Services does not support RESTful or KVP service modes.\",{error:e})}}this.resourceInfo?t.data=wmtsUtils_p(t.data):t.data=wmtsUtils_a(t.data,{serviceMode:this.serviceMode,url:this.url}),t.data&&this.read(t.data,{origin:\"service\"})}async _getCapabilities(e,t){const r=this._getCapabilitiesUrl(e);return await Object(request[\"default\"])(r,{...t,responseType:\"text\"})}_getTileMatrixSetById(e){return this.findSublayerById(this.activeLayer.id).tileMatrixSets.find((t=>t.id===e))}_appendCustomParameters(e){if(this.customParameters)for(const t in this.customParameters)e+=(-1===e.indexOf(\"?\")?\"?\":\"&\")+t+\"=\"+encodeURIComponent(this.customParameters[t]);return e}_appendCustomLayerParameters(e){if(this.customLayerParameters||this.customParameters){const r={...Object(lang[\"a\" /* clone */])(this.customParameters||{}),...this.customLayerParameters};for(const t in r)e+=(-1===e.indexOf(\"?\")?\"?\":\"&\")+t+\"=\"+encodeURIComponent(r[t])}return e}_getCapabilitiesUrl(e){let t;return this.url=this.url.split(\"?\")[0],\"KVP\"===e?t=this.url+\"?request=GetCapabilities&service=WMTS&version=\"+this.version:\"RESTful\"===e&&(t=this.url+\"/\"+this.version+\"/WMTSCapabilities.xml\"),t=this._appendCustomParameters(t),t}_getLowerCasedUrlParams(e){if(!e)return null;const t=Object(urlUtils[\"I\" /* urlToObject */])(e).query;if(!t)return null;const r={};return Object.keys(t).forEach((e=>{r[e.toLowerCase()]=t[e]})),r}_mergeParams(e,r){const s=this._getLowerCasedUrlParams(r);if(s){const r=Object.keys(s);r.length&&(e=e?Object(lang[\"a\" /* clone */])(e):{},r.forEach((t=>{e.hasOwnProperty(t)||_.has(t)||(e[t]=s[t])})))}return e}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],O.prototype,\"dimensionMap\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],O.prototype,\"layerMap\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:WMTSSublayer,dependsOn:[\"sublayers\"],json:{origins:{\"web-document\":{write:{ignoreOrigin:!0}}}}})],O.prototype,\"activeLayer\",null),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"service\",\"activeLayer\",[\"layers\"])],O.prototype,\"readActiveLayerFromService\",null),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])([\"web-document\",\"portal-item\"],\"activeLayer\",[\"wmtsInfo\"])],O.prototype,\"readActiveLayerFromItemOrWebDoc\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])([\"web-document\",\"portal-item\"],\"activeLayer\",{templateUrl:{type:String},tileInfo:{type:TileInfo[\"a\" /* default */]},\"wmtsInfo.layerIdentifier\":{type:String},\"wmtsInfo.tileMatrixSet\":{type:String}})],O.prototype,\"writeActiveLayer\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,value:\"\",json:{write:!0}})],O.prototype,\"copyright\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[\"show\",\"hide\"]})],O.prototype,\"listMode\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{origins:{\"web-document\":{read:{source:[\"wmtsInfo.customParameters\",\"wmtsInfo.url\"]},write:{target:\"wmtsInfo.customParameters\"}},\"portal-item\":{read:{source:[\"wmtsInfo.customParameters\",\"wmtsInfo.url\"]},write:{target:\"wmtsInfo.customParameters\"}}}}})],O.prototype,\"customParameters\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"web-document\",\"customParameters\"),Object(reader[\"a\" /* reader */])(\"portal-item\",\"customParameters\")],O.prototype,\"readCustomParameters\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{origins:{\"web-document\":{read:{source:\"wmtsInfo.customLayerParameters\"},write:{target:\"wmtsInfo.customLayerParameters\"}},\"portal-item\":{read:{source:\"wmtsInfo.customLayerParameters\"},write:{target:\"wmtsInfo.customLayerParameters\"}}}}})],O.prototype,\"customLayerParameters\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Extent[\"a\" /* default */],json:{write:{ignoreOrigin:!0},origins:{\"web-document\":{read:{source:\"fullExtent\"}},\"portal-item\":{read:{source:\"fullExtent\"}}}}})],O.prototype,\"fullExtent\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"activeLayer\"]})],O.prototype,\"fullExtents\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[\"WebTiledLayer\"]})],O.prototype,\"operationalLayerType\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],O.prototype,\"resourceInfo\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],O.prototype,\"serviceMode\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])([\"portal-item\",\"web-document\"],\"serviceMode\",[\"templateUrl\"])],O.prototype,\"readServiceMode\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Collection[\"a\" /* default */].ofType(WMTSSublayer)})],O.prototype,\"sublayers\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"service\",\"sublayers\",[\"layers\"])],O.prototype,\"readSublayersFromService\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"activeLayer\"]})],O.prototype,\"supportedSpatialReferences\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({dependsOn:[\"activeLayer\"],json:{read:{source:\"title\"}}})],O.prototype,\"title\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:!1},readOnly:!0,value:\"wmts\"})],O.prototype,\"type\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{origins:{service:{read:{source:\"tileUrl\"}},\"web-document\":{read:{source:\"wmtsInfo.url\"},write:{target:\"wmtsInfo.url\"}},\"portal-item\":{read:{source:\"wmtsInfo.url\"},write:{target:\"wmtsInfo.url\"}}}}})],O.prototype,\"url\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],O.prototype,\"version\",void 0),O=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layers.WMTSLayer\")],O);var C=O;/* harmony default export */ var WMTSLayer = __webpack_exports__[\"default\"] = (C);\n\n\n/***/ })\n\n}]);","inputSourceMap":null}