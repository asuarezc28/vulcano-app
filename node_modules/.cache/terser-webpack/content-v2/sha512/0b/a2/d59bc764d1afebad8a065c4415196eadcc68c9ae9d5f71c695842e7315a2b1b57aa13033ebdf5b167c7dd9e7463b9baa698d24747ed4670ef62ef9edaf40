{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{\"/GVf\":function(e,t,r){\"use strict\";r.r(t);var i,a=r(\"pO5D\"),n=(r(\"wSAH\"),r(\"srIe\")),s=r(\"6S2I\"),o=r(\"zqDF\"),l=r(\"WbKI\"),c=r(\"04ZG\"),u=r(\"Cduq\"),p=r(\"4EHJ\"),d=(r(\"ju1D\"),r(\"9AIY\"),r(\"9MzC\")),m=r(\"SFah\"),b=r(\"pqNC\"),h=r(\"5pQd\"),f=r(\"IvSi\"),y=r(\"uRH/\"),O=r(\"PVlI\"),g=r(\"mXvl\"),j=r(\"DbUH\"),v=r(\"jhcG\"),R=r(\"WmKv\"),w=r(\"YBpl\"),x=r(\"9Ruv\"),S=r(\"f/qv\"),I=r(\"Stxv\"),N=r(\"+opI\"),_=r(\"r88o\"),T=r(\"zlDU\"),F=r(\"WZb1\"),C=r(\"SuVq\"),P=r(\"OvF4\"),D=r(\"Ehki\"),M=(r(\"4GrV\"),r(\"Lqtk\")),A=r(\"jWBI\"),V=r(\"Piei\"),J=r(\"ukD5\"),z=r(\"ofM5\"),L=r(\"gLc9\"),E=r(\"8prj\"),k=r(\"xk++\"),q=r(\"/uz8\"),U=r(\"tidM\"),H=r(\"RI0u\"),Q=r(\"ag7Y\");const B=new Set([\"Raster\",\"Raster2\",\"DEM\",\"FillRaster\"]),G=new Set([\"Rasters\"]),W=e=>e&&e.rasterFunction?Z.fromJSON(e):e,X=e=>e&&e instanceof Z?e.toJSON():e;var Y,K;(K=Y||(Y={}))[K.MOSAIC=0]=\"MOSAIC\",K[K.GROUP=1]=\"GROUP\",K[K.ITEM=2]=\"ITEM\";let Z=i=class extends Q.a{constructor(e){super(e),this.functionArguments=null,this.functionName=null,this.outputPixelType=\"unknown\",this.variableName=null,this.description=null,this.functionDefinition=null,this.thumbnail=null}readFunctionArguments(e,t){return(e=>{if(null==e)return null;const t={};for(const r of Object.keys(e))t[r]=B.has(r)?W(e[r]):G.has(r)&&Array.isArray(e[r])?e[r].map(W):e[r];return t})(t.arguments||t.rasterFunctionArguments)}writeFunctionArguments(e,t,r){const i={};for(const a of Object.keys(e))i[a]=B.has(a)?X(e[a]):G.has(a)&&Array.isArray(e[a])?e[a].map(X):X(e[a]);this.functionDefinition?t.arguments=i:t[r]=i}readFunctionName(e,t){const r=t.rasterFunctionInfos;return t.name||(r&&r.length&&\"None\"!==r[0].name?r[0].name:t.rasterFunction)}writeFunctionName(e,t,r){this.functionDefinition?t.name=e:t[r]=e}readFunctionType(e){return Y[e]}writeFunctionType(e,t,r){t[r]=Y[e]}clone(){return new i({functionName:this.functionName,functionArguments:Object(S.a)(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,description:this.description,functionType:this.functionType,functionDefinition:this.functionDefinition,thumbnail:this.thumbnail})}};Object(a.a)([Object(l.b)({json:{type:Object,write:{target:\"rasterFunctionArguments\"}}})],Z.prototype,\"functionArguments\",void 0),Object(a.a)([Object(_.a)(\"functionArguments\",[\"rasterFunctionArguments\",\"arguments\"])],Z.prototype,\"readFunctionArguments\",null),Object(a.a)([Object(u.a)(\"functionArguments\")],Z.prototype,\"writeFunctionArguments\",null),Object(a.a)([Object(l.b)({json:{type:String,write:{target:\"rasterFunction\"}}})],Z.prototype,\"functionName\",void 0),Object(a.a)([Object(_.a)(\"functionName\",[\"rasterFunction\",\"rasterFunctionInfos\",\"name\"])],Z.prototype,\"readFunctionName\",null),Object(a.a)([Object(u.a)(\"functionName\")],Z.prototype,\"writeFunctionName\",null),Object(a.a)([Object(H.a)({C128:\"c128\",C64:\"c64\",F32:\"f32\",F64:\"f64\",S16:\"s16\",S32:\"s32\",S8:\"s8\",U1:\"u1\",U16:\"u16\",U2:\"u2\",U32:\"u32\",U4:\"u4\",U8:\"u8\",UNKNOWN:\"unknown\"},{ignoreUnknown:!1}),Object(l.b)({json:{default:\"unknown\"}})],Z.prototype,\"outputPixelType\",void 0),Object(a.a)([Object(l.b)({type:String,json:{read:!0,write:!0}})],Z.prototype,\"variableName\",void 0),Object(a.a)([Object(l.b)({type:String,json:{read:!0,write:!0,origins:{\"web-document\":{read:!1,write:!1}}}})],Z.prototype,\"description\",void 0),Object(a.a)([Object(l.b)({json:{origins:{\"web-document\":{read:!1,write:!1}}}})],Z.prototype,\"functionType\",void 0),Object(a.a)([Object(_.a)(\"functionType\")],Z.prototype,\"readFunctionType\",null),Object(a.a)([Object(u.a)(\"functionType\")],Z.prototype,\"writeFunctionType\",null),Object(a.a)([Object(l.b)({type:Object,json:{read:{source:\"function\"},write:{target:\"function\"},origins:{\"web-document\":{read:!1,write:!1}}}})],Z.prototype,\"functionDefinition\",void 0),Object(a.a)([Object(l.b)({type:String,json:{read:!0,write:!0,origins:{\"web-document\":{read:!1,write:!1}}}})],Z.prototype,\"thumbnail\",void 0),Z=i=Object(a.a)([Object(c.a)(\"esri.layers.support.RasterFunction\")],Z);var $=Z,ee=r(\"w/y1\"),te=r(\"fG4V\"),re=r(\"ZVeJ\");const ie={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34e38,34e38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},ae={simple_scalar:\"Simple Scalar\",wind_barb:\"Wind Barb\",single_arrow:\"Single Arrow\",beaufort_kn:\"Beaufort Wind (Knots)\",beaufort_m:\"Beaufort Wind (MetersPerSecond)\",ocean_current_m:\"Ocean Current (MetersPerSecond)\",ocean_current_kn:\"Ocean Current (Knots)\"},ne=new Set([\"raster-stretch\",\"unique-value\",\"class-breaks\",\"raster-shaded-relief\",\"vector-field\",\"raster-colormap\"]);function se(e){return ne.has(e.type)}function oe(e,t){if(!e||!t)return Object(S.a)(e||t);const r=Object(S.a)(e);return\"none\"!==t.functionName.toLowerCase()&&(le(r.functionArguments).Raster=t),r}function le(e){const t=e.Raster;return t&&\"esri.layers.support.RasterFunction\"===t.declaredClass?le(t.functionArguments):e}const ce={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};function ue(e,t){const r=ie[String(t).toLowerCase()];return r&&e.push([Math.floor(r[0]-1),0,0,0],[Math.ceil(r[1]+1),0,0,0]),e}function pe(e){if(!e)return;const{fields:t}=e,r=t&&t.find(e=>e&&e.name&&\"value\"===e.name.toLowerCase());return r&&r.name}var de,me=r(\"Gj5k\");const be=Object(N.b)()({MT_FIRST:\"first\",MT_LAST:\"last\",MT_MIN:\"min\",MT_MAX:\"max\",MT_MEAN:\"mean\",MT_BLEND:\"blend\",MT_SUM:\"sum\"}),he=Object(N.b)()({esriMosaicNone:\"none\",esriMosaicCenter:\"center\",esriMosaicNadir:\"nadir\",esriMosaicViewpoint:\"viewpoint\",esriMosaicAttribute:\"attribute\",esriMosaicLockRaster:\"lock-raster\",esriMosaicNorthwest:\"northwest\",esriMosaicSeamline:\"seamline\"});let fe=de=class extends Q.a{constructor(e){super(e),this.ascending=!0,this.itemRenderingRule=null,this.lockRasterIds=null,this.method=null,this.multidimensionalDefinition=null,this.objectIds=null,this.operation=null,this.sortField=null,this.sortValue=null,this.viewpoint=null,this.where=null}readAscending(e,t){return null!=t.ascending?t.ascending:null==t.sortAscending||t.sortAscending}readMethod(e,t){return function(e){let t;switch(e?e.toLowerCase().replace(\"esrimosaic\",\"\"):\"\"){case\"byattribute\":case\"attribute\":t=\"esriMosaicAttribute\";break;case\"lockraster\":t=\"esriMosaicLockRaster\";break;case\"center\":t=\"esriMosaicCenter\";break;case\"northwest\":t=\"esriMosaicNorthwest\";break;case\"nadir\":t=\"esriMosaicNadir\";break;case\"viewpoint\":t=\"esriMosaicViewpoint\";break;case\"seamline\":t=\"esriMosaicSeamline\";break;case\"none\":default:t=\"esriMosaicNone\"}return he.fromJSON(t)}(t.mosaicMethod||t.defaultMosaicMethod)}readOperation(e,t){const r=t.mosaicOperation,i=t.mosaicOperator&&t.mosaicOperator.toLowerCase(),a=r||(i?be.toJSON(i):null);return be.fromJSON(a)||\"first\"}castSortValue(e){return null==e||\"string\"==typeof e||\"number\"==typeof e?e:\"\"+e}clone(){return new de({ascending:this.ascending,itemRenderingRule:Object(S.a)(this.itemRenderingRule),lockRasterIds:Object(S.a)(this.lockRasterIds),method:this.method,multidimensionalDefinition:Object(S.a)(this.multidimensionalDefinition),objectIds:Object(S.a)(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:Object(S.a)(this.viewpoint),where:this.where})}};Object(a.a)([Object(l.b)({type:Boolean,json:{write:!0}})],fe.prototype,\"ascending\",void 0),Object(a.a)([Object(_.a)(\"ascending\",[\"ascending\",\"sortAscending\"])],fe.prototype,\"readAscending\",null),Object(a.a)([Object(l.b)({type:$,json:{write:!0}})],fe.prototype,\"itemRenderingRule\",void 0),Object(a.a)([Object(l.b)({type:[o.a],json:{write:{overridePolicy(){return{enabled:\"lock-raster\"===this.method}}}}})],fe.prototype,\"lockRasterIds\",void 0),Object(a.a)([Object(l.b)({type:String,json:{type:he.jsonValues,write:{target:\"mosaicMethod\",writer:he.write}}})],fe.prototype,\"method\",void 0),Object(a.a)([Object(_.a)(\"method\",[\"mosaicMethod\",\"defaultMosaicMethod\"])],fe.prototype,\"readMethod\",null),Object(a.a)([Object(l.b)({type:[U.a],json:{write:!0}})],fe.prototype,\"multidimensionalDefinition\",void 0),Object(a.a)([Object(l.b)({type:[o.a],json:{name:\"fids\",write:!0}})],fe.prototype,\"objectIds\",void 0),Object(a.a)([Object(l.b)({json:{type:be.jsonValues,read:{reader:be.read},write:{target:\"mosaicOperation\",writer:be.write}}})],fe.prototype,\"operation\",void 0),Object(a.a)([Object(_.a)(\"operation\",[\"mosaicOperation\",\"mosaicOperator\"])],fe.prototype,\"readOperation\",null),Object(a.a)([Object(l.b)({type:String,json:{write:{overridePolicy(){return{enabled:\"attribute\"===this.method}}}}})],fe.prototype,\"sortField\",void 0),Object(a.a)([Object(l.b)({type:[String,Number],json:{write:{allowNull:!0,overridePolicy(){return{enabled:\"attribute\"===this.method,allowNull:!0}}}}})],fe.prototype,\"sortValue\",void 0),Object(a.a)([Object(me.a)(\"sortValue\")],fe.prototype,\"castSortValue\",null),Object(a.a)([Object(l.b)({type:C.a,json:{write:!0}})],fe.prototype,\"viewpoint\",void 0),Object(a.a)([Object(l.b)({type:String,json:{write:!0}})],fe.prototype,\"where\",void 0),fe=de=Object(a.a)([Object(c.a)(\"esri.layers.support.MosaicRule\")],fe);var ye=fe;const Oe=new N.a({RSP_NearestNeighbor:\"nearest\",RSP_BilinearInterpolation:\"bilinear\",RSP_CubicConvolution:\"cubic\",RSP_Majority:\"majority\"}),ge=new N.a({esriNoDataMatchAny:\"any\",esriNoDataMatchAll:\"all\"});let je=class extends Q.a{constructor(){super(...arguments),this.layer=null,this.adjustAspectRatio=void 0,this.bandIds=void 0,this.compression=void 0,this.compressionQuality=void 0,this.compressionTolerance=.01,this.format=null,this.interpolation=null,this.noData=null,this.noDataInterpretation=void 0,this.pixelType=void 0,this.lercVersion=2}writeAdjustAspectRatio(e,t,r){this.layer.version<10.3||(t[r]=e)}writeCompressionQuality(e,t,r){this.format&&this.format.toLowerCase().indexOf(\"jpg\")>-1&&null!=e&&(t[r]=e)}writeCompressionTolerance(e,t,r){\"lerc\"===this.format&&null!=e&&(t[r]=e)}writeLercVersion(e,t,r){\"lerc\"===this.format&&this.layer.version>=10.5&&(t[r]=e)}get version(){return(this._get(\"version\")||0)+1}set version(e){this._set(\"version\",e)}get mosaicRule(){const e=this.layer;let t=e.mosaicRule;const r=e.definitionExpression;return t?r&&r!==t.where&&(t=t.clone(),t.where=r):r&&(t=new ye({where:r})),t}get renderingRule(){const e=this.layer;let t=e.renderingRule;const r=e.pixelFilter,i=!e.format||e.format.indexOf(\"jpg\")>-1||e.format.indexOf(\"png\")>-1;return t=this._addResampleRasterFunction(t),i&&!r&&(t=this.combineRendererWithRenderingRule()),t}combineRendererWithRenderingRule(){var e;const t=this.layer,{rasterInfo:r,renderingRule:i,renderer:a}=t;return a&&se(a)?oe(function(e,t){switch(t=t||{},e.type){case\"raster-stretch\":return function(e,t){const r=new $;r.functionName=\"Stretch\";const i=ce[re.b.toJSON(e.stretchType)],a=\"u8\",n={StretchType:i,Statistics:function(e){const t=[];return e.forEach(e=>{const r=e;if(Array.isArray(r))t.push(r);else{if(null==r.min||null==r.max)return;t.push([r.min,r.max,r.avg||0,r.stddev||0])}}),t}(e.statistics),DRA:e.dynamicRangeAdjustment,UseGamma:e.useGamma,Gamma:e.gamma,ComputeGamma:e.computeGamma};if(null!=e.outputMin&&(n.Min=e.outputMin),null!=e.outputMax&&(n.Max=e.outputMax),i===ce.standardDeviation?(n.NumberOfStandardDeviations=e.numberOfStandardDeviations,r.outputPixelType=a):i===ce.percentClip?(n.MinPercent=e.minPercent,n.MaxPercent=e.maxPercent,r.outputPixelType=a):i===ce.minMax?r.outputPixelType=a:i===ce.sigmoid&&(n.SigmoidStrengthLevel=e.sigmoidStrengthLevel),r.functionArguments=n,r.variableName=\"Raster\",e.colorRamp){const i=e.colorRamp,a=new $,n=Object(te.c)(i);return a.functionArguments=n?{colorRamp:n}:!t.convertColorRampToColormap||\"algorithmic\"!==i.type&&\"multipart\"!==i.type?{colorRamp:e.colorRamp.toJSON()}:{Colormap:Object(te.b)(i,256)},a.variableName=\"Raster\",a.functionName=\"Colormap\",a.functionArguments.Raster=r,a}return r}(e,t);case\"class-breaks\":return function(e,t){const r=[],i=[],a=[],n=[],s=1e-6,{pixelType:o,rasterAttributeTable:l}=t,c=l&&l.features,u=pe(l);if(c&&Array.isArray(c)&&e.classBreakInfos){e.classBreakInfos.forEach((t,r)=>{const i=t.symbol.color;let a;i.a&&c.forEach(s=>{a=s.attributes[e.field],(a>=t.minValue&&a<t.maxValue||r===e.classBreakInfos.length-1&&a>=t.minValue)&&n.push([s.attributes[u],i.r,i.g,i.b])})});const t=o?ue(n,o):n,r=new $;return r.functionName=\"Colormap\",r.functionArguments={},r.functionArguments.Colormap=t,r.variableName=\"Raster\",r}e.classBreakInfos.forEach((e,t)=>{const o=e.symbol&&e.symbol.color;o.a?(r.push(0===t?e.minValue:e.minValue+s,e.maxValue+s),i.push(t),n.push([t,o.r,o.g,o.b])):a.push(e.minValue,e.maxValue)});const p=o?ue(n,o):n,d=new $;d.functionName=\"Remap\",d.functionArguments={InputRanges:r,OutputValues:i,NoDataRanges:a},d.variableName=\"Raster\";const m=new $;return m.functionName=\"Colormap\",m.functionArguments={Colormap:p,Raster:d},m}(e,t);case\"unique-value\":return function(e,t){const r=[],{pixelType:i,rasterAttributeTable:a}=t,n=a&&a.features,s=pe(a);let o=!1;if(e.uniqueValueInfos&&e.uniqueValueInfos.forEach(t=>{const i=t.symbol.color;i.a&&(e.field!==s&&n?n&&n.forEach(a=>{String(a.attributes[e.field])===String(t.value)&&r.push([a.attributes[s],i.r,i.g,i.b])}):isNaN(+t.value)?o=!0:r.push([+t.value,i.r,i.g,i.b]))}),o)return null;const l=i&&r.length>0?ue(r,i):r,c=new $;return c.functionName=\"Colormap\",c.functionArguments={},c.functionArguments.Colormap=l,c.variableName=\"Raster\",c}(e,t);case\"raster-colormap\":return function(e,t){const r=e.extractColormap();if(!r||0===r.length)return;const{pixelType:i}=t,a=i?ue(r,i):r,n=new $;return n.functionName=\"Colormap\",n.functionArguments={},n.functionArguments.Colormap=a,n}(e,t);case\"vector-field\":return function(e,t){const r=new $;r.functionName=\"VectorFieldRenderer\";const{dataType:i,bandProperties:a}=t,n=\"vector-uv\"===i;let s,o;a&&2===a.length&&(s=a.map(e=>e.BandName.toLowerCase()).indexOf(\"magnitude\"),o=a.map(e=>e.BandName.toLowerCase()).indexOf(\"direction\")),-1!==s&&null!==s||(s=0,o=1);const l=\"arithmetic\"===e.rotationType?1:2,c=\"flow-from\"===e.flowRepresentation?0:1,u=e.visualVariables?e.visualVariables.filter(e=>\"Magnitude\"===e.field)[0]:new ee.a,p={magnitudeBandID:s,directionBandID:o,isUVComponents:n,referenceSystem:l,massFlowAngleRepresentation:c,symbolTileSize:50,symbolTileSizeUnits:100,calculationMethod:\"Vector Average\",symbologyName:ae[e.style.toLowerCase().replace(\"-\",\"_\")],minimumMagnitude:u.minDataValue,maximumMagnitude:u.maxDataValue,minimumSymbolSize:u.minSize,maximumSymbolSize:u.maxSize};return r.functionArguments=p,r}(e,t);case\"raster-shaded-relief\":return function(e,t){if(\"elevation\"!==t.dataType)return new $;const r=new $;r.functionName=\"Hillshade\";const i=\"traditional\"===e.hillshadeType?0:1,a=\"none\"===e.scalingType?1:3,n={HillshadeType:i,SlopeType:a,ZFactor:e.zFactor};return 0===i&&(n.Azimuth=e.azimuth,n.Altitude=e.altitude),3===a&&(n.PSPower=e.pixelSizePower,n.PSZFactor=e.pixelSizeFactor),r.functionArguments=n,r.variableName=\"Raster\",e.colorRamp&&(r.functionName=\"ShadedRelief\",n.Colormap=Object(te.b)(e.colorRamp,256)),r}(e,t)}}(a,{rasterAttributeTable:r.attributeTable,pixelType:r.pixelType,dataType:r.dataType,bandProperties:null==(e=r.keyProperties)?void 0:e.BandProperties,convertColorRampToColormap:t.version<10.6}),i):i}_addResampleRasterFunction(e){var t;let r=null;if(\"vector-field\"===(null==(t=this.layer.renderer)?void 0:t.type)){const e={},t=this.layer.renderingRule;if(!t||\"Resample\"!==t.functionName){const t=\"esriImageServiceDataTypeVector-UV\"===this.layer.serviceDataType?7:10;e.rasterFunction=\"Resample\",e.rasterFunctionArguments={ResamplingType:t,InputCellSize:{x:this.layer.pixelSizeX,y:this.layer.pixelSizeY}}}r=$.fromJSON(e)}return oe(r,e)}};Object(a.a)([Object(l.b)()],je.prototype,\"layer\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],je.prototype,\"adjustAspectRatio\",void 0),Object(a.a)([Object(u.a)(\"adjustAspectRatio\")],je.prototype,\"writeAdjustAspectRatio\",null),Object(a.a)([Object(l.b)({json:{write:!0}}),Object(I.a)(\"layer.bandIds\")],je.prototype,\"bandIds\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],je.prototype,\"compression\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}}),Object(I.a)(\"layer.compressionQuality\")],je.prototype,\"compressionQuality\",void 0),Object(a.a)([Object(u.a)(\"compressionQuality\")],je.prototype,\"writeCompressionQuality\",null),Object(a.a)([Object(l.b)({json:{write:!0}}),Object(I.a)(\"layer.compressionTolerance\")],je.prototype,\"compressionTolerance\",void 0),Object(a.a)([Object(u.a)(\"compressionTolerance\")],je.prototype,\"writeCompressionTolerance\",null),Object(a.a)([Object(l.b)({json:{write:!0}}),Object(I.a)(\"layer.format\")],je.prototype,\"format\",void 0),Object(a.a)([Object(l.b)({type:String,json:{read:{reader:Oe.read},write:{writer:Oe.write}}}),Object(I.a)(\"layer.interpolation\")],je.prototype,\"interpolation\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}}),Object(I.a)(\"layer.noData\")],je.prototype,\"noData\",void 0),Object(a.a)([Object(l.b)({type:String,json:{read:{reader:ge.read},write:{writer:ge.write}}}),Object(I.a)(\"layer.noDataInterpretation\")],je.prototype,\"noDataInterpretation\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],je.prototype,\"pixelType\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],je.prototype,\"lercVersion\",void 0),Object(a.a)([Object(u.a)(\"lercVersion\")],je.prototype,\"writeLercVersion\",null),Object(a.a)([Object(l.b)({type:Number,dependsOn:[\"layer.adjustAspectRatio\",\"layer.bandIds\",\"layer.format\",\"layer.compressionQuality\",\"layer.compressionTolerance\",\"layer.definitionExpression\",\"layer.interpolation\",\"layer.noData\",\"layer.noDataInterpretation\",\"layer.mosaicRule\",\"layer.renderingRule\",\"layer.pixelFilter\",\"layer.renderer\",\"lercVersion\",\"pixelType\"]})],je.prototype,\"version\",null),Object(a.a)([Object(l.b)({dependsOn:[\"layer.mosaicRule\",\"layer.definitionExpression\"],json:{write:!0}})],je.prototype,\"mosaicRule\",null),Object(a.a)([Object(l.b)({dependsOn:[\"layer.renderingRule\",\"layer.renderer\",\"layer.rasterInfo\",\"layer.format\"],json:{write:!0}})],je.prototype,\"renderingRule\",null),je=Object(a.a)([Object(c.a)(\"esri.layers.mixins.ExportImageServiceParameters\")],je);var ve=r(\"pPNP\"),Re=r(\"2mvb\"),we=r(\"FFFX\"),xe=r(\"HM2S\"),Se=r(\"ciAr\"),Ie=r(\"qNUd\"),Ne=r(\"u3Ia\");let _e=class extends Q.a{constructor(){super(...arguments),this.catalogItemVisibilities=null,this.catalogItems=null,this.location=null,this.name=null,this.objectId=null,this.processedValues=null,this.properties=null,this.value=null}};Object(a.a)([Object(l.b)({json:{write:!0}})],_e.prototype,\"catalogItemVisibilities\",void 0),Object(a.a)([Object(l.b)({type:E.default,json:{write:!0}})],_e.prototype,\"catalogItems\",void 0),Object(a.a)([Object(l.b)({type:C.a,json:{write:!0}})],_e.prototype,\"location\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],_e.prototype,\"name\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],_e.prototype,\"objectId\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],_e.prototype,\"processedValues\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],_e.prototype,\"properties\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],_e.prototype,\"value\",void 0),_e=Object(a.a)([Object(c.a)(\"esri.tasks.support.ImageIdentifyResult\")],_e);var Te=_e;async function Fe(e,t,r){const i=Object(Ne.c)(e),a=t.geometry?[t.geometry]:[],s=await Object(Ie.a)(a),o=t.toJSON();!function(e){const t=null==e?void 0:e.time;if(t&&(null!=t.start||null!=t.end)){const r=[];null!=t.start&&r.push(t.start),null!=t.end&&-1===r.indexOf(t.end)&&r.push(t.end),e.time=r.join(\",\")}}(o);const l=s&&s[0];Object(n.h)(l)&&(o.geometry=l.toJSON());const c=Object(Ne.b)({...i.query,f:\"json\",...o});return Object(Ne.a)(c,r)}var Ce=r(\"kglp\");let Pe=class extends Ce.a{execute(e,t){return async function(e,t,r){const i=Object(Ne.c)(e),a=t.geometry?[t.geometry]:[];return Object(Ie.a)(a).then(e=>{const a=t.toJSON(),s=e&&e[0];Object(n.h)(s)&&(a.geometry=JSON.stringify(s.toJSON()));const o=Object(Ne.b)({...i.query,f:\"json\",...a}),l=Object(Ne.a)(o,r);return Object(M.default)(i.path+\"/identify\",l)}).then(e=>Te.fromJSON(e.data))}(this.url,e,t)}};Pe=Object(a.a)([Object(c.a)(\"esri.tasks.ImageIdentifyTask\")],Pe);var De,Me=Pe,Ae=r(\"qatw\"),Ve=r(\"ZYtI\");let Je=De=class extends Q.a{constructor(){super(...arguments),this.geometry=null,this.renderingRules=null,this.pixelSize=null,this.returnGeometry=!0,this.returnCatalogItems=!0,this.returnPixelValues=!0,this.maxItemCount=null,this.timeExtent=null,this.raster=void 0,this.viewId=void 0}writeGeometry(e,t,r){null!=e&&(t.geometryType=Object(Ae.c)(e),t[r]=JSON.stringify(e.toJSON()))}set mosaicRule(e){let t=e;t&&t.mosaicMethod&&(t=ye.fromJSON({...t.toJSON(),mosaicMethod:t.mosaicMethod,mosaicOperation:t.mosaicOperation})),this._set(\"mosaicRule\",t)}writeMosaicRule(e,t,r){null!=e&&(t[r]=JSON.stringify(e.toJSON()))}set renderingRule(e){let t=e;t&&t.rasterFunction&&(t=$.fromJSON({...t.toJSON(),rasterFunction:t.rasterFunction,rasterFunctionArguments:t.rasterFunctionArguments})),this._set(\"renderingRule\",t)}writeRenderingRule(e,t,r){null!=e&&(t[r]=JSON.stringify(e.toJSON()))}writeRenderingRules(e,t,r){null!=e&&(t[r]=JSON.stringify(e.map(e=>e.toJSON())))}writePixelSize(e,t,r){null!=e&&(t[r]=JSON.stringify(e))}writeTimeExtent(e,t,r){if(null!=e){const i=e.start?e.start.getTime():null,a=e.end?e.end.getTime():null;t[r]=null!=i?null!=a?`${i},${a}`:\"\"+i:null}}clone(){return new De(Object(S.a)({geometry:this.geometry,mosaicRule:this.mosaicRule,renderingRule:this.renderingRule,pixelSize:this.pixelSize,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,returnPixelValues:this.returnPixelValues,maxItemCount:this.maxItemCount,raster:this.raster,viewId:this.viewId,timeExtent:this.timeExtent}))}};Object(a.a)([Object(l.b)({json:{write:!0}})],Je.prototype,\"geometry\",void 0),Object(a.a)([Object(u.a)(\"geometry\")],Je.prototype,\"writeGeometry\",null),Object(a.a)([Object(l.b)({type:ye,json:{write:!0}})],Je.prototype,\"mosaicRule\",null),Object(a.a)([Object(u.a)(\"mosaicRule\")],Je.prototype,\"writeMosaicRule\",null),Object(a.a)([Object(l.b)({type:$,json:{write:!0}})],Je.prototype,\"renderingRule\",null),Object(a.a)([Object(u.a)(\"renderingRule\")],Je.prototype,\"writeRenderingRule\",null),Object(a.a)([Object(l.b)({type:[$],json:{write:!0}})],Je.prototype,\"renderingRules\",void 0),Object(a.a)([Object(u.a)(\"renderingRules\")],Je.prototype,\"writeRenderingRules\",null),Object(a.a)([Object(l.b)({type:C.a,json:{write:!0}})],Je.prototype,\"pixelSize\",void 0),Object(a.a)([Object(u.a)(\"pixelSize\")],Je.prototype,\"writePixelSize\",null),Object(a.a)([Object(l.b)({type:Boolean,json:{write:!0}})],Je.prototype,\"returnGeometry\",void 0),Object(a.a)([Object(l.b)({type:Boolean,json:{write:!0}})],Je.prototype,\"returnCatalogItems\",void 0),Object(a.a)([Object(l.b)({type:Boolean,json:{write:!0}})],Je.prototype,\"returnPixelValues\",void 0),Object(a.a)([Object(l.b)({type:Number,json:{write:!0}})],Je.prototype,\"maxItemCount\",void 0),Object(a.a)([Object(l.b)({type:Ve.a,json:{write:{target:\"time\"}}})],Je.prototype,\"timeExtent\",void 0),Object(a.a)([Object(u.a)(\"timeExtent\")],Je.prototype,\"writeTimeExtent\",null),Object(a.a)([Object(l.b)({json:{write:!0}})],Je.prototype,\"raster\",void 0),Object(a.a)([Object(l.b)({json:{write:!0}})],Je.prototype,\"viewId\",void 0),Je=De=Object(a.a)([Object(c.a)(\"esri.tasks.support.ImageIdentifyParameters\")],Je);var ze=Je;const Le=s.a.getLogger(\"esri.layers.mixins.ArcGISImageService\"),Ee=Object(N.b)()({RSP_NearestNeighbor:\"nearest\",RSP_BilinearInterpolation:\"bilinear\",RSP_CubicConvolution:\"cubic\",RSP_Majority:\"majority\"}),ke=Object(N.b)()({esriNoDataMatchAny:\"any\",esriNoDataMatchAll:\"all\"}),qe=Object(N.b)()({U1:\"u1\",U2:\"u2\",U4:\"u4\",U8:\"u8\",S8:\"s8\",U16:\"u16\",S16:\"s16\",U32:\"u32\",S32:\"s32\",F32:\"f32\",F64:\"f64\",C64:\"c64\",C128:\"c128\",UNKNOWN:\"unknown\"}),Ue=new Set([\"png\",\"png8\",\"png24\",\"png32\",\"jpg\",\"bmp\",\"gif\",\"jpgpng\",\"lerc\",\"tiff\"]),He=Object(l.a)(o.i,{min:0,max:255}),Qe=e=>{let t=class extends e{constructor(){super(...arguments),this._functionRasterInfos={},this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this._symbolizer=null,this._defaultServiceMosaicRule=null,this.rasterAttributeTableFieldPrefix=\"Raster.\",this.adjustAspectRatio=null,this.bandCount=null,this.bandIds=void 0,this.capabilities=null,this.compressionQuality=void 0,this.compressionTolerance=.01,this.copyright=null,this.definitionExpression=null,this.exportImageServiceParameters=null,this.rasterInfo=null,this.fields=null,this.fullExtent=null,this.hasMultidimensions=!1,this.imageMaxHeight=4100,this.imageMaxWidth=4100,this.interpolation=void 0,this.minScale=0,this.maxScale=0,this.multidimensionalInfo=null,this.noData=null,this.noDataInterpretation=void 0,this.objectIdField=null,this.pixelSizeX=null,this.pixelSizeY=null,this.pixelFilter=null,this.raster=void 0,this.viewId=void 0,this.renderer=null,this.rasterAttributeTable=null,this.rasterFunctionInfos=null,this.serviceDataType=null,this.spatialReference=null,this.pixelType=null,this.serviceRasterInfo=null,this.sourceJSON=null,this.url=null,this.version=null}initialize(){this._set(\"exportImageServiceParameters\",new je({layer:this}))}readDefaultServiceMosaicRule(e,t){return ye.fromJSON(t)}get rasterFunctionNamesIndex(){const e=new Map;return!this.rasterFunctionInfos||this.rasterFunctionInfos.length<1||this.rasterFunctionInfos.forEach(t=>{e.set(t.name.toLowerCase().replace(/ /gi,\"_\"),t.name)}),e}get queryTask(){return new q.a({url:this.url})}readBandIds(e,t){if(Array.isArray(e)&&e.length>0&&e.every(e=>\"number\"==typeof e))return e}readCapabilities(e,t){return this._readCapabilities(t)}writeCompressionQuality(e,t,r){null!=e&&\"lerc\"!==this.format&&(t[r]=e)}writeCompressionTolerance(e,t,r){\"lerc\"===this.format&&null!=e&&(t[r]=e)}get fieldsIndex(){return this.fields?new L.a(this.fields):null}set format(e){e&&Ue.has(e.toLowerCase())&&this._set(\"format\",e.toLowerCase())}readFormat(e,t){return\"esriImageServiceDataTypeVector-UV\"===t.serviceDataType||\"esriImageServiceDataTypeVector-MagDir\"===t.serviceDataType||null!=this.pixelFilter?\"lerc\":\"jpgpng\"}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}set mosaicRule(e){let t=e;t&&t.mosaicMethod&&(t=ye.fromJSON({...t.toJSON(),mosaicMethod:t.mosaicMethod,mosaicOperation:t.mosaicOperation})),this._set(\"mosaicRule\",t)}readMosaicRule(e,t){return ye.fromJSON(e||t.mosaicRule||t)}writeMosaicRule(e,t,r){let i=this.mosaicRule;const a=this.definitionExpression;i?a&&a!==i.where&&(i=i.clone(),i.where=a):a&&(i=new ye({where:a})),this._isValidCustomizedMosaicRule(i)&&(t[r]=i.toJSON())}writeNoData(e,t,r){null!=e&&\"number\"==typeof e&&(t[r]=He(e))}readObjectIdField(e,t){if(!e){const r=t.fields.filter(e=>\"esriFieldTypeOID\"===e.type||\"oid\"===e.type);e=r&&r[0]&&r[0].name}return e}get parsedUrl(){return this.url?Object(p.I)(this.url):null}readRenderer(e,t,r){const i=t&&t.layerDefinition&&t.layerDefinition.drawingInfo&&t.layerDefinition.drawingInfo.renderer,a=Object(J.b)(i,r)||void 0;if(null!=a)return se(a)||Le.warn(\"ArcGISImageService\",\"Imagery layer doesn't support given renderer type.\"),a}get rasterFields(){const e=this.rasterAttributeTableFieldPrefix||\"Raster.\",t=new z.a({name:\"Raster.ItemPixelValue\",alias:\"Item Pixel Value\",domain:null,editable:!1,length:50,type:\"string\"}),r=new z.a({name:\"Raster.ServicePixelValue\",alias:\"Service Pixel Value\",domain:null,editable:!1,length:50,type:\"string\"}),i=new z.a({name:\"Raster.ServicePixelValue.Raw\",alias:\"Raw Service Pixel Value\",domain:null,editable:!1,length:50,type:\"string\"});let a=this.fields?Object(S.a)(this.fields):[];a.push(r),this.capabilities.operations.supportsQuery&&this.fields&&this.fields.length>0&&a.push(t),this.version>=10.4&&this.rasterFunctionInfos&&this.rasterFunctionInfos.some(e=>\"none\"===e.name.toLowerCase())&&a.push(i),this.rasterFunctionInfos&&this.rasterFunctionInfos.filter(e=>\"none\"!==e.name.toLowerCase()).forEach(e=>{a.push(new z.a({name:\"Raster.ServicePixelValue.\"+e.name,alias:e.name,domain:null,editable:!1,length:50,type:\"string\"}))}),null==this.pixelFilter||\"esriImageServiceDataTypeVector-UV\"!==this.serviceDataType&&\"esriImageServiceDataTypeVector-MagDir\"!==this.serviceDataType||(a.push(new z.a({name:\"Raster.Magnitude\",alias:\"Magnitude\",domain:null,editable:!1,type:\"double\"})),a.push(new z.a({name:\"Raster.Direction\",alias:\"Direction\",domain:null,editable:!1,type:\"double\"})));const n=this.rasterInfo.attributeTable&&this.rasterInfo.attributeTable.fields||null;if(n&&n.length>0){const t=n.filter(e=>\"esriFieldTypeOID\"!==e.type&&\"value\"!==e.name.toLowerCase()).map(t=>{const r=Object(S.a)(t);return r.name=e+t.name,r});a=a.concat(t)}return a}set renderingRule(e){let t=e;t&&t.rasterFunction&&(t=$.fromJSON({...t.toJSON(),rasterFunction:t.rasterFunction,rasterFunctionArguments:t.rasterFunctionArguments})),this._set(\"renderingRule\",t)}readRenderingRule(e,t){const r=t.rasterFunctionInfos;return t.renderingRule||r&&r.length&&\"None\"!==r[0].name?$.fromJSON(t.renderingRule||{rasterFunctionInfos:t.rasterFunctionInfos}):null}writeRenderingRule(e,t,r){this._isRFTJson(e)||(t[r]=e.toJSON())}readSpatialReference(e,t){const r=e||t.extent.spatialReference;return r?F.a.fromJSON(r):null}readPixelType(e){return qe.fromJSON(e)||e}writePixelType(e,t,r){(Object(n.g)(this.serviceRasterInfo)||this.pixelType!==this.serviceRasterInfo.pixelType)&&(t[r]=qe.toJSON(e))}readVersion(e,t){let r=t.currentVersion;return r||(r=t.hasOwnProperty(\"fields\")||t.hasOwnProperty(\"timeInfo\")?10:9.3),r}applyFilter(e){let t=e;return this.pixelFilter&&(t=this._clonePixelData(e),this.pixelFilter(t)),t}async applyRenderer(e,t){let r=e;if(!this._isPicture()&&this.renderer&&this._symbolizer&&!this.pixelFilter){const i=JSON.stringify(this._cachedRendererJson)!==JSON.stringify(this.renderer.toJSON()),a=this._rasterJobHandler.instance,{bandIds:n}=this;if(a){i&&(this._symbolizer.bind(),await a.updateSymbolizer(this._symbolizer,t),this._cachedRendererJson=this.renderer.toJSON());const s=await a.symbolize({bandIds:n,...e},t);r={extent:e.extent,pixelBlock:s}}else r={extent:e.extent,pixelBlock:this._symbolizer.symbolize({bandIds:n,...e})}}return r}destroy(){this._shutdownJobHandler()}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}async computeHistograms(e,t){const r=null==t?void 0:t.signal;if(await this._fetchCapabilities(r),!this.capabilities.operations.supportsComputeHistograms)throw new T.a(\"imagery-layer:compute-histograms\",\"this operation is not supported on the input image service\");e=e.clone();const{raster:i,mosaicRule:a,renderingRule:n}=this;return n&&null==e.renderingRule&&(e.renderingRule=n),a&&null==e.mosaicRule&&(e.mosaicRule=a),i&&null==e.raster&&(e.raster=i),async function(e,t,r){const i=await Fe(e,t,r),a=Object(Ne.c)(e),{data:n}=await Object(M.default)(a.path+\"/computeHistograms\",i);return{histograms:n.histograms}}(this.url,e,{signal:r})}async computeStatisticsHistograms(e,t){const r=null==t?void 0:t.signal;if(await this._fetchCapabilities(r),!this.capabilities.operations.supportsComputeStatisticsHistograms)throw new T.a(\"imagery-layer:compute-statistics-histograms\",\"this operation is not supported on the input image service\");e=e.clone();const{raster:i,mosaicRule:a,renderingRule:n}=this;return n&&null==e.renderingRule&&(e.renderingRule=n),a&&null==e.mosaicRule&&(e.mosaicRule=a),i&&null==e.raster&&(e.raster=i),async function(e,t,r){const i=await Fe(e,t,r),a=Object(Ne.c)(e),{data:n}=await Object(M.default)(a.path+\"/computeStatisticsHistograms\",i),{statistics:s}=n;return null!=s&&s.length&&s.forEach(e=>{e.avg=e.mean,e.stddev=e.standardDeviation}),{statistics:s,histograms:n.histograms}}(this.url,e,{signal:r})}fetchImage(e,t,r,i={}){if(null==e||null==t||null==r)return Object(d.t)(new T.a(\"imagery-layer:fetch-image\",\"Insufficient parameters for requesting an image. A valid extent, width and height values are required.\"));const a=this.renderer||this._symbolizer?this.generateRasterInfo(this.renderingRule,{signal:i.signal}):null;return Object(d.y)(a).then(a=>{a&&(this.rasterInfo=a);const n={imageServiceParameters:this.getExportImageServiceParameters(e,t,r,i.timeExtent),imageProps:{extent:e,width:t,height:r,format:this.format},requestAsImageElement:i.requestAsImageElement&&!this.pixelFilter||!1,signal:i.signal};return this._requestArrayBuffer(n)})}fetchKeyProperties(e){const t=e&&e.renderingRule&&e.renderingRule.toJSON();return Object(M.default)(this.parsedUrl.path+\"/keyProperties\",{query:this._getQueryParams({renderingRule:this.version>=10.3&&t?JSON.stringify(t):null})}).then(e=>e.data)}fetchRasterAttributeTable(e){const t=e&&e.renderingRule&&e.renderingRule.toJSON();return this.version<10.1?Object(d.t)(new T.a(\"#fetchRasterAttributeTable()\",\"Failed to get rasterAttributeTable\")):Object(M.default)(this.parsedUrl.path+\"/rasterAttributeTable\",{query:this._getQueryParams({renderingRule:this.version>=10.3&&t?JSON.stringify(t):null})}).then(e=>E.default.fromJSON(e.data))}async getCatalogItemRasterInfo(e,t){const r=Object(M.default)(this.parsedUrl.path+\"/\"+e+\"/info\",{query:this._getQueryParams(),...t}).then(e=>e.data),i=Object(M.default)(this.parsedUrl.path+\"/\"+e+\"/info/keyProperties\",{query:this._getQueryParams(),...t}).then(e=>e.data).catch(()=>{}),a=await Object(d.b)([r,i]);if(!a[0])return;const n=P.a.fromJSON(a[0].extent),s=a[0].statistics?a[0].statistics.map(e=>({min:e[0],max:e[1],avg:e[2],stddev:e[3]})):null;return new ve.a({bandCount:a[0].bandCount,extent:n,spatialReference:n.sr,pixelSize:new C.a({x:a[0].pixelSizeX,y:a[0].pixelSizeY,spatialReference:n.sr}),pixelType:a[0].pixelType.toLowerCase(),statistics:s,histograms:a[0].histograms,keyProperties:a[1]||{}})}async getCatalogItemICSInfo(e,t){const{data:r}=await Object(M.default)(this.parsedUrl.path+\"/\"+e+\"/info/ics\",{query:this._getQueryParams(),...t}),i=r&&r.ics;if(!i)return;let a=null;try{a=(await Object(M.default)(this.parsedUrl.path+\"/\"+e+\"/info\",{query:this._getQueryParams(),...t})).data.extent}catch{}if(!a||!a.spatialReference)return{ics:i,icsToPixelTransform:null,icsExtent:null,northDirection:null};const n=this.version>=10.7?Object(M.default)(this.parsedUrl.path+\"/\"+e+\"/info/icstopixel\",{query:this._getQueryParams(),...t}).then(e=>e.data).catch(()=>({})):{},s=a.spatialReference,o={geometries:JSON.stringify({geometryType:\"esriGeometryEnvelope\",geometries:[a]}),inSR:s.wkid||JSON.stringify(s),outSR:\"0:\"+e},l=Object(M.default)(this.parsedUrl.path+\"/project\",{query:this._getQueryParams(o),...t}).then(e=>e.data).catch(()=>({})),c=(a.xmin+a.xmax)/2,u=(a.ymax-a.ymin)/6,p=a.ymin+u,m=[];for(let d=0;d<5;d++)m.push({x:c,y:p+u*d});const b={geometries:JSON.stringify({geometryType:\"esriGeometryPoint\",geometries:m}),inSR:s.wkid||JSON.stringify(s),outSR:\"0:\"+e},h=Object(M.default)(this.parsedUrl.path+\"/project\",{query:this._getQueryParams(b),...t}).then(e=>e.data).catch(()=>({})),f=await Object(d.b)([n,l,h]);let y=f[0].ipxf;if(null==y){var O,g,j;const e=null==(O=i.geodataXform)?void 0:O.xf_0;\"topup\"===(null==e||null==(g=e.name)?void 0:g.toLowerCase())&&6===(null==e||null==(j=e.coefficients)?void 0:j.length)&&(y={affine:{name:\"ics [sensor: Frame] to pixel (column, row) transformation\",coefficients:e.coefficients,cellsizeRatio:0,type:\"GeometricXform\"}})}const v=P.a.fromJSON(f[1]&&f[1].geometries&&f[1].geometries[0]);v&&(v.spatialReference=new F.a({wkid:0,imageCoordinateSystem:i}));const R=f[2].geometries?f[2].geometries.filter(e=>null!=e&&null!=e.x&&null!=e.y&&\"NaN\"!==e.x&&\"NaN\"!==e.y):[],w=R.length;if(w<3)return{ics:i,icsToPixelTransform:y,icsExtent:v,northDirection:null};let x=0,S=0,I=0,N=0;for(let d=0;d<w;d++)x+=R[d].x,S+=R[d].y,I+=R[d].x*R[d].x,N+=R[d].x*R[d].y;const _=(w*N-x*S)/(w*I-x*x);let T=0;const C=R[4].x>R[0].x,D=R[4].y>R[0].y;return _===1/0?T=D?90:270:0===_?T=C?0:180:_>0?T=C?180*Math.atan(_)/Math.PI:180*Math.atan(_)/Math.PI+180:_<0&&(T=D?180+180*Math.atan(_)/Math.PI:360+180*Math.atan(_)/Math.PI),{ics:i,icsToPixelTransform:y,icsExtent:v,northDirection:T}}async generateRasterInfo(e,t){if((!e||\"none\"===e.functionName.toLowerCase())&&Object(n.h)(this.serviceRasterInfo))return this.serviceRasterInfo;const r=function(e){if(!e)return null;const t=JSON.stringify(e).match(/\"rasterFunction\":\"(.*?\")/gi),r=null==t?void 0:t.map(e=>e.replace('\"rasterFunction\":\"',\"\").replace('\"',\"\"));return r?r.join(\"/\"):null}(e);if(this._functionRasterInfos[r])return this._functionRasterInfos[r];const i=this._generateRasterInfo(e,t);this._functionRasterInfos[r]=i;try{return await i}catch{return this._functionRasterInfos[r]=null,null}}getExportImageServiceParameters(e,t,r,i){const a=(e=e.clone().shiftCentralMeridian()).spatialReference;let s;if(a.imageCoordinateSystem){const{id:e,referenceServiceName:t}=a.imageCoordinateSystem;s=null!=e?t?this.parsedUrl.path.toLowerCase().indexOf(\"/\"+t.toLowerCase()+\"/\")>-1?\"0:\"+e:JSON.stringify({icsid:e,icsns:t}):\"0:\"+e:JSON.stringify({ics:a.imageCoordinateSystem})}else s=a.wkid||JSON.stringify(a.toJSON());Object(n.h)(this.serviceRasterInfo)&&this.pixelType!==this.serviceRasterInfo.pixelType&&(this.exportImageServiceParameters.pixelType=this.pixelType);const o=this.exportImageServiceParameters.toJSON(),{bandIds:l,noData:c,mosaicRule:u,renderingRule:p}=o;l instanceof Array&&l.length>0&&(o.bandIds=l.join(\",\")),c instanceof Array&&c.length>0&&(o.noData=c.join(\",\"));const d=this.timeInfo;u&&u.multidimensionalDefinition&&i&&d&&d.startField&&(u.multidimensionalDefinition=u.multidimensionalDefinition.filter(e=>e.dimensionName!==d.startField)),o.mosaicRule=u&&JSON.stringify(u),o.renderingRule=p&&JSON.stringify(p);const m={};if(i){const{start:e,end:t}=i.toJSON();e&&t&&e===t?m.time=\"\"+e:null==e&&null==t||(m.time=`${null==e?\"null\":e},${null==t?\"null\":t}`)}return{bbox:e.xmin+\",\"+e.ymin+\",\"+e.xmax+\",\"+e.ymax,bboxSR:s,imageSR:s,size:t+\",\"+r,...o,...m}}async identify(e,t){if(await this._fetchCapabilities(null==t?void 0:t.signal),!this.capabilities.operations.supportsIdentify)throw new T.a(\"imagery-layer:query-rasters\",\"query operation is not supported on the input image service\");e=e.clone();const{raster:r,mosaicRule:i,renderingRule:a}=this;return a&&null==e.renderingRule&&(e.renderingRule=a),i&&null==e.mosaicRule&&(e.mosaicRule=i),r&&null==e.raster&&(e.raster=r),new Me({url:this.url}).execute(e,t)}async queryRasters(e,t){if(await this._fetchCapabilities(null==t?void 0:t.signal),!this.capabilities.operations.supportsQuery)throw new T.a(\"imagery-layer:query-rasters\",\"query operation is not supported on the input image service\");return this.queryTask.execute(e,t)}queryVisibleRasters(e,t){if(!e)return Object(d.t)(new T.a(\"imagery-layer: query-visible-rasters\",\"missing query parameter\"));const{pixelSize:r,returnDomainValues:i,returnTopmostRaster:a,showNoDataRecords:s}=t||{pixelSize:null,returnDomainValues:!1,returnTopmostRaster:!1,showNoDataRecords:!1};let o=!1,l=null,c=null;const u=\"raster.servicepixelvalue\",p=this.rasterFunctionNamesIndex;if(Object(n.h)(e.outFields)&&(o=e.outFields.some(e=>-1===e.toLowerCase().indexOf(u)),this.version>=10.4)){const t=e.outFields.filter(e=>e.toLowerCase().indexOf(u)>-1&&e.length>u.length).map(e=>{const t=e.slice(u.length+1);return[this._updateRenderingRulesFunctionName(t,p),t]});l=t.map(e=>new $({functionName:e[0]})),c=t.map(e=>e[1]),0===l.length?this.renderingRule?(l.push(this.renderingRule),c.push(this.renderingRule.functionName)):l=null:this.renderingRule&&!l.some(e=>e.functionName===this.renderingRule.functionName)&&(l.push(this.renderingRule),c.push(this.renderingRule.functionName))}const m=Object(n.g)(e.outSpatialReference)||e.outSpatialReference.equals(this.spatialReference),b=this._getQueryParams({geometry:e.geometry,timeExtent:e.timeExtent,mosaicRule:this.exportImageServiceParameters.mosaicRule,renderingRule:this.version<10.4?this.renderingRule:null,renderingRules:l,pixelSize:r,returnCatalogItems:o,returnGeometry:m,maxItemCount:a?1:null});delete b.f;const h=new ze(b),f=new Me({url:this.url}),y=this.generateRasterInfo(this.renderingRule);return Object(d.c)(t=>{y.then(()=>{f.execute(h).then(r=>{const a=e.outFields;if(o&&!m&&r.catalogItems&&r.catalogItems.features&&r.catalogItems.features.length>0){const n=this.objectIdField||\"ObjectId\",o=r.catalogItems.features,l=o.map(e=>e.attributes&&e.attributes[n]),u=new k.a({objectIds:l,returnGeometry:!0,outSpatialReference:e.outSpatialReference,outFields:[n]});return this.queryRasters(u).then(l=>{l&&l.features&&l.features.length>0&&l.features.forEach(t=>{o.forEach(r=>{r.attributes[n]===t.attributes[n]&&(r.geometry=new D.a(t.geometry),r.geometry.spatialReference=e.outSpatialReference)})}),t(this._processVisibleRastersResponse(r,{returnDomainValues:i,templateRRFunctionNames:c,showNoDataRecords:s,templateFields:a}))}).catch(()=>{throw new T.a(\"imagery-layer:query-visible-rasters\",\"encountered error when querying visible rasters geometry\")})}t(this._processVisibleRastersResponse(r,{returnDomainValues:i,templateRRFunctionNames:c,showNoDataRecords:s,templateFields:a}))}).catch(()=>{throw new T.a(\"imagery-layer:query-visible-rasters\",\"encountered error when querying visible rasters\")})})})}async fetchVariableStatisticsHistograms(e,t){const r=Object(M.default)(this.parsedUrl.path+\"/statistics\",{query:this._getQueryParams({variable:e}),signal:t}).then(e=>{var t;return null==(t=e.data)?void 0:t.statistics}),i=Object(M.default)(this.parsedUrl.path+\"/histograms\",{query:this._getQueryParams({variable:e}),signal:t}).then(e=>{var t;return null==(t=e.data)?void 0:t.histograms}),a=await Object(d.b)([r,i]);return a[0]&&a[0].forEach(e=>{e.avg=e.mean,e.stddev=e.standardDeviation}),{statistics:a[0]||null,histograms:a[1]||null}}async _fetchService(e){await this._fetchServiceInfo(e),Object(n.h)(this.serviceRasterInfo)&&!this.rasterInfo&&(this.rasterInfo=this.serviceRasterInfo);const t=this.sourceJSON,r=Object(n.h)(this.serviceRasterInfo)?Object(d.u)(this.serviceRasterInfo):this._fetchAuxiliaryRasterInfo({serviceInfo:t,signal:e}).then(e=>(this._set(\"serviceRasterInfo\",e),e)),i=this.renderingRule&&\"none\"!==this.renderingRule.functionName.toLowerCase()?this.generateRasterInfo(this.renderingRule,{signal:e}):null;return Object(d.b)([r,i]).then(e=>{this._set(\"rasterInfo\",e[1]?e[1]:e[0]),this.renderer&&Object(xe.d)(this.rasterInfo).indexOf(this.renderer.type)<0&&(this.renderer=null,Le.warn(\"ArcGISImageService\",\"Switching to the default renderer. Renderer applied is not valid for this Imagery Layer\")),this._configDefaultRenderer(),this.watch(\"renderer\",()=>this._configDefaultRenderer()),this.watch(\"renderingRule\",e=>{(this.renderer||this._symbolizer||this.popupEnabled&&this.popupTemplate)&&this.generateRasterInfo(e).then(e=>{e&&(this.rasterInfo=e)})});const t=Object(n.h)(this.serviceRasterInfo)&&this.serviceRasterInfo.multidimensionalInfo;t&&this._updateMultidimensionalDefinition(t)})}async _initJobHandler(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const e=new Re.a;this._rasterJobHandler.connectionPromise=e.initialize().then(()=>{this._rasterJobHandler.instance=e},()=>null),await this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0}async _fetchCapabilities(e){return this.capabilities||await this._fetchServiceInfo(e),this.capabilities}async _fetchServiceInfo(e){var t;let r=this.sourceJSON;if(!r){const{data:t,ssl:i}=await Object(M.default)(this.parsedUrl.path,{query:this._getQueryParams(),signal:e});r=t,this.sourceJSON=r,i&&(this.url=this.url.replace(/^http:/i,\"https:\"))}if((null==(t=r.capabilities)?void 0:t.toLowerCase().split(\",\").map(e=>e.trim()).indexOf(\"tilesonly\"))>-1)throw new T.a(\"imagery-layer:fetch-service-info\",\"use ImageryTileLayer to open tiles-only image services\");this.read(r,{origin:\"service\",url:this.parsedUrl})}_isPicture(){return!this.format||this.format.indexOf(\"jpg\")>-1||this.format.indexOf(\"png\")>-1}_configDefaultRenderer(){if(!this._isPicture()&&!this.pixelFilter){if(!this.bandIds&&this.rasterInfo.bandCount>=3){const e=Object(xe.b)(this.rasterInfo);!e||3===this.rasterInfo.bandCount&&0===e[0]&&1===e[1]&&2===e[2]||(this.bandIds=e)}var e,t;this.renderer||(this.renderer=Object(xe.a)(this.rasterInfo,{bandIds:this.bandIds,variableName:this.renderingRule?null:null==(e=this.mosaicRule)||null==(t=e.multidimensionalDefinition)?void 0:t[0].variableName})),this._symbolizer?(this._symbolizer.rendererJSON=this.renderer.toJSON(),this._symbolizer.rasterInfo=this.rasterInfo):this._symbolizer=new Se.a({rendererJSON:this.renderer.toJSON(),rasterInfo:this.rasterInfo}),this._symbolizer.bind()||(this._symbolizer=null)}}_clonePixelData(e){return null==e?e:{extent:e.extent&&e.extent.clone(),pixelBlock:e.pixelBlock&&e.pixelBlock.clone()}}_getQueryParams(e){const{raster:t,viewId:r}=this;return{raster:t,viewId:r,f:\"json\",...e}}_decodePixelBlock(e,t,r){return this._rasterJobHandler.instance?this._rasterJobHandler.instance.decode({data:e,options:t}):Object(we.a)(e,t,r)}async _fetchMultidimensionalInfo(e){var t;const r=await Object(M.default)(this.parsedUrl.path+\"/multidimensionalInfo\",{query:this._getQueryParams(),signal:e}).then(e=>{var t;return null==(t=e.data)?void 0:t.multidimensionalInfo});return null!=(t=r.variables)&&t.length&&r.variables.forEach(e=>{var t;null!=(t=e.statistics)&&t.length&&e.statistics.forEach(e=>{e.avg=e.mean,e.stddev=e.standardDeviation})}),r}_fetchAuxiliaryRasterInfo(e){const t=e&&e.serviceInfo;if(!t)return Object(d.t)(new T.a(\"imagery-layer:fetch-metadata\",\"valid serviceInfo is required\"));const r=e.renderingRule?JSON.stringify(e.renderingRule.toJSON()):null,i=e.signal,a=!!(t.hasRasterAttributeTable&&this.version>=10.1)&&Object(M.default)(this.parsedUrl.path+\"/rasterAttributeTable\",{query:this._getQueryParams({renderingRule:this.version>=10.1?r:null}),signal:i}).then(e=>E.default.fromJSON(e.data)).catch(()=>null),n=!!(t.hasColormap&&this.version>=10.1)&&Object(M.default)(this.parsedUrl.path+\"/colormap\",{query:this._getQueryParams({renderingRule:this.version>=10.6?r:null}),signal:i}).then(e=>{var t;return null==(t=e.data)?void 0:t.colormap}),s=!!(t.hasHistograms&&this.version>=10.1)&&Object(M.default)(this.parsedUrl.path+\"/histograms\",{query:this._getQueryParams({renderingRule:this.version>=10.1?r:null}),signal:i}).then(e=>{var t;return null==(t=e.data)?void 0:t.histograms}),o=this.version>=10.3&&Object(M.default)(this.parsedUrl.path+\"/keyProperties\",{query:this._getQueryParams({renderingRule:r}),signal:i}).then(e=>e.data).catch(()=>{}),l=!!(t.hasMultidimensions&&this.version>=10.3)&&this._fetchMultidimensionalInfo();return Object(d.b)([a,n,s,o,l]).then(e=>{let r=null;if(t.minValues&&t.minValues.length===t.bandCount){r=[];for(let e=0;e<t.minValues.length;e++)r.push({min:t.minValues[e],max:t.maxValues[e],avg:t.meanValues[e],stddev:t.stdvValues[e]})}const i=Math.ceil((t.extent.xmax-t.extent.xmin)/t.pixelSizeX-.1),a=Math.ceil((t.extent.ymax-t.extent.ymin)/t.pixelSizeY-.1),n=F.a.fromJSON(t.spatialReference||t.extent.spatialReference);return new ve.a({width:i,height:a,bandCount:t.bandCount,extent:P.a.fromJSON(t.extent),spatialReference:n,pixelSize:new C.a({x:t.pixelSizeX,y:t.pixelSizeY,spatialReference:n}),pixelType:t.pixelType.toLowerCase(),statistics:r,attributeTable:e[0]||null,colormap:e[1]||null,histograms:e[2]||null,keyProperties:e[3]||{},multidimensionalInfo:e[4]||null})})}_requestArrayBuffer(e){const{imageProps:t,requestAsImageElement:r,signal:i}=e;if(r&&!this.pixelFilter&&t.format&&t.format.indexOf(\"png\")>-1)return Object(M.default)(this.parsedUrl.path+\"/exportImage\",{responseType:\"image\",query:this._getQueryParams({f:\"image\",...e.imageServiceParameters}),signal:i}).then(e=>({imageElement:e.data,params:t}));const a=this._initJobHandler(),n=Object(M.default)(this.parsedUrl.path+\"/exportImage\",{responseType:\"array-buffer\",query:this._getQueryParams({f:\"image\",...e.imageServiceParameters}),signal:i});return Object(d.b)([n,a]).then(e=>{const r=e[0].data,a=t.format||\"jpgpng\";let n=a;if(\"bsq\"!==n&&\"bip\"!==n&&(n=Object(we.b)(r)),!n)throw new T.a(\"imagery-layer:fetch-image\",\"unsupported format signature \"+String.fromCharCode.apply(null,new Uint8Array(r)));const s=\"gif\"===a||\"bmp\"===a||a.indexOf(\"png\")>-1&&(\"png\"===n||\"jpg\"===n),o={signal:i};return s?Object(we.a)(r,{useCanvas:!0,...t},o).then(e=>({pixelData:{pixelBlock:e,extent:t.extent},params:t})):this._decodePixelBlock(r,{width:t.width,height:t.height,planes:null,pixelType:null,noDataValue:null,format:a},o).then(e=>({pixelData:{pixelBlock:e,extent:t.extent},params:t}))})}async _generateRasterInfo(e,t){const{data:r}=await Object(M.default)(this.parsedUrl.path,{query:this._getQueryParams({renderingRule:e}),...t});return await this._fetchAuxiliaryRasterInfo({serviceInfo:r,renderingRule:e,...t})}_isValidCustomizedMosaicRule(e){return e&&JSON.stringify(e.toJSON())!==JSON.stringify(this._defaultServiceMosaicRule&&this._defaultServiceMosaicRule.toJSON())}_updateMultidimensionalDefinition(e){if(this._isValidCustomizedMosaicRule(this.mosaicRule))return;const t=e.variables[0].dimensions,r=[];for(const i in t)if(t.hasOwnProperty(i)){const e=t[i],a=e.extent;let n=!0,s=[a[0]];e.hasRanges&&!0===e.hasRanges?(n=!1,s=[e.values[0]]):\"stdz\"===e.name.toLowerCase()&&Math.abs(a[1])<=Math.abs(a[0])&&(s=[a[1]]),r.push(new U.a({variableName:\"\",dimensionName:t[i].name,isSlice:n,values:s}))}if(r.length>0){this.mosaicRule=this.mosaicRule||new ye;const e=this.mosaicRule.multidimensionalDefinition;(!e||e&&e.length<=0)&&(this.mosaicRule.multidimensionalDefinition=r)}}_formatAttributeValue(e,t){if(\"string\"==typeof e){const r=this._getFieldInfo(this.popupTemplate&&this.popupTemplate.fieldInfos,t),i=r&&r.format;if(i){let t,r;return e.trim().indexOf(\",\")>-1?(t=\",\",r=t+\" \",this._formatDelimitedString(e,t,r,i)):e.trim().indexOf(\" \")>-1?(t=r=\" \",this._formatDelimitedString(e,t,r,i)):this._formatNumberFromString(e,i)}}return e}_getFieldInfo(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let i;return e.some(e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r&&e.fieldName.toLowerCase()!==r.replace(/ /g,\"_\")||(i=e,0))),i}_formatDelimitedString(e,t,r,i){return e&&t&&r&&i?e.trim().split(t).map(e=>this._formatNumberFromString(e,i)).join(r):e}_formatNumberFromString(e,t){if(!e||!t)return e;const r=Number(e);return isNaN(r)?e:t.format(r)}_processVisibleRastersResponse(e,t){t=t||{};const r=e.value,{templateRRFunctionNames:i,showNoDataRecords:a,returnDomainValues:s,templateFields:o}=t,l=e.processedValues;let c=e.catalogItems&&e.catalogItems.features,u=e.properties&&e.properties.Values&&e.properties.Values.map(e=>e.replace(/ /gi,\", \"))||[];const p=this.objectIdField||\"ObjectId\",d=\"string\"==typeof r&&r.toLowerCase().indexOf(\"nodata\")>-1,m=[];if(r&&!c&&!d){const e={};e[p]=0,u=[r],c=[new A.a(this.fullExtent,null,e)]}if(!c)return[];let b,h,f;this._updateResponseFieldNames(c,o);for(let y=0;y<c.length;y++){if(b=c[y],null!=r&&!d){if(h=u[y],f=this.renderingRule&&l&&l.length>0&&i&&i.length>0&&i.indexOf(this.renderingRule.functionName)>-1?l[i.indexOf(this.renderingRule.functionName)]:r,\"nodata\"===h.toLowerCase()&&!a)continue;const e=\"Raster.ItemPixelValue\",t=\"Raster.ServicePixelValue\";b.attributes[e]=this._formatAttributeValue(h,e),b.attributes[t]=this._formatAttributeValue(f,t),this._updateFeatureWithMagDirValues(b,h);const s=this.fields&&this.fields.length>0;let o=this.renderingRule&&Object(n.h)(this.serviceRasterInfo)&&this.serviceRasterInfo.attributeTable?s?h:r:f;this.renderingRule||(o=s?h:r),this._updateFeatureWithRasterAttributeTableValues(b,o)}if(b.sourceLayer=this,s&&this._updateFeatureWithDomainValues(b),i&&l&&i.length===l.length)for(let e=0;e<i.length;e++){const t=\"Raster.ServicePixelValue.\"+i[e];b.attributes[t]=this._formatAttributeValue(l[e],t)}m.push(c[y])}return m}_updateFeatureWithRasterAttributeTableValues(e,t){const r=this.rasterInfo&&this.rasterInfo.attributeTable||Object(n.h)(this.serviceRasterInfo)&&this.serviceRasterInfo.attributeTable,i=r&&r.features;if(!i)return;const a=r.fields,s=a.map(e=>e.name).filter(e=>\"value\"===e.toLowerCase()),o=s&&s[0];if(!o)return;const l=i.filter(e=>e.attributes[o]===(null!=t?parseInt(t,10):null));l&&l[0]&&a.forEach(t=>{const r=this.rasterAttributeTableFieldPrefix+t.name;e.attributes[r]=this._formatAttributeValue(l[0].attributes[t.name],r)})}_updateFeatureWithMagDirValues(e,t){if(!this.pixelFilter||\"esriImageServiceDataTypeVector-UV\"!==this.serviceDataType&&\"esriImageServiceDataTypeVector-MagDir\"!==this.serviceDataType)return;const r=t.replace(\" \",\",\").split(\",\").map(e=>parseFloat(e)),i=r.map(e=>[e]),a=r.map(e=>({minValue:e,maxValue:e,noDataValue:null})),n=new V.a({height:1,width:1,pixelType:\"f32\",pixels:i,statistics:a});this.pixelFilter({pixelBlock:n,extent:new P.a(0,0,0,0,this.spatialReference)}),e.attributes[\"Raster.Magnitude\"]=n.pixels[0][0],e.attributes[\"Raster.Direction\"]=n.pixels[1][0]}_updateFeatureWithDomainValues(e){const t=this.fields&&this.fields.filter(e=>e.domain&&\"coded-value\"===e.domain.type);null!=t&&t.forEach(t=>{const r=e.attributes[t.name];if(null!=r){const i=t.domain.codedValues.filter(e=>e.code===r)[0];i&&(e.attributes[t.name]=i.name)}})}_updateResponseFieldNames(e,t){if(!t||t.length<1)return;const r=this.fieldsIndex;r&&e.forEach(e=>{if(e&&e.attributes)for(const i of t)if(r.has(i)){const t=r.get(i).name;t!==i&&(e.attributes[i]=e.attributes[t],delete e.attributes[t])}})}_updateRenderingRulesFunctionName(e,t){if(!e||e.length<1)return;if(\"Raw\"===e)return e.replace(\"Raw\",\"None\");const r=e.toLowerCase().replace(/ /gi,\"_\");return t.has(r)?t.get(r):e}_isRFTJson(e){return e.name&&e.arguments&&e.function&&e.hasOwnProperty(\"functionType\")}_readCapabilities(e){const t=e.capabilities?e.capabilities.toLowerCase().split(\",\").map(e=>e.trim()):[\"image\",\"catalog\"],{currentVersion:r,advancedQueryCapabilities:i,maxRecordCount:a}=e,n=t.indexOf(\"image\")>-1,s=\"esriImageServiceDataTypeElevation\"===e.serviceDataType,o=!!(e.spatialReference||e.extent&&e.extent.spatialReference);return{operations:{supportsComputeHistograms:n,supportsExportImage:n,supportsIdentify:n,supportsMeasure:t.indexOf(\"mensuration\")>-1&&o,supportsDownload:t.indexOf(\"download\")>-1,supportsQuery:t.indexOf(\"catalog\")>-1&&e.fields&&e.fields.length>0,supportsGetSamples:r>=10.2&&n,supportsProject:r>=10.3&&n,supportsComputeStatisticsHistograms:r>=10.4&&n,supportsQueryBoundary:r>=10.6&&n,supportsCalculateVolume:r>=10.7&&s,supportsComputePixelLocation:r>=10.7&&t.indexOf(\"catalog\")>-1},query:{supportsStatistics:!(!i||!i.supportsStatistics),supportsOrderBy:!(!i||!i.supportsOrderBy),supportsDistinct:!(!i||!i.supportsDistinct),supportsPagination:!(!i||!i.supportsPagination),supportsStandardizedQueriesOnly:!(!i||!i.useStandardizedQueries),maxRecordCount:a}}}};return Object(a.a)([Object(l.b)()],t.prototype,\"_functionRasterInfos\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"_rasterJobHandler\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"_symbolizer\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"_defaultServiceMosaicRule\",void 0),Object(a.a)([Object(_.a)(\"_defaultServiceMosaicRule\",[\"defaultMosaicMethod\"])],t.prototype,\"readDefaultServiceMosaicRule\",null),Object(a.a)([Object(l.b)()],t.prototype,\"_cachedRendererJson\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"rasterAttributeTableFieldPrefix\",void 0),Object(a.a)([Object(l.b)({readOnly:!0,dependsOn:[\"rasterFunctionInfos\"]})],t.prototype,\"rasterFunctionNamesIndex\",null),Object(a.a)([Object(l.b)({readOnly:!0,dependsOn:[\"url\"]})],t.prototype,\"queryTask\",null),Object(a.a)([Object(l.b)()],t.prototype,\"adjustAspectRatio\",void 0),Object(a.a)([Object(l.b)({readOnly:!0}),Object(I.a)(\"serviceRasterInfo.bandCount\")],t.prototype,\"bandCount\",void 0),Object(a.a)([Object(l.b)({type:[o.a],json:{write:!0}})],t.prototype,\"bandIds\",void 0),Object(a.a)([Object(_.a)(\"bandIds\")],t.prototype,\"readBandIds\",null),Object(a.a)([Object(l.b)({readOnly:!0,json:{read:!1}})],t.prototype,\"capabilities\",void 0),Object(a.a)([Object(_.a)(\"service\",\"capabilities\",[\"capabilities\",\"currentVersion\",\"serviceDataType\"])],t.prototype,\"readCapabilities\",null),Object(a.a)([Object(l.b)({type:Number})],t.prototype,\"compressionQuality\",void 0),Object(a.a)([Object(u.a)(\"compressionQuality\")],t.prototype,\"writeCompressionQuality\",null),Object(a.a)([Object(l.b)({type:Number})],t.prototype,\"compressionTolerance\",void 0),Object(a.a)([Object(u.a)(\"compressionTolerance\")],t.prototype,\"writeCompressionTolerance\",null),Object(a.a)([Object(l.b)({json:{read:{source:\"copyrightText\"}}})],t.prototype,\"copyright\",void 0),Object(a.a)([Object(l.b)({type:String,json:{read:{source:\"layerDefinition.definitionExpression\"},write:{target:\"layerDefinition.definitionExpression\"}}})],t.prototype,\"definitionExpression\",void 0),Object(a.a)([Object(l.b)({readOnly:!0,constructOnly:!0})],t.prototype,\"exportImageServiceParameters\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"rasterInfo\",void 0),Object(a.a)([Object(l.b)({readOnly:!0,type:[z.a]})],t.prototype,\"fields\",void 0),Object(a.a)([Object(l.b)({readOnly:!0,dependsOn:[\"fields\"]})],t.prototype,\"fieldsIndex\",null),Object(a.a)([Object(l.b)({type:[\"png\",\"png8\",\"png24\",\"png32\",\"jpg\",\"bmp\",\"gif\",\"jpgpng\",\"lerc\",\"tiff\"],json:{write:!0}})],t.prototype,\"format\",null),Object(a.a)([Object(_.a)(\"service\",\"format\",[\"serviceDataType\"])],t.prototype,\"readFormat\",null),Object(a.a)([Object(l.b)({type:P.a})],t.prototype,\"fullExtent\",void 0),Object(a.a)([Object(l.b)({readOnly:!0})],t.prototype,\"hasMultidimensions\",void 0),Object(a.a)([Object(l.b)({json:{read:{source:\"maxImageHeight\"}}})],t.prototype,\"imageMaxHeight\",void 0),Object(a.a)([Object(l.b)({json:{read:{source:\"maxImageWidth\"}}})],t.prototype,\"imageMaxWidth\",void 0),Object(a.a)([Object(l.b)({type:String,json:{type:Ee.jsonValues,read:Ee.read,write:Ee.write}})],t.prototype,\"interpolation\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"minScale\",void 0),Object(a.a)([Object(_.a)(\"service\",\"minScale\")],t.prototype,\"readMinScale\",null),Object(a.a)([Object(l.b)()],t.prototype,\"maxScale\",void 0),Object(a.a)([Object(_.a)(\"service\",\"maxScale\")],t.prototype,\"readMaxScale\",null),Object(a.a)([Object(l.b)({type:ye})],t.prototype,\"mosaicRule\",null),Object(a.a)([Object(_.a)(\"mosaicRule\",[\"mosaicRule\",\"defaultMosaicMethod\"])],t.prototype,\"readMosaicRule\",null),Object(a.a)([Object(u.a)(\"mosaicRule\")],t.prototype,\"writeMosaicRule\",null),Object(a.a)([Object(l.b)({readOnly:!0}),Object(I.a)(\"serviceRasterInfo.multidimensionalInfo\")],t.prototype,\"multidimensionalInfo\",void 0),Object(a.a)([Object(l.b)({json:{type:o.a}})],t.prototype,\"noData\",void 0),Object(a.a)([Object(u.a)(\"noData\")],t.prototype,\"writeNoData\",null),Object(a.a)([Object(l.b)({type:String,json:{type:ke.jsonValues,read:ke.read,write:ke.write}})],t.prototype,\"noDataInterpretation\",void 0),Object(a.a)([Object(l.b)({type:String,readOnly:!0,json:{read:{source:[\"fields\"]}}})],t.prototype,\"objectIdField\",void 0),Object(a.a)([Object(_.a)(\"objectIdField\")],t.prototype,\"readObjectIdField\",null),Object(a.a)([Object(l.b)({readOnly:!0,dependsOn:[\"url\"]})],t.prototype,\"parsedUrl\",null),Object(a.a)([Object(l.b)({readOnly:!0}),Object(I.a)(\"serviceRasterInfo.pixelSize.x\")],t.prototype,\"pixelSizeX\",void 0),Object(a.a)([Object(l.b)({readOnly:!0}),Object(I.a)(\"serviceRasterInfo.pixelSize.y\")],t.prototype,\"pixelSizeY\",void 0),Object(a.a)([Object(l.b)({type:Function})],t.prototype,\"pixelFilter\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"raster\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"viewId\",void 0),Object(a.a)([Object(l.b)({types:J.a,json:{name:\"layerDefinition.drawingInfo.renderer\",origins:{\"web-scene\":{types:J.c,name:\"layerDefinition.drawingInfo.renderer\",write:{overridePolicy:e=>({enabled:e&&\"vector-field\"!==e.type})}}}}})],t.prototype,\"renderer\",void 0),Object(a.a)([Object(_.a)(\"renderer\")],t.prototype,\"readRenderer\",null),Object(a.a)([Object(l.b)(f.f)],t.prototype,\"opacity\",void 0),Object(a.a)([Object(l.b)({readOnly:!0}),Object(I.a)(\"serviceRasterInfo.attributeTable\")],t.prototype,\"rasterAttributeTable\",void 0),Object(a.a)([Object(l.b)({readOnly:!0,dependsOn:[\"fields\",\"rasterInfo\",\"capabilities\"]})],t.prototype,\"rasterFields\",null),Object(a.a)([Object(l.b)({readOnly:!0})],t.prototype,\"rasterFunctionInfos\",void 0),Object(a.a)([Object(l.b)({type:$})],t.prototype,\"renderingRule\",null),Object(a.a)([Object(_.a)(\"renderingRule\",[\"renderingRule\",\"rasterFunctionInfos\"])],t.prototype,\"readRenderingRule\",null),Object(a.a)([Object(u.a)(\"renderingRule\")],t.prototype,\"writeRenderingRule\",null),Object(a.a)([Object(l.b)()],t.prototype,\"serviceDataType\",void 0),Object(a.a)([Object(l.b)({readOnly:!0,type:F.a})],t.prototype,\"spatialReference\",void 0),Object(a.a)([Object(_.a)(\"spatialReference\",[\"spatialReference\",\"extent\"])],t.prototype,\"readSpatialReference\",null),Object(a.a)([Object(l.b)({json:{type:qe.jsonValues}})],t.prototype,\"pixelType\",void 0),Object(a.a)([Object(_.a)(\"pixelType\")],t.prototype,\"readPixelType\",null),Object(a.a)([Object(u.a)(\"pixelType\")],t.prototype,\"writePixelType\",null),Object(a.a)([Object(l.b)({constructOnly:!0,type:ve.a})],t.prototype,\"serviceRasterInfo\",void 0),Object(a.a)([Object(l.b)()],t.prototype,\"sourceJSON\",void 0),Object(a.a)([Object(l.b)(f.j)],t.prototype,\"url\",void 0),Object(a.a)([Object(l.b)({readOnly:!0})],t.prototype,\"version\",void 0),Object(a.a)([Object(_.a)(\"version\",[\"currentVersion\",\"fields\",\"timeInfo\"])],t.prototype,\"readVersion\",null),t=Object(a.a)([Object(c.a)(\"esri.layers.mixins.ArcGISImageService\")],t),t};let Be=class extends(Object(g.a)(Object(w.a)(Object(v.a)(Object(R.a)(Object(y.a)(Object(j.a)(Qe(Object(O.a)(Object(h.a)(b.a)))))))))){constructor(...e){super(...e),this.legendEnabled=!0,this.isReference=null,this.operationalLayerType=\"ArcGISImageServiceLayer\",this.popupEnabled=!0,this.popupTemplate=null,this.type=\"imagery\"}normalizeCtorArgs(e,t){return\"string\"==typeof e?{url:e,...t}:e}load(e){const t=Object(n.h)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Image Service\"]},e).then(()=>this._fetchService(t),()=>this._fetchService(t))),Object(d.u)(this)}writeOperationalLayerType(e,t,r){var i;const a=\"vector-field\"===(null==(i=this.renderer)?void 0:i.type);t[r]=a?\"ArcGISImageServiceVectorLayer\":\"ArcGISImageServiceLayer\"}get defaultPopupTemplate(){return this.createPopupTemplate()}createPopupTemplate(e){const t=this.rasterFields,r=this.title,i=new Set;let a=!1,n=!1;this.capabilities&&(a=this.capabilities.operations.supportsQuery&&this.fields&&this.fields.length>0,n=a&&(\"esriImageServiceDataTypeVector-UV\"===this.serviceDataType||\"esriImageServiceDataTypeVector-MagDir\"===this.serviceDataType));const s=new Set;a&&(s.add(\"raster.itempixelvalue\"),n&&s.add(\"raster.magnitude\").add(\"raster.direction\"));for(const o of t){const e=o.name.toLowerCase();s.has(e)||e.indexOf(\"raster.servicepixelvalue.\")>-1||i.add(o.name)}return Object(x.a)({fields:t,title:r},{...e,visibleFieldNames:i})}redraw(){this.emit(\"redraw\")}};Object(a.a)([Object(l.b)(f.d)],Be.prototype,\"legendEnabled\",void 0),Object(a.a)([Object(l.b)({type:[\"show\",\"hide\"]})],Be.prototype,\"listMode\",void 0),Object(a.a)([Object(l.b)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Be.prototype,\"isReference\",void 0),Object(a.a)([Object(l.b)({type:[\"ArcGISImageServiceLayer\"],json:{origins:{\"web-map\":{type:[\"ArcGISImageServiceLayer\",\"ArcGISImageServiceVectorLayer\"],read:!1,write:{target:\"layerType\",ignoreOrigin:!0}}}}})],Be.prototype,\"operationalLayerType\",void 0),Object(a.a)([Object(u.a)(\"web-map\",\"operationalLayerType\")],Be.prototype,\"writeOperationalLayerType\",null),Object(a.a)([Object(l.b)(f.g)],Be.prototype,\"popupEnabled\",void 0),Object(a.a)([Object(l.b)({type:m.a,json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\"}}})],Be.prototype,\"popupTemplate\",void 0),Object(a.a)([Object(l.b)({readOnly:!0,dependsOn:[\"fields\",\"title\"]})],Be.prototype,\"defaultPopupTemplate\",null),Object(a.a)([Object(l.b)({readOnly:!0,json:{read:!1}})],Be.prototype,\"type\",void 0),Be=Object(a.a)([Object(c.a)(\"esri.layers.ImageryLayer\")],Be),t.default=Be},u3Ia:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return a}),r.d(t,\"b\",function(){return s}),r.d(t,\"c\",function(){return n});var i=r(\"4EHJ\");function a(e,t){let r={query:e};return t&&(r={...t,...r}),r}function n(e){return\"string\"==typeof e?Object(i.I)(e):e}function s(e,t,r){const i={};for(const a in e){if(\"declaredClass\"===a)continue;const n=e[a];if(null!=n&&\"function\"!=typeof n)if(Array.isArray(n)){i[a]=[];for(let e=0;e<n.length;e++)i[a][e]=s(n[e])}else if(\"object\"==typeof n)if(n.toJSON){const e=n.toJSON(r&&r[a]);i[a]=t?e:JSON.stringify(e)}else i[a]=t?n:JSON.stringify(n);else i[a]=n}return i}}}]);","name":"113.7cd66cd6b3710e2f5fb1.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[113],{\n\n/***/ \"/GVf\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"pO5D\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js\nvar has = __webpack_require__(\"wSAH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/maybe.js\nvar maybe = __webpack_require__(\"srIe\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Logger.js\nvar Logger = __webpack_require__(\"6S2I\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/ensureType.js\nvar ensureType = __webpack_require__(\"zqDF\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js\nvar property = __webpack_require__(\"WbKI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js + 1 modules\nvar subclass = __webpack_require__(\"04ZG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/writer.js\nvar writer = __webpack_require__(\"Cduq\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/urlUtils.js\nvar urlUtils = __webpack_require__(\"4EHJ\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/uuid.js\nvar uuid = __webpack_require__(\"ju1D\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/portal/support/resourceExtension.js\nvar resourceExtension = __webpack_require__(\"9AIY\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/promiseUtils.js\nvar promiseUtils = __webpack_require__(\"9MzC\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/PopupTemplate.js + 3 modules\nvar PopupTemplate = __webpack_require__(\"SFah\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/Layer.js\nvar Layer = __webpack_require__(\"pqNC\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/MultiOriginJSONSupport.js + 2 modules\nvar MultiOriginJSONSupport = __webpack_require__(\"5pQd\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/commonProperties.js\nvar commonProperties = __webpack_require__(\"IvSi\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/OperationalLayer.js + 1 modules\nvar OperationalLayer = __webpack_require__(\"uRH/\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/ArcGISService.js\nvar ArcGISService = __webpack_require__(\"PVlI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/BlendLayer.js\nvar BlendLayer = __webpack_require__(\"mXvl\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/PortalLayer.js\nvar PortalLayer = __webpack_require__(\"DbUH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/RefreshableLayer.js\nvar RefreshableLayer = __webpack_require__(\"jhcG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/ScaleRangeLayer.js\nvar ScaleRangeLayer = __webpack_require__(\"WmKv\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/mixins/TemporalLayer.js\nvar TemporalLayer = __webpack_require__(\"YBpl\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/support/popupUtils.js\nvar popupUtils = __webpack_require__(\"9Ruv\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/lang.js\nvar lang = __webpack_require__(\"f/qv\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/aliasOf.js\nvar aliasOf = __webpack_require__(\"Stxv\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/jsonMap.js\nvar jsonMap = __webpack_require__(\"+opI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/reader.js\nvar reader = __webpack_require__(\"r88o\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Error.js\nvar Error = __webpack_require__(\"zlDU\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/SpatialReference.js\nvar SpatialReference = __webpack_require__(\"WZb1\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Point.js + 2 modules\nvar Point = __webpack_require__(\"SuVq\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Extent.js\nvar Extent = __webpack_require__(\"OvF4\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Polygon.js\nvar Polygon = __webpack_require__(\"Ehki\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry.js\nvar geometry = __webpack_require__(\"4GrV\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/request.js\nvar request = __webpack_require__(\"Lqtk\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/Graphic.js\nvar Graphic = __webpack_require__(\"jWBI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/PixelBlock.js\nvar PixelBlock = __webpack_require__(\"Piei\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/rasterRenderers.js\nvar rasterRenderers = __webpack_require__(\"ukD5\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/Field.js\nvar Field = __webpack_require__(\"ofM5\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/FieldsIndex.js\nvar FieldsIndex = __webpack_require__(\"gLc9\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/tasks/support/FeatureSet.js\nvar FeatureSet = __webpack_require__(\"8prj\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/tasks/support/Query.js\nvar Query = __webpack_require__(\"xk++\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/tasks/QueryTask.js + 2 modules\nvar QueryTask = __webpack_require__(\"/uz8\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/DimensionalDefinition.js\nvar DimensionalDefinition = __webpack_require__(\"tidM\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js\nvar enumeration = __webpack_require__(\"RI0u\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/JSONSupport.js\nvar JSONSupport = __webpack_require__(\"ag7Y\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/RasterFunction.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nvar RasterFunction_c;const RasterFunction_a=new Set([\"Raster\",\"Raster2\",\"DEM\",\"FillRaster\"]),RasterFunction_p=new Set([\"Rasters\"]),RasterFunction_m=t=>t&&t.rasterFunction?RasterFunction_y.fromJSON(t):t,RasterFunction_l=t=>t&&t instanceof RasterFunction_y?t.toJSON():t;var RasterFunction_f;!function(t){t[t.MOSAIC=0]=\"MOSAIC\",t[t.GROUP=1]=\"GROUP\",t[t.ITEM=2]=\"ITEM\"}(RasterFunction_f||(RasterFunction_f={}));let RasterFunction_y=RasterFunction_c=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(t){super(t),this.functionArguments=null,this.functionName=null,this.outputPixelType=\"unknown\",this.variableName=null,this.description=null,this.functionDefinition=null,this.thumbnail=null}readFunctionArguments(t,n){return(t=>{if(null==t)return null;const n={};for(const e of Object.keys(t))RasterFunction_a.has(e)?n[e]=RasterFunction_m(t[e]):RasterFunction_p.has(e)&&Array.isArray(t[e])?n[e]=t[e].map(RasterFunction_m):n[e]=t[e];return n})(n.arguments||n.rasterFunctionArguments)}writeFunctionArguments(t,n,e){const r={};for(const n of Object.keys(t))RasterFunction_a.has(n)?r[n]=RasterFunction_l(t[n]):RasterFunction_p.has(n)&&Array.isArray(t[n])?r[n]=t[n].map(RasterFunction_l):r[n]=RasterFunction_l(t[n]);this.functionDefinition?n.arguments=r:n[e]=r}readFunctionName(t,n){const e=n.rasterFunctionInfos,r=n.name;return r||(e&&e.length&&\"None\"!==e[0].name?e[0].name:n.rasterFunction)}writeFunctionName(t,n,e){this.functionDefinition?n.name=t:n[e]=t}readFunctionType(t){return RasterFunction_f[t]}writeFunctionType(t,n,e){n[e]=RasterFunction_f[t]}clone(){return new RasterFunction_c({functionName:this.functionName,functionArguments:Object(lang[\"a\" /* clone */])(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,description:this.description,functionType:this.functionType,functionDefinition:this.functionDefinition,thumbnail:this.thumbnail})}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{type:Object,write:{target:\"rasterFunctionArguments\"}}})],RasterFunction_y.prototype,\"functionArguments\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"functionArguments\",[\"rasterFunctionArguments\",\"arguments\"])],RasterFunction_y.prototype,\"readFunctionArguments\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"functionArguments\")],RasterFunction_y.prototype,\"writeFunctionArguments\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{type:String,write:{target:\"rasterFunction\"}}})],RasterFunction_y.prototype,\"functionName\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"functionName\",[\"rasterFunction\",\"rasterFunctionInfos\",\"name\"])],RasterFunction_y.prototype,\"readFunctionName\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"functionName\")],RasterFunction_y.prototype,\"writeFunctionName\",null),Object(tslib_es6[\"a\" /* _ */])([Object(enumeration[\"a\" /* enumeration */])({C128:\"c128\",C64:\"c64\",F32:\"f32\",F64:\"f64\",S16:\"s16\",S32:\"s32\",S8:\"s8\",U1:\"u1\",U16:\"u16\",U2:\"u2\",U32:\"u32\",U4:\"u4\",U8:\"u8\",UNKNOWN:\"unknown\"},{ignoreUnknown:!1}),Object(property[\"b\" /* property */])({json:{default:\"unknown\"}})],RasterFunction_y.prototype,\"outputPixelType\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{read:!0,write:!0}})],RasterFunction_y.prototype,\"variableName\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{read:!0,write:!0,origins:{\"web-document\":{read:!1,write:!1}}}})],RasterFunction_y.prototype,\"description\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{origins:{\"web-document\":{read:!1,write:!1}}}})],RasterFunction_y.prototype,\"functionType\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"functionType\")],RasterFunction_y.prototype,\"readFunctionType\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"functionType\")],RasterFunction_y.prototype,\"writeFunctionType\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Object,json:{read:{source:\"function\"},write:{target:\"function\"},origins:{\"web-document\":{read:!1,write:!1}}}})],RasterFunction_y.prototype,\"functionDefinition\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{read:!0,write:!0,origins:{\"web-document\":{read:!1,write:!1}}}})],RasterFunction_y.prototype,\"thumbnail\",void 0),RasterFunction_y=RasterFunction_c=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layers.support.RasterFunction\")],RasterFunction_y);var RasterFunction_d=RasterFunction_y;/* harmony default export */ var RasterFunction = (RasterFunction_d);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/renderers/visualVariables/SizeVariable.js + 1 modules\nvar SizeVariable = __webpack_require__(\"w/y1\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/renderers/support/colorRampUtils.js\nvar colorRampUtils = __webpack_require__(\"fG4V\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/renderers/support/stretchRendererUtils.js\nvar stretchRendererUtils = __webpack_require__(\"ZVeJ\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/imageryRendererUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst imageryRendererUtils_i={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34e38,34e38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},imageryRendererUtils_u={simple_scalar:\"Simple Scalar\",wind_barb:\"Wind Barb\",single_arrow:\"Single Arrow\",beaufort_kn:\"Beaufort Wind (Knots)\",beaufort_m:\"Beaufort Wind (MetersPerSecond)\",ocean_current_m:\"Ocean Current (MetersPerSecond)\",ocean_current_kn:\"Ocean Current (Knots)\"},imageryRendererUtils_s=new Set([\"raster-stretch\",\"unique-value\",\"class-breaks\",\"raster-shaded-relief\",\"vector-field\",\"raster-colormap\"]);function imageryRendererUtils_l(e){return imageryRendererUtils_s.has(e.type)}function imageryRendererUtils_m(t,n){if(!t||!n)return Object(lang[\"a\" /* clone */])(t||n);const r=Object(lang[\"a\" /* clone */])(t);if(\"none\"!==n.functionName.toLowerCase()){imageryRendererUtils_p(r.functionArguments).Raster=n}return r}function imageryRendererUtils_c(e,i){switch(i=i||{},e.type){case\"raster-stretch\":return function(e,t){const i=new RasterFunction;i.functionName=\"Stretch\";const u=imageryRendererUtils_f[stretchRendererUtils[\"b\" /* stretchTypeJSONDict */].toJSON(e.stretchType)],s=\"u8\",l=function(e){const t=[];return e.forEach((e=>{const n=e;if(Array.isArray(n))t.push(n);else{if(null==n.min||null==n.max)return;const e=[n.min,n.max,n.avg||0,n.stddev||0];t.push(e)}})),t}(e.statistics),m={StretchType:u,Statistics:l,DRA:e.dynamicRangeAdjustment,UseGamma:e.useGamma,Gamma:e.gamma,ComputeGamma:e.computeGamma};null!=e.outputMin&&(m.Min=e.outputMin);null!=e.outputMax&&(m.Max=e.outputMax);u===imageryRendererUtils_f.standardDeviation?(m.NumberOfStandardDeviations=e.numberOfStandardDeviations,i.outputPixelType=s):u===imageryRendererUtils_f.percentClip?(m.MinPercent=e.minPercent,m.MaxPercent=e.maxPercent,i.outputPixelType=s):u===imageryRendererUtils_f.minMax?i.outputPixelType=s:u===imageryRendererUtils_f.sigmoid&&(m.SigmoidStrengthLevel=e.sigmoidStrengthLevel);if(i.functionArguments=m,i.variableName=\"Raster\",e.colorRamp){const a=e.colorRamp,u=new RasterFunction,s=Object(colorRampUtils[\"c\" /* getColorRampName */])(a);return s?u.functionArguments={colorRamp:s}:!t.convertColorRampToColormap||\"algorithmic\"!==a.type&&\"multipart\"!==a.type?u.functionArguments={colorRamp:e.colorRamp.toJSON()}:u.functionArguments={Colormap:Object(colorRampUtils[\"b\" /* convertColorRampToColormap */])(a,256)},u.variableName=\"Raster\",u.functionName=\"Colormap\",u.functionArguments.Raster=i,u}return i}(e,i);case\"class-breaks\":return function(e,t){const n=[],r=[],a=[],i=[],u=1e-6,{pixelType:s,rasterAttributeTable:l}=t,m=l&&l.features,c=imageryRendererUtils_g(l);if(m&&Array.isArray(m)&&e.classBreakInfos){e.classBreakInfos.forEach(((t,n)=>{const r=t.symbol.color;let a;r.a&&m.forEach((o=>{a=o.attributes[e.field],(a>=t.minValue&&a<t.maxValue||n===e.classBreakInfos.length-1&&a>=t.minValue)&&i.push([o.attributes[c],r.r,r.g,r.b])}))}));const t=s?imageryRendererUtils_d(i,s):i,n=new RasterFunction;return n.functionName=\"Colormap\",n.functionArguments={},n.functionArguments.Colormap=t,n.variableName=\"Raster\",n}e.classBreakInfos.forEach(((e,t)=>{const o=e.symbol&&e.symbol.color;o.a?(0===t?n.push(e.minValue,e.maxValue+u):n.push(e.minValue+u,e.maxValue+u),r.push(t),i.push([t,o.r,o.g,o.b])):a.push(e.minValue,e.maxValue)}));const p=s?imageryRendererUtils_d(i,s):i,f=new RasterFunction;f.functionName=\"Remap\",f.functionArguments={InputRanges:n,OutputValues:r,NoDataRanges:a},f.variableName=\"Raster\";const h=new RasterFunction;return h.functionName=\"Colormap\",h.functionArguments={Colormap:p,Raster:f},h}(e,i);case\"unique-value\":return function(e,t){const n=[],{pixelType:r,rasterAttributeTable:a}=t,i=a&&a.features,u=imageryRendererUtils_g(a);let s=!1;e.uniqueValueInfos&&e.uniqueValueInfos.forEach((t=>{const r=t.symbol.color;r.a&&(e.field!==u&&i?i&&i.forEach((a=>{String(a.attributes[e.field])===String(t.value)&&n.push([a.attributes[u],r.r,r.g,r.b])})):isNaN(+t.value)?s=!0:n.push([+t.value,r.r,r.g,r.b]))}));if(s)return null;const l=r&&n.length>0?imageryRendererUtils_d(n,r):n,m=new RasterFunction;return m.functionName=\"Colormap\",m.functionArguments={},m.functionArguments.Colormap=l,m.variableName=\"Raster\",m}(e,i);case\"raster-colormap\":return function(e,t){const n=e.extractColormap();if(!n||0===n.length)return;const{pixelType:r}=t,a=r?imageryRendererUtils_d(n,r):n,i=new RasterFunction;return i.functionName=\"Colormap\",i.functionArguments={},i.functionArguments.Colormap=a,i}(e,i);case\"vector-field\":return function(e,n){const r=new RasterFunction;r.functionName=\"VectorFieldRenderer\";const{dataType:a,bandProperties:i}=n,s=\"vector-uv\"===a;let l,m;i&&2===i.length&&(l=i.map((e=>e.BandName.toLowerCase())).indexOf(\"magnitude\"),m=i.map((e=>e.BandName.toLowerCase())).indexOf(\"direction\"));-1!==l&&null!==l||(l=0,m=1);const c=\"arithmetic\"===e.rotationType?1:2,p=\"flow-from\"===e.flowRepresentation?0:1,f=e.visualVariables?e.visualVariables.filter((e=>\"Magnitude\"===e.field))[0]:new SizeVariable[\"a\" /* default */],d={magnitudeBandID:l,directionBandID:m,isUVComponents:s,referenceSystem:c,massFlowAngleRepresentation:p,symbolTileSize:50,symbolTileSizeUnits:100,calculationMethod:\"Vector Average\",symbologyName:imageryRendererUtils_u[e.style.toLowerCase().replace(\"-\",\"_\")],minimumMagnitude:f.minDataValue,maximumMagnitude:f.maxDataValue,minimumSymbolSize:f.minSize,maximumSymbolSize:f.maxSize};return r.functionArguments=d,r}(e,i);case\"raster-shaded-relief\":return function(e,t){if(\"elevation\"!==t.dataType)return new RasterFunction;const r=new RasterFunction;r.functionName=\"Hillshade\";const a=\"traditional\"===e.hillshadeType?0:1,i=\"none\"===e.scalingType?1:3,u={HillshadeType:a,SlopeType:i,ZFactor:e.zFactor};0===a&&(u.Azimuth=e.azimuth,u.Altitude=e.altitude);3===i&&(u.PSPower=e.pixelSizePower,u.PSZFactor=e.pixelSizeFactor);r.functionArguments=u,r.variableName=\"Raster\",e.colorRamp&&(r.functionName=\"ShadedRelief\",u.Colormap=Object(colorRampUtils[\"b\" /* convertColorRampToColormap */])(e.colorRamp,256));return r}(e,i)}}function imageryRendererUtils_p(e){const t=e.Raster;return t&&\"esri.layers.support.RasterFunction\"===t.declaredClass?imageryRendererUtils_p(t.functionArguments):e}const imageryRendererUtils_f={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};function imageryRendererUtils_d(e,t){const n=imageryRendererUtils_i[String(t).toLowerCase()];return n&&e.push([Math.floor(n[0]-1),0,0,0],[Math.ceil(n[1]+1),0,0,0]),e}function imageryRendererUtils_g(e){if(!e)return;const{fields:t}=e,n=t&&t.find((e=>e&&e.name&&\"value\"===e.name.toLowerCase()));return n&&n.name}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/cast.js\nvar cast = __webpack_require__(\"Gj5k\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/MosaicRule.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nvar MosaicRule_u;const MosaicRule_m=Object(jsonMap[\"b\" /* strict */])()({MT_FIRST:\"first\",MT_LAST:\"last\",MT_MIN:\"min\",MT_MAX:\"max\",MT_MEAN:\"mean\",MT_BLEND:\"blend\",MT_SUM:\"sum\"}),MosaicRule_h=Object(jsonMap[\"b\" /* strict */])()({esriMosaicNone:\"none\",esriMosaicCenter:\"center\",esriMosaicNadir:\"nadir\",esriMosaicViewpoint:\"viewpoint\",esriMosaicAttribute:\"attribute\",esriMosaicLockRaster:\"lock-raster\",esriMosaicNorthwest:\"northwest\",esriMosaicSeamline:\"seamline\"});let M=MosaicRule_u=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(e){super(e),this.ascending=!0,this.itemRenderingRule=null,this.lockRasterIds=null,this.method=null,this.multidimensionalDefinition=null,this.objectIds=null,this.operation=null,this.sortField=null,this.sortValue=null,this.viewpoint=null,this.where=null}readAscending(e,t){return null!=t.ascending?t.ascending:null==t.sortAscending||t.sortAscending}readMethod(e,t){return function(e){let t;switch(e?e.toLowerCase().replace(\"esrimosaic\",\"\"):\"\"){case\"byattribute\":case\"attribute\":t=\"esriMosaicAttribute\";break;case\"lockraster\":t=\"esriMosaicLockRaster\";break;case\"center\":t=\"esriMosaicCenter\";break;case\"northwest\":t=\"esriMosaicNorthwest\";break;case\"nadir\":t=\"esriMosaicNadir\";break;case\"viewpoint\":t=\"esriMosaicViewpoint\";break;case\"seamline\":t=\"esriMosaicSeamline\";break;case\"none\":default:t=\"esriMosaicNone\"}return MosaicRule_h.fromJSON(t)}(t.mosaicMethod||t.defaultMosaicMethod)}readOperation(e,t){const o=t.mosaicOperation,r=t.mosaicOperator&&t.mosaicOperator.toLowerCase(),i=o||(r?MosaicRule_m.toJSON(r):null);return MosaicRule_m.fromJSON(i)||\"first\"}castSortValue(e){return null==e||\"string\"==typeof e||\"number\"==typeof e?e:`${e}`}clone(){return new MosaicRule_u({ascending:this.ascending,itemRenderingRule:Object(lang[\"a\" /* clone */])(this.itemRenderingRule),lockRasterIds:Object(lang[\"a\" /* clone */])(this.lockRasterIds),method:this.method,multidimensionalDefinition:Object(lang[\"a\" /* clone */])(this.multidimensionalDefinition),objectIds:Object(lang[\"a\" /* clone */])(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:Object(lang[\"a\" /* clone */])(this.viewpoint),where:this.where})}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Boolean,json:{write:!0}})],M.prototype,\"ascending\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"ascending\",[\"ascending\",\"sortAscending\"])],M.prototype,\"readAscending\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:RasterFunction,json:{write:!0}})],M.prototype,\"itemRenderingRule\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[ensureType[\"a\" /* Integer */]],json:{write:{overridePolicy(){return{enabled:\"lock-raster\"===this.method}}}}})],M.prototype,\"lockRasterIds\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{type:MosaicRule_h.jsonValues,write:{target:\"mosaicMethod\",writer:MosaicRule_h.write}}})],M.prototype,\"method\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"method\",[\"mosaicMethod\",\"defaultMosaicMethod\"])],M.prototype,\"readMethod\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[DimensionalDefinition[\"a\" /* default */]],json:{write:!0}})],M.prototype,\"multidimensionalDefinition\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[ensureType[\"a\" /* Integer */]],json:{name:\"fids\",write:!0}})],M.prototype,\"objectIds\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{type:MosaicRule_m.jsonValues,read:{reader:MosaicRule_m.read},write:{target:\"mosaicOperation\",writer:MosaicRule_m.write}}})],M.prototype,\"operation\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"operation\",[\"mosaicOperation\",\"mosaicOperator\"])],M.prototype,\"readOperation\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{write:{overridePolicy(){return{enabled:\"attribute\"===this.method}}}}})],M.prototype,\"sortField\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[String,Number],json:{write:{allowNull:!0,overridePolicy(){return{enabled:\"attribute\"===this.method,allowNull:!0}}}}})],M.prototype,\"sortValue\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(cast[\"a\" /* cast */])(\"sortValue\")],M.prototype,\"castSortValue\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Point[\"a\" /* default */],json:{write:!0}})],M.prototype,\"viewpoint\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{write:!0}})],M.prototype,\"where\",void 0),M=MosaicRule_u=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layers.support.MosaicRule\")],M);var MosaicRule_w=M;/* harmony default export */ var MosaicRule = (MosaicRule_w);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/support/ExportImageServiceParameters.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst ExportImageServiceParameters_d=new jsonMap[\"a\" /* JSONMap */]({RSP_NearestNeighbor:\"nearest\",RSP_BilinearInterpolation:\"bilinear\",RSP_CubicConvolution:\"cubic\",RSP_Majority:\"majority\"}),ExportImageServiceParameters_u=new jsonMap[\"a\" /* JSONMap */]({esriNoDataMatchAny:\"any\",esriNoDataMatchAll:\"all\"});let ExportImageServiceParameters_m=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(){super(...arguments),this.layer=null,this.adjustAspectRatio=void 0,this.bandIds=void 0,this.compression=void 0,this.compressionQuality=void 0,this.compressionTolerance=.01,this.format=null,this.interpolation=null,this.noData=null,this.noDataInterpretation=void 0,this.pixelType=void 0,this.lercVersion=2}writeAdjustAspectRatio(e,r,o){this.layer.version<10.3||(r[o]=e)}writeCompressionQuality(e,r,o){this.format&&this.format.toLowerCase().indexOf(\"jpg\")>-1&&null!=e&&(r[o]=e)}writeCompressionTolerance(e,r,o){\"lerc\"===this.format&&null!=e&&(r[o]=e)}writeLercVersion(e,r,o){\"lerc\"===this.format&&this.layer.version>=10.5&&(r[o]=e)}get version(){const e=this.layer;return e.bandIds,e.format,e.compressionQuality,e.compressionTolerance,e.interpolation,e.noData,e.noDataInterpretation,e.mosaicRule,e.renderingRule,e.adjustAspectRatio,e.pixelFilter,e.renderer,e.definitionExpression,(this._get(\"version\")||0)+1}set version(e){this._set(\"version\",e)}get mosaicRule(){const e=this.layer;let r=e.mosaicRule;const o=e.definitionExpression;return r?o&&o!==r.where&&(r=r.clone(),r.where=o):o&&(r=new MosaicRule({where:o})),r}get renderingRule(){const e=this.layer;let r=e.renderingRule;const o=e.pixelFilter,t=!e.format||e.format.indexOf(\"jpg\")>-1||e.format.indexOf(\"png\")>-1;return r=this._addResampleRasterFunction(r),t&&!o&&(r=this.combineRendererWithRenderingRule()),r}combineRendererWithRenderingRule(){var e;const r=this.layer,{rasterInfo:o,renderingRule:t,renderer:i}=r;if(!i||!imageryRendererUtils_l(i))return t;return imageryRendererUtils_m(imageryRendererUtils_c(i,{rasterAttributeTable:o.attributeTable,pixelType:o.pixelType,dataType:o.dataType,bandProperties:null==(e=o.keyProperties)?void 0:e.BandProperties,convertColorRampToColormap:r.version<10.6}),t)}_addResampleRasterFunction(e){var r;let o=null;if(\"vector-field\"===(null==(r=this.layer.renderer)?void 0:r.type)){const e={},r=this.layer.renderingRule;if(!r||\"Resample\"!==r.functionName){const r=\"esriImageServiceDataTypeVector-UV\"===this.layer.serviceDataType?7:10;e.rasterFunction=\"Resample\",e.rasterFunctionArguments={ResamplingType:r,InputCellSize:{x:this.layer.pixelSizeX,y:this.layer.pixelSizeY}}}o=RasterFunction.fromJSON(e)}return imageryRendererUtils_m(o,e)}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],ExportImageServiceParameters_m.prototype,\"layer\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ExportImageServiceParameters_m.prototype,\"adjustAspectRatio\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"adjustAspectRatio\")],ExportImageServiceParameters_m.prototype,\"writeAdjustAspectRatio\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}}),Object(aliasOf[\"a\" /* aliasOf */])(\"layer.bandIds\")],ExportImageServiceParameters_m.prototype,\"bandIds\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ExportImageServiceParameters_m.prototype,\"compression\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}}),Object(aliasOf[\"a\" /* aliasOf */])(\"layer.compressionQuality\")],ExportImageServiceParameters_m.prototype,\"compressionQuality\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"compressionQuality\")],ExportImageServiceParameters_m.prototype,\"writeCompressionQuality\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}}),Object(aliasOf[\"a\" /* aliasOf */])(\"layer.compressionTolerance\")],ExportImageServiceParameters_m.prototype,\"compressionTolerance\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"compressionTolerance\")],ExportImageServiceParameters_m.prototype,\"writeCompressionTolerance\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}}),Object(aliasOf[\"a\" /* aliasOf */])(\"layer.format\")],ExportImageServiceParameters_m.prototype,\"format\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{read:{reader:ExportImageServiceParameters_d.read},write:{writer:ExportImageServiceParameters_d.write}}}),Object(aliasOf[\"a\" /* aliasOf */])(\"layer.interpolation\")],ExportImageServiceParameters_m.prototype,\"interpolation\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}}),Object(aliasOf[\"a\" /* aliasOf */])(\"layer.noData\")],ExportImageServiceParameters_m.prototype,\"noData\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{read:{reader:ExportImageServiceParameters_u.read},write:{writer:ExportImageServiceParameters_u.write}}}),Object(aliasOf[\"a\" /* aliasOf */])(\"layer.noDataInterpretation\")],ExportImageServiceParameters_m.prototype,\"noDataInterpretation\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ExportImageServiceParameters_m.prototype,\"pixelType\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ExportImageServiceParameters_m.prototype,\"lercVersion\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"lercVersion\")],ExportImageServiceParameters_m.prototype,\"writeLercVersion\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Number,dependsOn:[\"layer.adjustAspectRatio\",\"layer.bandIds\",\"layer.format\",\"layer.compressionQuality\",\"layer.compressionTolerance\",\"layer.definitionExpression\",\"layer.interpolation\",\"layer.noData\",\"layer.noDataInterpretation\",\"layer.mosaicRule\",\"layer.renderingRule\",\"layer.pixelFilter\",\"layer.renderer\",\"lercVersion\",\"pixelType\"]})],ExportImageServiceParameters_m.prototype,\"version\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({dependsOn:[\"layer.mosaicRule\",\"layer.definitionExpression\"],json:{write:!0}})],ExportImageServiceParameters_m.prototype,\"mosaicRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({dependsOn:[\"layer.renderingRule\",\"layer.renderer\",\"layer.rasterInfo\",\"layer.format\"],json:{write:!0}})],ExportImageServiceParameters_m.prototype,\"renderingRule\",null),ExportImageServiceParameters_m=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layers.mixins.ExportImageServiceParameters\")],ExportImageServiceParameters_m);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/RasterInfo.js\nvar RasterInfo = __webpack_require__(\"pPNP\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/RasterJobHandler.js\nvar RasterJobHandler = __webpack_require__(\"2mvb\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/rasterFormats/RasterCodec.js + 3 modules\nvar RasterCodec = __webpack_require__(\"FFFX\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/renderers/support/rasterRendererHelper.js + 3 modules\nvar rasterRendererHelper = __webpack_require__(\"HM2S\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/renderers/support/RasterSymbolizer.js + 1 modules\nvar RasterSymbolizer = __webpack_require__(\"ciAr\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/normalizeUtils.js + 2 modules\nvar normalizeUtils = __webpack_require__(\"qNUd\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/utils.js\nvar utils = __webpack_require__(\"u3Ia\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/ImageIdentifyResult.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet ImageIdentifyResult_p=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(){super(...arguments),this.catalogItemVisibilities=null,this.catalogItems=null,this.location=null,this.name=null,this.objectId=null,this.processedValues=null,this.properties=null,this.value=null}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyResult_p.prototype,\"catalogItemVisibilities\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:FeatureSet[\"default\"],json:{write:!0}})],ImageIdentifyResult_p.prototype,\"catalogItems\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Point[\"a\" /* default */],json:{write:!0}})],ImageIdentifyResult_p.prototype,\"location\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyResult_p.prototype,\"name\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyResult_p.prototype,\"objectId\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyResult_p.prototype,\"processedValues\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyResult_p.prototype,\"properties\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyResult_p.prototype,\"value\",void 0),ImageIdentifyResult_p=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.tasks.support.ImageIdentifyResult\")],ImageIdentifyResult_p);var ImageIdentifyResult_l=ImageIdentifyResult_p;/* harmony default export */ var ImageIdentifyResult = (ImageIdentifyResult_l);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/rest/imageService.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nasync function imageService_i(s,a,i){const m=Object(utils[\"c\" /* parseUrl */])(s),u=a.geometry?[a.geometry]:[],c=await Object(normalizeUtils[\"a\" /* normalizeCentralMeridian */])(u),f=a.toJSON();!function(t){const s=null==t?void 0:t.time;if(s&&(null!=s.start||null!=s.end)){const o=[];null!=s.start&&o.push(s.start),null!=s.end&&-1===o.indexOf(s.end)&&o.push(s.end),t.time=o.join(\",\")}}(f);const g=c&&c[0];Object(maybe[\"h\" /* isSome */])(g)&&(f.geometry=g.toJSON());const l=Object(utils[\"b\" /* encode */])({...m.query,f:\"json\",...f});return Object(utils[\"a\" /* asValidOptions */])(l,i)}async function imageService_m(t,o,r){const e=await imageService_i(t,o,r),a=Object(utils[\"c\" /* parseUrl */])(t),{data:m}=await Object(request[\"default\"])(`${a.path}/computeStatisticsHistograms`,e),{statistics:u}=m;return null!=u&&u.length&&u.forEach((t=>{t.avg=t.mean,t.stddev=t.standardDeviation})),{statistics:u,histograms:m.histograms}}async function imageService_u(t,o,r){const e=await imageService_i(t,o,r),a=Object(utils[\"c\" /* parseUrl */])(t),{data:m}=await Object(request[\"default\"])(`${a.path}/computeHistograms`,e);return{histograms:m.histograms}}async function imageService_c(i,m,u){const c=Object(utils[\"c\" /* parseUrl */])(i),f=m.geometry?[m.geometry]:[];return Object(normalizeUtils[\"a\" /* normalizeCentralMeridian */])(f).then((o=>{const n=m.toJSON(),a=o&&o[0];Object(maybe[\"h\" /* isSome */])(a)&&(n.geometry=JSON.stringify(a.toJSON()));const i=Object(utils[\"b\" /* encode */])({...c.query,f:\"json\",...n}),f=Object(utils[\"a\" /* asValidOptions */])(i,u);return Object(request[\"default\"])(c.path+\"/identify\",f)})).then((t=>ImageIdentifyResult.fromJSON(t.data)))}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/tasks/Task.js\nvar Task = __webpack_require__(\"kglp\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/ImageIdentifyTask.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet ImageIdentifyTask_t=class extends Task[\"a\" /* default */]{execute(r,s){return imageService_c(this.url,r,s)}};ImageIdentifyTask_t=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.tasks.ImageIdentifyTask\")],ImageIdentifyTask_t);var ImageIdentifyTask_p=ImageIdentifyTask_t;/* harmony default export */ var ImageIdentifyTask = (ImageIdentifyTask_p);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/jsonUtils.js\nvar jsonUtils = __webpack_require__(\"qatw\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/TimeExtent.js\nvar TimeExtent = __webpack_require__(\"ZYtI\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/tasks/support/ImageIdentifyParameters.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nvar ImageIdentifyParameters_a;let ImageIdentifyParameters_y=ImageIdentifyParameters_a=class extends JSONSupport[\"a\" /* JSONSupport */]{constructor(){super(...arguments),this.geometry=null,this.renderingRules=null,this.pixelSize=null,this.returnGeometry=!0,this.returnCatalogItems=!0,this.returnPixelValues=!0,this.maxItemCount=null,this.timeExtent=null,this.raster=void 0,this.viewId=void 0}writeGeometry(e,t,r){null!=e&&(t.geometryType=Object(jsonUtils[\"c\" /* getJsonType */])(e),t[r]=JSON.stringify(e.toJSON()))}set mosaicRule(e){let t=e;t&&t.mosaicMethod&&(t=MosaicRule.fromJSON({...t.toJSON(),mosaicMethod:t.mosaicMethod,mosaicOperation:t.mosaicOperation})),this._set(\"mosaicRule\",t)}writeMosaicRule(e,t,r){null!=e&&(t[r]=JSON.stringify(e.toJSON()))}set renderingRule(e){let t=e;t&&t.rasterFunction&&(t=RasterFunction.fromJSON({...t.toJSON(),rasterFunction:t.rasterFunction,rasterFunctionArguments:t.rasterFunctionArguments})),this._set(\"renderingRule\",t)}writeRenderingRule(e,t,r){null!=e&&(t[r]=JSON.stringify(e.toJSON()))}writeRenderingRules(e,t,r){null!=e&&(t[r]=JSON.stringify(e.map((e=>e.toJSON()))))}writePixelSize(e,t,r){null!=e&&(t[r]=JSON.stringify(e))}writeTimeExtent(e,t,r){if(null!=e){const o=e.start?e.start.getTime():null,i=e.end?e.end.getTime():null;t[r]=null!=o?null!=i?`${o},${i}`:`${o}`:null}}clone(){return new ImageIdentifyParameters_a(Object(lang[\"a\" /* clone */])({geometry:this.geometry,mosaicRule:this.mosaicRule,renderingRule:this.renderingRule,pixelSize:this.pixelSize,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,returnPixelValues:this.returnPixelValues,maxItemCount:this.maxItemCount,raster:this.raster,viewId:this.viewId,timeExtent:this.timeExtent}))}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"geometry\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"geometry\")],ImageIdentifyParameters_y.prototype,\"writeGeometry\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:MosaicRule,json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"mosaicRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"mosaicRule\")],ImageIdentifyParameters_y.prototype,\"writeMosaicRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:RasterFunction,json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"renderingRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"renderingRule\")],ImageIdentifyParameters_y.prototype,\"writeRenderingRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[RasterFunction],json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"renderingRules\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"renderingRules\")],ImageIdentifyParameters_y.prototype,\"writeRenderingRules\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Point[\"a\" /* default */],json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"pixelSize\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"pixelSize\")],ImageIdentifyParameters_y.prototype,\"writePixelSize\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Boolean,json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"returnGeometry\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Boolean,json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"returnCatalogItems\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Boolean,json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"returnPixelValues\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Number,json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"maxItemCount\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:TimeExtent[\"a\" /* default */],json:{write:{target:\"time\"}}})],ImageIdentifyParameters_y.prototype,\"timeExtent\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"timeExtent\")],ImageIdentifyParameters_y.prototype,\"writeTimeExtent\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"raster\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{write:!0}})],ImageIdentifyParameters_y.prototype,\"viewId\",void 0),ImageIdentifyParameters_y=ImageIdentifyParameters_a=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.tasks.support.ImageIdentifyParameters\")],ImageIdentifyParameters_y);var ImageIdentifyParameters_c=ImageIdentifyParameters_y;/* harmony default export */ var ImageIdentifyParameters = (ImageIdentifyParameters_c);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/mixins/ArcGISImageService.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst te=Logger[\"a\" /* default */].getLogger(\"esri.layers.mixins.ArcGISImageService\"),re=Object(jsonMap[\"b\" /* strict */])()({RSP_NearestNeighbor:\"nearest\",RSP_BilinearInterpolation:\"bilinear\",RSP_CubicConvolution:\"cubic\",RSP_Majority:\"majority\"}),ie=Object(jsonMap[\"b\" /* strict */])()({esriNoDataMatchAny:\"any\",esriNoDataMatchAll:\"all\"}),se=Object(jsonMap[\"b\" /* strict */])()({U1:\"u1\",U2:\"u2\",U4:\"u4\",U8:\"u8\",S8:\"s8\",U16:\"u16\",S16:\"s16\",U32:\"u32\",S32:\"s32\",F32:\"f32\",F64:\"f64\",C64:\"c64\",C128:\"c128\",UNKNOWN:\"unknown\"}),ne=new Set([\"png\",\"png8\",\"png24\",\"png32\",\"jpg\",\"bmp\",\"gif\",\"jpgpng\",\"lerc\",\"tiff\"]),ae=Object(property[\"a\" /* ensureRange */])(ensureType[\"i\" /* ensureNumber */],{min:0,max:255});const oe=s=>{let a=class extends s{constructor(){super(...arguments),this._functionRasterInfos={},this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this._symbolizer=null,this._defaultServiceMosaicRule=null,this.rasterAttributeTableFieldPrefix=\"Raster.\",this.adjustAspectRatio=null,this.bandCount=null,this.bandIds=void 0,this.capabilities=null,this.compressionQuality=void 0,this.compressionTolerance=.01,this.copyright=null,this.definitionExpression=null,this.exportImageServiceParameters=null,this.rasterInfo=null,this.fields=null,this.fullExtent=null,this.hasMultidimensions=!1,this.imageMaxHeight=4100,this.imageMaxWidth=4100,this.interpolation=void 0,this.minScale=0,this.maxScale=0,this.multidimensionalInfo=null,this.noData=null,this.noDataInterpretation=void 0,this.objectIdField=null,this.pixelSizeX=null,this.pixelSizeY=null,this.pixelFilter=null,this.raster=void 0,this.viewId=void 0,this.renderer=null,this.rasterAttributeTable=null,this.rasterFunctionInfos=null,this.serviceDataType=null,this.spatialReference=null,this.pixelType=null,this.serviceRasterInfo=null,this.sourceJSON=null,this.url=null,this.version=null}initialize(){this._set(\"exportImageServiceParameters\",new ExportImageServiceParameters_m({layer:this}))}readDefaultServiceMosaicRule(e,t){return MosaicRule.fromJSON(t)}get rasterFunctionNamesIndex(){const e=new Map;return!this.rasterFunctionInfos||this.rasterFunctionInfos.length<1||this.rasterFunctionInfos.forEach((t=>{e.set(t.name.toLowerCase().replace(/ /gi,\"_\"),t.name)})),e}get queryTask(){return new QueryTask[\"a\" /* default */]({url:this.url})}readBandIds(e,t){if(Array.isArray(e)&&e.length>0&&e.every((e=>\"number\"==typeof e)))return e}readCapabilities(e,t){return this._readCapabilities(t)}writeCompressionQuality(e,t,r){null!=e&&\"lerc\"!==this.format&&(t[r]=e)}writeCompressionTolerance(e,t,r){\"lerc\"===this.format&&null!=e&&(t[r]=e)}get fieldsIndex(){return this.fields?new FieldsIndex[\"a\" /* default */](this.fields):null}set format(e){e&&ne.has(e.toLowerCase())&&this._set(\"format\",e.toLowerCase())}readFormat(e,t){return\"esriImageServiceDataTypeVector-UV\"===t.serviceDataType||\"esriImageServiceDataTypeVector-MagDir\"===t.serviceDataType||null!=this.pixelFilter?\"lerc\":\"jpgpng\"}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}set mosaicRule(e){let t=e;t&&t.mosaicMethod&&(t=MosaicRule.fromJSON({...t.toJSON(),mosaicMethod:t.mosaicMethod,mosaicOperation:t.mosaicOperation})),this._set(\"mosaicRule\",t)}readMosaicRule(e,t){return MosaicRule.fromJSON(e||t.mosaicRule||t)}writeMosaicRule(e,t,r){let i=this.mosaicRule;const s=this.definitionExpression;i?s&&s!==i.where&&(i=i.clone(),i.where=s):s&&(i=new MosaicRule({where:s})),this._isValidCustomizedMosaicRule(i)&&(t[r]=i.toJSON())}writeNoData(e,t,r){null!=e&&\"number\"==typeof e&&(t[r]=ae(e))}readObjectIdField(e,t){if(!e){const r=t.fields.filter((e=>\"esriFieldTypeOID\"===e.type||\"oid\"===e.type));e=r&&r[0]&&r[0].name}return e}get parsedUrl(){return this.url?Object(urlUtils[\"I\" /* urlToObject */])(this.url):null}readRenderer(e,t,r){const i=t&&t.layerDefinition&&t.layerDefinition.drawingInfo&&t.layerDefinition.drawingInfo.renderer,s=Object(rasterRenderers[\"b\" /* read */])(i,r)||void 0;if(null!=s)return imageryRendererUtils_l(s)||te.warn(\"ArcGISImageService\",\"Imagery layer doesn't support given renderer type.\"),s}get rasterFields(){const e=this.rasterAttributeTableFieldPrefix||\"Raster.\",r=new Field[\"a\" /* default */]({name:\"Raster.ItemPixelValue\",alias:\"Item Pixel Value\",domain:null,editable:!1,length:50,type:\"string\"}),i=new Field[\"a\" /* default */]({name:\"Raster.ServicePixelValue\",alias:\"Service Pixel Value\",domain:null,editable:!1,length:50,type:\"string\"}),s=new Field[\"a\" /* default */]({name:\"Raster.ServicePixelValue.Raw\",alias:\"Raw Service Pixel Value\",domain:null,editable:!1,length:50,type:\"string\"});let n=this.fields?Object(lang[\"a\" /* clone */])(this.fields):[];n.push(i),this.capabilities.operations.supportsQuery&&this.fields&&this.fields.length>0&&n.push(r),this.version>=10.4&&this.rasterFunctionInfos&&this.rasterFunctionInfos.some((e=>\"none\"===e.name.toLowerCase()))&&n.push(s),this.rasterFunctionInfos&&this.rasterFunctionInfos.filter((e=>\"none\"!==e.name.toLowerCase())).forEach((e=>{n.push(new Field[\"a\" /* default */]({name:\"Raster.ServicePixelValue.\"+e.name,alias:e.name,domain:null,editable:!1,length:50,type:\"string\"}))})),null==this.pixelFilter||\"esriImageServiceDataTypeVector-UV\"!==this.serviceDataType&&\"esriImageServiceDataTypeVector-MagDir\"!==this.serviceDataType||(n.push(new Field[\"a\" /* default */]({name:\"Raster.Magnitude\",alias:\"Magnitude\",domain:null,editable:!1,type:\"double\"})),n.push(new Field[\"a\" /* default */]({name:\"Raster.Direction\",alias:\"Direction\",domain:null,editable:!1,type:\"double\"})));const a=this.rasterInfo.attributeTable&&this.rasterInfo.attributeTable.fields||null;if(a&&a.length>0){const r=a.filter((e=>\"esriFieldTypeOID\"!==e.type&&\"value\"!==e.name.toLowerCase())).map((r=>{const i=Object(lang[\"a\" /* clone */])(r);return i.name=e+r.name,i}));n=n.concat(r)}return n}set renderingRule(e){let t=e;t&&t.rasterFunction&&(t=RasterFunction.fromJSON({...t.toJSON(),rasterFunction:t.rasterFunction,rasterFunctionArguments:t.rasterFunctionArguments})),this._set(\"renderingRule\",t)}readRenderingRule(e,t){const r=t.rasterFunctionInfos;return t.renderingRule||r&&r.length&&\"None\"!==r[0].name?RasterFunction.fromJSON(t.renderingRule||{rasterFunctionInfos:t.rasterFunctionInfos}):null}writeRenderingRule(e,t,r){this._isRFTJson(e)||(t[r]=e.toJSON())}readSpatialReference(e,t){const r=e||t.extent.spatialReference;return r?SpatialReference[\"a\" /* default */].fromJSON(r):null}readPixelType(e){return se.fromJSON(e)||e}writePixelType(e,t,i){(Object(maybe[\"g\" /* isNone */])(this.serviceRasterInfo)||this.pixelType!==this.serviceRasterInfo.pixelType)&&(t[i]=se.toJSON(e))}readVersion(e,t){let r=t.currentVersion;return r||(r=t.hasOwnProperty(\"fields\")||t.hasOwnProperty(\"timeInfo\")?10:9.3),r}applyFilter(e){let t=e;return this.pixelFilter&&(t=this._clonePixelData(e),this.pixelFilter(t)),t}async applyRenderer(e,t){let r=e;if(!this._isPicture()&&this.renderer&&this._symbolizer&&!this.pixelFilter){const i=JSON.stringify(this._cachedRendererJson)!==JSON.stringify(this.renderer.toJSON()),s=this._rasterJobHandler.instance,{bandIds:n}=this;if(s){i&&(this._symbolizer.bind(),await s.updateSymbolizer(this._symbolizer,t),this._cachedRendererJson=this.renderer.toJSON());const a=await s.symbolize({bandIds:n,...e},t);r={extent:e.extent,pixelBlock:a}}else r={extent:e.extent,pixelBlock:this._symbolizer.symbolize({bandIds:n,...e})}}return r}destroy(){this._shutdownJobHandler()}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}async computeHistograms(e,t){const r=null==t?void 0:t.signal;if(await this._fetchCapabilities(r),!this.capabilities.operations.supportsComputeHistograms)throw new Error[\"a\" /* default */](\"imagery-layer:compute-histograms\",\"this operation is not supported on the input image service\");e=e.clone();const{raster:i,mosaicRule:s,renderingRule:n}=this;return n&&null==e.renderingRule&&(e.renderingRule=n),s&&null==e.mosaicRule&&(e.mosaicRule=s),i&&null==e.raster&&(e.raster=i),imageService_u(this.url,e,{signal:r})}async computeStatisticsHistograms(e,t){const r=null==t?void 0:t.signal;if(await this._fetchCapabilities(r),!this.capabilities.operations.supportsComputeStatisticsHistograms)throw new Error[\"a\" /* default */](\"imagery-layer:compute-statistics-histograms\",\"this operation is not supported on the input image service\");e=e.clone();const{raster:i,mosaicRule:s,renderingRule:n}=this;return n&&null==e.renderingRule&&(e.renderingRule=n),s&&null==e.mosaicRule&&(e.mosaicRule=s),i&&null==e.raster&&(e.raster=i),imageService_m(this.url,e,{signal:r})}fetchImage(e,t,r,i={}){if(null==e||null==t||null==r)return Object(promiseUtils[\"t\" /* reject */])(new Error[\"a\" /* default */](\"imagery-layer:fetch-image\",\"Insufficient parameters for requesting an image. A valid extent, width and height values are required.\"));const s=this.renderer||this._symbolizer?this.generateRasterInfo(this.renderingRule,{signal:i.signal}):null;return Object(promiseUtils[\"y\" /* when */])(s).then((s=>{s&&(this.rasterInfo=s);const n={imageServiceParameters:this.getExportImageServiceParameters(e,t,r,i.timeExtent),imageProps:{extent:e,width:t,height:r,format:this.format},requestAsImageElement:i.requestAsImageElement&&!this.pixelFilter||!1,signal:i.signal};return this._requestArrayBuffer(n)}))}fetchKeyProperties(e){const t=e&&e.renderingRule&&e.renderingRule.toJSON();return Object(request[\"default\"])(this.parsedUrl.path+\"/keyProperties\",{query:this._getQueryParams({renderingRule:this.version>=10.3&&t?JSON.stringify(t):null})}).then((e=>e.data))}fetchRasterAttributeTable(e){const t=e&&e.renderingRule&&e.renderingRule.toJSON();return this.version<10.1?Object(promiseUtils[\"t\" /* reject */])(new Error[\"a\" /* default */](\"#fetchRasterAttributeTable()\",\"Failed to get rasterAttributeTable\")):Object(request[\"default\"])(this.parsedUrl.path+\"/rasterAttributeTable\",{query:this._getQueryParams({renderingRule:this.version>=10.3&&t?JSON.stringify(t):null})}).then((e=>FeatureSet[\"default\"].fromJSON(e.data)))}async getCatalogItemRasterInfo(e,t){const r=Object(request[\"default\"])(this.parsedUrl.path+\"/\"+e+\"/info\",{query:this._getQueryParams(),...t}).then((e=>e.data)),i=Object(request[\"default\"])(this.parsedUrl.path+\"/\"+e+\"/info/keyProperties\",{query:this._getQueryParams(),...t}).then((e=>e.data)).catch((()=>{})),s=await Object(promiseUtils[\"b\" /* all */])([r,i]);if(!s[0])return;const n=Extent[\"a\" /* default */].fromJSON(s[0].extent),a=s[0].statistics?s[0].statistics.map((e=>({min:e[0],max:e[1],avg:e[2],stddev:e[3]}))):null;return new RasterInfo[\"a\" /* default */]({bandCount:s[0].bandCount,extent:n,spatialReference:n.sr,pixelSize:new Point[\"a\" /* default */]({x:s[0].pixelSizeX,y:s[0].pixelSizeY,spatialReference:n.sr}),pixelType:s[0].pixelType.toLowerCase(),statistics:a,histograms:s[0].histograms,keyProperties:s[1]||{}})}async getCatalogItemICSInfo(e,t){const{data:r}=await Object(request[\"default\"])(this.parsedUrl.path+\"/\"+e+\"/info/ics\",{query:this._getQueryParams(),...t}),i=r&&r.ics;if(!i)return;let s=null;try{s=(await Object(request[\"default\"])(this.parsedUrl.path+\"/\"+e+\"/info\",{query:this._getQueryParams(),...t})).data.extent}catch{}if(!s||!s.spatialReference)return{ics:i,icsToPixelTransform:null,icsExtent:null,northDirection:null};const n=this.version>=10.7?Object(request[\"default\"])(this.parsedUrl.path+\"/\"+e+\"/info/icstopixel\",{query:this._getQueryParams(),...t}).then((e=>e.data)).catch((()=>({}))):{},a=s.spatialReference,o={geometries:JSON.stringify({geometryType:\"esriGeometryEnvelope\",geometries:[s]}),inSR:a.wkid||JSON.stringify(a),outSR:\"0:\"+e},l=Object(request[\"default\"])(this.parsedUrl.path+\"/project\",{query:this._getQueryParams(o),...t}).then((e=>e.data)).catch((()=>({}))),u=(s.xmin+s.xmax)/2,p=(s.ymax-s.ymin)/6,c=s.ymin+p,d=[];for(let e=0;e<5;e++)d.push({x:u,y:c+p*e});const m={geometries:JSON.stringify({geometryType:\"esriGeometryPoint\",geometries:d}),inSR:a.wkid||JSON.stringify(a),outSR:\"0:\"+e},h=Object(request[\"default\"])(this.parsedUrl.path+\"/project\",{query:this._getQueryParams(m),...t}).then((e=>e.data)).catch((()=>({}))),f=await Object(promiseUtils[\"b\" /* all */])([n,l,h]);let y=f[0].ipxf;if(null==y){var g,v,x;const e=null==(g=i.geodataXform)?void 0:g.xf_0;\"topup\"===(null==e||null==(v=e.name)?void 0:v.toLowerCase())&&6===(null==e||null==(x=e.coefficients)?void 0:x.length)&&(y={affine:{name:\"ics [sensor: Frame] to pixel (column, row) transformation\",coefficients:e.coefficients,cellsizeRatio:0,type:\"GeometricXform\"}})}const I=Extent[\"a\" /* default */].fromJSON(f[1]&&f[1].geometries&&f[1].geometries[0]);I&&(I.spatialReference=new SpatialReference[\"a\" /* default */]({wkid:0,imageCoordinateSystem:i}));const w=f[2].geometries?f[2].geometries.filter((e=>null!=e&&null!=e.x&&null!=e.y&&\"NaN\"!==e.x&&\"NaN\"!==e.y)):[],O=w.length;if(O<3)return{ics:i,icsToPixelTransform:y,icsExtent:I,northDirection:null};let N=0,P=0,F=0,D=0;for(let e=0;e<O;e++)N+=w[e].x,P+=w[e].y,F+=w[e].x*w[e].x,D+=w[e].x*w[e].y;const j=(O*D-N*P)/(O*F-N*N);let T=0;const J=w[4].x>w[0].x,C=w[4].y>w[0].y;return j===1/0?T=C?90:270:0===j?T=J?0:180:j>0?T=J?180*Math.atan(j)/Math.PI:180*Math.atan(j)/Math.PI+180:j<0&&(T=C?180+180*Math.atan(j)/Math.PI:360+180*Math.atan(j)/Math.PI),{ics:i,icsToPixelTransform:y,icsExtent:I,northDirection:T}}async generateRasterInfo(e,t){if((!e||\"none\"===e.functionName.toLowerCase())&&Object(maybe[\"h\" /* isSome */])(this.serviceRasterInfo))return this.serviceRasterInfo;const r=function(e){if(!e)return null;const t=JSON.stringify(e).match(/\"rasterFunction\":\"(.*?\")/gi),r=null==t?void 0:t.map((e=>e.replace('\"rasterFunction\":\"',\"\").replace('\"',\"\")));return r?r.join(\"/\"):null}(e);if(this._functionRasterInfos[r])return this._functionRasterInfos[r];const s=this._generateRasterInfo(e,t);this._functionRasterInfos[r]=s;try{return await s}catch{return this._functionRasterInfos[r]=null,null}}getExportImageServiceParameters(e,t,r,s){const n=(e=e.clone().shiftCentralMeridian()).spatialReference;let a;if(n.imageCoordinateSystem){const{id:e,referenceServiceName:t}=n.imageCoordinateSystem;a=null!=e?t?this.parsedUrl.path.toLowerCase().indexOf(\"/\"+t.toLowerCase()+\"/\")>-1?\"0:\"+e:JSON.stringify({icsid:e,icsns:t}):\"0:\"+e:JSON.stringify({ics:n.imageCoordinateSystem})}else a=n.wkid||JSON.stringify(n.toJSON());Object(maybe[\"h\" /* isSome */])(this.serviceRasterInfo)&&this.pixelType!==this.serviceRasterInfo.pixelType&&(this.exportImageServiceParameters.pixelType=this.pixelType);const o=this.exportImageServiceParameters.toJSON(),{bandIds:l,noData:u,mosaicRule:p,renderingRule:c}=o;l instanceof Array&&l.length>0&&(o.bandIds=l.join(\",\")),u instanceof Array&&u.length>0&&(o.noData=u.join(\",\"));const d=this.timeInfo;p&&p.multidimensionalDefinition&&s&&d&&d.startField&&(p.multidimensionalDefinition=p.multidimensionalDefinition.filter((e=>e.dimensionName!==d.startField))),o.mosaicRule=p&&JSON.stringify(p),o.renderingRule=c&&JSON.stringify(c);const m={};if(s){const{start:e,end:t}=s.toJSON();e&&t&&e===t?m.time=\"\"+e:null==e&&null==t||(m.time=`${null==e?\"null\":e},${null==t?\"null\":t}`)}return{bbox:e.xmin+\",\"+e.ymin+\",\"+e.xmax+\",\"+e.ymax,bboxSR:a,imageSR:a,size:t+\",\"+r,...o,...m}}async identify(e,t){if(await this._fetchCapabilities(null==t?void 0:t.signal),!this.capabilities.operations.supportsIdentify)throw new Error[\"a\" /* default */](\"imagery-layer:query-rasters\",\"query operation is not supported on the input image service\");e=e.clone();const{raster:r,mosaicRule:i,renderingRule:s}=this;s&&null==e.renderingRule&&(e.renderingRule=s),i&&null==e.mosaicRule&&(e.mosaicRule=i),r&&null==e.raster&&(e.raster=r);return new ImageIdentifyTask({url:this.url}).execute(e,t)}async queryRasters(e,t){if(await this._fetchCapabilities(null==t?void 0:t.signal),!this.capabilities.operations.supportsQuery)throw new Error[\"a\" /* default */](\"imagery-layer:query-rasters\",\"query operation is not supported on the input image service\");return this.queryTask.execute(e,t)}queryVisibleRasters(e,t){if(!e)return Object(promiseUtils[\"t\" /* reject */])(new Error[\"a\" /* default */](\"imagery-layer: query-visible-rasters\",\"missing query parameter\"));const{pixelSize:s,returnDomainValues:n,returnTopmostRaster:a,showNoDataRecords:o}=t||{pixelSize:null,returnDomainValues:!1,returnTopmostRaster:!1,showNoDataRecords:!1};let l=!1,u=null,p=null;const c=\"raster.servicepixelvalue\",d=this.rasterFunctionNamesIndex;if(Object(maybe[\"h\" /* isSome */])(e.outFields)&&(l=e.outFields.some((e=>-1===e.toLowerCase().indexOf(c))),this.version>=10.4)){const t=e.outFields.filter((e=>e.toLowerCase().indexOf(c)>-1&&e.length>c.length)).map((e=>{const t=e.slice(c.length+1);return[this._updateRenderingRulesFunctionName(t,d),t]}));u=t.map((e=>new RasterFunction({functionName:e[0]}))),p=t.map((e=>e[1])),0===u.length?this.renderingRule?(u.push(this.renderingRule),p.push(this.renderingRule.functionName)):u=null:this.renderingRule&&!u.some((e=>e.functionName===this.renderingRule.functionName))&&(u.push(this.renderingRule),p.push(this.renderingRule.functionName))}const m=Object(maybe[\"g\" /* isNone */])(e.outSpatialReference)||e.outSpatialReference.equals(this.spatialReference),f=this._getQueryParams({geometry:e.geometry,timeExtent:e.timeExtent,mosaicRule:this.exportImageServiceParameters.mosaicRule,renderingRule:this.version<10.4?this.renderingRule:null,renderingRules:u,pixelSize:s,returnCatalogItems:l,returnGeometry:m,maxItemCount:a?1:null});delete f.f;const g=new ImageIdentifyParameters(f),R=new ImageIdentifyTask({url:this.url}),x=this.generateRasterInfo(this.renderingRule);return Object(promiseUtils[\"c\" /* create */])((t=>{x.then((()=>{R.execute(g).then((r=>{const i=e.outFields;if(l&&!m&&r.catalogItems&&r.catalogItems.features&&r.catalogItems.features.length>0){const s=this.objectIdField||\"ObjectId\",a=r.catalogItems.features,l=a.map((e=>e.attributes&&e.attributes[s])),u=new Query[\"a\" /* default */]({objectIds:l,returnGeometry:!0,outSpatialReference:e.outSpatialReference,outFields:[s]});return this.queryRasters(u).then((l=>{l&&l.features&&l.features.length>0&&l.features.forEach((t=>{a.forEach((r=>{r.attributes[s]===t.attributes[s]&&(r.geometry=new Polygon[\"a\" /* default */](t.geometry),r.geometry.spatialReference=e.outSpatialReference)}))})),t(this._processVisibleRastersResponse(r,{returnDomainValues:n,templateRRFunctionNames:p,showNoDataRecords:o,templateFields:i}))})).catch((()=>{throw new Error[\"a\" /* default */](\"imagery-layer:query-visible-rasters\",\"encountered error when querying visible rasters geometry\")}))}t(this._processVisibleRastersResponse(r,{returnDomainValues:n,templateRRFunctionNames:p,showNoDataRecords:o,templateFields:i}))})).catch((()=>{throw new Error[\"a\" /* default */](\"imagery-layer:query-visible-rasters\",\"encountered error when querying visible rasters\")}))}))}))}async fetchVariableStatisticsHistograms(e,t){const r=Object(request[\"default\"])(this.parsedUrl.path+\"/statistics\",{query:this._getQueryParams({variable:e}),signal:t}).then((e=>{var t;return null==(t=e.data)?void 0:t.statistics})),i=Object(request[\"default\"])(this.parsedUrl.path+\"/histograms\",{query:this._getQueryParams({variable:e}),signal:t}).then((e=>{var t;return null==(t=e.data)?void 0:t.histograms})),s=await Object(promiseUtils[\"b\" /* all */])([r,i]);return s[0]&&s[0].forEach((e=>{e.avg=e.mean,e.stddev=e.standardDeviation})),{statistics:s[0]||null,histograms:s[1]||null}}async _fetchService(e){await this._fetchServiceInfo(e),Object(maybe[\"h\" /* isSome */])(this.serviceRasterInfo)&&!this.rasterInfo&&(this.rasterInfo=this.serviceRasterInfo);const t=this.sourceJSON,r=Object(maybe[\"h\" /* isSome */])(this.serviceRasterInfo)?Object(promiseUtils[\"u\" /* resolve */])(this.serviceRasterInfo):this._fetchAuxiliaryRasterInfo({serviceInfo:t,signal:e}).then((e=>(this._set(\"serviceRasterInfo\",e),e))),s=this.renderingRule&&\"none\"!==this.renderingRule.functionName.toLowerCase()?this.generateRasterInfo(this.renderingRule,{signal:e}):null;return Object(promiseUtils[\"b\" /* all */])([r,s]).then((e=>{e[1]?this._set(\"rasterInfo\",e[1]):this._set(\"rasterInfo\",e[0]),this.renderer&&Object(rasterRendererHelper[\"d\" /* getSupportedRendererTypes */])(this.rasterInfo).indexOf(this.renderer.type)<0&&(this.renderer=null,te.warn(\"ArcGISImageService\",\"Switching to the default renderer. Renderer applied is not valid for this Imagery Layer\")),this._configDefaultRenderer(),this.watch(\"renderer\",(()=>this._configDefaultRenderer())),this.watch(\"renderingRule\",(e=>{(this.renderer||this._symbolizer||this.popupEnabled&&this.popupTemplate)&&this.generateRasterInfo(e).then((e=>{e&&(this.rasterInfo=e)}))}));const t=Object(maybe[\"h\" /* isSome */])(this.serviceRasterInfo)&&this.serviceRasterInfo.multidimensionalInfo;t&&this._updateMultidimensionalDefinition(t)}))}async _initJobHandler(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const e=new RasterJobHandler[\"a\" /* default */];this._rasterJobHandler.connectionPromise=e.initialize().then((()=>{this._rasterJobHandler.instance=e}),(()=>null)),await this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0}async _fetchCapabilities(e){return this.capabilities||await this._fetchServiceInfo(e),this.capabilities}async _fetchServiceInfo(e){var t;let r=this.sourceJSON;if(!r){const{data:t,ssl:i}=await Object(request[\"default\"])(this.parsedUrl.path,{query:this._getQueryParams(),signal:e});r=t,this.sourceJSON=r,i&&(this.url=this.url.replace(/^http:/i,\"https:\"))}if((null==(t=r.capabilities)?void 0:t.toLowerCase().split(\",\").map((e=>e.trim())).indexOf(\"tilesonly\"))>-1)throw new Error[\"a\" /* default */](\"imagery-layer:fetch-service-info\",\"use ImageryTileLayer to open tiles-only image services\");this.read(r,{origin:\"service\",url:this.parsedUrl})}_isPicture(){return!this.format||this.format.indexOf(\"jpg\")>-1||this.format.indexOf(\"png\")>-1}_configDefaultRenderer(){if(!this._isPicture()&&!this.pixelFilter){if(!this.bandIds&&this.rasterInfo.bandCount>=3){const e=Object(rasterRendererHelper[\"b\" /* getDefaultBandCombination */])(this.rasterInfo);!e||3===this.rasterInfo.bandCount&&0===e[0]&&1===e[1]&&2===e[2]||(this.bandIds=e)}var e,t;if(!this.renderer)this.renderer=Object(rasterRendererHelper[\"a\" /* createDefaultRenderer */])(this.rasterInfo,{bandIds:this.bandIds,variableName:this.renderingRule?null:null==(e=this.mosaicRule)||null==(t=e.multidimensionalDefinition)?void 0:t[0].variableName});this._symbolizer?(this._symbolizer.rendererJSON=this.renderer.toJSON(),this._symbolizer.rasterInfo=this.rasterInfo):this._symbolizer=new RasterSymbolizer[\"a\" /* default */]({rendererJSON:this.renderer.toJSON(),rasterInfo:this.rasterInfo}),this._symbolizer.bind()||(this._symbolizer=null)}}_clonePixelData(e){return null==e?e:{extent:e.extent&&e.extent.clone(),pixelBlock:e.pixelBlock&&e.pixelBlock.clone()}}_getQueryParams(e){const{raster:t,viewId:r}=this;return{raster:t,viewId:r,f:\"json\",...e}}_decodePixelBlock(e,t,r){return this._rasterJobHandler.instance?this._rasterJobHandler.instance.decode({data:e,options:t}):Object(RasterCodec[\"a\" /* decode */])(e,t,r)}async _fetchMultidimensionalInfo(e){var t;const r=await Object(request[\"default\"])(this.parsedUrl.path+\"/multidimensionalInfo\",{query:this._getQueryParams(),signal:e}).then((e=>{var t;return null==(t=e.data)?void 0:t.multidimensionalInfo}));return null!=(t=r.variables)&&t.length&&r.variables.forEach((e=>{var t;null!=(t=e.statistics)&&t.length&&e.statistics.forEach((e=>{e.avg=e.mean,e.stddev=e.standardDeviation}))})),r}_fetchAuxiliaryRasterInfo(e){const t=e&&e.serviceInfo;if(!t)return Object(promiseUtils[\"t\" /* reject */])(new Error[\"a\" /* default */](\"imagery-layer:fetch-metadata\",\"valid serviceInfo is required\"));const r=e.renderingRule?JSON.stringify(e.renderingRule.toJSON()):null,i=e.signal,s=!!(t.hasRasterAttributeTable&&this.version>=10.1)&&Object(request[\"default\"])(this.parsedUrl.path+\"/rasterAttributeTable\",{query:this._getQueryParams({renderingRule:this.version>=10.1?r:null}),signal:i}).then((e=>FeatureSet[\"default\"].fromJSON(e.data))).catch((()=>null)),n=!!(t.hasColormap&&this.version>=10.1)&&Object(request[\"default\"])(this.parsedUrl.path+\"/colormap\",{query:this._getQueryParams({renderingRule:this.version>=10.6?r:null}),signal:i}).then((e=>{var t;return null==(t=e.data)?void 0:t.colormap})),a=!!(t.hasHistograms&&this.version>=10.1)&&Object(request[\"default\"])(this.parsedUrl.path+\"/histograms\",{query:this._getQueryParams({renderingRule:this.version>=10.1?r:null}),signal:i}).then((e=>{var t;return null==(t=e.data)?void 0:t.histograms})),o=this.version>=10.3&&Object(request[\"default\"])(this.parsedUrl.path+\"/keyProperties\",{query:this._getQueryParams({renderingRule:r}),signal:i}).then((e=>e.data)).catch((()=>{})),l=!!(t.hasMultidimensions&&this.version>=10.3)&&this._fetchMultidimensionalInfo();return Object(promiseUtils[\"b\" /* all */])([s,n,a,o,l]).then((e=>{let r=null;if(t.minValues&&t.minValues.length===t.bandCount){r=[];for(let e=0;e<t.minValues.length;e++)r.push({min:t.minValues[e],max:t.maxValues[e],avg:t.meanValues[e],stddev:t.stdvValues[e]})}const i=Math.ceil((t.extent.xmax-t.extent.xmin)/t.pixelSizeX-.1),s=Math.ceil((t.extent.ymax-t.extent.ymin)/t.pixelSizeY-.1),n=SpatialReference[\"a\" /* default */].fromJSON(t.spatialReference||t.extent.spatialReference);return new RasterInfo[\"a\" /* default */]({width:i,height:s,bandCount:t.bandCount,extent:Extent[\"a\" /* default */].fromJSON(t.extent),spatialReference:n,pixelSize:new Point[\"a\" /* default */]({x:t.pixelSizeX,y:t.pixelSizeY,spatialReference:n}),pixelType:t.pixelType.toLowerCase(),statistics:r,attributeTable:e[0]||null,colormap:e[1]||null,histograms:e[2]||null,keyProperties:e[3]||{},multidimensionalInfo:e[4]||null})}))}_requestArrayBuffer(e){const{imageProps:t,requestAsImageElement:r,signal:i}=e;if(r&&!this.pixelFilter&&t.format&&t.format.indexOf(\"png\")>-1)return Object(request[\"default\"])(this.parsedUrl.path+\"/exportImage\",{responseType:\"image\",query:this._getQueryParams({f:\"image\",...e.imageServiceParameters}),signal:i}).then((e=>({imageElement:e.data,params:t})));const s=this._initJobHandler(),n=Object(request[\"default\"])(this.parsedUrl.path+\"/exportImage\",{responseType:\"array-buffer\",query:this._getQueryParams({f:\"image\",...e.imageServiceParameters}),signal:i});return Object(promiseUtils[\"b\" /* all */])([n,s]).then((e=>{const r=e[0].data,s=t.format||\"jpgpng\";let n=s;if(\"bsq\"!==n&&\"bip\"!==n&&(n=Object(RasterCodec[\"b\" /* getFormat */])(r)),!n){throw new Error[\"a\" /* default */](\"imagery-layer:fetch-image\",\"unsupported format signature \"+String.fromCharCode.apply(null,new Uint8Array(r)))}const a=\"gif\"===s||\"bmp\"===s||s.indexOf(\"png\")>-1&&(\"png\"===n||\"jpg\"===n),o={signal:i};return a?Object(RasterCodec[\"a\" /* decode */])(r,{useCanvas:!0,...t},o).then((e=>({pixelData:{pixelBlock:e,extent:t.extent},params:t}))):this._decodePixelBlock(r,{width:t.width,height:t.height,planes:null,pixelType:null,noDataValue:null,format:s},o).then((e=>({pixelData:{pixelBlock:e,extent:t.extent},params:t})))}))}async _generateRasterInfo(e,t){const{data:r}=await Object(request[\"default\"])(this.parsedUrl.path,{query:this._getQueryParams({renderingRule:e}),...t});return await this._fetchAuxiliaryRasterInfo({serviceInfo:r,renderingRule:e,...t})}_isValidCustomizedMosaicRule(e){return e&&JSON.stringify(e.toJSON())!==JSON.stringify(this._defaultServiceMosaicRule&&this._defaultServiceMosaicRule.toJSON())}_updateMultidimensionalDefinition(e){if(this._isValidCustomizedMosaicRule(this.mosaicRule))return;const t=e.variables[0].dimensions,r=[];for(const e in t)if(t.hasOwnProperty(e)){const i=t[e],s=i.extent;let n=!0,a=[s[0]];i.hasRanges&&!0===i.hasRanges?(n=!1,a=[i.values[0]]):\"stdz\"===i.name.toLowerCase()&&Math.abs(s[1])<=Math.abs(s[0])&&(a=[s[1]]),r.push(new DimensionalDefinition[\"a\" /* default */]({variableName:\"\",dimensionName:t[e].name,isSlice:n,values:a}))}if(r.length>0){this.mosaicRule=this.mosaicRule||new MosaicRule;const e=this.mosaicRule.multidimensionalDefinition;(!e||e&&e.length<=0)&&(this.mosaicRule.multidimensionalDefinition=r)}}_formatAttributeValue(e,t){if(\"string\"==typeof e){const r=this.popupTemplate&&this.popupTemplate.fieldInfos,i=this._getFieldInfo(r,t),s=i&&i.format;if(s){let t,r;return e.trim().indexOf(\",\")>-1?(t=\",\",r=t+\" \",this._formatDelimitedString(e,t,r,s)):e.trim().indexOf(\" \")>-1?(t=r=\" \",this._formatDelimitedString(e,t,r,s)):this._formatNumberFromString(e,s)}}return e}_getFieldInfo(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let i;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r&&e.fieldName.toLowerCase()!==r.replace(/ /g,\"_\"))&&(i=e,!0))),i}_formatDelimitedString(e,t,r,i){return e&&t&&r&&i?e.trim().split(t).map((e=>this._formatNumberFromString(e,i))).join(r):e}_formatNumberFromString(e,t){if(!e||!t)return e;const r=Number(e);return isNaN(r)?e:t.format(r)}_processVisibleRastersResponse(e,t){t=t||{};const r=e.value,{templateRRFunctionNames:s,showNoDataRecords:n,returnDomainValues:a,templateFields:o}=t,l=e.processedValues;let u=e.catalogItems&&e.catalogItems.features,p=e.properties&&e.properties.Values&&e.properties.Values.map((e=>e.replace(/ /gi,\", \")))||[];const c=this.objectIdField||\"ObjectId\",d=\"string\"==typeof r&&r.toLowerCase().indexOf(\"nodata\")>-1,m=[];if(r&&!u&&!d){const e={};e[c]=0;p=[r],u=[new Graphic[\"a\" /* default */](this.fullExtent,null,e)]}if(!u)return[];let h,f,y;this._updateResponseFieldNames(u,o);for(let e=0;e<u.length;e++){if(h=u[e],null!=r&&!d){if(f=p[e],y=this.renderingRule&&l&&l.length>0&&s&&s.length>0&&s.indexOf(this.renderingRule.functionName)>-1?l[s.indexOf(this.renderingRule.functionName)]:r,\"nodata\"===f.toLowerCase()&&!n)continue;const t=\"Raster.ItemPixelValue\",a=\"Raster.ServicePixelValue\";h.attributes[t]=this._formatAttributeValue(f,t),h.attributes[a]=this._formatAttributeValue(y,a),this._updateFeatureWithMagDirValues(h,f);const o=this.fields&&this.fields.length>0;let u=this.renderingRule&&Object(maybe[\"h\" /* isSome */])(this.serviceRasterInfo)&&this.serviceRasterInfo.attributeTable?o?f:r:y;this.renderingRule||(u=o?f:r),this._updateFeatureWithRasterAttributeTableValues(h,u)}if(h.sourceLayer=this,a&&this._updateFeatureWithDomainValues(h),s&&l&&s.length===l.length)for(let e=0;e<s.length;e++){const t=\"Raster.ServicePixelValue.\"+s[e];h.attributes[t]=this._formatAttributeValue(l[e],t)}m.push(u[e])}return m}_updateFeatureWithRasterAttributeTableValues(e,t){const r=this.rasterInfo&&this.rasterInfo.attributeTable||Object(maybe[\"h\" /* isSome */])(this.serviceRasterInfo)&&this.serviceRasterInfo.attributeTable,s=r&&r.features;if(!s)return;const n=r.fields,a=n.map((e=>e.name)).filter((e=>\"value\"===e.toLowerCase())),o=a&&a[0];if(!o)return;const l=s.filter((e=>e.attributes[o]===(null!=t?parseInt(t,10):null)));l&&l[0]&&n.forEach((t=>{const r=this.rasterAttributeTableFieldPrefix+t.name;e.attributes[r]=this._formatAttributeValue(l[0].attributes[t.name],r)}))}_updateFeatureWithMagDirValues(e,t){if(!this.pixelFilter||\"esriImageServiceDataTypeVector-UV\"!==this.serviceDataType&&\"esriImageServiceDataTypeVector-MagDir\"!==this.serviceDataType)return;const r=t.replace(\" \",\",\").split(\",\").map((e=>parseFloat(e))),i=r.map((e=>[e])),s=r.map((e=>({minValue:e,maxValue:e,noDataValue:null}))),n=new PixelBlock[\"a\" /* default */]({height:1,width:1,pixelType:\"f32\",pixels:i,statistics:s});this.pixelFilter({pixelBlock:n,extent:new Extent[\"a\" /* default */](0,0,0,0,this.spatialReference)}),e.attributes[\"Raster.Magnitude\"]=n.pixels[0][0],e.attributes[\"Raster.Direction\"]=n.pixels[1][0]}_updateFeatureWithDomainValues(e){const t=this.fields&&this.fields.filter((e=>e.domain&&\"coded-value\"===e.domain.type));null!=t&&t.forEach((t=>{const r=e.attributes[t.name];if(null!=r){const i=t.domain.codedValues.filter((e=>e.code===r))[0];i&&(e.attributes[t.name]=i.name)}}))}_updateResponseFieldNames(e,t){if(!t||t.length<1)return;const r=this.fieldsIndex;r&&e.forEach((e=>{if(e&&e.attributes)for(const i of t)if(r.has(i)){const t=r.get(i).name;t!==i&&(e.attributes[i]=e.attributes[t],delete e.attributes[t])}}))}_updateRenderingRulesFunctionName(e,t){if(!e||e.length<1)return;if(\"Raw\"===e)return e.replace(\"Raw\",\"None\");const r=e.toLowerCase().replace(/ /gi,\"_\");return t.has(r)?t.get(r):e}_isRFTJson(e){return e.name&&e.arguments&&e.function&&e.hasOwnProperty(\"functionType\")}_readCapabilities(e){const t=e.capabilities?e.capabilities.toLowerCase().split(\",\").map((e=>e.trim())):[\"image\",\"catalog\"],{currentVersion:r,advancedQueryCapabilities:i,maxRecordCount:s}=e,n=t.indexOf(\"image\")>-1,a=\"esriImageServiceDataTypeElevation\"===e.serviceDataType,o=!!(e.spatialReference||e.extent&&e.extent.spatialReference);return{operations:{supportsComputeHistograms:n,supportsExportImage:n,supportsIdentify:n,supportsMeasure:t.indexOf(\"mensuration\")>-1&&o,supportsDownload:t.indexOf(\"download\")>-1,supportsQuery:t.indexOf(\"catalog\")>-1&&e.fields&&e.fields.length>0,supportsGetSamples:r>=10.2&&n,supportsProject:r>=10.3&&n,supportsComputeStatisticsHistograms:r>=10.4&&n,supportsQueryBoundary:r>=10.6&&n,supportsCalculateVolume:r>=10.7&&a,supportsComputePixelLocation:r>=10.7&&t.indexOf(\"catalog\")>-1},query:{supportsStatistics:!(!i||!i.supportsStatistics),supportsOrderBy:!(!i||!i.supportsOrderBy),supportsDistinct:!(!i||!i.supportsDistinct),supportsPagination:!(!i||!i.supportsPagination),supportsStandardizedQueriesOnly:!(!i||!i.useStandardizedQueries),maxRecordCount:s}}}};return Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"_functionRasterInfos\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"_rasterJobHandler\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"_symbolizer\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"_defaultServiceMosaicRule\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"_defaultServiceMosaicRule\",[\"defaultMosaicMethod\"])],a.prototype,\"readDefaultServiceMosaicRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"_cachedRendererJson\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"rasterAttributeTableFieldPrefix\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"rasterFunctionInfos\"]})],a.prototype,\"rasterFunctionNamesIndex\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"url\"]})],a.prototype,\"queryTask\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"adjustAspectRatio\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0}),Object(aliasOf[\"a\" /* aliasOf */])(\"serviceRasterInfo.bandCount\")],a.prototype,\"bandCount\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[ensureType[\"a\" /* Integer */]],json:{write:!0}})],a.prototype,\"bandIds\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"bandIds\")],a.prototype,\"readBandIds\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,json:{read:!1}})],a.prototype,\"capabilities\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"service\",\"capabilities\",[\"capabilities\",\"currentVersion\",\"serviceDataType\"])],a.prototype,\"readCapabilities\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Number})],a.prototype,\"compressionQuality\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"compressionQuality\")],a.prototype,\"writeCompressionQuality\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Number})],a.prototype,\"compressionTolerance\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"compressionTolerance\")],a.prototype,\"writeCompressionTolerance\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"copyrightText\"}}})],a.prototype,\"copyright\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{read:{source:\"layerDefinition.definitionExpression\"},write:{target:\"layerDefinition.definitionExpression\"}}})],a.prototype,\"definitionExpression\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,constructOnly:!0})],a.prototype,\"exportImageServiceParameters\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"rasterInfo\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,type:[Field[\"a\" /* default */]]})],a.prototype,\"fields\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"fields\"]})],a.prototype,\"fieldsIndex\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[\"png\",\"png8\",\"png24\",\"png32\",\"jpg\",\"bmp\",\"gif\",\"jpgpng\",\"lerc\",\"tiff\"],json:{write:!0}})],a.prototype,\"format\",null),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"service\",\"format\",[\"serviceDataType\"])],a.prototype,\"readFormat\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Extent[\"a\" /* default */]})],a.prototype,\"fullExtent\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0})],a.prototype,\"hasMultidimensions\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"maxImageHeight\"}}})],a.prototype,\"imageMaxHeight\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{read:{source:\"maxImageWidth\"}}})],a.prototype,\"imageMaxWidth\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{type:re.jsonValues,read:re.read,write:re.write}})],a.prototype,\"interpolation\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"minScale\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"service\",\"minScale\")],a.prototype,\"readMinScale\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"maxScale\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"service\",\"maxScale\")],a.prototype,\"readMaxScale\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:MosaicRule})],a.prototype,\"mosaicRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"mosaicRule\",[\"mosaicRule\",\"defaultMosaicMethod\"])],a.prototype,\"readMosaicRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"mosaicRule\")],a.prototype,\"writeMosaicRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0}),Object(aliasOf[\"a\" /* aliasOf */])(\"serviceRasterInfo.multidimensionalInfo\")],a.prototype,\"multidimensionalInfo\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{type:ensureType[\"a\" /* Integer */]}})],a.prototype,\"noData\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"noData\")],a.prototype,\"writeNoData\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,json:{type:ie.jsonValues,read:ie.read,write:ie.write}})],a.prototype,\"noDataInterpretation\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:String,readOnly:!0,json:{read:{source:[\"fields\"]}}})],a.prototype,\"objectIdField\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"objectIdField\")],a.prototype,\"readObjectIdField\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"url\"]})],a.prototype,\"parsedUrl\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0}),Object(aliasOf[\"a\" /* aliasOf */])(\"serviceRasterInfo.pixelSize.x\")],a.prototype,\"pixelSizeX\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0}),Object(aliasOf[\"a\" /* aliasOf */])(\"serviceRasterInfo.pixelSize.y\")],a.prototype,\"pixelSizeY\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Function})],a.prototype,\"pixelFilter\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"raster\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"viewId\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({types:rasterRenderers[\"a\" /* rasterRendererTypes */],json:{name:\"layerDefinition.drawingInfo.renderer\",origins:{\"web-scene\":{types:rasterRenderers[\"c\" /* websceneRasterRendererTypes */],name:\"layerDefinition.drawingInfo.renderer\",write:{overridePolicy:e=>({enabled:e&&\"vector-field\"!==e.type})}}}}})],a.prototype,\"renderer\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"renderer\")],a.prototype,\"readRenderer\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])(commonProperties[\"f\" /* opacityDrawingInfo */])],a.prototype,\"opacity\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0}),Object(aliasOf[\"a\" /* aliasOf */])(\"serviceRasterInfo.attributeTable\")],a.prototype,\"rasterAttributeTable\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"fields\",\"rasterInfo\",\"capabilities\"]})],a.prototype,\"rasterFields\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0})],a.prototype,\"rasterFunctionInfos\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:RasterFunction})],a.prototype,\"renderingRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"renderingRule\",[\"renderingRule\",\"rasterFunctionInfos\"])],a.prototype,\"readRenderingRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"renderingRule\")],a.prototype,\"writeRenderingRule\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"serviceDataType\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,type:SpatialReference[\"a\" /* default */]})],a.prototype,\"spatialReference\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"spatialReference\",[\"spatialReference\",\"extent\"])],a.prototype,\"readSpatialReference\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({json:{type:se.jsonValues}})],a.prototype,\"pixelType\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"pixelType\")],a.prototype,\"readPixelType\",null),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"pixelType\")],a.prototype,\"writePixelType\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({constructOnly:!0,type:RasterInfo[\"a\" /* default */]})],a.prototype,\"serviceRasterInfo\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])()],a.prototype,\"sourceJSON\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])(commonProperties[\"j\" /* url */])],a.prototype,\"url\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0})],a.prototype,\"version\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(reader[\"a\" /* reader */])(\"version\",[\"currentVersion\",\"fields\",\"timeInfo\"])],a.prototype,\"readVersion\",null),a=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layers.mixins.ArcGISImageService\")],a),a};\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/layers/ImageryLayer.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet ImageryLayer_j=class extends(Object(BlendLayer[\"a\" /* BlendLayer */])(Object(TemporalLayer[\"a\" /* TemporalLayer */])(Object(RefreshableLayer[\"a\" /* RefreshableLayer */])(Object(ScaleRangeLayer[\"a\" /* ScaleRangeLayer */])(Object(OperationalLayer[\"a\" /* OperationalLayer */])(Object(PortalLayer[\"a\" /* PortalLayer */])(oe(Object(ArcGISService[\"a\" /* ArcGISService */])(Object(MultiOriginJSONSupport[\"a\" /* MultiOriginJSONMixin */])(Layer[\"a\" /* default */])))))))))){constructor(...e){super(...e),this.legendEnabled=!0,this.isReference=null,this.operationalLayerType=\"ArcGISImageServiceLayer\",this.popupEnabled=!0,this.popupTemplate=null,this.type=\"imagery\"}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const t=Object(maybe[\"h\" /* isSome */])(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Image Service\"]},e).then((()=>this._fetchService(t)),(()=>this._fetchService(t)))),Object(promiseUtils[\"u\" /* resolve */])(this)}writeOperationalLayerType(e,r,t){var o;const i=\"vector-field\"===(null==(o=this.renderer)?void 0:o.type);r[t]=i?\"ArcGISImageServiceVectorLayer\":\"ArcGISImageServiceLayer\"}get defaultPopupTemplate(){return this.createPopupTemplate()}createPopupTemplate(e){const r=this.rasterFields,t=this.title,o=new Set;let i=!1,p=!1;this.capabilities&&(i=this.capabilities.operations.supportsQuery&&this.fields&&this.fields.length>0,p=i&&(\"esriImageServiceDataTypeVector-UV\"===this.serviceDataType||\"esriImageServiceDataTypeVector-MagDir\"===this.serviceDataType));const s=new Set;i&&(s.add(\"raster.itempixelvalue\"),p&&s.add(\"raster.magnitude\").add(\"raster.direction\"));for(const e of r){const r=e.name.toLowerCase();s.has(r)||r.indexOf(\"raster.servicepixelvalue.\")>-1||o.add(e.name)}return Object(popupUtils[\"a\" /* createPopupTemplate */])({fields:r,title:t},{...e,visibleFieldNames:o})}redraw(){this.emit(\"redraw\")}};Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])(commonProperties[\"d\" /* legendEnabled */])],ImageryLayer_j.prototype,\"legendEnabled\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[\"show\",\"hide\"]})],ImageryLayer_j.prototype,\"listMode\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],ImageryLayer_j.prototype,\"isReference\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:[\"ArcGISImageServiceLayer\"],json:{origins:{\"web-map\":{type:[\"ArcGISImageServiceLayer\",\"ArcGISImageServiceVectorLayer\"],read:!1,write:{target:\"layerType\",ignoreOrigin:!0}}}}})],ImageryLayer_j.prototype,\"operationalLayerType\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(writer[\"a\" /* writer */])(\"web-map\",\"operationalLayerType\")],ImageryLayer_j.prototype,\"writeOperationalLayerType\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])(commonProperties[\"g\" /* popupEnabled */])],ImageryLayer_j.prototype,\"popupEnabled\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({type:PopupTemplate[\"a\" /* default */],json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\"}}})],ImageryLayer_j.prototype,\"popupTemplate\",void 0),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,dependsOn:[\"fields\",\"title\"]})],ImageryLayer_j.prototype,\"defaultPopupTemplate\",null),Object(tslib_es6[\"a\" /* _ */])([Object(property[\"b\" /* property */])({readOnly:!0,json:{read:!1}})],ImageryLayer_j.prototype,\"type\",void 0),ImageryLayer_j=Object(tslib_es6[\"a\" /* _ */])([Object(subclass[\"a\" /* subclass */])(\"esri.layers.ImageryLayer\")],ImageryLayer_j);var ImageryLayer_I=ImageryLayer_j;/* harmony default export */ var ImageryLayer = __webpack_exports__[\"default\"] = (ImageryLayer_I);\n\n\n/***/ }),\n\n/***/ \"u3Ia\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return n; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return r; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return e; });\n/* harmony import */ var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"4EHJ\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction n(t,n){let e={query:t};return n&&(e={...n,...e}),e}function e(n){return\"string\"==typeof n?Object(_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_0__[/* urlToObject */ \"I\"])(n):n}function r(t,n,e){const o={};for(const i in t){if(\"declaredClass\"===i)continue;const f=t[i];if(null!=f&&\"function\"!=typeof f)if(Array.isArray(f)){o[i]=[];for(let t=0;t<f.length;t++)o[i][t]=r(f[t])}else if(\"object\"==typeof f)if(f.toJSON){const t=f.toJSON(e&&e[i]);o[i]=n?t:JSON.stringify(t)}else o[i]=n?f:JSON.stringify(f);else o[i]=f}return o}\n\n\n/***/ })\n\n}]);","inputSourceMap":null}