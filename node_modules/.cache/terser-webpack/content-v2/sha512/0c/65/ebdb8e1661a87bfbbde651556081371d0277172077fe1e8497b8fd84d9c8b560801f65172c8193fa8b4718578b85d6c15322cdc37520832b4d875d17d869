{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{\"0BfS\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return a});var i,n=r(\"OIYib\"),o=r(\"UBvB\");function a(e){e.fragment.include(o.a),e.fragment.uniforms.add(\"depthTex\",\"sampler2D\"),e.fragment.uniforms.add(\"shadowMapNum\",\"int\"),e.fragment.uniforms.add(\"shadowMapDistance\",\"vec4\"),e.fragment.uniforms.add(\"shadowMapMatrix\",\"mat4\",4),e.fragment.uniforms.add(\"depthHalfPixelSz\",\"float\"),e.fragment.code.add(n.a`\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      float halfPixelSize = depthHalfPixelSz;\n      vec4 distance = shadowMapDistance;\n      float depth = _linearDepth;\n\n      //choose correct cascade\n      int i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;\n\n      if (i >= shadowMapNum) { return 0.0; }\n\n      mat4 mat = i == 0 ? shadowMapMatrix[0] : i == 1 ? shadowMapMatrix[1] : i == 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];\n\n      vec4 lv = mat * vec4(_vpos, 1.0);\n      lv.xy /= lv.w;\n\n      // vertex completely outside? -> no shadow\n      vec3 lvpos = 0.5 * lv.xyz + vec3(0.5);\n      if (lvpos.z >= 1.0) { return 0.0; }\n      if (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv = vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n\n      float texSize = 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st = fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 = rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, -halfPixelSize))) < lvpos.z ? 1.0 : 0.0;\n      float s10 = rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, -halfPixelSize))) < lvpos.z ? 1.0 : 0.0;\n      float s11 = rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, halfPixelSize))) < lvpos.z ? 1.0 : 0.0;\n      float s01 = rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, halfPixelSize))) < lvpos.z ? 1.0 : 0.0;\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n  `)}(i=a||(a={})).bindUniforms=function(e,t,r){t.shadowMappingEnabled&&(t.shadowMap.bind(e,r),t.shadowMap.bindView(e,t.origin))},i.bindViewCustomOrigin=function(e,t,r){t.shadowMappingEnabled&&t.shadowMap.bindView(e,r)},i.bindView=function(e,t){t.shadowMappingEnabled&&t.shadowMap.bindView(e,t.origin)}},\"0nJL\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return c});var i,n=r(\"srIe\"),o=r(\"Cy1f\"),a=r(\"5DEt\"),s=r(\"OIYib\");function c(e,t){if(t.slicePlaneEnabled){e.extensions.add(\"GL_OES_standard_derivatives\"),t.sliceEnabledForVertexPrograms&&(e.vertex.uniforms.add(\"slicePlaneOrigin\",\"vec3\"),e.vertex.uniforms.add(\"slicePlaneBasis1\",\"vec3\"),e.vertex.uniforms.add(\"slicePlaneBasis2\",\"vec3\")),e.fragment.uniforms.add(\"slicePlaneOrigin\",\"vec3\"),e.fragment.uniforms.add(\"slicePlaneBasis1\",\"vec3\"),e.fragment.uniforms.add(\"slicePlaneBasis2\",\"vec3\");const r=s.a`\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel = pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot = dot(slicePlaneBasis1, rel);\n        float basis2Dot = dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front < 0.0\n          && factors.side0 < 0.0\n          && factors.side1 < 0.0\n          && factors.side2 < 0.0\n          && factors.side3 < 0.0;\n      }\n\n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    `,i=s.a`\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors = calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH = 1.0;\n        const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor = (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    `,n=t.sliceHighlightDisabled?s.a`#define highlightSlice(_color_, _pos_) (_color_)`:s.a`\n        ${i}\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      `;t.sliceEnabledForVertexPrograms&&e.vertex.code.add(r),e.fragment.code.add(r),e.fragment.code.add(n)}else{const r=s.a`\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    `;t.sliceEnabledForVertexPrograms&&e.vertex.code.add(r),e.fragment.code.add(r)}}(i=c||(c={})).bindUniformsWithOrigin=function(e,t,r){i.bindUniforms(e,t,r.slicePlane,r.origin)},i.bindUniforms=function(e,t,r,i){t.slicePlaneEnabled&&(Object(n.h)(r)?(i?(Object(a.g)(l,r.origin,i),e.setUniform3fv(\"slicePlaneOrigin\",l)):e.setUniform3fv(\"slicePlaneOrigin\",r.origin),e.setUniform3fv(\"slicePlaneBasis1\",r.basis1),e.setUniform3fv(\"slicePlaneBasis2\",r.basis2)):(e.setUniform3fv(\"slicePlaneBasis1\",o.b),e.setUniform3fv(\"slicePlaneBasis2\",o.b),e.setUniform3fv(\"slicePlaneOrigin\",o.b)))};const l=Object(o.e)()},\"1TnO\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return c});var i,n=r(\"Cy1f\"),o=r(\"OIYib\"),a=r(\"mmTy\"),s=r(\"aiF/\");function c(e,t){t.instanced&&t.instancedDoublePrecision&&(e.attributes.add(\"modelOriginHi\",\"vec3\"),e.attributes.add(\"modelOriginLo\",\"vec3\"),e.attributes.add(\"model\",\"mat3\"),e.attributes.add(\"modelNormal\",\"mat3\")),t.instancedDoublePrecision&&(e.vertex.include(s.a,t),e.vertex.uniforms.add(\"viewOriginHi\",\"vec3\"),e.vertex.uniforms.add(\"viewOriginLo\",\"vec3\"));const r=[o.a`\n    vec3 calculateVPos() {\n      ${t.instancedDoublePrecision?\"return model * localPosition().xyz;\":\"return localPosition().xyz;\"}\n    }\n    `,o.a`\n    vec3 subtractOrigin(vec3 _pos) {\n      ${t.instancedDoublePrecision?o.a`\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;`:\"return vpos;\"}\n    }\n    `,o.a`\n    vec3 dpNormal(vec4 _normal) {\n      ${t.instancedDoublePrecision?\"return normalize(modelNormal * _normal.xyz);\":\"return normalize(_normal.xyz);\"}\n    }\n    `,o.a`\n    vec3 dpNormalView(vec4 _normal) {\n      ${t.instancedDoublePrecision?\"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);\":\"return normalize((viewNormal * _normal).xyz);\"}\n    }\n    `,t.vertexTangets?o.a`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${t.instancedDoublePrecision?\"return vec4(modelNormal * _tangent.xyz, _tangent.w);\":\"return _tangent;\"}\n\n    }\n    `:o.a``];e.vertex.code.add(r[0]),e.vertex.code.add(r[1]),e.vertex.code.add(r[2]),2===t.output&&e.vertex.code.add(r[3]),e.vertex.code.add(r[4])}(i=c||(c={})).Uniforms=class{},i.bindCustomOrigin=function(e,t){Object(a.b)(t,l,u,3),e.setUniform3fv(\"viewOriginHi\",l),e.setUniform3fv(\"viewOriginLo\",u)};const l=Object(n.e)(),u=Object(n.e)()},\"1W42\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n}),r(\"wSAH\");var i=r(\"OIYib\");function n(e,t){i.a`\n  /*\n  *  ${t.name}\n  *  ${0===t.output?\"RenderOutput: Color\":1===t.output?\"RenderOutput: Depth\":3===t.output?\"RenderOutput: Shadow\":2===t.output?\"RenderOutput: Normal\":4===t.output?\"RenderOutput: Highlight\":\"\"}\n  */\n  `}},\"368d\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e,t){1===t.attributeTextureCoordinates&&(e.attributes.add(\"uv0\",\"vec2\"),e.varyings.add(\"vuv0\",\"vec2\"),e.vertex.code.add(i.a`\n      void forwardTextureCoordinates() {\n        vuv0 = uv0;\n      }\n    `)),2===t.attributeTextureCoordinates&&(e.attributes.add(\"uv0\",\"vec2\"),e.varyings.add(\"vuv0\",\"vec2\"),e.attributes.add(\"uvRegion\",\"vec4\"),e.varyings.add(\"vuvRegion\",\"vec4\"),e.vertex.code.add(i.a`\n      void forwardTextureCoordinates() {\n        vuv0 = uv0;\n        vuvRegion = uvRegion;\n      }\n    `)),0===t.attributeTextureCoordinates&&e.vertex.code.add(i.a`\n      void forwardTextureCoordinates() {}\n    `)}},\"69UF\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return a}),r.d(t,\"b\",function(){return n}),r.d(t,\"c\",function(){return o});var i=r(\"OIYib\");const n=.1,o=.001;function a(e,t){const r=e.fragment;switch(t.alphaDiscardMode){case 0:r.code.add(i.a`\n        #define discardOrAdjustAlpha(color) { if (color.a < ${i.a.float(.001)}) { discard; } }\n      `);break;case 1:r.code.add(i.a`\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a = 1.0;\n        }\n      `);break;case 2:r.uniforms.add(\"textureAlphaCutoff\",\"float\"),r.code.add(i.a`\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }\n      `);break;case 3:e.fragment.uniforms.add(\"textureAlphaCutoff\",\"float\"),e.fragment.code.add(i.a`\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }\n      `)}}},\"6kvK\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return u});var i=r(\"OIYib\"),n=r(\"xRv2\"),o=r(\"0BfS\"),a=r(\"XV/G\"),s=r(\"cIib\");function c(e,t){const r=e.fragment,n=void 0!==t.lightingSphericalHarmonicsOrder?t.lightingSphericalHarmonicsOrder:2;0===n?(r.uniforms.add(\"lightingAmbientSH0\",\"vec3\"),r.code.add(i.a`\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight = 0.282095 * lightingAmbientSH0;\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    `)):1===n?(r.uniforms.add(\"lightingAmbientSH_R\",\"vec4\"),r.uniforms.add(\"lightingAmbientSH_G\",\"vec4\"),r.uniforms.add(\"lightingAmbientSH_B\",\"vec4\"),r.code.add(i.a`\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec4 sh0 = vec4(\n          0.282095,\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y\n        );\n        vec3 ambientLight = vec3(\n          dot(lightingAmbientSH_R, sh0),\n          dot(lightingAmbientSH_G, sh0),\n          dot(lightingAmbientSH_B, sh0)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    `)):2===n&&(r.uniforms.add(\"lightingAmbientSH0\",\"vec3\"),r.uniforms.add(\"lightingAmbientSH_R1\",\"vec4\"),r.uniforms.add(\"lightingAmbientSH_G1\",\"vec4\"),r.uniforms.add(\"lightingAmbientSH_B1\",\"vec4\"),r.uniforms.add(\"lightingAmbientSH_R2\",\"vec4\"),r.uniforms.add(\"lightingAmbientSH_G2\",\"vec4\"),r.uniforms.add(\"lightingAmbientSH_B2\",\"vec4\"),r.code.add(i.a`\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight = 0.282095 * lightingAmbientSH0;\n\n        vec4 sh1 = vec4(\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y,\n          1.092548 * normal.x * normal.y\n        );\n        vec4 sh2 = vec4(\n          1.092548 * normal.y * normal.z,\n          0.315392 * (3.0 * normal.z * normal.z - 1.0),\n          1.092548 * normal.x * normal.z,\n          0.546274 * (normal.x * normal.x - normal.y * normal.y)\n        );\n        ambientLight += vec3(\n          dot(lightingAmbientSH_R1, sh1),\n          dot(lightingAmbientSH_G1, sh1),\n          dot(lightingAmbientSH_B1, sh1)\n        );\n        ambientLight += vec3(\n          dot(lightingAmbientSH_R2, sh2),\n          dot(lightingAmbientSH_G2, sh2),\n          dot(lightingAmbientSH_B2, sh2)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    `),1!==t.pbrMode&&2!==t.pbrMode||r.code.add(i.a`\n        const vec3 skyTransmittance = vec3(0.9, 0.9, 1.0);\n\n        vec3 calculateAmbientRadiance(float ambientOcclusion)\n        {\n          vec3 ambientLight = 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;\n          return ambientLight *= (1.0 - ambientOcclusion) * skyTransmittance;\n        }\n      `))}function l(e){const t=e.fragment;t.uniforms.add(\"lightingMainDirection\",\"vec3\"),t.uniforms.add(\"lightingMainIntensity\",\"vec3\"),t.uniforms.add(\"lightingFixedFactor\",\"float\"),t.code.add(i.a`\n    vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {\n      float dotVal = clamp(-dot(normal_global, lightingMainDirection), 0.0, 1.0);\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal = mix(dotVal, 1.0, lightingFixedFactor);\n\n      return lightingMainIntensity * ((1.0 - shadowing) * dotVal);\n    }\n  `)}function u(e,t){const r=e.fragment;e.include(l),e.include(s.a,t),0!==t.pbrMode&&e.include(a.a,t),e.include(c,t),t.receiveShadows&&e.include(o.a,t),r.uniforms.add(\"lightingGlobalFactor\",\"float\"),r.uniforms.add(\"ambientBoostFactor\",\"float\"),e.include(n.a),r.code.add(i.a`\n    const float GAMMA_SRGB = 2.1;\n    const float INV_GAMMA_SRGB = 0.4761904;\n    ${0===t.pbrMode?\"\":\"const vec3 GROUND_REFLECTANCE = vec3(0.2);\"}\n  `),t.useOldSceneLightInterface?r.code.add(i.a`\n    vec3 evaluateSceneLightingExt(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight) {\n      // evaluate the main light\n      #if defined(TREE_RENDERING)\n        // Special case for tree rendering:\n        // We shift the Lambert lobe to the back, allowing it to reach part of the hemisphere\n        // facing away from the light. The idea is to get an effect where light is transmitted\n        // through the tree.\n        float minDot = -0.5;\n        float dotRange = 1.0 - minDot;\n        float dotNormalization = 0.66; // guessed & hand tweaked value, for an exact value we could precompute an integral over the sphere\n\n        float dotVal = dotNormalization * (clamp(-dot(normal, lightingMainDirection), 1.0 - dotRange, 1.0) - minDot) * (1.0 / dotRange);\n      #else\n        float dotVal = clamp(-dot(normal, lightingMainDirection), 0.0, 1.0);\n      #endif\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal = mix(dotVal, 1.0, lightingFixedFactor);\n\n      vec3 mainLight = (1.0 - shadow) * lightingMainIntensity * dotVal;\n      vec3 ambientLight = calculateAmbientIrradiance(normal, ssao);\n\n      // inverse gamma correction on the albedo color\n      vec3 albedoGammaC = pow(albedo, vec3(GAMMA_SRGB));\n\n      // physically correct BRDF normalizes by PI\n      vec3 totalLight = mainLight + ambientLight + additionalLight;\n      totalLight = min(totalLight, vec3(PI));\n      vec3 outColor = vec3((albedoGammaC / PI) * (totalLight));\n\n      // apply gamma correction to the computed color\n      outColor = pow(outColor, vec3(INV_GAMMA_SRGB));\n\n      return outColor;\n    }\n  `):(r.code.add(1===t.viewingMode?i.a`\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        vec3 shadingNormalWorld = normalize(vPosWorld);\n        float vndl = -dot(shadingNormalWorld, lightingMainDirection);\n\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    `:i.a`\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        float vndl = -dot(vec3(0.0, 0.0, 1.0), lightingMainDirection);\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    `),r.code.add(i.a`\n      vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\n        float additionalAmbientScale = _oldHeuristicLighting(vPosWorld);\n        return (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n      }\n    `),0===t.pbrMode||4===t.pbrMode?r.code.add(i.a`\n      vec3 evaluateSceneLighting(vec3 normalWorld, vec3 baseColor, float mainLightShadow, float ambientOcclusion, vec3 additionalLight)\n      {\n        vec3 mainLighting = evaluateMainLighting(normalWorld, mainLightShadow);\n        vec3 ambientLighting = calculateAmbientIrradiance(normalWorld, ambientOcclusion);\n        // inverse gamma correction on the base color\n        vec3 baseColorLinear = pow(baseColor, vec3(GAMMA_SRGB));\n\n        // physically correct BRDF normalizes by PI\n        vec3 totalLight = mainLighting + ambientLighting + additionalLight;\n        totalLight = min(totalLight, vec3(PI));\n        vec3 outColor = vec3((baseColorLinear / PI) * totalLight);\n\n        // apply gamma correction to the computed color\n        outColor = pow(outColor, vec3(INV_GAMMA_SRGB));\n\n        return outColor;\n      }\n      `):1!==t.pbrMode&&2!==t.pbrMode||(r.code.add(i.a`\n      const float fillLightIntensity = 0.25;\n      const float horizonLightDiffusion = 0.4;\n      const float additionalAmbientIrradianceFactor = 0.02;\n\n      vec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n      {\n        // Calculate half vector between view and light direction\n        vec3 viewDirection = -viewDir;\n        vec3 mainLightDirection = -lightingMainDirection;\n        vec3 h = normalize(viewDirection + mainLightDirection);\n\n        PBRShadingInfo inputs;\n        inputs.NdotL = clamp(dot(normal, mainLightDirection), 0.001, 1.0);\n        inputs.NdotV = clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\n        inputs.NdotH = clamp(dot(normal, h), 0.0, 1.0);\n        inputs.VdotH = clamp(dot(viewDirection, h), 0.0, 1.0);\n        inputs.NdotNG = clamp(dot(normal, normalGround), -1.0, 1.0);\n        vec3 reflectedView = normalize(reflect(viewDirection, normal));\n        inputs.RdotNG = clamp(dot(reflectedView, normalGround), -1.0, 1.0);\n\n        inputs.albedoLinear = pow(albedo, vec3(GAMMA_SRGB));\n        inputs.ssao = ssao;\n\n        inputs.metalness = mrr[0];\n        inputs.roughness = clamp(mrr[1] * mrr[1], 0.001, 0.99);\n      `),r.code.add(i.a`\n        inputs.f0 = (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\n        inputs.f90 = vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0)); // more accurate then using  f90 = 1.0\n        inputs.diffuseColor = inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);\n      `),r.code.add(i.a`\n        vec3 ambientDir = vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\n        ambientDir = ambientDir != vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\n\n        inputs.NdotAmbDir = abs(dot(normal, ambientDir));\n\n        // Calculate the irradiance components: sun, fill lights and the sky.\n        vec3 mainLightIrradianceComponent  = inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\n        vec3 fillLightsIrradianceComponent = inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\n        // calculateAmbientIrradiance for localView and additionalLight for gloabalView\n        vec3 ambientLightIrradianceComponent = calculateAmbientIrradiance(normal, ssao) + additionalLight;\n\n        // Assemble the overall irradiance of the sky that illuminates the surface\n        inputs.skyIrradianceToSurface    = ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n        // Assemble the overall irradiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky irradiance by the groundReflectance\n        inputs.groundIrradianceToSurface = GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n      `),r.code.add(i.a`\n        vec3 horizonRingDir = inputs.RdotNG * normalGround - reflectedView;\n        vec3 horizonRingH = normalize(viewDirection + horizonRingDir);\n        inputs.NdotH_Horizon = dot(normal, horizonRingH);\n\n        vec3 mainLightRadianceComponent  = normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\n        vec3 horizonLightRadianceComponent = normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\n        vec3 ambientLightRadianceComponent = calculateAmbientRadiance(ssao) + additionalLight; // calculateAmbientRadiance for localView and additionalLight for gloabalView\n\n        // Assemble the overall radiance of the sky that illuminates the surface\n        inputs.skyRadianceToSurface    =  ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\n        // Assemble the overall radiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky radince by the groundReflectance\n        inputs.groundRadianceToSurface = GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\n\n        // Calculate average ambient radiance - this is used int the gamut mapping part to deduce the black level that is soft compressed\n        inputs.averageAmbientRadiance = ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);\n        `),r.code.add(i.a`\n        vec3 reflectedColorComponent = evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent = inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent = pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear = reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ${2===t.pbrMode?i.a`vec3 outColor = pow(max(vec3(0.0), outColorLinear - 0.005 * inputs.averageAmbientRadiance), vec3(INV_GAMMA_SRGB));`:i.a`vec3 outColor = pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));`}\n        return outColor;\n      }\n    `)))}},AxBq:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return P}),r.d(t,\"b\",function(){return A});var i=r(\"OIYib\"),n=r(\"Tbkp\"),o=r(\"aQrP\"),a=r(\"0nJL\"),s=r(\"viRi\"),c=r(\"69UF\"),l=r(\"F7CJ\"),u=r(\"bVvB\"),d=r(\"0BfS\"),f=r(\"vXUg\"),h=r(\"XV/G\"),m=r(\"1TnO\"),p=r(\"368d\"),b=r(\"p9cc\"),g=r(\"F8o4\"),v=r(\"wzLF\"),x=r(\"sJp1\"),O=r(\"bLIi\"),y=r(\"fRF2\"),_=r(\"fiGu\"),w=r(\"DXpj\"),j=r(\"cIib\"),T=r(\"6kvK\"),S=r(\"qrV2\"),M=r(\"1W42\"),C=r(\"NiZE\");function A(e){const t=new o.a,r=t.vertex.code,A=t.fragment.code;return t.include(M.a,{name:\"Default Material Shader\",output:e.output}),t.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\").add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\"),t.include(x.a),t.varyings.add(\"vpos\",\"vec3\"),t.include(s.a,e),t.include(m.a,e),t.include(l.a,e),0!==e.output&&7!==e.output||(t.include(v.a,e),t.include(n.a,{linearDepth:!1}),0===e.normalType&&e.offsetBackfaces&&t.include(g.a),t.include(w.a,e),t.include(y.a,e),e.instancedColor&&t.attributes.add(\"instanceColor\",\"vec4\"),t.varyings.add(\"localvpos\",\"vec3\"),t.include(p.a,e),t.include(f.a,e),t.include(O.a,e),t.include(u.a,e),t.vertex.uniforms.add(\"externalColor\",\"vec4\"),t.varyings.add(\"vcolorExt\",\"vec4\"),r.add(i.a`\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt = externalColor;\n        ${e.instancedColor?\"vcolorExt *= instanceColor;\":\"\"}\n        vcolorExt *= vvColor();\n        vcolorExt *= getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a < ${i.a.float(c.c)}) {\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        }\n        else {\n          vpos = calculateVPos();\n          localvpos = vpos - view[3].xyz;\n          vpos = subtractOrigin(vpos);\n          ${0===e.normalType?i.a`\n          vNormalWorld = dpNormal(vvLocalNormal(normalModel()));`:\"\"}\n          vpos = addVerticalOffset(vpos, localOrigin);\n          ${e.vertexTangets?\"vTangent = dpTransformVertexTangent(tangent);\":\"\"}\n          gl_Position = transformPosition(proj, view, vpos);\n          ${0===e.normalType&&e.offsetBackfaces?\"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);\":\"\"}\n        }\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    `)),7===e.output&&(t.include(a.a,e),t.include(c.a,e),t.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),e.hasColorTexture&&t.fragment.uniforms.add(\"tex\",\"sampler2D\"),t.fragment.include(C.a),A.add(i.a`\n      void main() {\n        discardBySlice(vpos);\n        ${e.hasColorTexture?i.a`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${e.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:i.a`vec4 texColor = vec4(1.0);`}\n        ${e.attributeColor?i.a`\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:i.a`\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        gl_FragColor = vec4(opacity_);\n      }\n    `)),0===e.output&&(t.include(a.a,e),t.include(T.a,e),t.include(j.a,e),t.include(c.a,e),e.receiveShadows&&t.include(d.a,e),t.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"ambient\",\"vec3\").add(\"diffuse\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),e.hasColorTexture&&t.fragment.uniforms.add(\"tex\",\"sampler2D\"),t.include(b.a,e),t.include(h.a,e),t.fragment.include(C.a),t.include(S.a,e),A.add(i.a`\n      void main() {\n        discardBySlice(vpos);\n        ${e.hasColorTexture?i.a`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${e.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:i.a`vec4 texColor = vec4(1.0);`}\n        shadingParams.viewDirection = normalize(vpos - camPos);\n        ${3===e.normalType?i.a`\n        vec3 normal = screenDerivativeNormal(localvpos);`:i.a`\n        shadingParams.normalView = vNormalWorld;\n        vec3 normal = shadingNormal(shadingParams);`}\n        ${1===e.pbrMode?\"applyPBRFactors();\":\"\"}\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ${e.receiveShadows?\"float shadow = readShadowMap(vpos, linearDepth);\":1===e.viewingMode?\"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);\":\"float shadow = 0.0;\"}\n        vec3 matColor = max(ambient, diffuse);\n        ${e.attributeColor?i.a`\n        vec3 albedo_ = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:i.a`\n        vec3 albedo_ = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        ${e.hasNormalTexture?i.a`\n              mat3 tangentSpace = ${e.vertexTangets?\"computeTangentSpace(normal);\":\"computeTangentSpace(normal, vpos, vuv0);\"}\n              vec3 shadedNormal = computeTextureNormal(tangentSpace, vuv0);`:\"vec3 shadedNormal = normal;\"}\n        ${1===e.pbrMode||2===e.pbrMode?1===e.viewingMode?i.a`vec3 normalGround = normalize(vpos + localOrigin);`:i.a`vec3 normalGround = vec3(0.0, 0.0, 1.0);`:i.a``}\n        ${1===e.pbrMode||2===e.pbrMode?i.a`\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor = evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);`:\"vec3 shadedColor = evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\"}\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ${e.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n      }\n    `)),t.include(_.a,e),t}var P=Object.freeze({__proto__:null,build:A})},D6bk:function(e,t,r){\"use strict\";var i=r(\"hTmG\");let n=0;t.a=class{constructor(e,t,r,i,o){this._context=e,this._locations=t,this._layout=r,this._buffers=i,this._indexBuffer=o,this._glName=null,this.id=n++,this._initialized=!1,e.instanceCounter.increment(2,this)}get glName(){return this._glName}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get size(){return Object.keys(this._buffers).reduce((e,t)=>e+this._buffers[t].size,this._indexBuffer?this._indexBuffer.size:0)}get layout(){return this._layout}get locations(){return this._locations}dispose(e=!0){if(!this._context)return;const t=this._context.capabilities.vao;if(t&&this._glName&&(t.deleteVertexArray(this._glName),this._glName=null),this._context.getBoundVAO()===this&&this._context.bindVAO(null),e){for(const e in this._buffers)this._buffers[e].dispose(),delete this._buffers[e];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context.instanceCounter.decrement(2,this),this._context=null}initialize(){if(this._initialized)return;const e=this._context.capabilities.vao;if(e){const t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t}this._initialized=!0}bind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const e=this._buffers,t=!!this._context.capabilities.vao,r=this._layout,n=this._indexBuffer;e||console.error(\"Vertex buffer dictionary is empty!\");const o=this._context.gl;for(const a in e){const t=e[a];t||console.error(\"Vertex buffer is uninitialized!\");const n=r[a];n||console.error(\"Vertex element descriptor is empty!\"),Object(i.a)(this._context,this._locations,t,n)}n&&(t?o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,n.glName):this._context.bindBuffer(n))}unbind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const e=this._buffers,t=this._layout;e||console.error(\"Vertex buffer dictionary is empty!\");for(const n in e){const r=e[n];r||console.error(\"Vertex buffer is uninitialized!\");const o=t[n];Object(i.b)(this._context,this._locations,r,o)}const r=this._indexBuffer;r&&this._context.unbindBuffer(r.bufferType)}}},D8Ta:function(e,t,r){\"use strict\";function i(){return[0,0,0,0]}function n(e,t,r,i){return[e,t,r,i]}function o(e,t){return new Float64Array(e,t,4)}function a(){return n(1,1,1,1)}function s(){return n(1,0,0,0)}function c(){return n(0,1,0,0)}function l(){return n(0,0,1,0)}function u(){return n(0,0,0,1)}r.d(t,\"a\",function(){return i}),r.d(t,\"b\",function(){return n}),r.d(t,\"c\",function(){return o});const d=a(),f=s(),h=c(),m=l(),p=u();Object.freeze({__proto__:null,create:i,clone:function(e){return[e[0],e[1],e[2],e[3]]},fromValues:n,fromArray:function(e){const t=[0,0,0,0],r=Math.min(4,e.length);for(let i=0;i<r;++i)t[i]=e[i];return t},createView:o,zeros:function(){return[0,0,0,0]},ones:a,unitX:s,unitY:c,unitZ:l,unitW:u,ZEROS:[0,0,0,0],ONES:d,UNIT_X:f,UNIT_Y:h,UNIT_Z:m,UNIT_W:p})},DXpj:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return o});var i=r(\"OIYib\"),n=r(\"fLTx\");function o(e,t){const r=e.fragment;r.uniforms.add(\"normalTexture\",\"sampler2D\"),r.uniforms.add(\"normalTextureSize\",\"vec2\"),t.vertexTangets?(e.attributes.add(\"tangent\",\"vec4\"),e.varyings.add(\"vTangent\",\"vec4\"),r.code.add(2===t.doubleSidedMode?i.a`\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness = gl_FrontFacing ? vTangent.w : -vTangent.w;\n        vec3 tangent = normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\n        vec3 bitangent = cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    `:i.a`\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness = vTangent.w;\n        vec3 tangent = normalize(vTangent.xyz);\n        vec3 bitangent = cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    `)):(e.extensions.add(\"GL_OES_standard_derivatives\"),r.code.add(i.a`\n    mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\n\n      vec3 Q1 = dFdx(pos);\n      vec3 Q2 = dFdy(pos);\n\n      vec2 stx = dFdx(st);\n      vec2 sty = dFdy(st);\n\n      float det = stx.t * sty.s - sty.t * stx.s;\n\n      vec3 T = stx.t * Q2 - sty.t * Q1; // compute tangent\n      T = T - normal * dot(normal, T); // orthogonalize tangent\n      T *= inversesqrt(max(dot(T,T), 1.e-10)); // \"soft\" normalize - goes to 0 when T goes to 0\n      vec3 B = sign(det) * cross(normal, T); // assume normal is normalized, B has the same lenght as B\n      return mat3(T, B, normal); // T and B go to 0 when the tangent space is not well defined by the uv coordinates\n    }\n  `)),0!==t.attributeTextureCoordinates&&(e.include(n.a,t),r.code.add(i.a`\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv = uv;\n      ${t.supportsTextureAtlas?\"vtc.size = normalTextureSize;\":\"\"}\n      vec3 rawNormal = textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  `))}},EVMh:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return o}),r.d(t,\"b\",function(){return a}),r.d(t,\"c\",function(){return s}),r.d(t,\"d\",function(){return c}),r.d(t,\"e\",function(){return l}),r(\"OKTS\"),r(\"Cy1f\"),r(\"15Hh\"),r(\"AvGH\");var i=r(\"D8Ta\");r(\"M0lq\"),r(\"dXfX\"),Object(i.a)();class n{constructor(e){this.message=e}toString(){return\"AssertException: \"+this.message}}const o={POSITION:\"position\",NORMAL:\"normal\",UV0:\"uv0\",UVMAPSPACE:\"uvMapSpace\",MEANVERTEXPOSITION:\"meanVertexPosition\",AUXPOS1:\"auxpos1\",AUXPOS2:\"auxpos2\",BOUND1:\"bound1\",BOUND2:\"bound2\",BOUND3:\"bound3\",COLOR:\"color\",SYMBOLCOLOR:\"symbolColor\",SIZE:\"size\",TANGENT:\"tangent\"};function a(e,t){if(!e){t=t||\"assert\";const e=new Error(t);throw e.stack&&console.log(e.stack),new n(t)}}function s(e){return e[function(e){for(const t in e)return t}(e)]}function c(e,t,r,i){e[12]=t,e[13]=r,e[14]=i}function l(e,t=0){let r=0;for(let i=0;i<4;i++)r+=e[t+i]*u[i];return r}const u=[1/256,1/65536,1/16777216,1/4294967296];l(new Uint8ClampedArray([255,255,255,255]))},F7CJ:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return a});var i=r(\"OIYib\"),n=r(\"fFEv\");function o(e){e.vertex.code.add(i.a`\n    float screenSizePerspectiveMinSize(float size, vec4 factor) {\n      float nonZeroSize = 1.0 - step(size, 0.0);\n\n      return (\n        factor.z * (\n          1.0 +\n          // Multiply by nzs ensures if size is 0, then we ignore proportionally scaled padding\n          nonZeroSize *\n          2.0 * factor.w / (\n            size + (1.0 - nonZeroSize) // Adding 1 - nzs ensures we divide either by size, or by 1\n          )\n        )\n      );\n    }\n  `),e.vertex.code.add(i.a`\n    float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\n      return absCosAngle * absCosAngle * absCosAngle;\n    }\n  `),e.vertex.code.add(i.a`\n    vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\n      return vec4(\n        min(params.x / (distanceToCamera - params.y), 1.0),\n        screenSizePerspectiveViewAngleDependentFactor(absCosAngle),\n        params.z,\n        params.w\n      );\n    }\n  `),e.vertex.code.add(i.a`\n    float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\n      return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n    }\n  `),e.vertex.code.add(i.a`\n    float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorFloat(\n        size,\n        screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)\n      );\n    }\n  `),e.vertex.code.add(i.a`\n    vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\n      return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n    }\n  `),e.vertex.code.add(i.a`\n    vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n    }\n  `)}function a(e,t){const r=e.vertex.code;t.verticalOffsetEnabled?(e.vertex.uniforms.add(\"verticalOffset\",\"vec4\"),t.screenSizePerspectiveEnabled&&(e.include(o),e.vertex.uniforms.add(\"screenSizePerspectiveAlignment\",\"vec4\")),r.add(i.a`\n    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);\n      ${1===t.viewingMode?i.a`vec3 worldNormal = normalize(worldPos + localOrigin);`:i.a`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}\n      ${t.screenSizePerspectiveEnabled?i.a`\n          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));\n          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:i.a`\n          float verticalOffsetScreenHeight = verticalOffset.x;`}\n      // Screen sized offset in world space, used for example for line callouts\n      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n      return worldNormal * worldOffset;\n    }\n\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n    }\n    `)):r.add(i.a`\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }\n    `)}(o||(o={})).bindUniforms=function(e,t){if(t.screenSizePerspective){Object(n.a)(t.screenSizePerspective,e,\"screenSizePerspective\");const r=t.screenSizePerspectiveAlignment||t.screenSizePerspective;Object(n.a)(r,e,\"screenSizePerspectiveAlignment\")}},(a||(a={})).bindUniforms=function(e,t,r){if(!t.verticalOffset)return;const i=function(e,t,r,i=s){return i.screenLength=e.screenLength,i.perDistance=Math.tan(.5*t)/(.5*r),i.minWorldLength=e.minWorldLength,i.maxWorldLength=e.maxWorldLength,i}(t.verticalOffset,r.camera.fovY,r.camera.fullViewport[3]);e.setUniform4f(\"verticalOffset\",i.screenLength*(r.camera.pixelRatio||1),i.perDistance,i.minWorldLength,i.maxWorldLength)};const s={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0}},F8o4:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e){e.vertex.code.add(i.a`\n    vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\n      vec3 camToVert = posWorld - camPosWorld;\n\n      bool isBackface = dot(camToVert, normalWorld) > 0.0;\n      if (isBackface) {\n        posClip.z += 0.0000003 * posClip.w;\n      }\n      return posClip;\n    }\n  `)}},NiZE:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return o});var i=r(\"OIYib\");function n(e){e.code.add(i.a`\n    vec4 premultiplyAlpha(vec4 v) {\n      return vec4(v.rgb * v.a, v.a);\n    }\n\n    // Note: the min in the last line has been added to fix an instability in chrome.\n    // See https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/23911\n    // With proper floating point handling, the value could never be >1.\n    vec3 rgb2hsv(vec3 c) {\n      vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n      vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n      vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n      float d = q.x - min(q.w, q.y);\n      float e = 1.0e-10;\n      return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n    }\n\n    vec3 hsv2rgb(vec3 c) {\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n      vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n      return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }\n\n    float rgb2v(vec3 c) {\n      return max(c.x, max(c.y, c.z));\n    }\n  `)}function o(e){e.include(n),e.code.add(i.a`\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed = internalColor * textureColor;\n      vec3 allMixed = internalMixed * externalColor;\n\n      if (mode == ${i.a.int(1)}) {\n        return allMixed;\n      }\n      else if (mode == ${i.a.int(2)}) {\n        return internalMixed;\n      }\n      else if (mode == ${i.a.int(3)}) {\n        return externalColor;\n      }\n      else {\n        // tint (or something invalid)\n        float vIn = rgb2v(internalMixed);\n        vec3 hsvTint = rgb2hsv(externalColor);\n        vec3 hsvOut = vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n        return hsv2rgb(hsvOut);\n      }\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed = internalOpacity * textureOpacity;\n      float allMixed = internalMixed * externalOpacity;\n\n      if (mode == ${i.a.int(2)}) {\n        return internalMixed;\n      }\n      else if (mode == ${i.a.int(3)}) {\n        return externalOpacity;\n      }\n      else {\n        // multiply or tint (or something invalid)\n        return allMixed;\n      }\n    }\n  `)}},OIYib:function(e,t,r){\"use strict\";function i(e,...t){let r=\"\";for(let i=0;i<t.length;i++)r+=e[i]+t[i];return r+=e[e.length-1],r}r.d(t,\"a\",function(){return i}),function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(i||(i={}))},Tbkp:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e,t){e.vertex.code.add(t.linearDepth?i.a`\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye = view * vec4(pos, 1.0);\n      depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    `:i.a`\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    `)}},UBvB:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e){e.code.add(i.a`\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT =\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat = 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS = vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0->1 back to 0->255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  `)}},\"XV/G\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return a});var i=r(\"OIYib\"),n=r(\"xRv2\");function o(e){const t=e.fragment.code;t.add(i.a`\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    `),t.add(i.a`\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    `),t.add(i.a`\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 = 1.0 - RdotNG * RdotNG;\n      float intRadTheta = integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky = 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    `)}function a(e,t){const r=e.fragment.code;e.include(n.a),3===t.pbrMode||4===t.pbrMode?(r.add(i.a`\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent = ${t.useCustomDTRExponentForWater?\"2.2\":\"2.0\"};\n    `),r.add(i.a`\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    `),r.add(i.a`\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 = roughness * roughness;\n      float NdotH2 = NdotH * NdotH;\n      float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    `),r.add(i.a`\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    `),r.add(i.a`\n    vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F = fresnelReflection(props.VdotH, F0, F0Max);\n      float dSun = normalDistributionWater(props.NdotH, roughness);\n      float V = geometricOcclusionKelemen(props.LdotH);\n\n      float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);\n      float strengthSunHaze  = 1.2;\n      float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;\n\n      return ((dSun + dSunHaze) * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    `)):1!==t.pbrMode&&2!==t.pbrMode||(e.include(o),r.add(i.a`\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    `),r.add(i.a`\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a = NdotH * roughness;\n        float b = roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    `),r.add(i.a`\n    const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 = vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r = roughness * c0 + c1;\n        float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    `),r.add(i.a`\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent = specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    `),r.add(i.a`\n    float gamutMapChanel(float x, vec2 p){\n      return (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }`),r.add(i.a`\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x = gamutMapChanel(inColor.x, p) ;\n      outColor.y = gamutMapChanel(inColor.y, p) ;\n      outColor.z = gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    `))}},aQrP:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return o});const i=r(\"6S2I\").a.getLogger(\"esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder\");class n{constructor(){this.includedModules=new Map}include(e,t){this.includedModules.has(e)?this.includedModules.get(e)!==t&&i.error(\"Trying to include shader module multiple times with different sets of options.\"):(this.includedModules.set(e,t),e(this.builder,t))}}class o extends n{constructor(){super(...arguments),this.vertex=new c,this.fragment=new c,this.attributes=new l,this.varyings=new u,this.extensions=new d,this.defines=new f}get builder(){return this}generateSource(e){const t=this.extensions.generateSource(e),r=this.attributes.generateSource(e),i=this.varyings.generateSource(),n=\"vertex\"===e?this.vertex:this.fragment,o=n.uniforms.generateSource(),a=n.code.generateSource(),s=\"vertex\"===e?m:h,c=this.defines.generateSource().concat(n.defines.generateSource());return`\\n${t.join(\"\\n\")}\\n\\n${c.join(\"\\n\")}\\n\\n${s}\\n\\n${o.join(\"\\n\")}\\n\\n${r.join(\"\\n\")}\\n\\n${i.join(\"\\n\")}\\n\\n${a.join(\"\\n\")}`}}class a{constructor(){this._entries=new Array,this._set=new Set}add(e,t,r){const i=`${e}_${t}_${r}`;return this._set.has(i)||(this._entries.push([e,t,r]),this._set.add(i)),this}generateSource(){return this._entries.map(e=>{return`uniform ${e[1]} ${e[0]}${t=e[2],t?`[${t}]`:\"\"};`;var t})}}class s{constructor(){this._entries=new Array}add(e){this._entries.push(e)}generateSource(){return this._entries}}class c extends n{constructor(){super(...arguments),this.uniforms=new a,this.code=new s,this.defines=new f}get builder(){return this}}class l{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(e){return\"fragment\"===e?[]:this._entries.map(e=>`attribute ${e[1]} ${e[0]};`)}}class u{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(){return this._entries.map(e=>`varying ${e[1]} ${e[0]};`)}}class d{constructor(){this._entries=new Set}add(e){this._entries.add(e)}generateSource(e){const t=\"vertex\"===e?d.ALLOWLIST_VERTEX:d.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(e=>t.includes(e)).map(e=>`#extension ${e} : enable`)}}d.ALLOWLIST_FRAGMENT=[\"GL_EXT_shader_texture_lod\",\"GL_OES_standard_derivatives\"],d.ALLOWLIST_VERTEX=[];class f{constructor(){this._entries=new Map}addInt(e,t){const r=t%1==0?t.toFixed(0):t.toString();this._entries.set(e,r)}addFloat(e,t){const r=t%1==0?t.toFixed(1):t.toString();this._entries.set(e,r)}generateSource(){return Array.from(this._entries,([e,t])=>`#define ${e} ${t}`)}}const h=\"#ifdef GL_FRAGMENT_PRECISION_HIGH\\n  precision highp float;\\n  precision highp sampler2D;\\n#else\\n  precision mediump float;\\n  precision mediump sampler2D;\\n#endif\",m=\"precision highp float;\\nprecision highp sampler2D;\"},agdK:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e){e.fragment.uniforms.add(\"depthTex\",\"sampler2D\"),e.fragment.uniforms.add(\"highlightViewportPixelSz\",\"vec4\"),e.fragment.code.add(i.a`\n    void outputHighlight() {\n      vec4 fragCoord = gl_FragCoord;\n\n      float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z > sceneDepth + 5e-7) {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  `)}(n||(n={})).bindOutputHighlight=function(e,t,r){e.bindTexture(r.highlightDepthTexture,5),t.setUniform1i(\"depthTex\",5),t.setUniform4f(\"highlightViewportPixelSz\",0,0,r.inverseViewport[0],r.inverseViewport[1])}},\"aiF/\":function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return b}),r.d(t,\"b\",function(){return g});var i=r(\"wSAH\"),n=r(\"OIYib\"),o=r(\"srIe\"),a=(r(\"OKTS\"),r(\"Cy1f\")),s=r(\"jjdI\"),c=r(\"EVMh\"),l=r(\"fOQB\"),u=r(\"D6bk\"),d=r(\"mmTy\"),f=r(\"0meK\");r(\"bfJE\");class h{constructor(e){this.context=e,this._doublePrecisionRequiresObfuscation=null}get doublePrecisionRequiresObfuscation(){if(Object(o.g)(this._doublePrecisionRequiresObfuscation)){const e=p(this.context,!1),t=p(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==e&&(0===t||e/t>5)}return this._doublePrecisionRequiresObfuscation}}let m=null;function p(e,t){const r=new f.a(e,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),i=l.a.createVertex(e,35044,new Uint16Array([0,0,1,0,0,1,1,1])),n=new u.a(e,{a_pos:0},{geometry:[{name:\"a_pos\",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:i}),o=Object(a.g)(5633261.287538229,2626832.878767164,1434988.0495278358),h=Object(a.g)(5633271.46742708,2626873.6381334523,1434963.231608387),m=function(r,i){const n=new s.a(e,`\\n\\n  precision highp float;\\n\\n  attribute vec2 a_pos;\\n\\n  uniform vec3 u_highA;\\n  uniform vec3 u_lowA;\\n  uniform vec3 u_highB;\\n  uniform vec3 u_lowB;\\n\\n  varying vec4 v_color;\\n\\n  ${t?\"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION\":\"\"}\\n\\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\\n\\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\\n  }\\n\\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\\n  }\\n\\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\\n    vec3 t1 = dpPlusFrc(hiA, hiB);\\n    vec3 e = dpMinusFrc(t1, hiA);\\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\\n    return t1 + t2;\\n  }\\n\\n  #else\\n\\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\\n    vec3 t1 = hiA + hiB;\\n    vec3 e = t1 - hiA;\\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\\n    return t1 + t2;\\n  }\\n\\n  #endif\\n\\n  const float MAX_RGBA_FLOAT =\\n    255.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\\n\\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\\n\\n  vec4 float2rgba(const float value) {\\n    // Make sure value is in the domain we can represent\\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\\n\\n    // Decompose value in 32bit fixed point parts represented as\\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\\n    // by a power of 256 (this removes the bits that are represented in the previous\\n    // component) and then converts the fractional part to 8bits.\\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\\n\\n    // Convert uint8 values (from 0 to 255) to floating point representation for\\n    // the shader\\n    const float toU8AsFloat = 1.0 / 255.0;\\n\\n    return fixedPointU8 * toU8AsFloat;\\n  }\\n\\n  void main() {\\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\\n\\n    v_color = float2rgba(val.z / 25.0);\\n\\n    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\\n  }\\n  `,\"\\n  precision highp float;\\n\\n  varying vec4 v_color;\\n\\n  void main() {\\n    gl_FragColor = v_color;\\n  }\\n  \",{a_pos:0}),o=new Float32Array(6);Object(d.a)(r,o,3);const a=new Float32Array(6);return Object(d.a)(i,a,3),e.bindProgram(n),n.setUniform3f(\"u_highA\",o[0],o[2],o[4]),n.setUniform3f(\"u_lowA\",o[1],o[3],o[5]),n.setUniform3f(\"u_highB\",a[0],a[2],a[4]),n.setUniform3f(\"u_lowB\",a[1],a[3],a[5]),n}(o,h),p=e.getBoundFramebufferObject(),{x:b,y:g,width:v,height:x}=e.getViewport();e.bindFramebuffer(r),e.setViewport(0,0,1,1),e.bindVAO(n),e.drawArrays(5,0,4);const O=new Uint8Array(4);r.readPixels(0,0,1,1,6408,5121,O),m.dispose(),n.dispose(!1),i.dispose(),r.dispose(),e.setViewport(b,g,v,x),e.bindFramebuffer(p);const y=(o[2]-h[2])/25,_=Object(c.e)(O);return Math.abs(y-_)}function b({code:e},t){e.add(t.doublePrecisionRequiresObfuscation?n.a`\n      vec3 dpPlusFrc(vec3 a, vec3 b) {\n        return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n      }\n\n      vec3 dpMinusFrc(vec3 a, vec3 b) {\n        return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n      }\n\n      // based on https://www.thasler.com/blog/blog/glsl-part2-emu\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 = dpPlusFrc(hiA, hiB);\n        vec3 e = dpMinusFrc(t1, hiA);\n        vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n        return t1 + t2;\n      }\n    `:n.a`\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 = hiA + hiB;\n        vec3 e = t1 - hiA;\n        vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n        return t1 + t2;\n      }\n    `)}function g(e){return!!Object(i.a)(\"force-double-precision-obfuscation\")||(t=e,(Object(o.g)(m)||m.context!==t)&&(m=new h(t)),m).doublePrecisionRequiresObfuscation;var t}},bLIi:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return o});var i=r(\"OIYib\");function n(e){e.vertex.code.add(i.a`\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha = 0.0;\n\n      const float maxTint = 85.0;\n      const float maxReplace = 170.0;\n      const float scaleAlpha = 3.0;\n\n      if (symbolColor.a > maxReplace) {\n        colorMixMode = ${i.a.int(1)};\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a > maxTint) {\n        colorMixMode = ${i.a.int(3)};\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a > 0.0) {\n        colorMixMode = ${i.a.int(4)};\n        symbolAlpha = scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode = ${i.a.int(1)};\n        symbolAlpha = 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  `)}function o(e,t){t.symbolColor?(e.include(n),e.attributes.add(\"symbolColor\",\"vec4\"),e.varyings.add(\"colorMixMode\",\"mediump float\")):e.fragment.uniforms.add(\"colorMixMode\",\"int\"),e.vertex.code.add(t.symbolColor?i.a`\n    int symbolColorMixMode;\n\n    vec4 getSymbolColor() {\n      return decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n    }\n\n    void forwardColorMixMode() {\n      colorMixMode = float(symbolColorMixMode) + 0.5;\n    }\n  `:i.a`\n    vec4 getSymbolColor() { return vec4(1.0); }\n    void forwardColorMixMode() {}\n    `)}},bVvB:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e,t){t.attributeColor?(e.attributes.add(\"color\",\"vec4\"),e.varyings.add(\"vColor\",\"vec4\"),e.vertex.code.add(i.a`\n      void forwardVertexColor() { vColor = color; }\n    `),e.vertex.code.add(i.a`\n      void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }\n    `)):e.vertex.code.add(i.a`\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    `)}},cIib:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e,t){const r=e.fragment;t.receiveAmbientOcclusion?(r.uniforms.add(\"ssaoTex\",\"sampler2D\"),r.uniforms.add(\"viewportPixelSz\",\"vec4\"),r.code.add(i.a`\n      float evaluateAmbientOcclusion() {\n        return 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n      }\n\n      float evaluateAmbientOcclusionInverse() {\n        float ssao = texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n        return viewportPixelSz.z < 0.0 ? 1.0 : ssao;\n      }\n    `)):r.code.add(i.a`\n      float evaluateAmbientOcclusion() { return 0.0; } // no occlusion\n      float evaluateAmbientOcclusionInverse() { return 1.0; }\n    `)}},fFEv:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return w}),r.d(t,\"b\",function(){return M}),r.d(t,\"c\",function(){return j}),r.d(t,\"d\",function(){return h}),r.d(t,\"e\",function(){return T}),r.d(t,\"f\",function(){return _});var i=r(\"srIe\"),n=r(\"OKTS\"),o=r(\"Cy1f\"),a=r(\"5DEt\"),s=r(\"QmHG\"),c=r(\"EVMh\"),l=r(\"tiP8\");Object(n.d)(10),Object(n.d)(12),Object(n.d)(70),Object(n.d)(40);const u={scale:0,factor:0,minPixelSize:0,paddingPixels:0},d=Object(s.b)(),f=c.a;function h(e,t,r,i,n,o,a){const s=Object(l.b)(t),u=r.tolerance;if(!s)if(e.boundingInfo)Object(c.b)(\"triangle\"===e.data.primitiveType),p(e.boundingInfo,i,n,u,o,a);else{const t=e.getIndices(f.POSITION),r=e.getAttribute(f.POSITION);v(i,n,0,t.length/3,t,r,void 0,o,a)}}const m=Object(o.e)();function p(e,t,r,n,o,c){const l=function(e,t,r){return Object(a.r)(r,1/(t[0]-e[0]),1/(t[1]-e[1]),1/(t[2]-e[2]))}(t,r,m);if(Object(s.l)(d,e.getBBMin()),Object(s.k)(d,e.getBBMax()),Object(i.h)(o)&&o.applyToAabb(d),function(e,t,r,i){return function(e,t,r,i,n){const o=(e[0]-i-t[0])*r[0],a=(e[3]+i-t[0])*r[0];let s=Math.min(o,a),c=Math.max(o,a);const l=(e[1]-i-t[1])*r[1],u=(e[4]+i-t[1])*r[1];if(c=Math.min(c,Math.max(l,u)),c<0)return!1;if(s=Math.max(s,Math.min(l,u)),s>c)return!1;const d=(e[2]-i-t[2])*r[2],f=(e[5]+i-t[2])*r[2];return c=Math.min(c,Math.max(d,f)),!(c<0)&&(s=Math.max(s,Math.min(d,f)),!(s>c)&&s<1/0)}(e,t,r,i)}(d,t,l,n)){const i=e.getPrimitiveIndices(),a=e.getIndices(),s=e.getPosition(),l=i?i.length:a.length/3;if(l>C){const i=e.getChildren();if(void 0!==i){for(let e=0;e<8;++e)void 0!==i[e]&&p(i[e],t,r,n,o,c);return}}v(t,r,0,l,a,s,i,o,c)}}const b=2**-52,g=Object(o.e)();function v(e,t,r,n,o,a,s,c,l){if(s)return function(e,t,r,n,o,a,s,c,l){const{data:u,offsetIdx:d,strideIdx:f}=a,h=e[0],m=e[1],p=e[2],v=t[0]-h,x=t[1]-m,O=t[2]-p;for(let _=r;_<n;++_){const e=s[_];let t=3*e,r=d+f*o[t++],n=u[r++],a=u[r++],w=u[r];r=d+f*o[t++];let j=u[r++],T=u[r++],S=u[r];r=d+f*o[t];let M=u[r++],C=u[r++],A=u[r];Object(i.h)(c)&&([n,a,w]=c.applyToVertex(n,a,w,_),[j,T,S]=c.applyToVertex(j,T,S,_),[M,C,A]=c.applyToVertex(M,C,A,_));const P=j-n,I=T-a,R=S-w,L=M-n,B=C-a,F=A-w,z=x*F-B*O,D=O*L-F*v,N=v*B-L*x,V=P*z+I*D+R*N;if(Math.abs(V)<=b)continue;const E=h-n,U=m-a,G=p-w,k=E*z+U*D+G*N;if(V>0){if(k<0||k>V)continue}else if(k>0||k<V)continue;const H=U*R-I*G,q=G*P-R*E,W=E*I-P*U,$=v*H+x*q+O*W;if(V>0){if($<0||k+$>V)continue}else if($>0||k+$<V)continue;const X=(L*H+B*q+F*W)/V;X>=0&&l(X,y(P,I,R,L,B,F,g),e)}}(e,t,r,n,o,a,s,c,l);const{data:u,offsetIdx:d,strideIdx:f}=a,h=e[0],m=e[1],p=e[2],v=t[0]-h,x=t[1]-m,O=t[2]-p;for(let _=r,w=3*r;_<n;++_){let e=d+f*o[w++],t=u[e++],r=u[e++],n=u[e];e=d+f*o[w++];let a=u[e++],s=u[e++],j=u[e];e=d+f*o[w++];let T=u[e++],S=u[e++],M=u[e];Object(i.h)(c)&&([t,r,n]=c.applyToVertex(t,r,n,_),[a,s,j]=c.applyToVertex(a,s,j,_),[T,S,M]=c.applyToVertex(T,S,M,_));const C=a-t,A=s-r,P=j-n,I=T-t,R=S-r,L=M-n,B=x*L-R*O,F=O*I-L*v,z=v*R-I*x,D=C*B+A*F+P*z;if(Math.abs(D)<=b)continue;const N=h-t,V=m-r,E=p-n,U=N*B+V*F+E*z;if(D>0){if(U<0||U>D)continue}else if(U>0||U<D)continue;const G=V*P-A*E,k=E*C-P*N,H=N*A-C*V,q=v*G+x*k+O*H;if(D>0){if(q<0||U+q>D)continue}else if(q>0||U+q<D)continue;const W=(I*G+R*k+L*H)/D;W>=0&&l(W,y(C,A,P,I,R,L,g),_)}}const x=Object(o.e)(),O=Object(o.e)();function y(e,t,r,i,n,o,s){return Object(a.r)(x,e,t,r),Object(a.r)(O,i,n,o),Object(a.d)(s,x,O),Object(a.o)(s,s),s}function _(e,t,r,i,o){let a=(r.screenLength||0)*e.pixelRatio;o&&(a=function(e,t,r,i){return function(e,t){return Math.max(Object(n.g)(e*t.scale,e,t.factor),function(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}(e,t))}(e,function(e,t,r){const i=r.parameters,n=r.paddingPixelsOverride;return u.scale=Math.min(i.divisor/(t-i.offset),1),u.factor=function(e){return Math.abs(e*e*e)}(e),u.minPixelSize=i.minPixelSize,u.paddingPixels=n,u}(t,r,i))}(a,i,t,o));const s=a*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return Object(n.e)(s*t,r.minWorldLength||0,null!=r.maxWorldLength?r.maxWorldLength:1/0)}function w(e,t,r){if(!e)return;const i=e.parameters;t.setUniform4f(r,i.divisor,i.offset,i.minPixelSize,e.paddingPixelsOverride)}function j(e,t){const r=t?j(t):{};for(const i in e){let t=e[i];t&&t.forEach&&(t=S(t)),null==t&&i in r||(r[i]=t)}return r}function T(e,t){let r=!1;for(const i in t){const n=t[i];void 0!==n&&(r=!0,e[i]=Array.isArray(n)?n.slice():n)}return r}function S(e){const t=[];return e.forEach(e=>t.push(e)),t}const M={multiply:1,ignore:2,replace:3,tint:4},C=1e3},fLTx:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return a});var i=r(\"OIYib\"),n=r(\"368d\");function o(e){e.extensions.add(\"GL_EXT_shader_texture_lod\"),e.extensions.add(\"GL_OES_standard_derivatives\"),e.fragment.code.add(i.a`\n    #ifndef GL_EXT_shader_texture_lod\n      float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\n        float deltaMaxSqr = max(dot(ddx, ddx), dot(ddy, ddy));\n        return max(0.0, 0.5 * log2(deltaMaxSqr));\n      }\n    #endif\n\n    vec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {\n      //[umin, vmin, umax, vmax]\n      vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;\n      vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;\n\n      // calculate derivative of continuous texture coordinate\n      // to avoid mipmapping artifacts caused by manual wrapping in shader\n      vec2 dUVdx = dFdx(textureCoordinates) * atlasScale;\n      vec2 dUVdy = dFdy(textureCoordinates) * atlasScale;\n\n      #ifdef GL_EXT_shader_texture_lod\n        return texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);\n      #else\n        // use bias to compensate for difference in automatic vs desired mipmap level\n        vec2 dUVdxAuto = dFdx(uvAtlas);\n        vec2 dUVdyAuto = dFdy(uvAtlas);\n        float mipMapLevel = calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);\n        float autoMipMapLevel = calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);\n\n        return texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);\n      #endif\n    }\n  `)}function a(e,t){e.include(n.a,t),e.fragment.code.add(i.a`\n  struct TextureLookupParameter {\n    vec2 uv;\n    ${t.supportsTextureAtlas?\"vec2 size;\":\"\"}\n  } vtc;\n  `),1===t.attributeTextureCoordinates&&e.fragment.code.add(i.a`\n      vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return texture2D(tex, params.uv);\n      }\n    `),2===t.attributeTextureCoordinates&&(e.include(o),e.fragment.code.add(i.a`\n    vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return textureAtlasLookup(tex, params.size, params.uv, vuvRegion);\n      }\n    `))}},fOQB:function(e,t,r){\"use strict\";var i=r(\"ohva\");class n{constructor(e,t,r,i,n){this._context=null,this._glName=null,this._bufferType=void 0,this._usage=35044,this._size=-1,this._indexType=void 0,this.id=o++,e.instanceCounter.increment(1,this),this._context=e,this._bufferType=t,this._usage=r,this._glName=this._context.gl.createBuffer(),i&&this.setData(i,n)}static createIndex(e,t,r,i){return new n(e,34963,t,r,i)}static createVertex(e,t,r){return new n(e,34962,t,r)}get glName(){return this._glName}get size(){return this._size}get usage(){return this._usage}get bufferType(){return this._bufferType}get indexType(){return this._indexType}get byteSize(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}dispose(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(1,this),this._context=null)}setData(e,t){if(!e)return;if(\"number\"==typeof e){if(e<0&&console.error(\"Buffer size cannot be negative!\"),34963===this._bufferType&&t)switch(this._indexType=t,this._size=e,t){case 5123:e*=2;break;case 5125:e*=4}}else{let t=e.byteLength;Object(i.i)(e)&&(t/=2,this._indexType=5123),Object(i.j)(e)&&(t/=4,this._indexType=5125),this._size=t}const r=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this),this._context.gl.bufferData(this._bufferType,e,this._usage),this._context.bindVAO(r)}setSubData(e,t=0,r=0,n){if(!e)return;(t<0||t>=this._size)&&console.error(\"offset is out of range!\");let o=t,a=r,s=n,c=e.byteLength;Object(i.i)(e)&&(c/=2,o*=2,a*=2,s*=2),Object(i.j)(e)&&(c/=4,o*=4,a*=4,s*=4),void 0===n&&(n=c-1),r>=n&&console.error(\"end must be bigger than start!\"),t+r-n>this._size&&console.error(\"An attempt to write beyond the end of the buffer!\");const l=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);const u=this._context.gl,d=ArrayBuffer.isView(e)?e.buffer:e;u.bufferSubData(this._bufferType,o,d.slice(a,s)),this._context.bindVAO(l)}}let o=0;t.a=n},fRF2:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return f});var i,n=r(\"OIYib\"),o=r(\"wzLF\"),a=r(\"Cy1f\"),s=r(\"2uVf\"),c=r(\"r+FG\"),l=r(\"aiF/\"),u=r(\"sJp1\");function d(e,t){e.include(u.a),e.vertex.include(l.a,t),e.varyings.add(\"vPositionWorldCameraRelative\",\"vec3\"),e.varyings.add(\"vPosition_view\",\"vec3\"),e.vertex.uniforms.add(\"uTransform_WorldFromModel_RS\",\"mat3\"),e.vertex.uniforms.add(\"uTransform_WorldFromModel_TH\",\"vec3\"),e.vertex.uniforms.add(\"uTransform_WorldFromModel_TL\",\"vec3\"),e.vertex.uniforms.add(\"uTransform_WorldFromView_TH\",\"vec3\"),e.vertex.uniforms.add(\"uTransform_WorldFromView_TL\",\"vec3\"),e.vertex.uniforms.add(\"uTransform_ViewFromCameraRelative_RS\",\"mat3\"),e.vertex.uniforms.add(\"uTransform_ProjFromView\",\"mat4\"),e.vertex.code.add(n.a`\n    // compute position in world space orientation, but relative to the camera position\n    vec3 positionWorldCameraRelative() {\n      vec3 rotatedModelPosition = uTransform_WorldFromModel_RS * positionModel();\n\n      vec3 transform_CameraRelativeFromModel = dpAdd(\n        uTransform_WorldFromModel_TL,\n        uTransform_WorldFromModel_TH,\n        -uTransform_WorldFromView_TL,\n        -uTransform_WorldFromView_TH\n      );\n\n      return transform_CameraRelativeFromModel + rotatedModelPosition;\n    }\n\n    // position in view space, that is relative to the camera position and orientation\n    vec3 position_view() {\n      return uTransform_ViewFromCameraRelative_RS * positionWorldCameraRelative();\n    }\n\n    // compute gl_Position and forward related varyings to fragment shader\n    void forwardPosition() {\n      vPositionWorldCameraRelative = positionWorldCameraRelative();\n      vPosition_view = position_view();\n      gl_Position = uTransform_ProjFromView * vec4(vPosition_view, 1.0);\n    }\n\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  `),e.fragment.uniforms.add(\"uTransform_WorldFromView_TL\",\"vec3\"),e.fragment.code.add(n.a`\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  `)}function f(e,t){0===t.normalType||1===t.normalType?(e.include(o.a,t),e.varyings.add(\"vNormalWorld\",\"vec3\"),e.varyings.add(\"vNormalView\",\"vec3\"),e.vertex.uniforms.add(\"uTransformNormal_GlobalFromModel\",\"mat3\"),e.vertex.uniforms.add(\"uTransformNormal_ViewFromGlobal\",\"mat3\"),e.vertex.code.add(n.a`\n      void forwardNormal() {\n        vNormalWorld = uTransformNormal_GlobalFromModel * normalModel();\n        vNormalView = uTransformNormal_ViewFromGlobal * vNormalWorld;\n      }\n    `)):2===t.normalType?(e.include(d,t),e.varyings.add(\"vNormalWorld\",\"vec3\"),e.vertex.code.add(n.a`\n    void forwardNormal() {\n      vNormalWorld = ${1===t.viewingMode?n.a`normalize(vPositionWorldCameraRelative);`:n.a`vec3(0.0, 0.0, 1.0);`}\n    }\n    `)):e.vertex.code.add(n.a`\n      void forwardNormal() {}\n    `)}(i=d||(d={})).ModelTransform=class{constructor(){this.worldFromModel_RS=Object(s.a)(),this.worldFromModel_TH=Object(a.e)(),this.worldFromModel_TL=Object(a.e)()}},i.ViewProjectionTransform=class{constructor(){this.worldFromView_TH=Object(a.e)(),this.worldFromView_TL=Object(a.e)(),this.viewFromCameraRelative_RS=Object(s.a)(),this.projFromView=Object(c.b)()}},i.bindModelTransform=function(e,t){e.setUniformMatrix3fv(\"uTransform_WorldFromModel_RS\",t.worldFromModel_RS),e.setUniform3fv(\"uTransform_WorldFromModel_TH\",t.worldFromModel_TH),e.setUniform3fv(\"uTransform_WorldFromModel_TL\",t.worldFromModel_TL)},i.bindViewProjTransform=function(e,t){e.setUniform3fv(\"uTransform_WorldFromView_TH\",t.worldFromView_TH),e.setUniform3fv(\"uTransform_WorldFromView_TL\",t.worldFromView_TL),e.setUniformMatrix4fv(\"uTransform_ProjFromView\",t.projFromView),e.setUniformMatrix3fv(\"uTransform_ViewFromCameraRelative_RS\",t.viewFromCameraRelative_RS)},(f||(f={})).bindUniforms=function(e,t){e.setUniformMatrix4fv(\"viewNormal\",t)}},fiGu:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return m});var i=r(\"OIYib\"),n=r(\"Tbkp\"),o=r(\"0nJL\"),a=r(\"agdK\"),s=r(\"viRi\"),c=r(\"69UF\"),l=r(\"UBvB\");function u(e,t){e.fragment.include(l.a),3===t.output?(e.extensions.add(\"GL_OES_standard_derivatives\"),e.fragment.code.add(i.a`\n      float _calculateFragDepth(const in float depth) {\n        // calc polygon offset\n        const float SLOPE_SCALE = 2.0;\n        const float BIAS = 2.0 * .000015259;    // 1 / (2^16 - 1)\n        float m = max(abs(dFdx(depth)), abs(dFdy(depth)));\n        float result = depth + SLOPE_SCALE * m + BIAS;\n        return clamp(result, .0, .999999);\n      }\n\n      void outputDepth(float _linearDepth) {\n        gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));\n      }\n    `)):1===t.output&&e.fragment.code.add(i.a`\n      void outputDepth(float _linearDepth) {\n        gl_FragColor = float2rgba(_linearDepth);\n      }\n    `)}var d=r(\"368d\"),f=r(\"wzLF\"),h=r(\"fRF2\");function m(e,t){const r=e.vertex.code,l=e.fragment.code;1!==t.output&&3!==t.output||(e.include(n.a,{linearDepth:!0}),e.include(d.a,t),e.include(s.a,t),e.include(u,t),e.include(o.a,t),e.vertex.uniforms.add(\"nearFar\",\"vec2\"),e.varyings.add(\"depth\",\"float\"),t.hasColorTexture&&e.fragment.uniforms.add(\"tex\",\"sampler2D\"),r.add(i.a`\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPositionWithDepth(proj, view, vpos, nearFar, depth);\n        forwardTextureCoordinates();\n      }\n    `),e.include(c.a,t),l.add(i.a`\n      void main(void) {\n        discardBySlice(vpos);\n        ${t.hasColorTexture?i.a`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n        outputDepth(depth);\n      }\n    `)),2===t.output&&(e.include(n.a,{linearDepth:!1}),e.include(f.a,t),e.include(h.a,t),e.include(d.a,t),e.include(s.a,t),t.hasColorTexture&&e.fragment.uniforms.add(\"tex\",\"sampler2D\"),e.vertex.uniforms.add(\"viewNormal\",\"mat4\"),e.varyings.add(\"vPositionView\",\"vec3\"),r.add(i.a`\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        ${0===t.normalType?i.a`\n        vNormalWorld = dpNormalView(vvLocalNormal(normalModel()));`:\"\"}\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    `),e.include(o.a,t),e.include(c.a,t),l.add(i.a`\n      void main() {\n        discardBySlice(vpos);\n        ${t.hasColorTexture?i.a`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n\n        ${3===t.normalType?i.a`\n            vec3 normal = screenDerivativeNormal(vPositionView);`:i.a`\n            vec3 normal = normalize(vNormalWorld);\n            if (gl_FrontFacing == false) normal = -normal;`}\n        gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    `)),4===t.output&&(e.include(n.a,{linearDepth:!1}),e.include(d.a,t),e.include(s.a,t),t.hasColorTexture&&e.fragment.uniforms.add(\"tex\",\"sampler2D\"),r.add(i.a`\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    `),e.include(o.a,t),e.include(c.a,t),e.include(a.a),l.add(i.a`\n      void main() {\n        discardBySlice(vpos);\n        ${t.hasColorTexture?i.a`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n        outputHighlight();\n      }\n    `))}},hTmG:function(e,t,r){\"use strict\";function i(e,t){return e.vertexBuffers[t].size/function(e){return e[0].stride}(e.layout[t])}function n(e,t,r,i,n){const o=e.gl,a=e.capabilities.instancing;e.bindBuffer(r);for(const s of i){const e=t[s.name],r=(n||(0+s.baseInstance?s.baseInstance:0))*s.stride;if(void 0===e&&console.error(`There is no location for vertex attribute '${s.name}' defined.`),s.baseInstance&&!s.divisor&&console.error(`Vertex attribute '${s.name}' uses baseInstanceOffset without divisor.`),s.count<=4)o.vertexAttribPointer(e,s.count,s.type,s.normalized,s.stride,s.offset+r),o.enableVertexAttribArray(e),s.divisor&&s.divisor>0&&a&&a.vertexAttribDivisor(e,s.divisor);else if(9===s.count)for(let t=0;t<3;t++)o.vertexAttribPointer(e+t,3,s.type,s.normalized,s.stride,s.offset+12*t+r),o.enableVertexAttribArray(e+t),s.divisor&&s.divisor>0&&a&&a.vertexAttribDivisor(e+t,s.divisor);else if(16===s.count)for(let t=0;t<4;t++)o.vertexAttribPointer(e+t,4,s.type,s.normalized,s.stride,s.offset+16*t+r),o.enableVertexAttribArray(e+t),s.divisor&&s.divisor>0&&a&&a.vertexAttribDivisor(e+t,s.divisor);else console.error(\"Unsupported vertex attribute element count: \"+s.count)}}function o(e,t,r,i){const n=e.gl,o=e.capabilities.instancing;e.bindBuffer(r);for(const a of i){const e=t[a.name];if(a.count<=4)n.disableVertexAttribArray(e),a.divisor&&a.divisor>0&&o&&o.vertexAttribDivisor(e,0);else if(9===a.count)for(let t=0;t<3;t++)n.disableVertexAttribArray(e+t),a.divisor&&a.divisor>0&&o&&o.vertexAttribDivisor(e+t,0);else if(16===a.count)for(let t=0;t<4;t++)n.disableVertexAttribArray(e+t),a.divisor&&a.divisor>0&&o&&o.vertexAttribDivisor(e+t,0);else console.error(\"Unsupported vertex attribute element count: \"+a.count)}e.unbindBuffer(34962)}r.d(t,\"a\",function(){return n}),r.d(t,\"b\",function(){return o}),r.d(t,\"c\",function(){return i}),r(\"wSAH\"),r(\"srIe\")},jjdI:function(e,t,r){\"use strict\";r(\"wSAH\");var i=r(\"srIe\"),n=[\"layout\",\"centroid\",\"smooth\",\"case\",\"mat2x2\",\"mat2x3\",\"mat2x4\",\"mat3x2\",\"mat3x3\",\"mat3x4\",\"mat4x2\",\"mat4x3\",\"mat4x4\",\"uint\",\"uvec2\",\"uvec3\",\"uvec4\",\"samplerCubeShadow\",\"sampler2DArray\",\"sampler2DArrayShadow\",\"isampler2D\",\"isampler3D\",\"isamplerCube\",\"isampler2DArray\",\"usampler2D\",\"usampler3D\",\"usamplerCube\",\"usampler2DArray\",\"coherent\",\"restrict\",\"readonly\",\"writeonly\",\"resource\",\"atomic_uint\",\"noperspective\",\"patch\",\"sample\",\"subroutine\",\"common\",\"partition\",\"active\",\"filter\",\"image1D\",\"image2D\",\"image3D\",\"imageCube\",\"iimage1D\",\"iimage2D\",\"iimage3D\",\"iimageCube\",\"uimage1D\",\"uimage2D\",\"uimage3D\",\"uimageCube\",\"image1DArray\",\"image2DArray\",\"iimage1DArray\",\"iimage2DArray\",\"uimage1DArray\",\"uimage2DArray\",\"image1DShadow\",\"image2DShadow\",\"image1DArrayShadow\",\"image2DArrayShadow\",\"imageBuffer\",\"iimageBuffer\",\"uimageBuffer\",\"sampler1DArray\",\"sampler1DArrayShadow\",\"isampler1D\",\"isampler1DArray\",\"usampler1D\",\"usampler1DArray\",\"isampler2DRect\",\"usampler2DRect\",\"samplerBuffer\",\"isamplerBuffer\",\"usamplerBuffer\",\"sampler2DMS\",\"isampler2DMS\",\"usampler2DMS\",\"sampler2DMSArray\",\"isampler2DMSArray\",\"usampler2DMSArray\",\"trunc\",\"round\",\"roundEven\",\"isnan\",\"isinf\",\"floatBitsToInt\",\"floatBitsToUint\",\"intBitsToFloat\",\"uintBitsToFloat\",\"packSnorm2x16\",\"unpackSnorm2x16\",\"packUnorm2x16\",\"unpackUnorm2x16\",\"packHalf2x16\",\"unpackHalf2x16\",\"outerProduct\",\"transpose\",\"determinant\",\"inverse\",\"texture\",\"textureSize\",\"textureProj\",\"textureLod\",\"textureOffset\",\"texelFetch\",\"texelFetchOffset\",\"textureProjOffset\",\"textureLodOffset\",\"textureProjLod\",\"textureProjLodOffset\",\"textureGrad\",\"textureGradOffset\",\"textureProjGrad\",\"textureProjGradOffset\"],o=r(\"n4uK\"),a=[\"block-comment\",\"line-comment\",\"preprocessor\",\"operator\",\"integer\",\"float\",\"ident\",\"builtin\",\"keyword\",\"whitespace\",\"eof\",\"integer\"];const s=[\"GL_OES_standard_derivatives\",\"GL_EXT_frag_depth\",\"GL_EXT_draw_buffers\",\"GL_EXT_shader_texture_lod\"];function c(e,t){for(let r=t-1;r>=0;r--){const t=e[r];if(\"whitespace\"!==t.type&&\"block-comment\"!==t.type){if(\"keyword\"!==t.type)break;if(\"attribute\"===t.data||\"in\"===t.data)return!0}}return!1}function l(e,t,r,i){i=i||r;for(const n of e)if(\"ident\"===n.type&&n.data===r)return i in t?t[i]++:t[i]=0,l(e,t,i+\"_\"+t[i],i);return r}function u(e,t,r=\"afterVersion\"){function i(e,t){for(let r=t;r<e.length;r++){const t=e[r];if(\"operator\"===t.type&&\";\"===t.data)return r}return null}const n={data:\"\\n\",type:\"whitespace\"},o=t=>t<e.length&&/[^\\r\\n]$/.test(e[t].data);let a=function(e){let t=-1,n=0,o=-1;for(let a=0;a<e.length;a++){const s=e[a];if(\"preprocessor\"===s.type&&(s.data.match(/\\#(if|ifdef|ifndef)\\s+.+/)?++n:s.data.match(/\\#endif\\s*.*/)&&--n),\"afterVersion\"!==r&&\"afterPrecision\"!==r||\"preprocessor\"===s.type&&/^#version/.test(s.data)&&(o=Math.max(o,a)),\"afterPrecision\"===r&&\"keyword\"===s.type&&\"precision\"===s.data){const t=i(e,a);if(null===t)throw new Error(\"precision statement not followed by any semicolons!\");o=Math.max(o,t)}t<o&&0===n&&(t=a)}return t+1}(e);o(a-1)&&e.splice(a++,0,n);for(const s of t)e.splice(a++,0,s);o(a-1)&&o(a)&&e.splice(a,0,n)}function d(e,t,r,i=\"lowp\"){u(e,[{type:\"keyword\",data:\"out\"},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:i},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:r},{type:\"whitespace\",data:\" \"},{type:\"ident\",data:t},{type:\"operator\",data:\";\"}],\"afterPrecision\")}function f(e,t,r,i,n=\"lowp\"){u(e,[{type:\"keyword\",data:\"layout\"},{type:\"operator\",data:\"(\"},{type:\"keyword\",data:\"location\"},{type:\"whitespace\",data:\" \"},{type:\"operator\",data:\"=\"},{type:\"whitespace\",data:\" \"},{type:\"integer\",data:i.toString()},{type:\"operator\",data:\")\"},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:\"out\"},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:n},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:r},{type:\"whitespace\",data:\" \"},{type:\"ident\",data:t},{type:\"operator\",data:\";\"}],\"afterPrecision\")}function h(e,t){let r,i,n=-1;for(let o=t;o<e.length;o++){const t=e[o];if(\"operator\"===t.type&&(\"[\"===t.data&&(r=o),\"]\"===t.data)){i=o;break}\"integer\"===t.type&&(n=parseInt(t.data,10))}return r&&i&&e.splice(r,i-r+1),n}class m{constructor(e,t,r,i,n={}){if(this._context=null,this._glName=null,this._locations={},this.id=b++,this._initialized=!1,this._vShader=null,this._fShader=null,this._defines={},this._nameToUniformLocation={},this._nameToAttribLocation={},this._nameToUniform1={},this._nameToUniform1v={},this._nameToUniform2={},this._nameToUniform3={},this._nameToUniform4={},this._nameToUniformMatrix3={},this._nameToUniformMatrix4={},e||console.error(\"RenderingContext isn't initialized!\"),0===t.length&&console.error(\"Shaders source should not be empty!\"),e.instanceCounter.increment(3,this),this._context=e,this._vertexShaderSource=t,this._fragmentShaderSource=r,Array.isArray(n))for(const o of n)this._defines[o]=\"1\";else this._defines=n;this._locations=i}get glName(){return this._glName}get locations(){return this._locations}getDefine(e){return this._defines[e]}dispose(){if(!this._context)return;const e=this._context.gl;this._vShader&&(e.deleteShader(this._vShader),this._vShader=null),this._fShader&&(e.deleteShader(this._fShader),this._fShader=null),this._glName&&(e.deleteProgram(this._glName),this._glName=null),this._context.instanceCounter.decrement(3,this),this._context=null}initialize(){if(this._initialized)return;this._vShader=this._loadShader(35633),this._fShader=this._loadShader(35632),this._vShader&&this._fShader||console.error(\"Error loading shaders!\");const e=this._context.gl,t=e.createProgram();e.attachShader(t,this._vShader),e.attachShader(t,this._fShader);for(const r in this._locations)e.bindAttribLocation(t,this._locations[r],r);e.linkProgram(t),this._glName=t,this._initialized=!0}getUniformLocation(e){return this.initialize(),void 0===this._nameToUniformLocation[e]&&(this._nameToUniformLocation[e]=this._context.gl.getUniformLocation(this._glName,e)),this._nameToUniformLocation[e]}hasUniform(e){return null!==this.getUniformLocation(e)}getAttribLocation(e){return this.initialize(),void 0===this._nameToAttribLocation[e]&&(this._nameToAttribLocation[e]=this._context.gl.getAttribLocation(this._glName,e)),this._nameToAttribLocation[e]}setUniform1i(e,t){const r=this._nameToUniform1[e];void 0!==r&&t===r||(this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(e),t),this._nameToUniform1[e]=t)}setUniform1iv(e,t){const r=this._nameToUniform1v[e];p(r,t)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(e),t),void 0===r?this._nameToUniform1v[e]=m._arrayCopy(t):m._arrayAssign(t,r))}setUniform2iv(e,t){const r=this._nameToUniform2[e];p(r,t)&&(this._context.bindProgram(this),this._context.gl.uniform2iv(this.getUniformLocation(e),t),void 0===r?this._nameToUniform2[e]=m._arrayCopy(t):m._arrayAssign(t,r))}setUniform3iv(e,t){const r=this._nameToUniform3[e];p(r,t)&&(this._context.bindProgram(this),this._context.gl.uniform3iv(this.getUniformLocation(e),t),void 0===r?this._nameToUniform3[e]=m._arrayCopy(t):m._arrayAssign(t,r))}setUniform4iv(e,t){const r=this._nameToUniform4[e];p(r,t)&&(this._context.bindProgram(this),this._context.gl.uniform4iv(this.getUniformLocation(e),t),void 0===r?this._nameToUniform4[e]=m._arrayCopy(t):m._arrayAssign(t,r))}setUniform1f(e,t){const r=this._nameToUniform1[e];void 0!==r&&t===r||(this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(e),t),this._nameToUniform1[e]=t)}setUniform1fv(e,t){const r=this._nameToUniform1v[e];p(r,t)&&(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(e),t),void 0===r?this._nameToUniform1v[e]=m._arrayCopy(t):m._arrayAssign(t,r))}setUniform2f(e,t,r){const i=this._nameToUniform2[e];void 0!==i&&t===i[0]&&r===i[1]||(this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(e),t,r),void 0===i?this._nameToUniform2[e]=[t,r]:(i[0]=t,i[1]=r))}setUniform2fv(e,t){const r=this._nameToUniform2[e];p(r,t)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(e),t),void 0===r?this._nameToUniform2[e]=m._arrayCopy(t):m._arrayAssign(t,r))}setUniform3f(e,t,r,i){const n=this._nameToUniform3[e];void 0!==n&&t===n[0]&&r===n[1]&&i===n[2]||(this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(e),t,r,i),void 0===n?this._nameToUniform3[e]=[t,r,i]:(n[0]=t,n[1]=r,n[2]=i))}setUniform3fv(e,t){const r=this._nameToUniform3[e];p(r,t)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(e),t),void 0===r?this._nameToUniform3[e]=m._arrayCopy(t):m._arrayAssign(t,r))}setUniform4f(e,t,r,i,n){const o=this._nameToUniform4[e];void 0!==o&&t===o[0]&&r===o[1]&&i===o[2]&&n===o[3]||(this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(e),t,r,i,n),void 0===o?this._nameToUniform4[e]=[t,r,i,n]:(o[0]=t,o[1]=r,o[2]=i,o[3]=n))}setUniform4fv(e,t){const r=this._nameToUniform4[e];p(r,t)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(e),t),void 0===r?this._nameToUniform4[e]=m._arrayCopy(t):m._arrayAssign(t,r))}setUniformMatrix3fv(e,t,r=!1){const n=this._nameToUniformMatrix3[e];(function(e,t){return!!Object(i.g)(e)||(9!==e.length?p(e,t):9!==e.length||e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]||e[6]!==t[6]||e[7]!==t[7]||e[8]!==t[8])})(n,t)&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(e),r,t),void 0===n?this._nameToUniformMatrix3[e]=m._arrayCopy(t):m._arrayAssign(t,n))}setUniformMatrix4fv(e,t,r=!1){const n=this._nameToUniformMatrix4[e];(function(e,t){return!!Object(i.g)(e)||(16!==e.length?p(e,t):16!==e.length||e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]||e[6]!==t[6]||e[7]!==t[7]||e[8]!==t[8]||e[9]!==t[9]||e[10]!==t[10]||e[11]!==t[11]||e[12]!==t[12]||e[13]!==t[13]||e[14]!==t[14]||e[15]!==t[15])})(n,t)&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(e),r,t),void 0===n?this._nameToUniformMatrix4[e]=m._arrayCopy(t):m._arrayAssign(t,n))}assertCompatibleVertexAttributeLocations(e){const t=e.locations===this.locations;return t||console.error(\"VertexAttributeLocations are incompatible\"),t}static _padToThree(e){let t=e.toString();return e<1e3&&(t=(\"  \"+e).slice(-3)),t}_addLineNumbers(e){let t=2;return e.replace(/\\n/g,()=>\"\\n\"+m._padToThree(t++)+\":\")}_loadShader(e){const t=35633===e;let r=t?this._vertexShaderSource:this._fragmentShaderSource,i=\"\";for(const n in this._defines)i+=`#define ${n} ${this._defines[n]}\\n`;r=i+r,\"webgl2\"===this._context.contextVersion&&(r=function(e,t){const r=function(e){return t=e,r=function(){var e,t,r,i=0,n=0,s=999,c=[],l=[],u=1,d=0,f=0,h=!1,m=!1,p=\"\";return function(o){return l=[],null!==o?function(o){var a;for(i=0,r=(p+=o).length;e=p[i],i<r;){switch(a=i,s){case 0:i=\"/\"===e&&\"*\"===t?(c.push(e),b(c.join(\"\")),s=999,i+1):(c.push(e),t=e,i+1);break;case 1:case 2:i=\"\\r\"!==e&&\"\\n\"!==e||\"\\\\\"===t?(c.push(e),t=e,i+1):(b(c.join(\"\")),s=999,i);break;case 3:i=g();break;case 4:i=\".\"===e||/[eE]/.test(e)?(c.push(e),s=5,t=e,i+1):\"x\"===e&&1===c.length&&\"0\"===c[0]?(s=11,c.push(e),t=e,i+1):/[^\\d]/.test(e)?(b(c.join(\"\")),s=999,i):(c.push(e),t=e,i+1);break;case 11:i=/[^a-fA-F0-9]/.test(e)?(b(c.join(\"\")),s=999,i):(c.push(e),t=e,i+1);break;case 5:\"f\"===e&&(c.push(e),t=e,i+=1),i=/[eE]/.test(e)||\"-\"===e&&/[eE]/.test(t)?(c.push(e),t=e,i+1):/[^\\d]/.test(e)?(b(c.join(\"\")),s=999,i):(c.push(e),t=e,i+1);break;case 9999:i=x();break;case 9:i=/[^\\s]/g.test(e)?(b(c.join(\"\")),s=999,i):(c.push(e),t=e,i+1);break;case 999:c=c.length?[]:c,i=\"/\"===t&&\"*\"===e?(f=n+i-1,s=0,t=e,i+1):\"/\"===t&&\"/\"===e?(f=n+i-1,s=1,t=e,i+1):\"#\"===e?(s=2,f=n+i,i):/\\s/.test(e)?(s=9,f=n+i,i):(h=/\\d/.test(e),m=/[^\\w_]/.test(e),f=n+i,s=h?4:m?3:9999,i)}if(a!==i)switch(p[a]){case\"\\n\":d=0,++u;break;default:++d}}return n+=i,p=p.slice(i),l}(o.replace?o.replace(/\\r\\n/g,\"\\n\"):o):(c.length&&b(c.join(\"\")),s=10,b(\"(eof)\"),l)};function b(e){e.length&&l.push({type:a[s],data:e,position:f,line:u,column:d})}function g(){if(\".\"===t&&/\\d/.test(e))return s=5,i;if(\"/\"===t&&\"*\"===e)return s=0,i;if(\"/\"===t&&\"/\"===e)return s=1,i;if(\".\"===e&&c.length){for(;v(c););return s=5,i}if(\";\"===e||\")\"===e||\"(\"===e){if(c.length)for(;v(c););return b(e),s=999,i+1}var r=2===c.length&&\"=\"!==e;if(/[\\w_\\d\\s]/.test(e)||r){for(;v(c););return s=999,i}return c.push(e),t=e,i+1}function v(e){for(var t,r,i=0;;){if(t=o.c.indexOf(e.slice(0,e.length+i).join(\"\")),r=o.c[t],-1===t){if(i--+e.length>0)continue;r=e.slice(0,1).join(\"\")}return b(r),f+=r.length,(c=c.slice(r.length)).length}}function x(){if(/[^\\d\\w_]/.test(e)){var r=c.join(\"\");return s=o.b.indexOf(r)>-1?8:o.a.indexOf(r)>-1?7:6,b(c.join(\"\")),s=999,i}return c.push(e),t=e,i+1}}(),[].concat(r(t)).concat(r(null));var t,r}(e);if(\"300 es\"===function(e,t=\"100\",r=\"300 es\"){const i=/^\\s*\\#version\\s+([0-9]+(\\s+[a-zA-Z]+)?)\\s*/;for(const n of e)if(\"preprocessor\"===n.type){const e=i.exec(n.data);if(e){const i=e[1].replace(/\\s\\s+/g,\" \");if(i===r)return i;if(i===t)return n.data=\"#version \"+r,t;throw new Error(\"unknown glsl version: \"+i)}}return e.splice(0,0,{type:\"preprocessor\",data:\"#version \"+r},{type:\"whitespace\",data:\"\\n\"}),null}(r,\"100\",\"300 es\"))throw new Error(\"shader is already glsl 300 es\");let i=null,u=null;const m={},p={};for(let o=0;o<r.length;++o){const e=r[o];switch(e.type){case\"keyword\":\"vertex\"===t&&\"attribute\"===e.data?e.data=\"in\":\"varying\"===e.data&&(e.data=\"vertex\"===t?\"out\":\"in\");break;case\"builtin\":if(/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(e.data.trim())&&(e.data=e.data.replace(/(2D|Cube|EXT)/g,\"\")),\"fragment\"===t&&\"gl_FragColor\"===e.data&&(i||(i=l(r,m,\"fragColor\"),d(r,i,\"vec4\")),e.data=i),\"fragment\"===t&&\"gl_FragData\"===e.data){const t=h(r,o+1),i=l(r,m,\"fragData\");f(r,i,\"vec4\",t,\"mediump\"),e.data=i}else\"fragment\"===t&&\"gl_FragDepthEXT\"===e.data&&(u||(u=l(r,m,\"gl_FragDepth\")),e.data=u);break;case\"ident\":if(n.indexOf(e.data)>=0){if(\"vertex\"===t&&c(r,o))throw new Error(\"attribute in vertex shader uses a name that is a reserved word in glsl 300 es\");e.data in p||(p[e.data]=l(r,m,e.data)),e.data=p[e.data]}}}for(let n=r.length-1;n>=0;--n){const e=r[n];if(\"preprocessor\"===e.type){const t=e.data.match(/\\#extension\\s+(.*)\\:/);if(t&&t[1]&&s.indexOf(t[1].trim())>=0){const e=r[n+1];r.splice(n,e&&\"whitespace\"===e.type?2:1)}const i=e.data.match(/\\#ifdef\\s+(.*)/);i&&i[1]&&s.indexOf(i[1].trim())>=0&&(e.data=\"#if 1\");const o=e.data.match(/\\#ifndef\\s+(.*)/);o&&o[1]&&s.indexOf(o[1].trim())>=0&&(e.data=\"#if 0\")}}return r.map(e=>\"eof\"!==e.type?e.data:\"\").join(\"\")}(r,t?\"vertex\":\"fragment\"));const u=this._context.gl,m=u.createShader(e);return u.shaderSource(m,r),u.compileShader(m),m}static _arrayCopy(e){const t=[];for(let r=0;r<e.length;++r)t.push(e[r]);return t}static _arrayAssign(e,t){for(let r=0;r<e.length;++r)t[r]=e[r]}}function p(e,t){if(Object(i.g)(e)||e.length!==t.length)return!0;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!0;return!1}let b=0;t.a=m},lKY1:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"fetch\",function(){return Vn}),r.d(t,\"gltfToEngineResources\",function(){return Un}),r.d(t,\"parseUrl\",function(){return En});var i=r(\"srIe\"),n=r(\"Cy1f\"),o=r(\"5DEt\"),a=r(\"15Hh\"),s=r(\"SbiP\"),c=r(\"2uVf\"),l=r(\"r+FG\"),u=r(\"HJJS\"),d=r(\"VeZB\"),f=r(\"6S2I\");const h=f.a.getLogger(\"esri.views.3d.support.buffer.math\");function m(e,t,r){if(e.count!==t.count)return void h.error(\"source and destination buffers need to have the same number of elements\");const i=e.count,n=r[0],o=r[1],a=r[2],s=r[4],c=r[5],l=r[6],u=r[8],d=r[9],f=r[10],m=r[12],p=r[13],b=r[14],g=e.typedBuffer,v=e.typedBufferStride,x=t.typedBuffer,O=t.typedBufferStride;for(let h=0;h<i;h++){const e=h*v,t=h*O,r=x[t],i=x[t+1],y=x[t+2];g[e]=n*r+s*i+u*y+m,g[e+1]=o*r+c*i+d*y+p,g[e+2]=a*r+l*i+f*y+b}}function p(e,t,r){if(e.count!==t.count)return void h.error(\"source and destination buffers need to have the same number of elements\");const i=e.count,n=r[0],o=r[1],a=r[2],s=r[3],c=r[4],l=r[5],u=r[6],d=r[7],f=r[8],m=e.typedBuffer,p=e.typedBufferStride,b=t.typedBuffer,g=t.typedBufferStride;for(let h=0;h<i;h++){const e=h*p,t=h*g,r=b[t],i=b[t+1],v=b[t+2];m[e]=n*r+s*i+u*v,m[e+1]=o*r+c*i+d*v,m[e+2]=a*r+l*i+f*v}}function b(e,t,r){const i=Math.min(e.count,t.count),n=e.typedBuffer,o=e.typedBufferStride,a=t.typedBuffer,s=t.typedBufferStride;for(let c=0;c<i;c++){const e=c*o,t=c*s;n[e]=r*a[t],n[e+1]=r*a[t+1],n[e+2]=r*a[t+2]}}Object.freeze({__proto__:null,transformMat4:m,transformMat3:p,scale:b,shiftRight:function(e,t,r){const i=Math.min(e.count,t.count),n=e.typedBuffer,o=e.typedBufferStride,a=t.typedBuffer,s=t.typedBufferStride;for(let c=0;c<i;c++){const e=c*o,t=c*s;n[e]=a[t]>>r,n[e+1]=a[t+1]>>r,n[e+2]=a[t+2]>>r}}});var g=r(\"QmHG\"),v=r(\"KrcW\");class x{constructor(e){this.allocator=e,this.items=[],this.itemsPtr=0,this.tickHandle=v.a.before(()=>this.reset()),this.grow()}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(i.l)(this.tickHandle)),this.items=Object(i.l)(this.items)}get(){return 0===this.itemsPtr&&Object(v.a)(()=>{}),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}reset(){const e=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*O);this.items.length=Math.min(e,this.items.length),this.itemsPtr=0}grow(){for(let e=0;e<Math.max(8,Math.min(this.items.length,O));e++)this.items.push(this.allocator())}}const O=1024;var y=r(\"M0lq\"),_=r(\"sTkM\"),w=r(\"AvGH\"),j=r(\"D8Ta\");class T{constructor(e,t,r){this.itemByteSize=e,this.itemCreate=t,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(r/this.itemByteSize),this.tickHandle=v.a.before(()=>this.reset())}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(i.l)(this.tickHandle)),this.itemsPtr=0,this.items=Object(i.l)(this.items),this.buffers=Object(i.l)(this.buffers)}get(){0===this.itemsPtr&&Object(v.a)(()=>{});const e=Math.floor(this.itemsPtr/this.itemsPerBuffer);for(;this.buffers.length<=e;){const e=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize);for(let t=0;t<this.itemsPerBuffer;++t)this.items.push(this.itemCreate(e,t*this.itemByteSize));this.buffers.push(e)}return this.items[this.itemsPtr++]}reset(){const e=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);for(;this.buffers.length>e;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}static createVec2f64(e=S){return new T(16,w.b,e)}static createVec3f64(e=S){return new T(24,n.c,e)}static createVec4f64(e=S){return new T(32,j.c,e)}static createMat3f64(e=S){return new T(72,c.b,e)}static createMat4f64(e=S){return new T(128,l.d,e)}static createQuatf64(e=S){return new T(32,_.b,e)}get test(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}const S=4096,M=(T.createVec2f64(),T.createVec3f64()),C=T.createVec4f64(),A=(T.createMat3f64(),T.createMat4f64());T.createQuatf64();var P=r(\"OKTS\");function I(e){return e?{origin:Object(n.d)(e.origin),vector:Object(n.d)(e.vector)}:{origin:Object(n.e)(),vector:Object(n.e)()}}function R(e,t){const r=N.get();return r.origin=e,r.vector=t,r}function L(e,t,r=I()){return Object(o.h)(r.origin,e),Object(o.h)(r.vector,t),r}function B(e,t){const r=Object(o.g)(M.get(),t,e.origin),i=Object(o.e)(e.vector,r),n=Object(o.e)(e.vector,e.vector),a=Object(P.c)(i/n,0,1),s=Object(o.g)(M.get(),Object(o.b)(M.get(),e.vector,a),r);return Object(o.e)(s,s)}function F(e,t,r,i,n){const{vector:a,origin:s}=e,c=Object(o.g)(M.get(),t,s),l=Object(o.m)(a),u=Object(o.e)(a,c)/l;return Object(o.b)(n,a,Object(P.c)(u,r,i)),Object(o.c)(n,n,e.origin)}function z(e,t,r,i){const n=1e-6,a=e.origin,s=Object(o.c)(M.get(),a,e.vector),c=t.origin,l=Object(o.c)(M.get(),c,t.vector),u=M.get(),d=M.get();if(u[0]=a[0]-c[0],u[1]=a[1]-c[1],u[2]=a[2]-c[2],d[0]=l[0]-c[0],d[1]=l[1]-c[1],d[2]=l[2]-c[2],Math.abs(d[0])<n&&Math.abs(d[1])<n&&Math.abs(d[2])<n)return!1;const f=M.get();if(f[0]=s[0]-a[0],f[1]=s[1]-a[1],f[2]=s[2]-a[2],Math.abs(f[0])<n&&Math.abs(f[1])<n&&Math.abs(f[2])<n)return!1;const h=u[0]*d[0]+u[1]*d[1]+u[2]*d[2],m=d[0]*f[0]+d[1]*f[1]+d[2]*f[2],p=u[0]*f[0]+u[1]*f[1]+u[2]*f[2],b=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],g=(f[0]*f[0]+f[1]*f[1]+f[2]*f[2])*b-m*m;if(Math.abs(g)<n)return!1;let v=(h*m-p*b)/g,x=(h+m*v)/b;r&&(v=Object(P.c)(v,0,1),x=Object(P.c)(x,0,1));const O=M.get(),y=M.get();return O[0]=a[0]+v*f[0],O[1]=a[1]+v*f[1],O[2]=a[2]+v*f[2],y[0]=c[0]+x*d[0],y[1]=c[1]+x*d[1],y[2]=c[2]+x*d[2],i.tA=v,i.tB=x,i.pA=O,i.pB=y,i.distance2=Object(o.i)(O,y),!0}const D={tA:0,tB:0,pA:Object(n.e)(),pB:Object(n.e)(),distance2:0},N=new x(()=>({origin:null,vector:null}));function V(e){return e?{p0:Object(n.d)(e.p0),p1:Object(n.d)(e.p1),p2:Object(n.d)(e.p2)}:{p0:Object(n.e)(),p1:Object(n.e)(),p2:Object(n.e)()}}function E(e,t,r,i=V()){return Object(o.h)(i.p0,e),Object(o.h)(i.p1,t),Object(o.h)(i.p2,r),i}function U(e,t,r){const i=Object(y.i)(e,t),n=Object(y.i)(t,r),o=Object(y.i)(r,e),a=(i+n+o)/2,s=a*(a-i)*(a-n)*(a-o);return s<=0?0:Math.sqrt(s)}function G(e,t,r){return Object(o.g)(q,t,e),Object(o.g)(W,r,e),Object(o.m)(Object(o.d)(q,q,W))/2}Object.freeze({__proto__:null,create:I,wrap:R,copy:function(e,t=I()){return L(e.origin,e.vector,t)},fromValues:L,fromPoints:function(e,t,r=I()){return Object(o.h)(r.origin,e),Object(o.g)(r.vector,t,e),r},distance2:B,distance:function(e,t){return Math.sqrt(B(e,t))},projectPoint:function(e,t,r){return F(e,t,0,1,r)},pointAt:function(e,t,r){return Object(o.c)(r,e.origin,Object(o.b)(r,e.vector,t))},projectPointClamp:F,closestRayDistance2:function(e,t){if(z(e,R(t.origin,t.direction),!1,D)){const{tA:t,pB:r,distance2:i}=D;if(t>=0&&t<=1)return i;if(t<0)return Object(o.i)(e.origin,r);if(t>1)return Object(o.i)(Object(o.c)(M.get(),e.origin,e.vector),r)}return null},closestLineSegmentPoint:function(e,t,r){return!!z(e,t,!0,D)&&(Object(o.h)(r,D.pA),!0)},closestLineSegmentDistance2:function(e,t){return z(e,t,!0,D)?D.distance2:null}});const k=new x(I),H=new x(()=>({p0:null,p1:null,p2:null})),q=Object(n.e)(),W=Object(n.e)();Object.freeze({__proto__:null,create:V,wrap:function(e,t,r){const i=H.get();return i.p0=e,i.p1=t,i.p2=r,i},copy:function(e,t=V()){return E(e.p0,e.p1,e.p2,t)},fromValues:E,distance2:function(e,t){const r=e.p0,i=e.p1,n=e.p2,a=Object(o.g)(M.get(),i,r),s=Object(o.g)(M.get(),n,i),c=Object(o.g)(M.get(),r,n),l=Object(o.g)(M.get(),t,r),u=Object(o.g)(M.get(),t,i),d=Object(o.g)(M.get(),t,n),f=Object(o.d)(a,a,c),h=Object(o.e)(Object(o.d)(M.get(),a,f),l),m=Object(o.e)(Object(o.d)(M.get(),s,f),u),p=Object(o.e)(Object(o.d)(M.get(),c,f),d);if(h>0&&m>0&&p>0){const e=Object(o.e)(f,l);return e*e/Object(o.e)(f,f)}const b=B(L(r,a,k.get()),t),g=B(L(i,s,k.get()),t),v=B(L(n,c,k.get()),t);return Math.min(b,g,v)},intersectRay:function(e,t,r){const i=1e-5,{direction:n,origin:a}=t,{p0:s,p1:c,p2:l}=e,u=c[0]-s[0],d=c[1]-s[1],f=c[2]-s[2],h=l[0]-s[0],m=l[1]-s[1],p=l[2]-s[2],b=n[1]*p-m*n[2],g=n[2]*h-p*n[0],v=n[0]*m-h*n[1],x=u*b+d*g+f*v;if(x>-i&&x<i)return!1;const O=1/x,y=a[0]-s[0],_=a[1]-s[1],w=a[2]-s[2],j=O*(y*b+_*g+w*v);if(j<0||j>1)return!1;const T=_*f-d*w,S=w*u-f*y,M=y*d-u*_,C=O*(n[0]*T+n[1]*S+n[2]*M);return!(C<0||j+C>1||(r&&(Object(o.b)(r,n,O*(h*T+m*S+p*M)),Object(o.c)(r,a,r)),0))},areaPoints2d:U,area2d:function(e){return U(e.p0,e.p1,e.p2)},areaPoints3d:G});let $=1,X=null;const Y=new Uint32Array([0]);function J(e){if(1===e)return Y;if(e>$||null==X){for(;e>$;)$*=2;X=new Uint32Array($);for(let e=0;e<$;e++)X[e]=e}return new Uint32Array(X.buffer,0,e)}let K=0;const Q=Object(n.e)(),Z=Object(n.e)(),ee=Object(n.e)(),te=Object(n.e)();var re=r(\"EVMh\");class ie{constructor(e,t=ie.DefaultIndices,r=\"triangle\"){this.initialize(e,t,r)}get id(){return this._id}get vertexAttributes(){return this._vertexAttributes}get indices(){return this._indices}get indexCount(){const e=Object(re.c)(this._indices);return null==e?0:e.length}get primitiveType(){return this._primitiveType}getVertexAttr(){return this.vertexAttributes}initialize(e,t=ie.DefaultIndices,r=\"triangle\"){const i={};for(const n in e){const{data:t,size:r}=e[n];i[n]={data:t,size:r,offsetIdx:0,strideIdx:r}}if(t===ie.DefaultIndices){const e=J(function(e){const t=Object(re.c)(e);return null==t?0:t.data.length/t.size}(i));t={};for(const r in i)t[r]=e}this._id=K++,this._vertexAttributes=i,this._indices=t,this._primitiveType=r}toRenderData(){return{id:this._id.toString(),indices:this._indices,vertexAttr:this._vertexAttributes}}getIndices(e){return this._indices[e]}getAttribute(e){return this._vertexAttributes[e]}estimateGpuMemoryUsage(){let e=0;return this._indices[re.a.POSITION]&&(e+=3*this._indices[re.a.POSITION].length*4),this._indices[re.a.NORMAL]&&(e+=3*this._indices[re.a.NORMAL].length*4),this._indices[re.a.UV0]&&(e+=2*this._indices[re.a.UV0].length*4),this._indices[re.a.COLOR]&&(e+=1*this._indices[re.a.COLOR].length*4),e}}ie.DefaultIndices={};class ne{constructor(){this._count=0}gen(e){return null==e&&(e=\"a\"),e+\"_\"+this._count++}}var oe=r(\"ikTR\");class ae{constructor(e,t,r,i){this.primitiveIndices=e,this._numIndexPerPrimitive=t,this.indices=r,this._position=i,this.center=Object(n.e)(),Object(re.b)(e.length>=1),Object(re.b)(r.length%this._numIndexPerPrimitive==0),Object(re.b)(r.length>=e.length*this._numIndexPerPrimitive),Object(re.b)(3===this._position.size||4===this._position.size);const{data:a,offsetIdx:s,strideIdx:c}=this._position;let l=0;const u=e.length;let d=s+c*r[this._numIndexPerPrimitive*e[l]];for(ae.tmpIndices.clear(),ae.tmpIndices.push(d),this.bbMin=Object(n.g)(a[d],a[d+1],a[d+2]),this.bbMax=Object(n.d)(this.bbMin);l<u;++l){const t=this._numIndexPerPrimitive*e[l];for(let e=0;e<this._numIndexPerPrimitive;++e){d=s+c*r[t+e],ae.tmpIndices.push(d);let i=a[d];this.bbMin[0]=Math.min(i,this.bbMin[0]),this.bbMax[0]=Math.max(i,this.bbMax[0]),i=a[d+1],this.bbMin[1]=Math.min(i,this.bbMin[1]),this.bbMax[1]=Math.max(i,this.bbMax[1]),i=a[d+2],this.bbMin[2]=Math.min(i,this.bbMin[2]),this.bbMax[2]=Math.max(i,this.bbMax[2])}}Object(o.f)(this.center,this.bbMin,this.bbMax,.5),this.bsRadius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);let f=this.bsRadius*this.bsRadius;for(l=0;l<ae.tmpIndices.length;++l){d=ae.tmpIndices.data[l];const e=a[d]-this.center[0],t=a[d+1]-this.center[1],r=a[d+2]-this.center[2],i=e*e+t*t+r*r;if(i<=f)continue;const n=Math.sqrt(i),o=.5*(n-this.bsRadius);this.bsRadius=this.bsRadius+o,f=this.bsRadius*this.bsRadius;const s=o/n;this.center[0]+=e*s,this.center[1]+=t*s,this.center[2]+=r*s}ae.tmpIndices.clear()}getCenter(){return this.center}getBSRadius(){return this.bsRadius}getBBMin(){return this.bbMin}getBBMax(){return this.bbMax}getPrimitiveIndices(){return this.primitiveIndices}getIndices(){return this.indices}getPosition(){return this._position}getChildren(){if(this._children)return this._children;if(Object(o.i)(this.bbMin,this.bbMax)>1){const e=Object(o.f)(Object(n.e)(),this.bbMin,this.bbMax,.5),t=this.primitiveIndices.length,r=new Uint8Array(t),i=new Array(8);for(let n=0;n<8;++n)i[n]=0;const{data:a,offsetIdx:s,strideIdx:c}=this._position;for(let n=0;n<t;++n){let t=0;const o=this._numIndexPerPrimitive*this.primitiveIndices[n];let l=s+c*this.indices[o],u=a[l],d=a[l+1],f=a[l+2];for(let e=1;e<this._numIndexPerPrimitive;++e){l=s+c*this.indices[o+e];const t=a[l],r=a[l+1],i=a[l+2];t<u&&(u=t),r<d&&(d=r),i<f&&(f=i)}u<e[0]&&(t|=1),d<e[1]&&(t|=2),f<e[2]&&(t|=4),r[n]=t,++i[t]}let l=0;for(let n=0;n<8;++n)i[n]>0&&++l;if(l<2)return;const u=new Array(8);for(let n=0;n<8;++n)u[n]=i[n]>0?new Uint32Array(i[n]):void 0;for(let n=0;n<8;++n)i[n]=0;for(let n=0;n<t;++n){const e=r[n];u[e][i[e]++]=this.primitiveIndices[n]}this._children=new Array(8);for(let n=0;n<8;++n)void 0!==u[n]&&(this._children[n]=new ae(u[n],this._numIndexPerPrimitive,this.indices,this._position))}return this._children}}(ae||(ae={})).tmpIndices=new oe.a({deallocator:null});var se=ae;class ce{constructor(e,t){this._boundingInfo=null,this._id=ce.__idGen.gen(t),this._data=e}get id(){return this._id}get data(){return this._data}getIndices(e){return this.data.getIndices(e)}get indexCount(){return this.data.indexCount}getAttribute(e){return this.data.getAttribute(e)}get vertexCount(){return this.data.indexCount}get faceCount(){return this.data.indexCount/3}get boundingInfo(){return Object(i.g)(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(e){return\"triangle\"===this.data.primitiveType?this.computeAttachmentOriginTriangles(e):this.computeAttachmentOriginPoints(e)}computeAttachmentOriginTriangles(e){const t=this.getIndices(re.a.POSITION);return function(e,t,r){if(!e)return!1;const{strideIdx:i,offsetIdx:n,data:a}=e;Object(o.r)(r,0,0,0),Object(o.r)(te,0,0,0);let s=0,c=0;for(let l=0;l<t.length-2;l+=3){const e=t[l+0]*i+n,u=t[l+1]*i+n,d=t[l+2]*i+n;Object(o.r)(Q,a[e+0],a[e+1],a[e+2]),Object(o.r)(Z,a[u+0],a[u+1],a[u+2]),Object(o.r)(ee,a[d+0],a[d+1],a[d+2]);const f=G(Q,Z,ee);f?(Object(o.c)(Q,Q,Z),Object(o.c)(Q,Q,ee),Object(o.b)(Q,Q,1/3*f),Object(o.c)(r,r,Q),s+=f):(Object(o.c)(te,te,Q),Object(o.c)(te,te,Z),Object(o.c)(te,te,ee),c+=3)}return!(0===c&&0===s||(0!==s?(Object(o.b)(r,r,1/s),0):0===c||(Object(o.b)(r,te,1/c),0)))}(this.getAttribute(re.a.POSITION),t,e)}computeAttachmentOriginPoints(e){const t=this.getIndices(re.a.POSITION);return function(e,t,r){if(!e||!t)return!1;const{strideIdx:i,offsetIdx:n,data:a}=e;Object(o.r)(r,0,0,0);let s=-1,c=0;for(let o=0;o<t.length;o++){const e=t[o]*i+n;s!==e&&(r[0]+=a[e+0],r[1]+=a[e+1],r[2]+=a[e+2],c++),s=e}return c>1&&Object(o.b)(r,r,1/c),c>0}(this.getAttribute(re.a.POSITION),t,e)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){let e=this.data.getIndices(re.a.POSITION);const t=this.data.getAttribute(re.a.POSITION),r=\"triangle\"===this.data.primitiveType?3:1;if(0===e.length){e=new Uint32Array(r);for(let t=0;t<r;++t)e[t]=t}const i=e.length;Object(re.b)(i%r==0,\"Indexing error: \"+i.toFixed(0)+\" not divisible by \"+r.toFixed(0));const n=J(i/r);return new se(n,r,e,t)}}ce.__idGen=new ne;var le=ce,ue=r(\"/ADo\"),de=r(\"dXfX\"),fe=r(\"BPBZ\"),he=r(\"R/jG\"),me=(r(\"wSAH\"),r(\"aAs6\"));function pe(e,t){return Object(o.e)(e,t)/Object(o.m)(e)}function be(e,t){const r=Object(o.e)(e,t)/(Object(o.m)(e)*Object(o.m)(t));return-Object(P.a)(r)}const ge=Object(n.e)(),ve=Object(n.e)();function xe(e=We){return[e[0],e[1],e[2],e[3]]}function Oe(e,t,r,i){return _e(e,t,r,i,C.get())}function ye(e,t=xe()){return _e(e[0],e[1],e[2],e[3],t)}function _e(e,t,r,i,n=xe()){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function we(e,t,r=xe()){Object(o.h)(r,t);const i=Object(o.e)(t,t);return Math.abs(i-1)>1e-5&&i>1e-12&&Object(o.b)(r,r,1/Math.sqrt(i)),Re(r,e,r),r}function je(e,t,r,i=xe()){return Le(Object(o.g)(M.get(),e,t),Object(o.g)(M.get(),r,t),e,i)}function Te(e,t,r,i,n){if(e.count<3)return!1;e.getVec(r,Me);let a=i,s=!1;for(;a<e.count-1&&!s;)e.getVec(a,Ce),a++,s=!Object(o.n)(Me,Ce);if(!s)return!1;for(a=Math.max(a,n),s=!1;a<e.count&&!s;)e.getVec(a,Ae),a++,Object(o.g)(Pe,Me,Ce),Object(o.o)(Pe,Pe),Object(o.g)(Ie,Ce,Ae),Object(o.o)(Ie,Ie),s=!Object(o.n)(Me,Ae)&&!Object(o.n)(Ce,Ae)&&Math.abs(Object(o.e)(Pe,Ie))<Se;return s?(je(Me,Ce,Ae,t),!0):(0!==r||1!==i||2!==n)&&Te(e,t,0,1,2)}Object.freeze({__proto__:null,projectPoint:function(e,t,r){const i=Object(o.e)(e,t)/Object(o.e)(e,e);return Object(o.b)(r,e,i)},projectPointSignedLength:pe,angle:be,angleAroundAxis:function(e,t,r){Object(o.o)(ge,e),Object(o.o)(ve,t);const i=Object(o.e)(ge,ve),n=Object(P.a)(i),a=Object(o.d)(ge,ge,ve);return Object(o.e)(a,r)<0?2*Math.PI-n:n}});const Se=.99619469809,Me=Object(n.e)(),Ce=Object(n.e)(),Ae=Object(n.e)(),Pe=Object(n.e)(),Ie=Object(n.e)();function Re(e,t,r){return e!==r&&ye(e,r),r[3]=-Object(o.e)(r,t),r}function Le(e,t,r,i=xe()){return we(r,Object(o.d)(M.get(),t,e),i)}function Be(e,t,r){return!!Object(i.h)(t)&&qe(e,t.origin,t.direction,!0,!1,r)}function Fe(e,t,r){return qe(e,t.origin,t.vector,!1,!1,r)}function ze(e,t,r){return qe(e,t.origin,t.vector,!1,!0,r)}function De(e,t){const{center:r,radius:i}=t;return He(e,r)-i>=0}function Ne(e,t){return He(e,t)>=0}function Ve(e,t){return e[0]*(e[0]>0?t[0]:t[3])+e[1]*(e[1]>0?t[1]:t[4])+e[2]*(e[2]>0?t[2]:t[5])+e[3]>=0}function Ee(e,t){const r=Object(o.e)(e,t.ray.direction),i=-He(e,t.ray.origin);if(i<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return i>0;if((i<0||r<0)&&!(i<0&&r<0))return!0;const n=i/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function Ue(e,t){const r=Object(o.e)(e,t.ray.direction),i=-He(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return i>0;const n=i/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function Ge(e,t,r){const i=Object(o.b)(M.get(),e,-e[3]),n=ke(e,Object(o.g)(M.get(),t,i),M.get());return Object(o.c)(r,n,i),r}function ke(e,t,r){const i=Object(o.b)(M.get(),e,Object(o.e)(e,t));return Object(o.g)(r,t,i),r}function He(e,t){return Object(o.e)(e,t)+e[3]}function qe(e,t,r,i,n,a){const s=Object(o.e)(e,r);if(0===s)return!1;let c=-(Object(o.e)(e,t)+e[3])/s;return n&&(c=i?Math.max(0,c):Object(P.c)(c,0,1)),!(c<0||!i&&c>1||(Object(o.c)(a,t,Object(o.b)(a,r,c)),0))}const We=[0,0,1,0];Object.freeze({__proto__:null,create:xe,wrap:Oe,copy:ye,fromValues:_e,fromNormalAndOffset:function(e,t,r=xe()){return Object(o.h)(r,e),r[3]=t,r},fromPositionAndNormal:we,fromPoints:je,fromManyPoints:function(e,t){return Te(e,t,0,1,2)},fromManyPointsSampleAt:Te,setOffsetFromPoint:Re,negate:function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},fromVectorsAndPoint:Le,intersectRay:Be,intersectLineSegment:Fe,intersectLineSegmentClamp:ze,isSphereFullyInside:De,isSphereFullyOutside:function(e,t){const{center:r,radius:i}=t;return He(e,r)+i<0},isPointInside:Ne,isPointOutside:function(e,t){return He(e,t)<0},isAABBFullyInside:Ve,clip:Ee,clipInfinite:Ue,projectPoint:Ge,projectVector:ke,distance:function(e,t){return Math.abs(He(e,t))},signedDistance:He,normal:function(e){return e},UP:We});var $e=r(\"qRWG\");function Xe(e){return e?{origin:Object(n.d)(e.origin),direction:Object(n.d)(e.direction)}:{origin:Object(n.e)(),direction:Object(n.e)()}}function Ye(e,t=Xe()){return Je(e.origin,e.direction,t)}function Je(e,t,r=Xe()){return Object(o.h)(r.origin,e),Object(o.h)(r.direction,t),r}function Ke(e,t,r=Xe()){const n=Object($e.a)(Object(y.c)(M.get(),t));if(n[2]=0,!e.unprojectFromRenderScreen(n,r.origin))return null;const a=Object($e.a)(Object(y.c)(M.get(),t));a[2]=1;const s=e.unprojectFromRenderScreen(a,M.get());return Object(i.g)(s)?null:(Object(o.g)(r.direction,s,r.origin),r)}function Qe(e,t,r=Xe()){return Ze(e,e.screenToRender(t,Object($e.a)(M.get())),r)}function Ze(e,t,r=Xe()){Object(o.h)(r.origin,e.eye);const n=Object(o.r)(M.get(),t[0],t[1],1),a=e.unprojectFromRenderScreen(n,M.get());return Object(i.g)(a)?null:(Object(o.g)(r.direction,a,r.origin),r)}function et(e,t){const r=Object(o.d)(M.get(),Object(o.o)(M.get(),e.direction),Object(o.g)(M.get(),t,e.origin));return Object(o.e)(r,r)}function tt(e,t,r){const i=Object(o.e)(e.direction,Object(o.g)(r,t,e.origin));return Object(o.c)(r,e.origin,Object(o.b)(r,e.direction,i)),r}function rt(){return{origin:null,direction:null}}const it=new x(rt);Object.freeze({__proto__:null,create:Xe,wrap:function(e,t){const r=it.get();return r.origin=e,r.direction=t,r},copy:Ye,fromPoints:function(e,t,r=Xe()){return Object(o.h)(r.origin,e),Object(o.g)(r.direction,t,e),r},fromValues:Je,fromScreen:function(e,t,r=Xe()){return Ke(e,e.screenToRender(t,Object($e.a)(M.get())),r)},fromRender:Ke,fromScreenAtEye:Qe,fromRenderAtEye:Ze,distance2:et,distance:function(e,t){return Math.sqrt(et(e,t))},closestPoint:tt,createWrapper:rt});const nt=f.a.getLogger(\"esri.views.3d.support.geometryUtils.boundedPlane\");function ot(e=wt){return{plane:xe(e.plane),origin:Object(n.d)(e.origin),basis1:Object(n.d)(e.basis1),basis2:Object(n.d)(e.basis2)}}function at(e,t=ot()){return st(e.origin,e.basis1,e.basis2,t)}function st(e,t,r,i=ot()){return Object(o.h)(i.origin,e),Object(o.h)(i.basis1,t),Object(o.h)(i.basis2,r),ct(i),function(e,t){Math.abs(Object(o.e)(e.basis1,e.basis2)/(Object(o.m)(e.basis1)*Object(o.m)(e.basis2)))>1e-6&&nt.warn(t,\"Provided basis vectors are not perpendicular\"),Math.abs(Object(o.e)(e.basis1,vt(e)))>1e-6&&nt.warn(t,\"Basis vectors and plane normal are not perpendicular\"),Math.abs(-Object(o.e)(vt(e),e.origin)-e.plane[3])>1e-6&&nt.warn(t,\"Plane offset is not consistent with plane origin\")}(i,\"fromValues()\"),i}function ct(e){Le(e.basis2,e.basis1,e.origin,e.plane)}function lt(e,t,r){e!==r&&at(e,r);const i=Object(o.b)(M.get(),vt(e),t);return Object(o.c)(r.origin,r.origin,i),r.plane[3]-=t,r}function ut(e,t=ot()){const r=(e[2]-e[0])/2,i=(e[3]-e[1])/2;return Object(o.r)(t.origin,e[0]+r,e[1]+i,0),Object(o.r)(t.basis1,r,0,0),Object(o.r)(t.basis2,0,i,0),_e(0,0,1,0,t.plane),t}function dt(e,t,r){return!!Be(e.plane,t,r)&&xt(e,r)}function ft(e,t,r){const i=jt.get();_t(e,t,i,jt.get());let n=Number.POSITIVE_INFINITY;for(const a of Ct){const s=yt(e,a,Tt.get()),c=M.get();if(Fe(i,s,c)){const e=Object(me.c)(M.get(),t.origin,c),i=Math.abs(Object(P.a)(Object(o.e)(t.direction,e)));i<n&&(n=i,Object(o.h)(r,c))}}return n===Number.POSITIVE_INFINITY?ht(e,t,r):r}function ht(e,t,r){if(dt(e,t,r))return r;const i=jt.get(),n=jt.get();_t(e,t,i,n);let a=Number.POSITIVE_INFINITY;for(const s of Ct){const c=yt(e,s,Tt.get()),l=M.get();if(ze(i,c,l)){const e=et(t,l);if(!Ne(n,l))continue;e<a&&(a=e,Object(o.h)(r,l))}}return bt(e,t.origin)<a&&mt(e,t.origin,r),r}function mt(e,t,r){const i=Ge(e.plane,t,M.get()),n=F(Ot(e,e.basis1),i,-1,1,M.get()),a=F(Ot(e,e.basis2),i,-1,1,M.get());return Object(o.g)(r,Object(o.c)(M.get(),n,a),e.origin),r}function pt(e,t,r){const{origin:i,basis1:n,basis2:a}=e,s=Object(o.g)(M.get(),t,i),c=pe(n,s),l=pe(a,s),u=pe(vt(e),s);return Object(o.r)(r,c,l,u)}function bt(e,t){const r=pt(e,t,M.get()),{basis1:i,basis2:n}=e,a=Object(o.m)(i),s=Object(o.m)(n),c=Math.max(Math.abs(r[0])-a,0),l=Math.max(Math.abs(r[1])-s,0),u=r[2];return c*c+l*l+u*u}function gt(e,t){const r=-e.plane[3];return pe(vt(e),t)-r}function vt(e){return e.plane}function xt(e,t){const r=Object(o.g)(M.get(),t,e.origin),i=Object(o.p)(e.basis1),n=Object(o.p)(e.basis2),a=Object(o.e)(e.basis1,r),s=Object(o.e)(e.basis2,r);return-a-i<0&&a-i<0&&-s-n<0&&s-n<0}function Ot(e,t){const r=Tt.get();return Object(o.h)(r.origin,e.origin),Object(o.h)(r.vector,t),r}function yt(e,t,r){const{basis1:i,basis2:n,origin:a}=e,s=Object(o.b)(M.get(),i,t.origin[0]),c=Object(o.b)(M.get(),n,t.origin[1]);Object(o.c)(r.origin,s,c),Object(o.c)(r.origin,r.origin,a);const l=Object(o.b)(M.get(),i,t.direction[0]),u=Object(o.b)(M.get(),n,t.direction[1]);return Object(o.b)(r.vector,Object(o.c)(l,l,u),2),r}function _t(e,t,r,i){const n=vt(e);Le(n,t.direction,t.origin,r),Le(r,n,t.origin,i)}const wt={plane:xe(),origin:Object(n.g)(0,0,0),basis1:Object(n.g)(1,0,0),basis2:Object(n.g)(0,1,0)},jt=new x(xe),Tt=new x(I),St=Object(n.e)(),Mt=new x(()=>({origin:null,basis1:null,basis2:null,plane:null})),Ct=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],At=Object(l.b)(),Pt=Object(l.b)();Object.freeze({__proto__:null,BoundedPlaneClass:class{constructor(){this.plane=xe(),this.origin=Object(n.e)(),this.basis1=Object(n.e)(),this.basis2=Object(n.e)()}},create:ot,wrap:function(e,t,r){const i=Mt.get();return i.origin=e,i.basis1=t,i.basis2=r,i.plane=Oe(0,0,0,0),ct(i),i},copy:at,fromValues:st,updateUnboundedPlane:ct,elevate:lt,setExtent:function(e,t,r){return ut(t,r),lt(r,gt(e,e.origin),r),r},fromAABoundingRect:ut,intersectRay:dt,intersectRayClosestSilhouette:function(e,t,r){if(dt(e,t,r))return r;const i=ft(e,t,M.get());return Object(o.c)(r,t.origin,Object(o.b)(M.get(),t.direction,Object(o.l)(t.origin,i)/Object(o.m)(t.direction))),r},closestPointOnSilhouette:ft,closestPoint:ht,projectPoint:mt,projectPointLocal:pt,distance2:bt,distance:function(e,t){return Math.sqrt(bt(e,t))},distanceToSilhouette:function(e,t){let r=Number.NEGATIVE_INFINITY;for(const i of Ct){const n=B(yt(e,i,Tt.get()),t);n>r&&(r=n)}return Math.sqrt(r)},extrusionContainsPoint:function(e,t){return Ne(e.plane,t)&&xt(e,t)},axisAt:function(e,t,r,i){return function(e,t,r){switch(t){case 0:Object(o.h)(r,e.basis1),Object(o.o)(r,r);break;case 1:Object(o.h)(r,e.basis2),Object(o.o)(r,r);break;case 2:Object(o.h)(r,vt(e))}return r}(e,r,i)},altitudeAt:gt,setAltitudeAt:function(e,t,r,i){const n=gt(e,t),a=Object(o.b)(St,vt(e),r-n);return Object(o.c)(i,t,a),i},equals:function(e,t){return Object(o.n)(e.basis1,t.basis1)&&Object(o.n)(e.basis2,t.basis2)&&Object(o.n)(e.origin,t.origin)},transform:function(e,t,r){return e!==r&&at(e,r),Object(a.a)(At,t),Object(a.b)(At,At),Object(o.j)(r.basis1,e.basis1,At),Object(o.j)(r.basis2,e.basis2,At),Object(o.j)(r.plane,e.plane,At),Object(o.j)(r.origin,e.origin,t),Re(r.plane,r.origin,r.plane),r},rotate:function(e,t,r,i){return e!==i&&at(e,i),Object(a.h)(Pt,Object(a.e)(Pt),t,r),Object(o.j)(i.basis1,e.basis1,Pt),Object(o.j)(i.basis2,e.basis2,Pt),ct(i),i},normal:vt,UP:wt});const It=f.a.getLogger(\"esri.views.3d.support.geometryUtils.sphere\");function Rt(e){return e?{radius:e.radius,center:Object(n.d)(e.center)}:{radius:1,center:Object(n.e)()}}function Lt(e,t=Rt()){return Bt(e.radius,e.center,t)}function Bt(e,t,r=Rt()){return Object(o.h)(r.center,t),r.radius=e,r}function Ft(e,t,r){if(Object(i.g)(t))return!1;const n=Object(o.g)(M.get(),t.origin,e.center),a=Object(o.e)(t.direction,t.direction),s=2*Object(o.e)(t.direction,n),c=s*s-4*a*(Object(o.e)(n,n)-e.radius*e.radius);if(c<0)return!1;const l=Math.sqrt(c);let u=(-s-l)/(2*a);const d=(-s+l)/(2*a);return(u<0||d<u&&d>0)&&(u=d),!(u<0||(r&&Object(o.c)(r,t.origin,Object(o.b)(M.get(),t.direction,u)),0))}function zt(e,t,r){const i=M.get(),n=A.get();Object(o.d)(i,t.origin,t.direction),Object(o.d)(r,i,t.origin),Object(o.b)(r,r,1/Object(o.m)(r)*e.radius);const s=Nt(e,t.origin),c=be(t.origin,r);return Object(a.e)(n),Object(a.h)(n,n,c+s,i),Object(o.j)(r,r,n),r}function Dt(e,t,r){const i=Object(o.g)(M.get(),t,e.center),n=Object(o.b)(M.get(),i,e.radius/Object(o.m)(i));return Object(o.c)(r,n,e.center)}function Nt(e,t){const r=Object(o.g)(M.get(),t,e.center),i=Object(o.m)(r),n=e.radius+Math.abs(e.radius-i);return Object(P.a)(e.radius/n)}const Vt=Object(n.e)();function Et(e,t,r,i){const n=Object(o.g)(Vt,t,e.center);switch(r){case 0:{const e=Object(me.a)(n,Vt)[2];return Object(o.r)(i,-Math.sin(e),Math.cos(e),0)}case 1:{const e=Object(me.a)(n,Vt),t=e[1],r=e[2],a=Math.sin(t);return Object(o.r)(i,-a*Math.cos(r),-a*Math.sin(r),Math.cos(t))}case 2:return Object(o.o)(i,n);default:return}}function Ut(e,t){const r=Object(o.g)(qt,t,e.center);return Object(o.m)(r)-e.radius}const Gt=new x(()=>({center:null,radius:0})),kt=Xe(),Ht=Object(n.e)(),qt=Object(n.e)();function Wt(e=Xt){return[e[0],e[1],e[2],e[3]]}function $t(e,t,r,i,n=Wt()){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}Object.freeze(Ht),Object.freeze({__proto__:null,create:Rt,wrap:function(e,t){const r=Gt.get();return r.radius=e,r.center=t||Ht,r},copy:Lt,fromValues:Bt,elevate:function(e,t,r){return e!==r&&Object(o.h)(r.center,e.center),r.radius=e.radius+t,r},setExtent:function(e,t,r){return It.error(\"sphere.setExtent is not yet supported\"),e===r?r:Lt(e,r)},intersectRay:Ft,intersectScreen:function(e,t,r,i){return Ft(e,Qe(t,r,kt),i)},intersectsRay:function(e,t){return Ft(e,t,null)},intersectRayClosestSilhouette:function(e,t,r){if(Ft(e,t,r))return r;const i=zt(e,t,M.get());return Object(o.c)(r,t.origin,Object(o.b)(M.get(),t.direction,Object(o.l)(t.origin,i)/Object(o.m)(t.direction))),r},closestPointOnSilhouette:zt,closestPoint:function(e,t,r){return Ft(e,t,r)?r:(tt(t,e.center,r),Dt(e,r,r))},projectPoint:Dt,distanceToSilhouette:function(e,t){const r=Object(o.g)(M.get(),t,e.center),i=Object(o.p)(r);return Math.sqrt(Math.abs(i-e.radius*e.radius))},angleToSilhouette:Nt,axisAt:Et,altitudeAt:Ut,setAltitudeAt:function(e,t,r,i){const n=Ut(e,t),a=Et(e,t,2,qt),s=Object(o.b)(qt,a,r-n);return Object(o.c)(i,t,s),i}});const Xt=[0,0,1,0];function Yt(e){return e?{ray:Xe(e.ray),c0:e.c0,c1:e.c1}:{ray:Xe(),c0:0,c1:Number.MAX_VALUE}}function Jt(e,t,r,i=Yt()){return Ye(e,i.ray),i.c0=t,i.c1=r,i}function Kt(e,t=Yt()){return Ye(e,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t}function Qt(e,t,r=Yt()){const i=Object(o.m)(e.vector);return Je(e.origin,t,r.ray),r.c0=0,r.c1=i,r}function Zt(e,t,r){return Object(o.c)(r,e.ray.origin,Object(o.b)(r,e.ray.direction,t))}Object.freeze({__proto__:null,create:Wt,wrap:function(e,t,r,i){return $t(e,t,r,i,C.get())},wrapAxisAngle:function(e,t){return $t(e[0],e[1],e[2],t,C.get())},copy:function(e,t=Wt()){return $t(e[0],e[1],e[2],e[3],t)},fromValues:$t,fromAxisAndAngle:function(e,t,r=Wt()){return Object(o.h)(r,e),r[3]=t,r},fromPoints:function(e,t,r=Wt()){return Object(o.d)(r,e,t),Object(o.o)(r,r),r[3]=be(e,t),r},axis:function(e){return e},UP:Xt});const er=new x(()=>({c0:0,c1:0,ray:null}));function tr(e){if(e){const{planes:t,points:r}=e;return{planes:[xe(t[0]),xe(t[1]),xe(t[2]),xe(t[3]),xe(t[4]),xe(t[5])],points:[Object(n.d)(r[0]),Object(n.d)(r[1]),Object(n.d)(r[2]),Object(n.d)(r[3]),Object(n.d)(r[4]),Object(n.d)(r[5]),Object(n.d)(r[6]),Object(n.d)(r[7])]}}return{planes:[xe(),xe(),xe(),xe(),xe(),xe()],points:[Object(n.e)(),Object(n.e)(),Object(n.e)(),Object(n.e)(),Object(n.e)(),Object(n.e)(),Object(n.e)(),Object(n.e)()]}}function rr(e,t,r=tr()){for(let i=0;i<6;i++)ye(e[i],r.planes[i]);for(let i=0;i<8;i++)Object(o.h)(r.points[i],t[i]);return r}function ir(e){const{planes:t,points:r}=e;je(r[4],r[0],r[3],t[0]),je(r[1],r[5],r[6],t[1]),je(r[4],r[5],r[1],t[2]),je(r[3],r[2],r[6],t[3]),je(r[0],r[1],r[2],t[4]),je(r[5],r[4],r[7],t[5])}function nr(e,t){for(let r=0;r<6;r++)if(!Ee(e[r],t))return!1;return!0}Object.freeze({__proto__:null,create:Yt,wrap:function(e,t,r){const i=er.get();return i.ray=e,i.c0=t,i.c1=r,i},copy:function(e,t=Yt()){return Jt(e.ray,e.c0,e.c1,t)},fromValues:Jt,fromRay:Kt,fromLineSegment:function(e,t=Yt()){return Qt(e,Object(o.o)(M.get(),e.vector),t)},fromLineSegmentAndDirection:Qt,getStart:function(e,t){return Zt(e,e.c0,t)},getEnd:function(e,t){return Zt(e,e.c1,t)},getAt:Zt});const or=[Object(j.b)(-1,-1,-1,1),Object(j.b)(1,-1,-1,1),Object(j.b)(1,1,-1,1),Object(j.b)(-1,1,-1,1),Object(j.b)(-1,-1,1,1),Object(j.b)(1,-1,1,1),Object(j.b)(1,1,1,1),Object(j.b)(-1,1,1,1)],ar=new x(Yt);Object.freeze({__proto__:null,create:tr,copy:function(e,t=tr()){return rr(e.planes,e.points,t)},fromValues:rr,fromMatrix:function(e,t,r=tr()){const{points:i}=r,n=Object(a.g)(A.get(),t,e);Object(a.a)(n,n);for(let a=0;a<8;++a){const e=Object(de.l)(C.get(),or[a],n);Object(o.r)(i[a],e[0]/e[3],e[1]/e[3],e[2]/e[3])}return ir(r),r},recomputePlanes:ir,intersectsSphere:function(e,t){for(let r=0;r<6;r++)if(De(e[r],t))return!1;return!0},intersectsRay:function(e,t){return nr(e,Kt(t,ar.get()))},intersectClipRay:function(e,t){for(let r=0;r<6;r++)if(!Ue(e[r],t))return!1;return!0},intersectsLineSegment:function(e,t,r){return nr(e,Qt(t,r,ar.get()))},intersectsPoint:function(e,t){for(let r=0;r<6;r++)if(He(e[r],t)>0)return!1;return!0},intersectsAABB:function(e,t){for(let r=0;r<6;r++)if(Ve(e[r],t))return!1;return!0},planePointIndices:{bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]}});var sr=r(\"7Nfj\");class cr{acquire(e,t,r,i,n,o){this.id=cr._idGen.gen(e&&e.id),this.geometry=e,this.material=t,this.transformation=r,this.instanceParameters=i,this.origin=n,this.shaderTransformation=o}getStaticTransformation(){return this.transformation}getShaderTransformation(){return this.shaderTransformation?this.shaderTransformation(this.transformation):this.transformation}computeAttachmentOrigin(e){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,e):this.geometry.computeAttachmentOrigin(e))&&(Object(o.j)(e,e,this.getStaticTransformation()),!0)}}cr._idGen=new ne,cr.pool=new sr.a(cr);var lr=cr;const ur=new ne;function dr(e){return{id:ur.gen(0===e?\"highlight\":\"occludee\"),channel:e}}var fr=r(\"tiP8\");class hr{constructor(e={}){this._objectTransformation=Object(l.b)(),this._bvObjectSpace=new pr,this._bvWorldSpace=new pr,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.id=hr._idGen.gen(e.idHint),this.castShadow=null==e.castShadow||e.castShadow,this.metadata=e.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new mr),this.objectTransformation=Object(l.b)(),this._initializeGeometryRecords(e.geometries,e.materials,e.transformations,e.origins)}get geometryRecords(){return this._geometryRecords}get geometries(){return this._geometries}get objectTransformation(){return this._objectTransformation}set objectTransformation(e){Object(a.c)(this._objectTransformation,e),this._invalidateBoundingVolume(),this._notifyDirty(\"objTransformation\")}dispose(){for(const e of this._geometryRecords)lr.pool.release(e);this._geometryRecords=null,this._geometries=null}_initializeGeometryRecords(e,t,r,i){if(!Array.isArray(e))return this._geometryRecords=[],void(this._geometries=[]);Object(re.b)(t.length===e.length,\"Object3D: materials don't match geometries\"),Object(re.b)(r.length===e.length,\"Object3D: transformations don't match geometries\"),this._geometryRecords=new Array(e.length),this._geometries=e.slice();for(let n=0;n<e.length;n++){const o={highlights:null,occludees:null,visible:!0};this._geometryRecords[n]=lr.pool.acquire(e[n],t[n],Object(l.c)(r[n]),o,i&&i[n])}this._hasVolatileTransformation=!1}get parentLayer(){return this._parentLayer}set parentLayer(e){Object(re.b)(null==this._parentLayer||null==e,\"Object3D can only be added to a single Layer\"),this._parentLayer=e}getNumGeometryRecords(){return this._geometryRecords.length}getGeometryRecord(e){return Object(re.b)(e>=0&&e<this._geometryRecords.length,\"Object3d.getGeometryDataByIndex: index out of range\"),this._geometryRecords[e]}addGeometry(e,t,r,i,n,o){r=r||l.a,this._geometries.push(e);const a=lr.pool.acquire(e,t,r,i||{highlights:null,occludees:null,visible:!0},n,o);return this._geometryRecords.push(a),this._hasVolatileTransformation=this._geometryRecords.some(e=>!!e.shaderTransformation),this._notifyDirty(\"objGeometryAdded\",a),this._invalidateBoundingVolume(),a}removeGeometry(e){const t=this._geometryRecords.splice(e,1)[0];return lr.pool.release(t),this._hasVolatileTransformation=this._geometryRecords.some(e=>!!e.shaderTransformation),this._geometries.splice(e,1),this._notifyDirty(\"objGeometryRemoved\",t),this._invalidateBoundingVolume(),t}removeAllGeometries(){for(;this.getNumGeometryRecords()>0;)this.removeGeometry(0)}geometryVertexAttrsUpdated(e){this._notifyDirty(\"vertexAttrsUpdated\",this._geometryRecords[e]),this._invalidateBoundingVolume()}get isVisible(){return this._visible}setVisible(e){this._visible=e;for(const t of this._geometryRecords)t.instanceParameters.visible=this._visible;this._notifyDirty(\"visibilityChanged\")}maskOccludee(){const e=dr(1);for(const t of this._geometryRecords)t.instanceParameters.occludees=Object(fr.a)(t.instanceParameters.occludees,e);return this._notifyDirty(\"occlusionChanged\"),e}removeOcclude(e){for(const t of this._geometryRecords)t.instanceParameters.occludees=Object(fr.c)(t.instanceParameters.occludees,e);this._notifyDirty(\"occlusionChanged\")}highlight(){const e=dr(0);for(const t of this._geometryRecords)t.instanceParameters.highlights=Object(fr.a)(t.instanceParameters.highlights,e);return this._notifyDirty(\"highlightChanged\"),e}removeHighlight(e){for(const t of this._geometryRecords)t.instanceParameters.highlights=Object(fr.c)(t.instanceParameters.highlights,e);this._notifyDirty(\"highlightChanged\")}getCombinedStaticTransformation(e,t){return Object(a.g)(Object(i.o)(t,Object(l.b)()),this.objectTransformation,e.getStaticTransformation())}getCombinedShaderTransformation(e,t){return t=t||Object(l.b)(),Object(a.g)(t,this.objectTransformation,e.getShaderTransformation()),t}hasVolativeTransformation(){return this._hasVolatileTransformation}getBBMin(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin}getBBMax(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax}getCenter(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.center:this._bvWorldSpace.center}getBSRadius(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius}_validateBoundingVolume(){if(!this._bvDirty&&!this._hasVolatileTransformation)return;this._bvObjectSpace.init(),this._bvWorldSpace.init();for(let i=0;i<this._geometryRecords.length;++i){const e=this._geometryRecords[i],t=this._geometries[i].boundingInfo;this._calculateTransformedBoundingVolume(t,this._bvObjectSpace,e.getShaderTransformation()),this._calculateTransformedBoundingVolume(t,this._bvWorldSpace,this.getCombinedShaderTransformation(e))}Object(o.f)(this._bvObjectSpace.center,this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5),Object(o.f)(this._bvWorldSpace.center,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);const e=Object(n.e)(),t=Object(n.e)(),r=Object(me.d)(this.objectTransformation);for(let i=0;i<this._geometryRecords.length;++i){const n=this._geometries[i],a=this._geometryRecords[i].getShaderTransformation(),s=Object(me.d)(a),c=n.boundingInfo;Object(o.j)(e,c.getCenter(),a);const l=Object(o.l)(e,this._bvObjectSpace.center),u=c.getBSRadius()*s;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,l+u),Object(o.j)(t,e,this.objectTransformation);const d=Object(o.l)(t,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,d+u*r)}this._bvDirty=!1}_calculateTransformedBoundingVolume(e,t,r){const i=e.getBBMin(),a=e.getBBMax(),s=Object(n.d)(i),c=Object(n.d)(a);Object(o.j)(s,s,r),Object(o.j)(c,c,r);for(let n=0;n<3;++n)t.bbMin[n]=Math.min(t.bbMin[n],s[n],c[n]),t.bbMax[n]=Math.max(t.bbMax[n],s[n],c[n]);for(let n=0;n<3;++n){Object(o.h)(s,i),Object(o.h)(c,a),s[n]=a[n],c[n]=i[n],Object(o.j)(s,s,r),Object(o.j)(c,c,r);for(let e=0;e<3;++e)t.bbMin[e]=Math.min(t.bbMin[e],s[e],c[e]),t.bbMax[e]=Math.max(t.bbMax[e],s[e],c[e])}}_invalidateBoundingVolume(){this._bvDirty=!0,this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,{center:this._bvWorldSpace.center,radius:this._bvWorldSpace.bsRadius})}_notifyDirty(e,t,r,i){this._parentLayer&&this._parentLayer.notifyDirty(e,t,r=r||1,i||this)}get test(){const e=this;return{hasGeometry:t=>e._geometries.indexOf(t)>-1,getGeometryIndex:t=>e._geometries.indexOf(t)}}}hr._idGen=new ne;class mr{constructor(){this.bbMin=Object(n.g)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.bbMax=Object(n.g)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]}}class pr extends mr{constructor(){super(),this.center=Object(n.e)(),this.bsRadius=0}init(){Object(o.r)(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),Object(o.r)(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),Object(o.r)(this.center,0,0,0),this.bsRadius=0}getCenter(){return this.center}getBSRadius(){return this.bsRadius}}const br=new class{constructor(e=0){this.offset=e,this.sphere=Rt(),this.tmpVertex=Object(n.e)()}applyToVertex(e,t,r){const i=this.objectTransform.transform;let n=i[0]*e+i[4]*t+i[8]*r+i[12],o=i[1]*e+i[5]*t+i[9]*r+i[13],a=i[2]*e+i[6]*t+i[10]*r+i[14];const s=this.offset/Math.sqrt(n*n+o*o+a*a);n+=n*s,o+=o*s,a+=a*s;const c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*n+c[4]*o+c[8]*a+c[12],this.tmpVertex[1]=c[1]*n+c[5]*o+c[9]*a+c[13],this.tmpVertex[2]=c[2]*n+c[6]*o+c[10]*a+c[14],this.tmpVertex}applyToMinMax(e,t){const r=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*r,e[1]+=e[1]*r,e[2]+=e[2]*r;const i=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*i,t[1]+=t[1]*i,t[2]+=t[2]*i}applyToAabb(e){const t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;const r=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*r,e[4]+=e[4]*r,e[5]+=e[5]*r,e}applyToBoundingSphere(e,t){const r=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),i=this.offset/r;return this.sphere.center[0]=t[0]+t[0]*i,this.sphere.center[1]=t[1]+t[1]*i,this.sphere.center[2]=t[2]+t[2]*i,this.sphere.radius=e+e*this.offset/r,this.sphere}};new class{constructor(e=0){this.offset=e,this.componentLocalOriginLength=0,this.tmpVertex=Object(n.e)(),this.mbs=Object(j.a)(),this.obb={center:Object(n.e)(),halfSize:Object(he.a)(),quaternion:null}}set localOrigin(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}applyToVertex(e,t,r){const i=e,n=t,o=r+this.componentLocalOriginLength,a=this.offset/Math.sqrt(i*i+n*n+o*o);return this.tmpVertex[0]=e+i*a,this.tmpVertex[1]=t+n*a,this.tmpVertex[2]=r+o*a,this.tmpVertex}applyToAabb(e){const t=e[0],r=e[1],i=e[2]+this.componentLocalOriginLength,n=e[3],o=e[4],a=e[5]+this.componentLocalOriginLength,s=this.offset/Math.sqrt(t*t+r*r+i*i);e[0]+=t*s,e[1]+=r*s,e[2]+=i*s;const c=this.offset/Math.sqrt(n*n+o*o+a*a);return e[3]+=n*c,e[4]+=o*c,e[5]+=a*c,e}applyToMbs(e){const t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=this.offset/t;return this.mbs[0]=e[0]+e[0]*r,this.mbs[1]=e[1]+e[1]*r,this.mbs[2]=e[2]+e[2]*r,this.mbs[3]=e[3]+e[3]*this.offset/t,this.mbs}applyToObb(e){const t=e.center,r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.obb.center[0]=t[0]+t[0]*r,this.obb.center[1]=t[1]+t[1]*r,this.obb.center[2]=t[2]+t[2]*r,Object(o.q)(this.obb.halfSize,e.halfSize,e.quaternion),Object(o.c)(this.obb.halfSize,this.obb.halfSize,e.center);const i=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*i,this.obb.halfSize[1]+=this.obb.halfSize[1]*i,this.obb.halfSize[2]+=this.obb.halfSize[2]*i,Object(o.g)(this.obb.halfSize,this.obb.halfSize,e.center),Object(fe.a)(gr,e.quaternion),Object(o.q)(this.obb.halfSize,this.obb.halfSize,gr),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=e.quaternion,this.obb}},new class{constructor(e=0){this.offset=e,this.tmpVertex=Object(n.e)()}applyToVertex(e,t,r){const i=e+this.localOrigin[0],n=t+this.localOrigin[1],o=r+this.localOrigin[2],a=this.offset/Math.sqrt(i*i+n*n+o*o);return this.tmpVertex[0]=e+i*a,this.tmpVertex[1]=t+n*a,this.tmpVertex[2]=r+o*a,this.tmpVertex}applyToAabb(e){const t=e[0]+this.localOrigin[0],r=e[1]+this.localOrigin[1],i=e[2]+this.localOrigin[2],n=e[3]+this.localOrigin[0],o=e[4]+this.localOrigin[1],a=e[5]+this.localOrigin[2],s=this.offset/Math.sqrt(t*t+r*r+i*i);e[0]+=t*s,e[1]+=r*s,e[2]+=i*s;const c=this.offset/Math.sqrt(n*n+o*o+a*a);return e[3]+=n*c,e[4]+=o*c,e[5]+=a*c,e}},Object(n.e)(),Object(n.e)(),Object(j.a)();const gr=Object(_.a)(),vr=e=>class extends e{constructor(){super(...arguments),this._isDisposed=!1}dispose(){for(const t of null!=(e=this._managedDisposables)?e:[]){var e;const r=this[t];this[t]=null,r&&\"function\"==typeof r.dispose&&r.dispose()}this._isDisposed=!0}get isDisposed(){return this._isDisposed}};class xr extends(vr(class{})){}var Or=class extends xr{constructor(e){super(),this.material=e.material,this.techniqueRep=e.techniqueRep,this.output=e.output}getTechnique(){return this.technique}getPipelineState(e,t){return this.getTechnique().pipeline}ensureResources(e){return 2}ensureParameters(e){}},yr=class extends Or{constructor(e){super(e),this._textureIDs=new Set,this._textureRepository=e.textureRep,this._textureId=e.textureId,this._initTransparent=!!e.initTextureTransparent,this._texture=this._acquireIfNotUndefined(this._textureId),this._textureNormal=this._acquireIfNotUndefined(e.normalTextureId),this._textureEmissive=this._acquireIfNotUndefined(e.emissiveTextureId),this._textureOcclusion=this._acquireIfNotUndefined(e.occlusionTextureId),this._textureMetallicRoughness=this._acquireIfNotUndefined(e.metallicRoughnessTextureId)}dispose(){this._textureIDs.forEach(e=>this._textureRepository.release(e)),this._textureIDs.clear()}updateTexture(e){e!==this._textureId&&(this._releaseIfNotUndefined(this._textureId),this._textureId=e,this._texture=this._acquireIfNotUndefined(this._textureId))}bindTexture(e,t){Object(i.h)(this._texture)&&(t.setUniform1i(\"tex\",0),e.bindTexture(this._texture.glTexture,0)),Object(i.h)(this._textureNormal)&&(t.setUniform1i(\"normalTexture\",1),e.bindTexture(this._textureNormal.glTexture,1)),Object(i.h)(this._textureEmissive)&&(t.setUniform1i(\"texEmission\",2),e.bindTexture(this._textureEmissive.glTexture,2)),Object(i.h)(this._textureOcclusion)&&(t.setUniform1i(\"texOcclusion\",3),e.bindTexture(this._textureOcclusion.glTexture,3)),Object(i.h)(this._textureMetallicRoughness)&&(t.setUniform1i(\"texMetallicRoughness\",4),e.bindTexture(this._textureMetallicRoughness.glTexture,4))}bindTextureScale(e,t){const r=Object(i.h)(this._texture)&&this._texture.glTexture;r&&r.descriptor.textureCoordinateScaleFactor?t.setUniform2fv(\"textureCoordinateScaleFactor\",r.descriptor.textureCoordinateScaleFactor):t.setUniform2f(\"textureCoordinateScaleFactor\",1,1)}_acquireIfNotUndefined(e){if(!Object(i.g)(e))return this._textureIDs.add(e),this._textureRepository.acquire(e,this._initTransparent)}_releaseIfNotUndefined(e){void 0!==e&&(this._textureIDs.delete(e),this._textureRepository.release(e))}},_r=r(\"fFEv\");const wr={position:0,normal:1,uv0:2,color:3,size:4,tangent:4,uvMapSpace:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,instanceColor:7,bound1:5,bound2:6,bound3:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15};class jr{constructor(e,t,r){this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=wr,this.id=jr._idGen.gen(e),this._params=Object(_r.c)(t,r),this.validateParameterValues(this._params)}dispose(){}get params(){return this._params}update(){return!1}setParameterValues(e){Object(_r.e)(this._params,e)&&(this.validateParameterValues(this._params),this.parametersChanged())}validateParameterValues(){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}isVisibleInPass(e){return!0}get renderOccluded(){return this.params.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){Object(i.h)(this.materialRepository)&&this.materialRepository.materialChanged(this)}}function Tr(e,t,r,i,n){const o=r.typedBuffer,a=r.typedBufferStride,s=e.length;if(i*=a,null==n||1===n)for(let c=0;c<s;++c){const r=2*e[c];o[i]=t[r],o[i+1]=t[r+1],i+=a}else for(let c=0;c<s;++c){const r=2*e[c];for(let e=0;e<n;++e)o[i]=t[r],o[i+1]=t[r+1],i+=a}}function Sr(e,t,r,i,n){const o=r.typedBuffer,a=r.typedBufferStride,s=e.length;if(i*=a,null==n||1===n)for(let c=0;c<s;++c){const r=3*e[c];o[i]=t[r],o[i+1]=t[r+1],o[i+2]=t[r+2],i+=a}else for(let c=0;c<s;++c){const r=3*e[c];for(let e=0;e<n;++e)o[i]=t[r],o[i+1]=t[r+1],o[i+2]=t[r+2],i+=a}}function Mr(e,t,r,i,n){const o=r.typedBuffer,a=r.typedBufferStride,s=e.length;if(i*=a,null==n||1===n)for(let c=0;c<s;++c){const r=4*e[c];o[i]=t[r],o[i+1]=t[r+1],o[i+2]=t[r+2],o[i+3]=t[r+3],i+=a}else for(let c=0;c<s;++c){const r=4*e[c];for(let e=0;e<n;++e)o[i]=t[r],o[i+1]=t[r+1],o[i+2]=t[r+2],o[i+3]=t[r+3],i+=a}}function Cr(e,t,r,i,n,o){if(r){const a=r,s=i.typedBuffer,c=i.typedBufferStride,l=e.length;if(n*=c,null==o||1===o)for(let r=0;r<l;++r){const i=3*e[r],o=t[i],l=t[i+1],u=t[i+2];s[n]=a[0]*o+a[4]*l+a[8]*u+a[12],s[n+1]=a[1]*o+a[5]*l+a[9]*u+a[13],s[n+2]=a[2]*o+a[6]*l+a[10]*u+a[14],n+=c}else for(let r=0;r<l;++r){const i=3*e[r],l=t[i],u=t[i+1],d=t[i+2],f=a[0]*l+a[4]*u+a[8]*d+a[12],h=a[1]*l+a[5]*u+a[9]*d+a[13],m=a[2]*l+a[6]*u+a[10]*d+a[14];for(let e=0;e<o;++e)s[n]=f,s[n+1]=h,s[n+2]=m,n+=c}}else Sr(e,t,i,n,o)}function Ar(e,t,r,i,n,o){if(r){const a=i.typedBuffer,s=i.typedBufferStride,c=e.length,l=r[0],u=r[1],d=r[2],f=r[4],h=r[5],m=r[6],p=r[8],b=r[9],g=r[10],v=Math.abs(1-l*l+f*f+p*p)>1e-5||Math.abs(1-u*u+h*h+b*b)>1e-5||Math.abs(1-d*d+m*m+g*g)>1e-5;if(n*=s,null==o||1===o)for(let r=0;r<c;++r){const i=3*e[r],o=t[i],c=t[i+1],x=t[i+2];let O=l*o+f*c+p*x,y=u*o+h*c+b*x,_=d*o+m*c+g*x;if(v){const e=O*O+y*y+_*_;if(e<.999999&&e>1e-6){const t=Math.sqrt(e);O/=t,y/=t,_/=t}}a[n+0]=O,a[n+1]=y,a[n+2]=_,n+=s}else for(let r=0;r<c;++r){const i=3*e[r],c=t[i],x=t[i+1],O=t[i+2];let y=l*c+f*x+p*O,_=u*c+h*x+b*O,w=d*c+m*x+g*O;if(v){const e=y*y+_*_+w*w;if(e<.999999&&e>1e-6){const t=Math.sqrt(e);y/=t,_/=t,w/=t}}for(let e=0;e<o;++e)a[n+0]=y,a[n+1]=_,a[n+2]=w,n+=s}}else Sr(e,t,i,n,o)}function Pr(e,t,r,i,n,o){const a=i.typedBuffer,s=i.typedBufferStride,c=e.length;if(n*=s,null==o||1===o){if(4===r)for(let l=0;l<c;++l){const r=4*e[l];a[n]=t[r],a[n+1]=t[r+1],a[n+2]=t[r+2],a[n+3]=t[r+3],n+=s}else if(3===r)for(let l=0;l<c;++l){const r=3*e[l];a[n]=t[r],a[n+1]=t[r+1],a[n+2]=t[r+2],a[n+3]=255,n+=s}}else if(4===r)for(let l=0;l<c;++l){const r=4*e[l];for(let e=0;e<o;++e)a[n]=t[r],a[n+1]=t[r+1],a[n+2]=t[r+2],a[n+3]=t[r+3],n+=s}else if(3===r)for(let l=0;l<c;++l){const r=3*e[l];for(let e=0;e<o;++e)a[n]=t[r],a[n+1]=t[r+1],a[n+2]=t[r+2],a[n+3]=255,n+=s}}jr._idGen=new ne;var Ir=r(\"69UF\"),Rr=r(\"GJyJ\");const Lr=Object(Rr.e)(770,1,771,771),Br=Object(Rr.f)(1,1),Fr=Object(Rr.f)(0,771),zr={factor:-1,units:-2};function Dr(e){return e?zr:null}function Nr(e){return 3===e||2===e?513:515}var Vr=r(\"pO5D\");class Er{constructor(e,t){this._module=e,this._loadModule=t}get(){return this._module}async reload(){return this._module=await this._loadModule(),this._module}}function Ur(e={}){return(t,r)=>{var i,n;t._parameterNames=null!=(i=t._parameterNames)?i:[],t._parameterNames.push(r);const o=t._parameterNames.length-1,a=e.count||2,s=Math.ceil(Object(P.h)(a)),c=null!=(n=t._parameterBits)?n:[0];let l=0;for(;c[l]+s>16;)l++,l>=c.length&&c.push(0);t._parameterBits=c;const u=c[l],d=(1<<s)-1<<u;c[l]+=s,Object.defineProperty(t,r,{get(){return this[o]},set(e){if(this[o]!==e&&(this[o]=e,this._keyDirty=!0,this._parameterBits[l]=this._parameterBits[l]&~d|+e<<u&d,\"number\"!=typeof e&&\"boolean\"!=typeof e))throw\"Configuration values must be booleans or numbers!\"}})}}var Gr,kr=r(\"jjdI\"),Hr=r(\"lwwL\");!function(e){function t(e,t,r){Object(a.j)(qr,r,t),e.setUniform3fv(\"localOrigin\",t),e.setUniformMatrix4fv(\"view\",qr)}e.bindCamPosition=function(e,t,r){e.setUniform3f(\"camPos\",r[3]-t[0],r[7]-t[1],r[11]-t[2])},e.bindProjectionMatrix=function(e,t){e.setUniformMatrix4fv(\"proj\",t)},e.bindNearFar=function(e,t){e.setUniform2fv(\"nearFar\",t)},e.bindViewCustomOrigin=t,e.bindView=function(e,r){t(e,r.origin,r.camera.viewMatrix)},e.bindViewport=function(e,t){e.setUniform4fv(\"viewport\",t.camera.fullViewport)}}(Gr||(Gr={}));const qr=Object(Hr.a)();var Wr=r(\"0nJL\"),$r=r(\"agdK\"),Xr=r(\"viRi\"),Yr=r(\"F7CJ\");const Jr={mask:255},Kr={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},Qr={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}};var Zr=r(\"0BfS\"),ei=r(\"aiF/\"),ti=r(\"1TnO\"),ri=r(\"p9cc\"),ii=r(\"AxBq\");class ni extends class{constructor(e,t){t&&(this._config=t.snapshot()),this._program=this.initializeProgram(e),e.commonUniformStore&&(this._commonUniformStore=e.commonUniformStore,this._commonUniformStore.subscribeProgram(this._program)),this._pipeline=this.initializePipeline(e)}dispose(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),this._program=null)}reload(e){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose()),this._program=this.initializeProgram(e),this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)}get program(){return this._program}get pipeline(){return this._pipeline}get key(){return this._config.key}get configuration(){return this._config}bindPass(e,t,r){}bindMaterial(e,t,r){}bindDraw(e,t,r){}bindPipelineState(e){e.setPipelineState(this.pipeline)}ensureAttributeLocations(e){this.program.assertCompatibleVertexAttributeLocations(e)}get primitiveType(){return 4}}{initializeProgram(e){const t=ni.shader.get(),r=this.configuration,i=t.build({OITEnabled:0===r.transparencyPassType,output:r.output,viewingMode:e.viewingMode,receiveShadows:r.receiveShadows,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:r.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:r.symbolColors,vvSize:r.vvSize,vvColor:r.vvColor,vvInstancingEnabled:!0,instanced:r.instanced,instancedColor:r.instancedColor,instancedDoublePrecision:r.instancedDoublePrecision,useOldSceneLightInterface:!1,pbrMode:r.usePBR?r.isSchematic?2:1:0,hasMetalnessAndRoughnessTexture:r.hasMetalnessAndRoughnessTexture,hasEmissionTexture:r.hasEmissionTexture,hasOcclusionTexture:r.hasOcclusionTexture,hasNormalTexture:r.hasNormalTexture,hasColorTexture:r.hasColorTexture,receiveAmbientOcclusion:r.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:r.normalsTypeDerivate?3:0,doubleSidedMode:r.doubleSidedMode,vertexTangets:r.vertexTangents,attributeTextureCoordinates:r.hasMetalnessAndRoughnessTexture||r.hasEmissionTexture||r.hasOcclusionTexture||r.hasNormalTexture||r.hasColorTexture?1:0,textureAlphaPremultiplied:r.textureAlphaPremultiplied,attributeColor:r.vertexColors,screenSizePerspectiveEnabled:r.screenSizePerspective,verticalOffsetEnabled:r.verticalOffset,offsetBackfaces:r.offsetBackfaces,doublePrecisionRequiresObfuscation:Object(ei.b)(e.rctx),alphaDiscardMode:r.alphaDiscardMode,supportsTextureAtlas:!1});return new kr.a(e.rctx,i.generateSource(\"vertex\"),i.generateSource(\"fragment\"),wr)}bindPass(e,t,r){Gr.bindProjectionMatrix(this.program,r.camera.projectionMatrix);const i=this.configuration.output;7===i&&(this.program.setUniform1f(\"opacity\",t.opacity),this.program.setUniform1f(\"layerOpacity\",t.layerOpacity),this.program.setUniform4fv(\"externalColor\",t.externalColor),this.program.setUniform1i(\"colorMixMode\",_r.b[t.colorMixMode])),0===i?(r.lighting.setUniforms(this.program,!1),this.program.setUniform3fv(\"ambient\",t.ambient),this.program.setUniform3fv(\"diffuse\",t.diffuse),this.program.setUniform4fv(\"externalColor\",t.externalColor),this.program.setUniform1i(\"colorMixMode\",_r.b[t.colorMixMode]),this.program.setUniform1f(\"opacity\",t.opacity),this.program.setUniform1f(\"layerOpacity\",t.layerOpacity),this.configuration.usePBR&&ri.a.bindUniforms(this.program,t,this.configuration.isSchematic)):1===i||3===i?this.program.setUniform2fv(\"nearFar\",r.camera.nearFar):4===i&&$r.a.bindOutputHighlight(e,this.program,r),Xr.a.bindUniformsForSymbols(this.program,t),Yr.a.bindUniforms(this.program,t,r),Object(_r.a)(t.screenSizePerspective,this.program,\"screenSizePerspectiveAlignment\"),2!==t.textureAlphaMode&&3!==t.textureAlphaMode||this.program.setUniform1f(\"textureAlphaCutoff\",t.textureAlphaCutoff)}bindDraw(e){const t=this.configuration.instancedDoublePrecision?Object(n.g)(e.camera.viewInverseTransposeMatrix[3],e.camera.viewInverseTransposeMatrix[7],e.camera.viewInverseTransposeMatrix[11]):e.origin;Gr.bindViewCustomOrigin(this.program,t,e.camera.viewMatrix),(0===this.configuration.output||7===this.configuration.output||1===this.configuration.output&&this.configuration.screenSizePerspective||2===this.configuration.output&&this.configuration.screenSizePerspective||4===this.configuration.output&&this.configuration.screenSizePerspective)&&Gr.bindCamPosition(this.program,t,e.camera.viewInverseTransposeMatrix),2===this.configuration.output&&this.program.setUniformMatrix4fv(\"viewNormal\",e.camera.viewInverseTransposeMatrix),this.configuration.instancedDoublePrecision&&ti.a.bindCustomOrigin(this.program,t),Wr.a.bindUniforms(this.program,this.configuration,e.slicePlane,t),0===this.configuration.output&&Zr.a.bindViewCustomOrigin(this.program,e,t)}setPipeline(e,t){const r=this.configuration,i=3===e,n=2===e;return Object(Rr.d)({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?Lr:(o=e,2===o?null:1===o?Fr:Br),culling:oi(r),depthTest:{func:Nr(e)},depthWrite:i||n?r.writeDepth&&Rr.c:null,colorWrite:Rr.b,stencilWrite:r.sceneHasOcludees?Jr:null,stencilTest:r.sceneHasOcludees?t?Qr:Kr:null,polygonOffset:i||n?null:Dr(r.enableOffset)});var o}initializePipeline(){return this._occludeePipelineState=this.setPipeline(this.configuration.transparencyPassType,!0),this.setPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}ni.shader=new Er(ii.a,()=>r.e(161).then(r.bind(null,\"SjXz\")));const oi=e=>function(e){return e.cullFace?0!==e.cullFace:!e.slicePlaneEnabled&&!e.transparent&&!e.doubleSidedMode}(e)&&{face:1===e.cullFace?1028:1029,mode:2305};class ai extends class{constructor(){this._key=\"\",this._keyDirty=!1,this._parameterBits=this._parameterBits.map(()=>0)}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){const e=this._parameterNames,t={key:this.key};for(const r of e)t[r]=this[r];return t}}{constructor(){super(...arguments),this.output=0,this.alphaDiscardMode=1,this.doubleSidedMode=0,this.isSchematic=!1,this.vertexColors=!1,this.offsetBackfaces=!1,this.symbolColors=!1,this.vvSize=!1,this.vvColor=!1,this.verticalOffset=!1,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.sliceHighlightDisabled=!1,this.receiveAmbientOcclusion=!1,this.screenSizePerspective=!1,this.textureAlphaPremultiplied=!1,this.hasColorTexture=!1,this.usePBR=!1,this.hasMetalnessAndRoughnessTexture=!1,this.hasEmissionTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1,this.instanced=!1,this.instancedColor=!1,this.instancedDoublePrecision=!1,this.vertexTangents=!1,this.normalsTypeDerivate=!1,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparent=!1,this.enableOffset=!0,this.cullFace=0,this.transparencyPassType=3}}Object(Vr.a)([Ur({count:8})],ai.prototype,\"output\",void 0),Object(Vr.a)([Ur({count:4})],ai.prototype,\"alphaDiscardMode\",void 0),Object(Vr.a)([Ur({count:3})],ai.prototype,\"doubleSidedMode\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"isSchematic\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"vertexColors\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"offsetBackfaces\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"symbolColors\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"vvSize\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"vvColor\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"verticalOffset\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"receiveShadows\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"slicePlaneEnabled\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"sliceHighlightDisabled\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"receiveAmbientOcclusion\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"screenSizePerspective\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"textureAlphaPremultiplied\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"hasColorTexture\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"usePBR\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"hasMetalnessAndRoughnessTexture\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"hasEmissionTexture\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"hasOcclusionTexture\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"hasNormalTexture\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"instanced\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"instancedColor\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"instancedDoublePrecision\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"vertexTangents\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"normalsTypeDerivate\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"writeDepth\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"sceneHasOcludees\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"transparent\",void 0),Object(Vr.a)([Ur()],ai.prototype,\"enableOffset\",void 0),Object(Vr.a)([Ur({count:3})],ai.prototype,\"cullFace\",void 0),Object(Vr.a)([Ur({count:4})],ai.prototype,\"transparencyPassType\",void 0);var si=r(\"sKsC\");class ci extends ni{initializeProgram(e){const t=ci.shader.get(),r=this.configuration,i=t.build({OITEnabled:0===r.transparencyPassType,output:r.output,viewingMode:e.viewingMode,receiveShadows:r.receiveShadows,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:r.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:r.symbolColors,vvSize:r.vvSize,vvColor:r.vvColor,vvInstancingEnabled:!0,instanced:r.instanced,instancedColor:r.instancedColor,instancedDoublePrecision:r.instancedDoublePrecision,useOldSceneLightInterface:!1,pbrMode:r.usePBR?1:0,hasMetalnessAndRoughnessTexture:!1,hasEmissionTexture:!1,hasOcclusionTexture:!1,hasNormalTexture:!1,hasColorTexture:r.hasColorTexture,receiveAmbientOcclusion:r.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:0,doubleSidedMode:2,vertexTangets:!1,attributeTextureCoordinates:r.hasColorTexture?1:0,textureAlphaPremultiplied:r.textureAlphaPremultiplied,attributeColor:r.vertexColors,screenSizePerspectiveEnabled:r.screenSizePerspective,verticalOffsetEnabled:r.verticalOffset,offsetBackfaces:r.offsetBackfaces,doublePrecisionRequiresObfuscation:Object(ei.b)(e.rctx),alphaDiscardMode:r.alphaDiscardMode,supportsTextureAtlas:!1});return new kr.a(e.rctx,i.generateSource(\"vertex\"),i.generateSource(\"fragment\"),wr)}}ci.shader=new Er(si.a,()=>r.e(159).then(r.bind(null,\"FmK6\")));class li extends jr{constructor(e,t){super(t,e,di),this.supportsEdges=!0,this.techniqueConfig=new ai,this.vertexBufferLayout=li.getVertexBufferLayout(this.params),this.instanceBufferLayout=e.instanced?li.getInstanceBufferLayout(this.params):null}isVisibleInPass(e){return 4!==e||this.params.castShadows}isVisible(){const e=this.params;if(!super.isVisible()||0===e.layerOpacity)return!1;const t=e.instanced,r=e.vertexColors,i=e.symbolColors,n=!!t&&t.indexOf(\"color\")>-1,o=e.vvColorEnabled,a=\"replace\"===e.colorMixMode,s=e.opacity>0,c=e.externalColor&&e.externalColor[3]>0;return r&&(n||o||i)?!!a||s:r?a?c:s:n||o||i?!!a||s:a?c:s}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.hasNormalTexture=!!this.params.normalTextureId,this.techniqueConfig.hasColorTexture=!!this.params.textureId,this.techniqueConfig.vertexTangents=this.params.vertexTangents,this.techniqueConfig.instanced=!!this.params.instanced,this.techniqueConfig.instancedDoublePrecision=this.params.instancedDoublePrecision,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.verticalOffset=null!==this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=null!==this.params.screenSizePerspective,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sliceHighlightDisabled=this.params.sliceHighlightDisabled,this.techniqueConfig.alphaDiscardMode=this.params.textureAlphaMode,this.techniqueConfig.normalsTypeDerivate=\"screenDerivative\"===this.params.normals,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.cullFace=null!=this.params.cullFace?this.params.cullFace:0,0!==e&&7!==e||(this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.symbolColors=this.params.symbolColors,this.techniqueConfig.doubleSidedMode=this.params.treeRendering?2:this.params.doubleSided&&\"normal\"===this.params.doubleSidedType?1:this.params.doubleSided&&\"winding-order\"===this.params.doubleSidedType?2:0,this.techniqueConfig.instancedColor=!!this.params.instanced&&this.params.instanced.indexOf(\"color\")>-1,this.techniqueConfig.receiveShadows=this.params.receiveShadows&&this.params.shadowMappingEnabled,this.techniqueConfig.receiveAmbientOcclusion=this.params.receiveSSAO,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.textureAlphaPremultiplied=!!this.params.textureAlphaPremultiplied,this.techniqueConfig.usePBR=this.params.usePBR,this.techniqueConfig.hasMetalnessAndRoughnessTexture=!!this.params.metallicRoughnessTextureId,this.techniqueConfig.hasEmissionTexture=!!this.params.emissiveTextureId,this.techniqueConfig.hasOcclusionTexture=!!this.params.occlusionTextureId,this.techniqueConfig.offsetBackfaces=!(!this.params.transparent||!this.params.offsetTransparentBackfaces),this.techniqueConfig.isSchematic=this.params.usePBR&&this.params.isSchematic,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<5e5),this.techniqueConfig}intersect(e,t,r,n,a,s,c){if(null!==this.params.verticalOffset){const e=n.camera;Object(o.r)(vi,r[12],r[13],r[14]);let t=null;switch(n.viewingMode){case 1:t=Object(o.o)(bi,vi);break;case 2:t=Object(o.h)(bi,pi)}let i=0;if(null!==this.params.verticalOffset){const r=Object(o.g)(xi,vi,e.eye),n=Object(o.m)(r),a=Object(o.b)(r,r,1/n);let s=null;this.params.screenSizePerspective&&(s=Object(o.e)(t,a)),i+=Object(_r.f)(e,n,this.params.verticalOffset,s,this.params.screenSizePerspective)}Object(o.b)(t,t,i),Object(o.s)(gi,t,n.transform.inverseRotation),a=Object(o.g)(hi,a,gi),s=Object(o.g)(mi,s,gi)}Object(_r.d)(e,t,n,a,s,function(e){return Object(i.h)(e)?(br.offset=e,br):null}(n.verticalOffset),c)}getGLMaterial(e){if(0===e.output||7===e.output||1===e.output||2===e.output||3===e.output||4===e.output)return new ui(e)}createBufferWriter(){return new fi(this.vertexBufferLayout,this.instanceBufferLayout)}static getVertexBufferLayout(e){const t=e.textureId||e.normalTextureId||e.metallicRoughnessTextureId||e.emissiveTextureId||e.occlusionTextureId,r=Object(ue.a)().vec3f(\"position\").vec3f(\"normal\");return e.vertexTangents&&r.vec4f(\"tangent\"),t&&r.vec2f(\"uv0\"),e.vertexColors&&r.vec4u8(\"color\"),e.symbolColors&&r.vec4u8(\"symbolColor\"),r}static getInstanceBufferLayout(e){let t=Object(ue.a)();return t=e.instancedDoublePrecision?t.vec3f(\"modelOriginHi\").vec3f(\"modelOriginLo\").mat3f(\"model\").mat3f(\"modelNormal\"):t.mat4f(\"model\").mat4f(\"modelNormal\"),e.instanced&&e.instanced.indexOf(\"color\")>-1&&(t=t.vec4f(\"instanceColor\")),e.instanced&&e.instanced.indexOf(\"featureAttribute\")>-1&&(t=t.vec4f(\"instanceFeatureAttribute\")),t}}class ui extends yr{constructor(e){const t=e.material;super({...e,...t.params}),this.updateParameters()}updateParameters(e){const t=this.material.params;this.updateTexture(t.textureId),this.technique=this.techniqueRep.acquireAndReleaseExisting(t.treeRendering?ci:ni,this.material.getTechniqueConfig(this.output,e),this.technique)}selectPipelines(){}_updateShadowState(e){e.shadowMappingEnabled!==this.material.params.shadowMappingEnabled&&this.material.setParameterValues({shadowMappingEnabled:e.shadowMappingEnabled})}_updateOccludeeState(e){e.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:e.hasOccludees})}ensureParameters(e){0!==this.output&&7!==this.output||(this._updateShadowState(e),this._updateOccludeeState(e)),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.params,t),this.bindTexture(e,this.technique.program)}beginSlot(e){return e===(this.material.params.transparent?this.material.params.writeDepth?5:8:3)}getPipelineState(e,t){return this.technique.getPipelineState(t)}}const di={textureId:void 0,initTextureTransparent:!1,isSchematic:!1,usePBR:!1,normalTextureId:void 0,vertexTangents:!1,occlusionTextureId:void 0,emissiveTextureId:void 0,metallicRoughnessTextureId:void 0,emissiveFactor:[0,0,0],mrrFactors:[0,1,.5],ambient:[.2,.2,.2],diffuse:[.8,.8,.8],externalColor:[1,1,1,1],colorMixMode:\"multiply\",opacity:1,layerOpacity:1,vertexColors:!1,symbolColors:!1,doubleSided:!1,doubleSidedType:\"normal\",cullFace:void 0,instanced:void 0,instancedDoublePrecision:!1,normals:\"default\",receiveSSAO:!0,receiveShadows:!0,castShadows:!0,shadowMappingEnabled:!1,verticalOffset:null,screenSizePerspective:null,slicePlaneEnabled:!1,sliceHighlightDisabled:!1,offsetTransparentBackfaces:!1,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvSizeValue:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:Object(c.a)(),transparent:!1,writeDepth:!0,textureAlphaMode:0,textureAlphaCutoff:Ir.b,textureAlphaPremultiplied:!1,sceneHasOcludees:!1,renderOccluded:1};class fi{constructor(e,t){this.vertexBufferLayout=e,this.instanceBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.position.length}write(e,t,r,i){!function(e,t,r,i,n,o){for(const a of t.fieldNames){const t=e.vertexAttr[a],s=e.indices[a];if(t&&s)switch(a){case re.a.POSITION:{Object(re.b)(3===t.size);const e=n.getField(a,d.u);e&&Cr(s,t.data,r,e,o);break}case re.a.NORMAL:{Object(re.b)(3===t.size);const e=n.getField(a,d.u);e&&Ar(s,t.data,i,e,o);break}case re.a.UV0:{Object(re.b)(2===t.size);const e=n.getField(a,d.m);e&&Tr(s,t.data,e,o);break}case re.a.UVMAPSPACE:{Object(re.b)(4===t.size);const e=n.getField(a,d.C);e&&Mr(s,t.data,e,o);break}case re.a.MEANVERTEXPOSITION:{Object(re.b)(3===t.size);const e=n.getField(a,d.u);e&&Cr(s,t.data,r,e,o);break}case re.a.BOUND1:case re.a.BOUND2:case re.a.BOUND3:{Object(re.b)(3===t.size);const e=n.getField(a,d.u);e&&Cr(s,t.data,r,e,o);break}case re.a.COLOR:{Object(re.b)(3===t.size||4===t.size);const e=n.getField(a,d.J);e&&Pr(s,t.data,t.size,e,o);break}case re.a.SYMBOLCOLOR:{Object(re.b)(3===t.size||4===t.size);const e=n.getField(a,d.J);e&&Pr(s,t.data,t.size,e,o);break}case re.a.TANGENT:{Object(re.b)(4===t.size);const e=n.getField(a,d.C);e&&Mr(s,t.data,e,o);break}}}}(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,i)}}const hi=Object(n.e)(),mi=Object(n.e)(),pi=Object(n.g)(0,0,1),bi=Object(n.e)(),gi=Object(n.e)(),vi=Object(n.e)(),xi=Object(n.e)();var Oi=r(\"bJda\"),yi=r(\"ohva\"),_i=r(\"zlDU\"),wi=r(\"4EHJ\"),ji=r(\"9MzC\"),Ti=r(\"zm0L\"),Si=r(\"Ioo4\"),Mi=r(\"LbAs\"),Ci=r(\"of9L\"),Ai=r(\"hTmG\"),Pi=r(\"fOQB\"),Ii=r(\"D6bk\");const Ri=[{name:\"position\",count:2,type:5126,offset:0,stride:8,normalized:!1}],Li=[{name:\"position\",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:\"uv0\",count:2,type:5126,offset:8,stride:16,normalized:!1}];var Bi=r(\"0meK\"),Fi=r(\"xRQN\");const zi=f.a.getLogger(\"esri.views.3d.webgl-engine.lib.DDSUtil\");function Di(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}const Ni=Di(\"DXT1\"),Vi=Di(\"DXT3\"),Ei=Di(\"DXT5\");class Ui{constructor(e,t,r){this.data=e,this.glTexture=null,this.powerOfTwoStretchInfo=null,this.loadingPromise=null,this.loadingController=null,this.events=new Ti.a,this.data=e,this.id=Ui.idGen.gen(t),this.params=r||{},this.params.mipmap=!1!==this.params.mipmap,this.params.noUnpackFlip=this.params.noUnpackFlip||!1,this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1,this.params.wrap=this.params.wrap||{s:10497,t:10497},this.params.powerOfTwoResizeMode=this.params.powerOfTwoResizeMode||1,this.estimatedTexMemRequired=Ui.estimateTexMemRequired(this.data,this.params),this.startPreload()}startPreload(){const e=this.data;Object(i.g)(e)||(e instanceof HTMLVideoElement?this.startPreloadVideoElement(e):e instanceof HTMLImageElement&&this.startPreloadImageElement(e))}startPreloadVideoElement(e){Object(wi.t)(e.src)||\"auto\"===e.preload&&e.crossOrigin||(e.preload=\"auto\",e.crossOrigin=\"anonymous\",e.src=e.src)}startPreloadImageElement(e){Object(wi.u)(e.src)||Object(wi.t)(e.src)||e.crossOrigin||(e.crossOrigin=\"anonymous\",e.src=e.src)}static getDataDimensions(e){return e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e}static estimateTexMemRequired(e,t){if(Object(i.g)(e))return 0;if(Object(yi.c)(e)||Object(yi.k)(e))return e.byteLength;const{width:r,height:n}=e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement?Ui.getDataDimensions(e):t;return(t.mipmap?4/3:1)*r*n*(t.components||4)||0}dispose(){this.data=void 0}get width(){return this.params.width}get height(){return this.params.height}createDescriptor(e){return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:this.params.mipmap&&!this.params.disableAnisotropy?e.parameters.maxMaxAnisotropy:void 0}}load(e,t){if(Object(i.h)(this.glTexture))return this.glTexture;if(Object(i.h)(this.loadingPromise))return this.loadingPromise;const r=this.data;return Object(i.g)(r)?(this.glTexture=new Ci.a(e,this.createDescriptor(e),null),e.bindTexture(this.glTexture,0),this.glTexture):\"string\"==typeof r?this.loadFromURL(e,t,r):r instanceof Image?this.loadFromImageElement(e,t,r):r instanceof HTMLVideoElement?this.loadFromVideoElement(e,t,r):r instanceof ImageData||r instanceof HTMLCanvasElement?this.loadFromImage(e,r,t):(Object(yi.c)(r)||Object(yi.k)(r))&&this.params.encoding===Ui.DDS_ENCODING?this.loadFromDDSData(e,r):Object(yi.k)(r)?this.loadFromPixelData(e,r):Object(yi.c)(r)?this.loadFromPixelData(e,new Uint8Array(r)):null}get requiresFrameUpdates(){return this.data instanceof HTMLVideoElement}frameUpdate(e,t,r){if(!(this.data instanceof HTMLVideoElement)||Object(i.g)(this.glTexture))return r;if(this.data.readyState<2||r===this.data.currentTime)return r;if(Object(i.h)(this.powerOfTwoStretchInfo)){const{framebuffer:r,vao:i,sourceTexture:n}=this.powerOfTwoStretchInfo;n.setData(this.data),this.drawStretchedTexture(e,t,r,i,n,this.glTexture)}else{const{width:e,height:t}=this.data,{width:r,height:i}=this.glTexture.descriptor;e!==r||t!==i?this.glTexture.updateData(0,0,0,Math.min(e,r),Math.min(t,i),this.data):this.glTexture.setData(this.data)}return this.glTexture.descriptor.hasMipmap&&this.glTexture.generateMipmap(),this.data.currentTime}loadFromDDSData(e,t){return this.glTexture=function(e,t,r,i){const{textureData:n,internalFormat:o,width:a,height:s}=function(e,t){const r=new Int32Array(e,0,31);if(542327876!==r[0])return zi.error(\"Invalid magic number in DDS header\"),null;if(!(4&r[20]))return zi.error(\"Unsupported format, must contain a FourCC code\"),null;const i=r[21];let n,o;switch(i){case Ni:n=8,o=33776;break;case Vi:n=16,o=33778;break;case Ei:n=16,o=33779;break;default:return zi.error(\"Unsupported FourCC code:\",(a=i,String.fromCharCode(255&a,a>>8&255,a>>16&255,a>>24&255))),null}var a;let s=1,c=r[4],l=r[3];0==(3&c)&&0==(3&l)||(zi.warn(\"Rounding up compressed texture size to nearest multiple of 4.\"),c=c+3&-4,l=l+3&-4);const u=c,d=l;let f,h;131072&r[2]&&!1!==t&&(s=Math.max(1,r[7])),1===s||Object(P.f)(c)&&Object(P.f)(l)||(zi.warn(\"Ignoring mipmaps of non power of two sized compressed texture.\"),s=1);let m=r[1]+4;const p=[];for(let b=0;b<s;++b)h=(c+3>>2)*(l+3>>2)*n,f=new Uint8Array(e,m,h),p.push(f),m+=h,c=Math.max(1,c>>1),l=Math.max(1,l>>1);return{textureData:{type:\"compressed\",levels:p},internalFormat:o,width:u,height:d}}(r,i);t.samplingMode=n.levels.length>1?9987:9729,t.hasMipmap=n.levels.length>1,t.internalFormat=o,t.width=a,t.height=s;const c=new Ci.a(e,t,n);return e.bindTexture(c,0),c}(e,this.createDescriptor(e),t,this.params.mipmap),e.bindTexture(this.glTexture,0),this.glTexture}loadFromPixelData(e,t){Object(re.b)(this.params.width>0&&this.params.height>0);const r=this.createDescriptor(e);return r.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408,r.width=this.params.width,r.height=this.params.height,this.glTexture=new Ci.a(e,r,t),e.bindTexture(this.glTexture,0),this.glTexture}async loadAsync(e){const t=Object(ji.d)();this.loadingController=t;const r=e(t.signal);this.loadingPromise=r;const i=()=>{this.loadingController===t&&(this.loadingController=null),this.loadingPromise===r&&(this.loadingPromise=null)};return r.then(i,i),r}loadFromURL(e,t,r){return this.loadAsync(async i=>{const n=await Object(Mi.a)(r,{signal:i});return this.loadFromImage(e,n,t)})}loadFromImageElement(e,t,r){return r.complete?this.loadFromImage(e,r,t):this.loadAsync(async i=>{const n=await Object(Si.a)(r,r.src,!1,i);return this.loadFromImage(e,n,t)})}loadFromVideoElement(e,t,r){return r.readyState>=2?this.loadFromImage(e,r,t):this.loadFromVideoElementAsync(e,t,r)}loadFromVideoElementAsync(e,t,r){return this.loadAsync(n=>Object(ji.c)((o,a)=>{const s=()=>{r.removeEventListener(\"loadeddata\",c),r.removeEventListener(\"error\",l),Object(i.h)(u)&&u.remove()},c=()=>{r.readyState>=2&&(s(),o(this.loadFromImage(e,r,t)))},l=e=>{s(),a(e||new _i.a(\"Failed to load video\"))};r.addEventListener(\"loadeddata\",c),r.addEventListener(\"error\",l);const u=Object(ji.r)(n,()=>l(Object(ji.e)()))}))}loadFromImage(e,t,r){const i=Ui.getDataDimensions(t);this.params.width=i.width,this.params.height=i.height;const n=this.createDescriptor(e);return n.pixelFormat=3===this.params.components?6407:6408,!this.requiresPowerOfTwo(e,n)||Object(P.f)(i.width)&&Object(P.f)(i.height)?(n.width=i.width,n.height=i.height,this.glTexture=new Ci.a(e,n,t),e.bindTexture(this.glTexture,0),this.glTexture):(this.glTexture=this.makePowerOfTwoTexture(e,t,i,n,r),e.bindTexture(this.glTexture,0),this.glTexture)}requiresPowerOfTwo(e,t){const r=33071,i=\"number\"==typeof t.wrapMode?t.wrapMode===r:t.wrapMode.s===r&&t.wrapMode.t===r;return!Object(Fi.a)(e.gl)&&(t.hasMipmap||!i)}makePowerOfTwoTexture(e,t,r,i,n){const{width:o,height:a}=r,s=Object(P.i)(o),c=Object(P.i)(a);let l;switch(i.width=s,i.height=c,this.params.powerOfTwoResizeMode){case 2:i.textureCoordinateScaleFactor=[o/s,a/c],l=new Ci.a(e,i),l.updateData(0,0,0,o,a,t);break;case 1:case null:case void 0:l=this.stretchToPowerOfTwo(e,t,i,n);break;default:Object(Oi.a)(this.params.powerOfTwoResizeMode)}return i.hasMipmap&&l.generateMipmap(),l}stretchToPowerOfTwo(e,t,r,i){const n=new Ci.a(e,r),o=new Bi.a(e,{colorTarget:0,depthStencilTarget:0},n),a=new Ci.a(e,{target:3553,pixelFormat:r.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!r.flipped,maxAnisotropy:8,preMultiplyAlpha:r.preMultiplyAlpha},t),s=function(e,t=Ri,r=wr,i=-1,n=1){let o=null;switch(t){case Li:o=new Float32Array([i,i,0,0,n,i,1,0,i,n,0,1,n,n,1,1]);break;case Ri:default:o=new Float32Array([i,i,n,i,i,n,n,n])}return new Ii.a(e,r,{geometry:t},{geometry:Pi.a.createVertex(e,35044,o)})}(e);return this.drawStretchedTexture(e,i,o,s,a,n),this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:s,sourceTexture:a,framebuffer:o}:(s.dispose(!0),a.dispose(),o.detachColorTexture(),e.bindFramebuffer(null),o.dispose()),n}drawStretchedTexture(e,t,r,i,n,o){e.bindFramebuffer(r);const a=e.getViewport();e.setViewport(0,0,o.descriptor.width,o.descriptor.height);const s=t.program;e.bindProgram(s),s.setUniform4f(\"color\",1,1,1,1),s.setUniform1i(\"tex\",0),e.bindTexture(n,0),e.bindVAO(i),e.setPipelineState(t.pipeline),e.drawArrays(5,0,Object(Ai.c)(i,\"geometry\")),e.bindFramebuffer(null),e.setViewport(a.x,a.y,a.width,a.height)}unload(){if(Object(i.h)(this.powerOfTwoStretchInfo)){const{framebuffer:e,vao:t,sourceTexture:r}=this.powerOfTwoStretchInfo;t.dispose(!0),r.dispose(),e.dispose(),this.glTexture=null,this.powerOfTwoStretchInfo=null}if(Object(i.h)(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null),Object(i.h)(this.loadingController)){const e=this.loadingController;this.loadingController=null,this.loadingPromise=null,e.abort()}this.events.emit(\"unloaded\")}}Ui.idGen=new ne,Ui.DDS_ENCODING=\"image/vnd-ms.dds\";var Gi=Ui,ki=r(\"Lqtk\"),Hi=r(\"eSsm\");class qi{constructor(e){this.streamDataRequester=e}async loadJSON(e,t){return this.load(\"json\",e,t)}async loadBinary(e,t){return Object(wi.u)(e)?(Object(ji.w)(t),Object(wi.j)(e)):this.load(\"binary\",e,t)}async loadImage(e,t){return this.load(\"image\",e,t)}async load(e,t,r){if(Object(i.g)(this.streamDataRequester))return(await Object(ki.default)(t,{responseType:Wi[e]})).data;const n=await Object(Hi.c)(this.streamDataRequester.request(t,e,r));if(!0===n.ok)return n.value;throw Object(ji.v)(n.error),new _i.a(\"\",\"Request for resource failed: \"+n.error)}}const Wi={image:\"image\",binary:\"array-buffer\",json:\"json\"};var $i=r(\"grla\");function Xi(e,t,r){const i=e.typedBuffer,n=e.typedBufferStride,o=t.typedBuffer,a=t.typedBufferStride,s=r?r.count:t.count;let c=(r&&r.dstIndex?r.dstIndex:0)*n,l=(r&&r.srcIndex?r.srcIndex:0)*a;for(let u=0;u<s;++u)i[c]=o[l],i[c+1]=o[l+1],c+=n,l+=a}function Yi(e,t,r){const i=e.typedBuffer,n=e.typedBufferStride,o=t.typedBuffer,a=t.typedBufferStride,s=r?r.count:t.count;let c=(r&&r.dstIndex?r.dstIndex:0)*n,l=(r&&r.srcIndex?r.srcIndex:0)*a;if(Object($i.b)(t.elementType)){const e=Object($i.d)(t.elementType);if(Object($i.c)(t.elementType))for(let t=0;t<s;++t)i[c]=Math.max(o[l]/e,-1),i[c+1]=Math.max(o[l+1]/e,-1),c+=n,l+=a;else for(let t=0;t<s;++t)i[c]=o[l]/e,i[c+1]=o[l+1]/e,c+=n,l+=a}else Xi(e,t,r);return e}function Ji(e,t,r){const i=e.typedBuffer,n=e.typedBufferStride,o=t.typedBuffer,a=t.typedBufferStride,s=r?r.count:t.count;let c=(r&&r.dstIndex?r.dstIndex:0)*n,l=(r&&r.srcIndex?r.srcIndex:0)*a;for(let u=0;u<s;++u)i[c]=o[l],i[c+1]=o[l+1],i[c+2]=o[l+2],c+=n,l+=a}function Ki(e,t,r){const i=e.typedBuffer,n=e.typedBufferStride,o=t.typedBuffer,a=t.typedBufferStride,s=r?r.count:t.count;let c=(r&&r.dstIndex?r.dstIndex:0)*n,l=(r&&r.srcIndex?r.srcIndex:0)*a;for(let u=0;u<s;++u)i[c]=o[l],i[c+1]=o[l+1],i[c+2]=o[l+2],i[c+3]=o[l+3],c+=n,l+=a}function Qi(e,t,r,i,n,o){const a=e.typedBuffer,s=e.typedBufferStride,c=o?o.count:e.count;let l=(o&&o.dstIndex?o.dstIndex:0)*s;for(let u=0;u<c;++u)a[l]=t,a[l+1]=r,a[l+2]=i,a[l+3]=n,l+=s}function Zi(e,t){const r=e.count;t||(t=new e.TypedArrayConstructor(r));for(let i=0;i<r;i++)t[i]=e.get(i);return t}function en(e,t){return new e(new ArrayBuffer(t*e.ElementCount*Object($i.a)(e.ElementType)))}Object.freeze({__proto__:null,copy:Xi,normalizeIntegerBuffer:Yi}),Object.freeze({__proto__:null,copy:Ji}),Object.freeze({__proto__:null,copy:Ki,fill:Qi}),Object.freeze({__proto__:null,copy:function(e,t,r){const i=e.typedBuffer,n=e.typedBufferStride,o=t.typedBuffer,a=t.typedBufferStride,s=r?r.count:t.count;let c=(r&&r.dstIndex?r.dstIndex:0)*n,l=(r&&r.srcIndex?r.srcIndex:0)*a;for(let u=0;u<s;++u){for(let e=0;e<9;++e)i[c+e]=o[l+e];c+=n,l+=a}}}),Object.freeze({__proto__:null,copy:function(e,t,r){const i=e.typedBuffer,n=e.typedBufferStride,o=t.typedBuffer,a=t.typedBufferStride,s=r?r.count:t.count;let c=(r&&r.dstIndex?r.dstIndex:0)*n,l=(r&&r.srcIndex?r.srcIndex:0)*a;for(let u=0;u<s;++u){for(let e=0;e<16;++e)i[c+e]=o[l+e];c+=n,l+=a}}}),Object.freeze({__proto__:null,copy:function(e,t,r){const i=e.typedBuffer,n=e.typedBufferStride,o=t.typedBuffer,a=t.typedBufferStride,s=r?r.count:t.count;let c=(r&&r.dstIndex?r.dstIndex:0)*n,l=(r&&r.srcIndex?r.srcIndex:0)*a;for(let u=0;u<s;++u)i[c]=o[l],c+=n,l+=a},makeDense:Zi});const tn=f.a.getLogger(\"esri.views.3d.glTF\");class rn{constructor(e,t,r=\"\"){this.major=e,this.minor=t,this._context=r}lessThan(e,t){return this.major<e||e===this.major&&this.minor<t}since(e,t){return!this.lessThan(e,t)}validate(e){if(this.major!==e.major)throw new _i.a((this._context&&this._context+\":\")+\"unsupported-version\",`Required major ${this._context&&this._context+\" \"}version is '${this.major}', but got '\\${version.major}.\\${version.minor}'`,{version:e})}clone(){return new rn(this.major,this.minor,this._context)}static parse(e,t=\"\"){const[r,i]=e.split(\".\"),n=/^\\s*\\d+\\s*$/;if(!r||!r.match||!r.match(n))throw new _i.a((t&&t+\":\")+\"invalid-version\",\"Expected major version to be a number, but got '${version}'\",{version:e});if(!i||!i.match||!i.match(n))throw new _i.a((t&&t+\":\")+\"invalid-version\",\"Expected minor version to be a number, but got '${version}'\",{version:e});const o=parseInt(r,10),a=parseInt(i,10);return new rn(o,a,t)}}class nn{constructor(e){this.data=e,this.offset4=0,this.dataUint32=new Uint32Array(this.data,0,Math.floor(this.data.byteLength/4))}readUint32(){const e=this.offset4;return this.offset4+=1,this.dataUint32[e]}readUint8Array(e){const t=4*this.offset4;return this.offset4+=e/4,new Uint8Array(this.data,t,e)}remainingBytes(){return this.data.byteLength-4*this.offset4}}const on={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},an={pbrMetallicRoughness:on,emissiveFactor:[0,0,0],alphaMode:\"OPAQUE\",alphaCutoff:.5,doubleSided:!1},sn={ESRI_externalColorMixMode:\"tint\"},cn=(e={})=>{const t={...on,...e.pbrMetallicRoughness},r=function(e){switch(e.ESRI_externalColorMixMode){case\"multiply\":case\"tint\":case\"ignore\":case\"replace\":break;default:Object(Oi.a)(e.ESRI_externalColorMixMode),e.ESRI_externalColorMixMode=\"tint\"}return e}({...sn,...e.extras});return{...an,...e,pbrMetallicRoughness:t,extras:r}},ln={magFilter:9729,minFilter:9987,wrapS:10497,wrapT:10497},un=1179937895;class dn{constructor(e,t,r,i,n){this.context=e,this.errorContext=t,this.uri=r,this.json=i,this.glbBuffer=n,this.bufferCache=new Map,this.textureCache=new Map,this.materialCache=new Map,this.nodeParentMap=new Map,this.nodeTransformCache=new Map,this.baseUri=function(e){let t,r;return e.replace(/^(.*\\/)?([^/]*)$/,(e,i,n)=>(t=i||\"\",r=n||\"\",\"\")),{dirPart:t,filePart:r}}(this.uri).dirPart,this.checkVersionSupported(),this.checkRequiredExtensionsSupported(),t.errorUnsupportedIf(null==i.scenes,\"Scenes must be defined.\"),t.errorUnsupportedIf(null==i.meshes,\"Meshes must be defined\"),t.errorUnsupportedIf(null==i.nodes,\"Nodes must be defined.\"),this.computeNodeParents()}static async load(e,t,r,i){if(Object(wi.u)(r)){const i=Object(wi.i)(r);if(\"model/gltf-binary\"!==i.mediaType)try{const n=JSON.parse(i.isBase64?atob(i.data):i.data);return new dn(e,t,r,n)}catch{}const n=Object(wi.j)(r);if(dn.isGLBData(n))return this.fromGLBData(e,t,r,n)}if(r.endsWith(\".gltf\")){const n=await e.loadJSON(r,i);return new dn(e,t,r,n)}const n=await e.loadBinary(r,i);if(dn.isGLBData(n))return this.fromGLBData(e,t,r,n);const o=await e.loadJSON(r,i);return new dn(e,t,r,o)}static isGLBData(e){const t=new nn(e);return t.remainingBytes()>=4&&t.readUint32()===un}static async fromGLBData(e,t,r,i){const n=await dn.parseGLBData(t,i);return new dn(e,t,r,n.json,n.binaryData)}static async parseGLBData(e,t){const r=new nn(t);e.assert(r.remainingBytes()>=12,\"GLB binary data is insufficiently large.\");const i=r.readUint32(),n=r.readUint32(),o=r.readUint32();e.assert(i===un,\"Magic first 4 bytes do not fit to expected GLB value.\"),e.assert(t.byteLength>=o,\"GLB binary data is smaller than header specifies.\"),e.errorUnsupportedIf(2!==n,\"An unsupported GLB container version was detected. Only version 2 is supported.\");let a,s,c=0;for(;r.remainingBytes()>=8;){const t=r.readUint32(),i=r.readUint32();0===c?(e.assert(1313821514===i,\"First GLB chunk must be JSON.\"),e.assert(t>=0,\"No JSON data found.\"),a=await gn(r.readUint8Array(t))):1===c?(e.errorUnsupportedIf(5130562!==i,\"Second GLB chunk expected to be BIN.\"),s=r.readUint8Array(t)):e.warnUnsupported(\"More than 2 GLB chunks detected. Skipping.\"),c+=1}return a||e.error(\"No GLB JSON chunk detected.\"),{json:a,binaryData:s}}async getBuffer(e,t){const r=this.json.buffers[e],i=this.errorContext;if(null==r.uri)return i.assert(null!=this.glbBuffer,\"GLB buffer not present\"),this.glbBuffer;let n=this.bufferCache.get(e);if(!n){const o=await this.context.loadBinary(this.resolveUri(r.uri),t);n=new Uint8Array(o),this.bufferCache.set(e,n),i.assert(n.byteLength===r.byteLength,\"Buffer byte lengths should match.\")}return n}async getAccessor(e,t){const r=this.json.accessors[e],i=this.errorContext;i.errorUnsupportedIf(null==r.bufferView,\"Some accessor does not specify a bufferView.\"),i.errorUnsupportedIf(r.type in[\"MAT2\",\"MAT3\",\"MAT4\"],`AttributeType ${r.type} is not supported`);const n=this.json.bufferViews[r.bufferView],o=await this.getBuffer(n.buffer,t),a=pn[r.type],s=bn[r.componentType],c=a*s,l=n.byteStride||c;return{raw:o.buffer,byteStride:l,byteOffset:o.byteOffset+(n.byteOffset||0)+(r.byteOffset||0),entryCount:r.count,isDenselyPacked:l===c,componentCount:a,componentByteSize:s,componentType:r.componentType,min:r.min,max:r.max,normalized:!!r.normalized}}async getIndexData(e,t){if(null==e.indices)return null;const r=await this.getAccessor(e.indices,t);if(r.isDenselyPacked)switch(r.componentType){case 5121:return new Uint8Array(r.raw,r.byteOffset,r.entryCount);case 5123:return new Uint16Array(r.raw,r.byteOffset,r.entryCount);case 5125:return new Uint32Array(r.raw,r.byteOffset,r.entryCount)}else switch(r.componentType){case 5121:return Zi(this.wrapAccessor(d.l,r));case 5123:return Zi(this.wrapAccessor(d.j,r));case 5125:return Zi(this.wrapAccessor(d.k,r))}}async getPositionData(e,t){const r=this.errorContext;r.errorUnsupportedIf(null==e.attributes.POSITION,\"No POSITION vertex data found.\");const i=await this.getAccessor(e.attributes.POSITION,t);return r.errorUnsupportedIf(5126!==i.componentType,\"Expected type FLOAT for POSITION vertex attribute, but found \"+vn[i.componentType]),r.errorUnsupportedIf(3!==i.componentCount,\"POSITION vertex attribute must have 3 components, but found \"+i.componentCount.toFixed()),this.wrapAccessor(d.u,i)}async getNormalData(e,t){const r=this.errorContext;r.assert(null!=e.attributes.NORMAL,\"No NORMAL vertex data found.\");const i=await this.getAccessor(e.attributes.NORMAL,t);return r.errorUnsupportedIf(5126!==i.componentType,\"Expected type FLOAT for NORMAL vertex attribute, but found \"+vn[i.componentType]),r.errorUnsupportedIf(3!==i.componentCount,\"NORMAL vertex attribute must have 3 components, but found \"+i.componentCount.toFixed()),this.wrapAccessor(d.u,i)}async getTangentData(e,t){const r=this.errorContext;r.assert(null!=e.attributes.TANGENT,\"No TANGENT vertex data found.\");const i=await this.getAccessor(e.attributes.TANGENT,t);return r.errorUnsupportedIf(5126!==i.componentType,\"Expected type FLOAT for TANGENT vertex attribute, but found \"+vn[i.componentType]),r.errorUnsupportedIf(4!==i.componentCount,\"TANGENT vertex attribute must have 4 components, but found \"+i.componentCount.toFixed()),new d.C(i.raw,i.byteOffset,i.byteStride,i.byteOffset+i.byteStride*i.entryCount)}async getTextureCoordinates(e,t){const r=this.errorContext;r.assert(null!=e.attributes.TEXCOORD_0,\"No TEXCOORD_0 vertex data found.\");const i=await this.getAccessor(e.attributes.TEXCOORD_0,t);return r.errorUnsupportedIf(2!==i.componentCount,\"TEXCOORD_0 vertex attribute must have 2 components, but found \"+i.componentCount.toFixed()),5126===i.componentType?this.wrapAccessor(d.m,i):(r.errorUnsupportedIf(!i.normalized,\"Integer component types are only supported for a normalized accessor for TEXCOORD_0.\"),function(e){switch(e.componentType){case 5120:return new d.q(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5121:return new d.t(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5122:return new d.o(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5123:return new d.r(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5125:return new d.s(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5126:return new d.m(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);default:return void Object(Oi.a)(e.componentType)}}(i))}async getVertexColors(e,t){const r=this.errorContext;r.assert(null!=e.attributes.COLOR_0,\"No COLOR_0 vertex data found.\");const i=await this.getAccessor(e.attributes.COLOR_0,t);if(r.errorUnsupportedIf(4!==i.componentCount&&3!==i.componentCount,\"COLOR_0 attribute must have 3 or 4 components, but found \"+i.componentCount.toFixed()),4===i.componentCount){if(5126===i.componentType)return this.wrapAccessor(d.C,i);if(5121===i.componentType)return this.wrapAccessor(d.J,i);if(5123===i.componentType)return this.wrapAccessor(d.H,i)}else if(3===i.componentCount){if(5126===i.componentType)return this.wrapAccessor(d.u,i);if(5121===i.componentType)return this.wrapAccessor(d.B,i);if(5123===i.componentType)return this.wrapAccessor(d.z,i)}r.errorUnsupported(\"Unsupported component type for COLOR_0 attribute: \"+vn[i.componentType])}hasPositions(e){return void 0!==e.attributes.POSITION}hasNormals(e){return void 0!==e.attributes.NORMAL}hasVertexColors(e){return void 0!==e.attributes.COLOR_0}hasTextureCoordinates(e){return void 0!==e.attributes.TEXCOORD_0}hasTangents(e){return void 0!==e.attributes.TANGENT}async getMaterial(e,t){const r=this.errorContext;let i=this.materialCache.get(e.material);if(!i){const n=null!=e.material?cn(this.json.materials[e.material]):cn(),o=n.pbrMetallicRoughness,a=this.hasVertexColors(e);let s,c,l,u,d;o.baseColorTexture&&(r.errorUnsupportedIf(0!==(o.baseColorTexture.texCoord||0),\"Only TEXCOORD with index 0 is supported.\"),s=await this.getTexture(o.baseColorTexture.index,t)),n.normalTexture&&(0!==(n.normalTexture.texCoord||0)?r.warnUnsupported(\"Only TEXCOORD with index 0 is supported for the normal map texture.\"):c=await this.getTexture(n.normalTexture.index,t)),n.occlusionTexture&&(0!==(n.occlusionTexture.texCoord||0)?r.warnUnsupported(\"Only TEXCOORD with index 0 is supported for the occlusion texture.\"):l=await this.getTexture(n.occlusionTexture.index,t)),n.emissiveTexture&&(0!==(n.emissiveTexture.texCoord||0)?r.warnUnsupported(\"Only TEXCOORD with index 0 is supported for the emissive texture.\"):u=await this.getTexture(n.emissiveTexture.index,t)),o.metallicRoughnessTexture&&(0!==(o.metallicRoughnessTexture.texCoord||0)?r.warnUnsupported(\"Only TEXCOORD with index 0 is supported for the metallicRoughness texture.\"):d=await this.getTexture(o.metallicRoughnessTexture.index,t)),i={alphaMode:n.alphaMode,alphaCutoff:n.alphaCutoff,color:o.baseColorFactor,doubleSided:!!n.doubleSided,colorTexture:s,normalTexture:c,name:n.name,id:null!=e.material?e.material:-1,occlusionTexture:l,emissiveTexture:u,emissiveFactor:n.emissiveFactor,metallicFactor:o.metallicFactor,roughnessFactor:o.roughnessFactor,metallicRoughnessTexture:d,vertexColors:a,ESRI_externalColorMixMode:n.extras.ESRI_externalColorMixMode}}return i}async getTexture(e,t){const r=this.errorContext,i=this.json.textures[e],n=(e=>({...ln,...e}))(null!=i.sampler?this.json.samplers[i.sampler]:{});r.errorUnsupportedIf(null==i.source,\"Source is expected to be defined for a texture.\");const o=this.json.images[i.source];let a=this.textureCache.get(e);if(!a){let i;if(o.uri)i=await this.context.loadImage(this.resolveUri(o.uri),t);else{r.errorUnsupportedIf(null==o.bufferView,\"Image bufferView must be defined.\"),r.errorUnsupportedIf(null==o.mimeType,\"Image mimeType must be defined.\");const e=this.json.bufferViews[o.bufferView],n=await this.getBuffer(e.buffer,t);r.errorUnsupportedIf(null!=e.byteStride,\"byteStride not supported for image buffer\"),i=await async function(e,t){return Object(ji.c)((r,i)=>{const n=new Blob([e],{type:t}),o=URL.createObjectURL(n),a=new Image;a.addEventListener(\"load\",()=>{URL.revokeObjectURL(o),\"decode\"in a?a.decode().then(()=>r(a),()=>r(a)):r(a)}),a.addEventListener(\"error\",e=>{URL.revokeObjectURL(o),i(e)}),a.src=o})}(new Uint8Array(n.buffer,n.byteOffset+(e.byteOffset||0),e.byteLength),o.mimeType)}a={data:i,wrapS:n.wrapS,wrapT:n.wrapT,minFilter:n.minFilter,name:o.name,id:e},this.textureCache.set(e,a)}return a}getNodeTransform(e){if(void 0===e)return hn;let t=this.nodeTransformCache.get(e);if(!t){const r=this.getNodeTransform(this.getNodeParent(e)),i=this.json.nodes[e];i.matrix?t=Object(a.g)(Object(l.b)(),r,i.matrix):i.translation||i.rotation||i.scale?(t=Object(l.c)(r),i.translation&&Object(a.j)(t,t,i.translation),i.rotation&&(mn[3]=Object(fe.b)(mn,i.rotation),Object(a.h)(t,t,mn[3],mn)),i.scale&&Object(a.i)(t,t,i.scale)):t=r,this.nodeTransformCache.set(e,t)}return t}wrapAccessor(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}resolveUri(e){return Object(wi.y)(e,this.baseUri)}getNodeParent(e){return this.nodeParentMap.get(e)}checkVersionSupported(){const e=rn.parse(this.json.asset.version,\"glTF\");fn.validate(e)}checkRequiredExtensionsSupported(){const e=this.json;e.extensionsRequired&&0!==e.extensionsRequired.length&&this.errorContext.errorUnsupported(\"gltf loader was not able to load unsupported feature. Required extensions: \"+e.extensionsRequired.join(\", \"))}computeNodeParents(){this.json.nodes.forEach((e,t)=>{e.children&&e.children.forEach(e=>{this.nodeParentMap.set(e,t)})})}}const fn=new rn(2,0,\"glTF\"),hn=Object(a.f)(Object(l.b)(),Math.PI/2),mn=Object(_.a)(),pn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},bn={5120:1,5121:1,5122:2,5123:2,5126:4,5125:4};async function gn(e){return Object(ji.c)((t,r)=>{const i=new Blob([e]),n=new FileReader;n.onload=()=>{t(JSON.parse(n.result))},n.onerror=e=>{r(e)},n.readAsText(i)})}const vn={5120:\"BYTE\",5121:\"UNSIGNED_BYTE\",5122:\"SHORT\",5123:\"UNSIGNED_SHORT\",5125:\"UNSIGNED_INT\",5126:\"FLOAT\"};let xn=0;function On(e){let t=null;return e.json.nodes.forEach(e=>{const r=e.extras;Object(i.h)(r)&&(r.ESRI_proxyEllipsoid||r.ESRI_lod)&&(t=r)}),t}function yn(e){return e.extensions&&e.extensions.MSFT_lod&&Array.isArray(e.extensions.MSFT_lod.ids)}function _n(e,t,r){const i=t=>{const i=`${r}_tex_${t&&t.id}${t&&t.name?\"_\"+t.name:\"\"}`;if(t&&!e.textures.has(i)){const r=function(e,t={}){return{data:e,parameters:{wrap:{s:10497,t:10497,...t.wrap},noUnpackFlip:!0,mipmap:!1,...t}}}(t.data,{wrap:{s:wn(t.wrapS),t:wn(t.wrapT)},mipmap:Tn.some(e=>e===t.minFilter),noUnpackFlip:!0});e.textures.set(i,r)}return i},n=`${r}_mat_${t.id}_${t.name}`;if(!e.materials.has(n)){const r=function(e={}){return{color:[1,1,1],opacity:1,alphaMode:\"OPAQUE\",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:\"multiply\",...e}}({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?i(t.colorTexture):void 0,textureNormal:t.normalTexture?i(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?i(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?i(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?i(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});e.materials.set(n,r)}return n}function wn(e){if(33071===e||33648===e||10497===e)return e;jn.error(\"Unexpected TextureSampler WrapMode: \"+e)}const jn=new class{error(e){throw new _i.a(\"gltf-loader-error\",e)}errorUnsupported(e){throw new _i.a(\"gltf-loader-unsupported-feature\",e)}errorUnsupportedIf(e,t){e&&this.errorUnsupported(t)}assert(e,t){e||this.error(t)}warn(e){tn.warn(e)}warnUnsupported(e){this.warn(\"[Unsupported Feature] \"+e)}warnUnsupportedIf(e,t){e&&this.warnUnsupported(t)}},Tn=[9987,9985],Sn=[\"POINTS\",\"LINES\",\"LINE_LOOP\",\"LINE_STRIP\",\"TRIANGLES\",\"TRIANGLE_STRIP\",\"TRIANGLE_FAN\"];var Mn=r(\"f/qv\");const Cn=f.a.getLogger(\"esri.views.3d.layers.graphics.objectResourceUtils\");function An(e){throw new _i.a(\"\",\"Request for object resource failed: \"+e)}function Pn(e){const t=e.params,r=t.topology;let i=!0;switch(t.vertexAttributes||(Cn.warn(\"Geometry must specify vertex attributes\"),i=!1),t.topology){case\"PerAttributeArray\":break;case\"Indexed\":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const r in t.vertexAttributes){const t=e[r];t&&t.values?(null!=t.valueType&&\"UInt32\"!==t.valueType&&(Cn.warn(`Unsupported indexed geometry indices type '${t.valueType}', only UInt32 is currently supported`),i=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(Cn.warn(`Unsupported indexed geometry values per element '${t.valuesPerElement}', only 1 is currently supported`),i=!1)):(Cn.warn(`Indexed geometry does not specify face indices for '${r}' attribute`),i=!1)}}else Cn.warn(\"Indexed geometries must specify faces\"),i=!1;break}default:Cn.warn(`Unsupported topology '${r}'`),i=!1}e.params.material||(Cn.warn(\"Geometry requires material\"),i=!1);const n=e.params.vertexAttributes;for(const o in n)n[o].values||(Cn.warn(\"Geometries with externally defined attributes are not yet supported\"),i=!1);return i}function In(e){const t=Object(g.c)();return e.forEach(e=>{const r=e.boundingInfo;Object(g.g)(t,r.getBBMin()),Object(g.g)(t,r.getBBMax())}),t}async function Rn(e,t){const r=[];for(const a in e){const n=e[a],o=n.images[0].data;if(!o){Cn.warn(\"Externally referenced texture data is not yet supported\");continue}const s=n.encoding+\";base64,\"+o,c=\"/textureDefinitions/\"+a,l={noUnpackFlip:!0,wrap:{s:10497,t:10497},preMultiplyAlpha:!0},u=Object(i.h)(t)&&t.disableTextures?Object(ji.u)(null):Object(Mi.a)(s,t);r.push(u.then(e=>({refId:c,image:e,params:l,alphaChannelUsage:\"rgba\"===n.channels?n.alphaChannelUsage||\"transparency\":\"none\"})))}const n=await Object(ji.b)(r),o={};for(const i of n)o[i.refId]=i;return o}function Ln(e){switch(e){case\"mask\":return 2;case\"maskAndTransparency\":return 3;case\"none\":return 1;case\"transparency\":default:return 0}}function Bn(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}function Fn(e){const t=new Uint32Array(e);for(let r=0;r<e;r++)t[r]=r;return t}const zn=new rn(1,2,\"wosr\");function Dn(e,t,r){if(e.count!==t.count)return void h.error(\"source and destination buffers need to have the same number of elements\");const i=e.count,n=r[0],o=r[1],a=r[2],s=r[3],c=r[4],l=r[5],u=r[6],d=r[7],f=r[8],m=e.typedBuffer,p=e.typedBufferStride,b=t.typedBuffer,g=t.typedBufferStride;for(let h=0;h<i;h++){const e=h*p,t=h*g,r=b[t],i=b[t+1],v=b[t+2],x=b[t+3];m[e]=n*r+s*i+u*v,m[e+1]=o*r+c*i+d*v,m[e+2]=a*r+l*i+f*v,m[e+3]=x}}function Nn(e,t,r){const i=Math.min(e.count,t.count),n=e.typedBuffer,o=e.typedBufferStride,a=t.typedBuffer,s=t.typedBufferStride;for(let c=0;c<i;c++){const e=c*o,t=c*s;n[e]=r*a[t],n[e+1]=r*a[t+1],n[e+2]=r*a[t+2],n[e+3]=r*a[t+3]}}async function Vn(e,t){const r=En(Object(s.a)(e));if(\"wosr\"===r.fileType){const e=await(t.cache?t.cache.loadWOSR(r.url,t):async function(e,t){const r=await async function(e,t){const r=Object(i.h)(t)&&t.streamDataRequester;if(r)return async function(e,t,r){const i=await Object(Hi.c)(t.request(e,\"json\",r));return!0===i.ok?i.value:(Object(ji.v)(i.error),void An(i.error.details.url))}(e,r,t);const n=await Object(Hi.c)(Object(ki.default)(e,Object(i.n)(t)));return!0===n.ok?n.value.data:(Object(ji.v)(n.error),void An(n.error))}(e,t);return{resource:r,textures:await Rn(r.textureDefinitions,t)}}(r.url,t)),o=function(e,t){const r=[],o=[],a=[],s=[],c=e.resource,l=rn.parse(c.version||\"1.0\",\"wosr\");zn.validate(l);const u=c.model.name,d=c.model.geometries,f=c.materialDefinitions,h=e.textures;let m=0;const p=new Map;for(let b=0;b<d.length;b++){const e=d[b];if(!Pn(e))continue;const c=Bn(e),l=e.params.vertexAttributes,g={};for(const t in l){const e=l[t];g[t]={data:e.values,size:e.valuesPerElement}}const v={};if(\"PerAttributeArray\"===e.params.topology){const e=Fn(g.position.data.length/g.position.size);for(const t in g)v[t]=e}else{const t=e.params.faces;for(const e in t)v[e]=new Uint32Array(t[e].values)}const x=h&&h[c.texture];if(x&&!p.has(c.texture)){const{image:e,params:t}=x,r=new Gi(e,u,t);s.push(r),p.set(c.texture,r)}const O=p.get(c.texture),y=O?O.id:void 0;let _=a[c.material]?a[c.material][c.texture]:null;if(!_){const e=f[c.material.substring(c.material.lastIndexOf(\"/\")+1)].params;1===e.transparency&&(e.transparency=0);const r=x&&x.alphaChannelUsage,o=e.transparency>0||\"transparency\"===r||\"maskAndTransparency\"===r,s={ambient:Object(n.f)(e.diffuse),diffuse:Object(n.f)(e.diffuse),opacity:1-(e.transparency||0),transparent:o,textureAlphaMode:x?Ln(x.alphaChannelUsage):void 0,textureAlphaCutoff:.33,textureId:y,initTextureTransparent:!0,doubleSided:!0,cullFace:0,colorMixMode:e.externalColorMixMode||\"tint\",textureAlphaPremultiplied:!0};Object(i.h)(t)&&t.materialParamsMixin&&Object(Mn.d)(s,t.materialParamsMixin),_=new li(s,u),a[c.material]||(a[c.material]={}),a[c.material][c.texture]=_}o.push(_);const w=new le(new ie(g,v),u);m+=v.position?v.position.length:0,r.push(w)}return{name:u,stageResources:{textures:s,materials:o,geometries:r},pivotOffset:c.model.pivotOffset,boundingBox:In(r),numberOfVertices:m,lodThreshold:null}}(e,t);return{lods:[o],referenceBoundingBox:o.boundingBox,isEsriSymbolResource:!1,isWosr:!0,remove:e.remove}}const c=await(t.cache?t.cache.loadGLTF(r.url,t):async function(e,t,r={}){const n=await dn.load(e,jn,t,r),o=\"gltf_\"+xn++,a={lods:[],materials:new Map,textures:new Map,meta:On(n)},s=!(!n.json.asset.extras||\"symbolResource\"!==n.json.asset.extras.ESRI_type);return await async function(e,t){const r=e.json,i=r.scenes[r.scene||0].nodes,n=i.length>1;for(const a of i){const e=r.nodes[a],t=[o(a,0)];yn(e)&&!n&&t.push(...e.extensions.MSFT_lod.ids.map((e,t)=>o(e,t+1))),await Object(ji.b)(t)}async function o(i,n){const a=r.nodes[i],s=e.getNodeTransform(i);if(jn.warnUnsupportedIf(null!=a.weights,\"Morph targets are not supported.\"),null!=a.mesh){const e=r.meshes[a.mesh];for(const r of e.primitives)await t(r,s,n,e.name)}for(const e of a.children||[])await o(e,n)}}(n,async(e,t,s,c)=>{const u=void 0!==e.mode?e.mode:4,d=function(e){switch(e){case 4:case 5:case 6:return e;default:return null}}(u);if(Object(i.g)(d))return void jn.warnUnsupported(\"Unsupported primitive mode (\"+Sn[u]+\"). Skipping primitive.\");if(!n.hasPositions(e))return void jn.warn(\"Skipping primitive without POSITION vertex attribute.\");const f=await n.getMaterial(e,r),h={transform:Object(l.c)(t),attributes:{position:await n.getPositionData(e,r),normal:null,texCoord0:null,color:null,tangent:null},indices:await n.getIndexData(e,r),primitiveType:d,material:_n(a,f,o)};n.hasNormals(e)&&(h.attributes.normal=await n.getNormalData(e,r)),n.hasTangents(e)&&(h.attributes.tangent=await n.getTangentData(e,r)),n.hasTextureCoordinates(e)&&(h.attributes.texCoord0=await n.getTextureCoordinates(e,r)),n.hasVertexColors(e)&&(h.attributes.color=await n.getVertexColors(e,r));let m=null;Object(i.h)(a.meta)&&Object(i.h)(a.meta.ESRI_lod)&&\"screenSpaceRadius\"===a.meta.ESRI_lod.metric&&(m=a.meta.ESRI_lod.thresholds[s]),a.lods[s]=a.lods[s]||{parts:[],name:c,lodThreshold:m},a.lods[s].parts.push(h)}),{model:a,meta:{isEsriSymbolResource:s,uri:n.uri},customMeta:{}}}(new qi(t.streamDataRequester),r.url,t)),u=Object(i.f)(c.model.meta,\"ESRI_proxyEllipsoid\");c.meta.isEsriSymbolResource&&Object(i.h)(u)&&-1!==c.meta.uri.indexOf(\"/RealisticTrees/\")&&function(e,t){for(let r=0;r<e.model.lods.length;++r){const s=e.model.lods[r];e.customMeta.esriTreeRendering=!0;for(const c of s.parts){const s=c.attributes.normal;if(Object(i.g)(s))return;const u=c.attributes.position,f=u.count,h=Object(n.e)(),m=Object(n.e)(),p=Object(n.e)(),b=en(d.J,f),g=en(d.u,f),v=Object(a.a)(Object(l.b)(),c.transform);for(let i=0;i<f;i++){u.getVec(i,m),s.getVec(i,h),Object(o.j)(m,m,c.transform),Object(o.g)(p,m,t.center),Object(o.a)(p,p,t.radius);const n=p[2],a=Object(o.m)(p),l=Math.min(.45+.55*a*a,1);Object(o.a)(p,p,t.radius),Object(o.j)(p,p,v),Object(o.o)(p,p),r+1!==e.model.lods.length&&e.model.lods.length>1&&Object(o.f)(p,p,h,n>-1?.2:Math.min(-4*n-3.8,1)),g.setVec(i,p),b.set(i,0,255*l),b.set(i,1,255*l),b.set(i,2,255*l),b.set(i,3,255)}c.attributes.normal=g,c.attributes.color=b}}}(c,u);const f=c.meta.isEsriSymbolResource?{usePBR:t.usePBR,isSchematic:!1,treeRendering:c.customMeta.esriTreeRendering,mrrFactors:[0,1,.2]}:{usePBR:!0,isSchematic:!1,mrrFactors:[0,1,.5]},h={...t.materialParamsMixin,treeRendering:c.customMeta.esriTreeRendering};if(null!=r.specifiedLodIndex){const e=Un(c,f,h,r.specifiedLodIndex);let t=e[0].boundingBox;return 0!==r.specifiedLodIndex&&(t=Un(c,f,h,0)[0].boundingBox),{lods:e,referenceBoundingBox:t,isEsriSymbolResource:c.meta.isEsriSymbolResource,isWosr:!1,remove:c.remove}}const m=Un(c,f,h);return{lods:m,referenceBoundingBox:m[0].boundingBox,isEsriSymbolResource:c.meta.isEsriSymbolResource,isWosr:!1,remove:c.remove}}function En(e){const t=e.match(/(.*\\.(gltf|glb))(\\?lod=([0-9]+))?$/);return t?{fileType:\"gltf\",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null}:e.match(/(.*\\.(json|json\\.gz))$/)?{fileType:\"wosr\",url:e,specifiedLodIndex:null}:{fileType:\"unknown\",url:e,specifiedLodIndex:null}}function Un(e,t,r,n){const o=e.model,a=Object(c.a)(),s=new Array,l=new Map,f=new Map;return o.lods.forEach((e,c)=>{if(void 0!==n&&c!==n)return;let h=0;const v={name:e.name,stageResources:{textures:new Array,materials:new Array,geometries:new Array},lodThreshold:Object(i.h)(e.lodThreshold)?e.lodThreshold:null,pivotOffset:[0,0,0],numberOfVertices:0,boundingBox:Object(g.c)()};s.push(v),e.parts.forEach(n=>{const s=n.material+(n.attributes.normal?\"_normal\":\"\")+(n.attributes.color?\"_color\":\"\")+(n.attributes.texCoord0?\"_texCoord0\":\"\")+(n.attributes.tangent?\"_tangent\":\"\"),c=o.materials.get(n.material),x=Object(i.h)(n.attributes.texCoord0),O=Object(i.h)(n.attributes.normal);if(!l.has(s)){if(x){if(Object(i.h)(c.textureColor)&&!f.has(c.textureColor)){const e=o.textures.get(c.textureColor),t={...e.parameters,preMultiplyAlpha:!0};f.set(c.textureColor,new Gi(e.data,c.textureColor,t))}if(Object(i.h)(c.textureNormal)&&!f.has(c.textureNormal)){const e=o.textures.get(c.textureNormal),t={...e.parameters,preMultiplyAlpha:!0};f.set(c.textureNormal,new Gi(e.data,c.textureNormal,t))}if(Object(i.h)(c.textureOcclusion)&&!f.has(c.textureOcclusion)){const e=o.textures.get(c.textureOcclusion),t={...e.parameters,preMultiplyAlpha:!0};f.set(c.textureOcclusion,new Gi(e.data,c.textureOcclusion,t))}if(Object(i.h)(c.textureEmissive)&&!f.has(c.textureEmissive)){const e=o.textures.get(c.textureEmissive),t={...e.parameters,preMultiplyAlpha:!0};f.set(c.textureEmissive,new Gi(e.data,c.textureEmissive,t))}if(Object(i.h)(c.textureMetallicRoughness)&&!f.has(c.textureMetallicRoughness)){const e=o.textures.get(c.textureMetallicRoughness),t={...e.parameters,preMultiplyAlpha:!0};f.set(c.textureMetallicRoughness,new Gi(e.data,c.textureMetallicRoughness,t))}}const e=Math.pow(c.color[0],.47619047619047616),a=Math.pow(c.color[1],.47619047619047616),u=Math.pow(c.color[2],.47619047619047616),d=Math.pow(c.emissiveFactor[0],.47619047619047616),h=Math.pow(c.emissiveFactor[1],.47619047619047616),m=Math.pow(c.emissiveFactor[2],.47619047619047616);l.set(s,new li({...t,transparent:\"BLEND\"===c.alphaMode,textureAlphaMode:Gn(c.alphaMode),textureAlphaCutoff:c.alphaCutoff,diffuse:[e,a,u],ambient:[e,a,u],opacity:c.opacity,doubleSided:c.doubleSided,doubleSidedType:\"winding-order\",cullFace:c.doubleSided?0:2,vertexColors:!!n.attributes.color,vertexTangents:!!n.attributes.tangent,normals:O?\"default\":\"screenDerivative\",castShadows:!0,receiveSSAO:!0,textureId:Object(i.h)(c.textureColor)&&x?f.get(c.textureColor).id:void 0,colorMixMode:c.colorMixMode,normalTextureId:Object(i.h)(c.textureNormal)&&x?f.get(c.textureNormal).id:void 0,textureAlphaPremultiplied:!0,occlusionTextureId:Object(i.h)(c.textureOcclusion)&&x?f.get(c.textureOcclusion).id:void 0,emissiveTextureId:Object(i.h)(c.textureEmissive)&&x?f.get(c.textureEmissive).id:void 0,metallicRoughnessTextureId:Object(i.h)(c.textureMetallicRoughness)&&x?f.get(c.textureMetallicRoughness).id:void 0,emissiveFactor:[d,h,m],mrrFactors:[c.metallicFactor,c.roughnessFactor,t.mrrFactors[2]],isSchematic:!1,...r},s))}const y=function(e,t){switch(t){case 4:return function(e){return\"number\"==typeof e?J(e):Object(yi.i)(e)||Object(yi.k)(e)?new Uint32Array(e):e}(e);case 5:return function(e){const t=\"number\"==typeof e?e:e.length;if(t<3)return new Uint32Array(0);const r=t-2,i=new Uint32Array(3*r);if(\"number\"==typeof e){let e=0;for(let t=0;t<r;t+=1)t%2==0?(i[e++]=t,i[e++]=t+1,i[e++]=t+2):(i[e++]=t+1,i[e++]=t,i[e++]=t+2)}else{let t=0;for(let n=0;n<r;n+=1)if(n%2==0){const r=e[n+1],o=e[n+2];i[t++]=e[n],i[t++]=r,i[t++]=o}else{const r=e[n],o=e[n+2];i[t++]=e[n+1],i[t++]=r,i[t++]=o}}return i}(e);case 6:return function(e){const t=\"number\"==typeof e?e:e.length;if(t<3)return new Uint32Array(0);const r=t-2,i=new Uint32Array(3*r);if(\"number\"==typeof e){let e=0;for(let t=0;t<r;++t)i[e++]=0,i[e++]=t+1,i[e++]=t+2;return i}{const t=e[0];let n=e[1],o=0;for(let a=0;a<r;++a){const r=e[a+2];i[o++]=t,i[o++]=n,i[o++]=r,n=r}return i}}(e)}}(n.indices||n.attributes.position.count,n.primitiveType),_={},w={},j=n.attributes.position.count,T=en(d.u,j);if(m(T,n.attributes.position,n.transform),w.position={data:T.typedBuffer,size:T.elementCount},_.position=y,Object(i.h)(n.attributes.normal)){const e=en(d.u,j);Object(u.g)(a,n.transform),p(e,n.attributes.normal,a),w.normal={data:e.typedBuffer,size:e.elementCount},_.normal=y}if(Object(i.h)(n.attributes.tangent)){const e=en(d.C,j);Object(u.g)(a,n.transform),Dn(e,n.attributes.tangent,a),w.tangent={data:e.typedBuffer,size:e.elementCount},_.tangent=y}if(Object(i.h)(n.attributes.texCoord0)){const e=en(d.m,j);Yi(e,n.attributes.texCoord0),w.uv0={data:e.typedBuffer,size:e.elementCount},_.uv0=y}if(Object(i.h)(n.attributes.color)){const e=en(d.J,j);if(4===n.attributes.color.elementCount)n.attributes.color instanceof d.C?Nn(e,n.attributes.color,255):n.attributes.color instanceof d.J?Ki(e,n.attributes.color):n.attributes.color instanceof d.H&&Nn(e,n.attributes.color,1/256);else{Qi(e,255,255,255,255);const t=new d.B(e.buffer,0,4);n.attributes.color instanceof d.u?b(t,n.attributes.color,255):n.attributes.color instanceof d.B?Ji(t,n.attributes.color):n.attributes.color instanceof d.z&&b(t,n.attributes.color,1/256)}w.color={data:e.typedBuffer,size:e.elementCount},_.color=y}const S=new le(new ie(w,_),`gltf_${e.name}_${h++}`);v.stageResources.geometries.push(S),v.stageResources.materials.push(l.get(s)),x&&(Object(i.h)(c.textureColor)&&v.stageResources.textures.push(f.get(c.textureColor)),Object(i.h)(c.textureNormal)&&v.stageResources.textures.push(f.get(c.textureNormal)),Object(i.h)(c.textureOcclusion)&&v.stageResources.textures.push(f.get(c.textureOcclusion)),Object(i.h)(c.textureEmissive)&&v.stageResources.textures.push(f.get(c.textureEmissive)),Object(i.h)(c.textureMetallicRoughness)&&v.stageResources.textures.push(f.get(c.textureMetallicRoughness))),v.numberOfVertices+=j;const M=S.boundingInfo;Object(g.g)(v.boundingBox,M.getBBMin()),Object(g.g)(v.boundingBox,M.getBBMax())})}),s}function Gn(e){switch(e){case\"BLEND\":return 0;case\"MASK\":return 2;case\"OPAQUE\":return 1;default:return 0}}Object.freeze({__proto__:null,transformMat4:function(e,t,r){if(e.count!==t.count)return void h.error(\"source and destination buffers need to have the same number of elements\");const i=e.count,n=r[0],o=r[1],a=r[2],s=r[3],c=r[4],l=r[5],u=r[6],d=r[7],f=r[8],m=r[9],p=r[10],b=r[11],g=r[12],v=r[13],x=r[14],O=r[15],y=e.typedBuffer,_=e.typedBufferStride,w=t.typedBuffer,j=t.typedBufferStride;for(let h=0;h<i;h++){const e=h*_,t=h*j,r=w[t],i=w[t+1],T=w[t+2],S=w[t+3];y[e]=n*r+c*i+f*T+g*S,y[e+1]=o*r+l*i+m*T+v*S,y[e+2]=a*r+u*i+p*T+x*S,y[e+3]=s*r+d*i+b*T+O*S}},transformMat3:Dn,scale:Nn,shiftRight:function(e,t,r){const i=Math.min(e.count,t.count),n=e.typedBuffer,o=e.typedBufferStride,a=t.typedBuffer,s=t.typedBufferStride;for(let c=0;c<i;c++){const e=c*o,t=c*s;n[e]=a[t]>>r,n[e+1]=a[t+1]>>r,n[e+2]=a[t+2]>>r,n[e+3]=a[t+3]>>r}}})},lwwL:function(e,t,r){\"use strict\";function i(){const e=new Float32Array(16);return e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}r.d(t,\"a\",function(){return i});const n=i();Object.freeze({__proto__:null,create:i,clone:function(e){const t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},fromValues:function(e,t,r,i,n,o,a,s,c,l,u,d,f,h,m,p){const b=new Float32Array(16);return b[0]=e,b[1]=t,b[2]=r,b[3]=i,b[4]=n,b[5]=o,b[6]=a,b[7]=s,b[8]=c,b[9]=l,b[10]=u,b[11]=d,b[12]=f,b[13]=h,b[14]=m,b[15]=p,b},createView:function(e,t){return new Float32Array(e,t,16)},IDENTITY:n})},mmTy:function(e,t,r){\"use strict\";function i(e,t,r){for(let i=0;i<r;++i)t[2*i]=e[i],t[2*i+1]=e[i]-t[2*i]}function n(e,t,r,n){for(let s=0;s<n;++s)o[0]=e[s],i(o,a,1),t[s]=a[0],r[s]=a[1]}r.d(t,\"a\",function(){return i}),r.d(t,\"b\",function(){return n});const o=new Float64Array(1),a=new Float32Array(2)},p9cc:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return a});var i=r(\"OIYib\"),n=r(\"R/jG\"),o=r(\"fLTx\");function a(e,t){const r=e.fragment,n=t.hasMetalnessAndRoughnessTexture||t.hasEmissionTexture||t.hasOcclusionTexture;1===t.pbrMode&&n&&e.include(o.a,t),2!==t.pbrMode?(0===t.pbrMode&&r.code.add(i.a`\n      float getBakedOcclusion() { return 1.0; }\n  `),1===t.pbrMode&&(r.uniforms.add(\"emissionFactor\",\"vec3\"),r.uniforms.add(\"mrrFactors\",\"vec3\"),r.code.add(i.a`\n      vec3 mrr;\n      vec3 emission;\n      float occlusion;\n    `),t.hasMetalnessAndRoughnessTexture&&(r.uniforms.add(\"texMetallicRoughness\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texMetallicRoughnessSize\",\"vec2\"),r.code.add(i.a`\n      void applyMetallnessAndRoughness(TextureLookupParameter params) {\n        vec3 metallicRoughness = textureLookup(texMetallicRoughness, params).rgb;\n\n        mrr[0] *= metallicRoughness.b;\n        mrr[1] *= metallicRoughness.g;\n      }`)),t.hasEmissionTexture&&(r.uniforms.add(\"texEmission\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texEmissionSize\",\"vec2\"),r.code.add(i.a`\n      void applyEmission(TextureLookupParameter params) {\n        emission *= textureLookup(texEmission, params).rgb;\n      }`)),t.hasOcclusionTexture?(r.uniforms.add(\"texOcclusion\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texOcclusionSize\",\"vec2\"),r.code.add(i.a`\n      void applyOcclusion(TextureLookupParameter params) {\n        occlusion *= textureLookup(texOcclusion, params).r;\n      }\n\n      float getBakedOcclusion() {\n        return occlusion;\n      }\n      `)):r.code.add(i.a`\n      float getBakedOcclusion() { return 1.0; }\n      `),r.code.add(i.a`\n    void applyPBRFactors() {\n      mrr = mrrFactors;\n      emission = emissionFactor;\n      occlusion = 1.0;\n      ${n?\"vtc.uv = vuv0;\":\"\"}\n      ${t.hasMetalnessAndRoughnessTexture?t.supportsTextureAtlas?\"vtc.size = texMetallicRoughnessSize; applyMetallnessAndRoughness(vtc);\":\"applyMetallnessAndRoughness(vtc);\":\"\"}\n      ${t.hasEmissionTexture?t.supportsTextureAtlas?\"vtc.size = texEmissionSize; applyEmission(vtc);\":\"applyEmission(vtc);\":\"\"}\n      ${t.hasOcclusionTexture?t.supportsTextureAtlas?\"vtc.size = texOcclusionSize; applyOcclusion(vtc);\":\"applyOcclusion(vtc);\":\"\"}\n    }\n  `))):r.code.add(i.a`\n      const vec3 mrr = vec3(0.0, 0.6, 0.2);\n      const vec3 emission = vec3(0.0);\n      float occlusion = 1.0;\n\n      void applyPBRFactors() {}\n\n      float getBakedOcclusion() { return 1.0; }\n    `)}Object(n.b)(0,.6,.2),(a||(a={})).bindUniforms=function(e,t,r=!1){r||(e.setUniform3fv(\"mrrFactors\",t.mrrFactors),e.setUniform3fv(\"emissionFactor\",t.emissiveFactor))}},qrV2:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e,t){const r=e.fragment;r.code.add(i.a`\n    struct ShadingNormalParameters {\n      vec3 normalView;\n      vec3 viewDirection;\n    } shadingParams;\n    `),r.code.add(1===t.doubleSidedMode?i.a`\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return dot(params.normalView, params.viewDirection) > 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n      }\n    `:2===t.doubleSidedMode?i.a`\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n      }\n    `:i.a`\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return normalize(params.normalView);\n      }\n    `)}},\"r+FG\":function(e,t,r){\"use strict\";function i(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function n(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function o(e,t){return new Float64Array(e,t,16)}r.d(t,\"a\",function(){return a}),r.d(t,\"b\",function(){return i}),r.d(t,\"c\",function(){return n}),r.d(t,\"d\",function(){return o});const a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:i,clone:n,fromValues:function(e,t,r,i,n,o,a,s,c,l,u,d,f,h,m,p){return[e,t,r,i,n,o,a,s,c,l,u,d,f,h,m,p]},createView:o,IDENTITY:a})},sJp1:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e){e.attributes.add(\"position\",\"vec3\"),e.vertex.code.add(i.a`\n    vec3 positionModel() { return position; }\n  `)}},sKsC:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return S}),r.d(t,\"b\",function(){return T});var i=r(\"OIYib\"),n=r(\"Tbkp\"),o=r(\"aQrP\"),a=r(\"0nJL\"),s=r(\"viRi\"),c=r(\"69UF\"),l=r(\"F7CJ\"),u=r(\"bVvB\"),d=r(\"0BfS\"),f=r(\"vXUg\"),h=r(\"XV/G\"),m=r(\"1TnO\"),p=r(\"368d\"),b=r(\"p9cc\"),g=r(\"F8o4\"),v=r(\"wzLF\"),x=r(\"sJp1\"),O=r(\"bLIi\"),y=r(\"fiGu\"),_=r(\"cIib\"),w=r(\"6kvK\"),j=r(\"NiZE\");function T(e){const t=new o.a,r=t.vertex.code,T=t.fragment.code;return t.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\").add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\"),t.include(x.a),t.varyings.add(\"vpos\",\"vec3\"),t.include(s.a,e),t.include(m.a,e),t.include(l.a,e),0!==e.output&&7!==e.output||(t.include(v.a,e),t.include(n.a,{linearDepth:!1}),e.offsetBackfaces&&t.include(g.a),e.instancedColor&&t.attributes.add(\"instanceColor\",\"vec4\"),t.varyings.add(\"vNormalWorld\",\"vec3\"),t.varyings.add(\"localvpos\",\"vec3\"),t.include(p.a,e),t.include(f.a,e),t.include(O.a,e),t.include(u.a,e),t.vertex.uniforms.add(\"externalColor\",\"vec4\"),t.varyings.add(\"vcolorExt\",\"vec4\"),r.add(i.a`\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt = externalColor;\n          ${e.instancedColor?\"vcolorExt *= instanceColor;\":\"\"}\n          vcolorExt *= vvColor();\n          vcolorExt *= getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a < ${i.a.float(c.c)}) {\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          }\n          else {\n            vpos = calculateVPos();\n            localvpos = vpos - view[3].xyz;\n            vpos = subtractOrigin(vpos);\n            vNormalWorld = dpNormal(vvLocalNormal(normalModel()));\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, vpos);\n            ${e.offsetBackfaces?\"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);\":\"\"}\n          }\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      `)),7===e.output&&(t.include(a.a,e),t.include(c.a,e),t.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),t.fragment.uniforms.add(\"view\",\"mat4\"),e.hasColorTexture&&t.fragment.uniforms.add(\"tex\",\"sampler2D\"),t.fragment.include(j.a),T.add(i.a`\n      void main() {\n        discardBySlice(vpos);\n        ${e.hasColorTexture?i.a`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${e.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:i.a`vec4 texColor = vec4(1.0);`}\n        ${e.attributeColor?i.a`\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:i.a`\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n\n        gl_FragColor = vec4(opacity_);\n      }\n    `)),0===e.output&&(t.include(a.a,e),t.include(w.a,e),t.include(_.a,e),t.include(c.a,e),e.receiveShadows&&t.include(d.a,e),t.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"ambient\",\"vec3\").add(\"diffuse\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),t.fragment.uniforms.add(\"view\",\"mat4\"),e.hasColorTexture&&t.fragment.uniforms.add(\"tex\",\"sampler2D\"),t.include(b.a,e),t.include(h.a,e),t.fragment.include(j.a),T.add(i.a`\n      void main() {\n        discardBySlice(vpos);\n        ${e.hasColorTexture?i.a`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${e.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:i.a`vec4 texColor = vec4(1.0);`}\n        vec3 viewDirection = normalize(vpos - camPos);\n        ${1===e.pbrMode?\"applyPBRFactors();\":\"\"}\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ${e.receiveShadows?\"float shadow = readShadowMap(vpos, linearDepth);\":1===e.viewingMode?\"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);\":\"float shadow = 0.0;\"}\n        vec3 matColor = max(ambient, diffuse);\n        ${e.attributeColor?i.a`\n        vec3 albedo_ = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:i.a`\n        vec3 albedo_ = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        ${i.a`\n        vec3 shadedNormal = normalize(vNormalWorld);\n        albedo_ *= 1.2;\n        vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\n        float alignmentLightView = clamp(dot(-viewForward, lightingMainDirection), 0.0, 1.0);\n        float transmittance = 1.0 - clamp(dot(-viewForward, shadedNormal), 0.0, 1.0);\n        float treeRadialFalloff = vColor.r;\n        float backLightFactor = 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n        additionalLight += backLightFactor * lightingMainIntensity;`}\n        ${1===e.pbrMode||2===e.pbrMode?1===e.viewingMode?i.a`vec3 normalGround = normalize(vpos + localOrigin);`:i.a`vec3 normalGround = vec3(0.0, 0.0, 1.0);`:i.a``}\n        ${1===e.pbrMode||2===e.pbrMode?i.a`\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor = evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);`:\"vec3 shadedColor = evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\"}\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ${e.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n      }\n    `)),t.include(y.a,e),t}var S=Object.freeze({__proto__:null,build:T})},tiP8:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return o}),r.d(t,\"b\",function(){return s}),r.d(t,\"c\",function(){return a});var i=r(\"srIe\"),n=(r(\"15Hh\"),r(\"r+FG\"));function o(e,t){return Object(i.g)(e)&&(e=[]),e.push(t),e}function a(e,t){if(Object(i.g)(e))return e;const r=e.filter(e=>e!==t);return 0===r.length?null:r}function s(e){return!!Object(i.h)(e)&&!e.visible}r(\"EVMh\"),r(\"mmTy\"),new Float64Array(3),new Float32Array(6),Object(n.b)()},vXUg:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e,t){0===t.output&&t.receiveShadows?(e.varyings.add(\"linearDepth\",\"float\"),e.vertex.code.add(i.a`\n      void forwardLinearDepth() { linearDepth = gl_Position.w; }\n    `)):1===t.output||3===t.output?(e.varyings.add(\"linearDepth\",\"float\"),e.vertex.uniforms.add(\"uCameraNearFar\",\"vec2\"),e.vertex.code.add(i.a`\n      void forwardLinearDepth() {\n        linearDepth = (-position_view().z - uCameraNearFar[0]) / (uCameraNearFar[1] - uCameraNearFar[0]);\n      }\n    `)):e.vertex.code.add(i.a`\n      void forwardLinearDepth() {}\n    `)}},viRi:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e,t){t.vvInstancingEnabled&&(t.vvSize||t.vvColor)&&e.attributes.add(\"instanceFeatureAttribute\",\"vec4\"),t.vvSize?(e.vertex.uniforms.add(\"vvSizeMinSize\",\"vec3\"),e.vertex.uniforms.add(\"vvSizeMaxSize\",\"vec3\"),e.vertex.uniforms.add(\"vvSizeOffset\",\"vec3\"),e.vertex.uniforms.add(\"vvSizeFactor\",\"vec3\"),e.vertex.uniforms.add(\"vvSymbolRotationMatrix\",\"mat3\"),e.vertex.uniforms.add(\"vvSymbolAnchor\",\"vec3\"),e.vertex.code.add(i.a`\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    `),e.vertex.code.add(i.a`\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ${t.vvInstancingEnabled?i.a`\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }`:\"\"}\n    `)):e.vertex.code.add(i.a`\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    `),t.vvColor?(e.vertex.defines.addInt(\"VV_COLOR_N\",8),e.vertex.code.add(i.a`\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < VV_COLOR_N; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ${t.vvInstancingEnabled?i.a`\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }`:\"\"}\n    `)):e.vertex.code.add(i.a`\n      vec4 vvColor() { return vec4(1.0); }\n    `)}!function(e){function t(e,t){t.vvSizeEnabled&&(e.setUniform3fv(\"vvSizeMinSize\",t.vvSizeMinSize),e.setUniform3fv(\"vvSizeMaxSize\",t.vvSizeMaxSize),e.setUniform3fv(\"vvSizeOffset\",t.vvSizeOffset),e.setUniform3fv(\"vvSizeFactor\",t.vvSizeFactor)),t.vvColorEnabled&&(e.setUniform1fv(\"vvColorValues\",t.vvColorValues),e.setUniform4fv(\"vvColorColors\",t.vvColorColors))}e.bindUniforms=t,e.bindUniformsWithOpacity=function(e,r){t(e,r),r.vvOpacityEnabled&&(e.setUniform1fv(\"vvOpacityValues\",r.vvOpacityValues),e.setUniform1fv(\"vvOpacityOpacities\",r.vvOpacityOpacities))},e.bindUniformsForSymbols=function(e,r){t(e,r),r.vvSizeEnabled&&(e.setUniform3fv(\"vvSymbolAnchor\",r.vvSymbolAnchor),e.setUniformMatrix3fv(\"vvSymbolRotationMatrix\",r.vvSymbolRotationMatrix))}}(n||(n={}))},wzLF:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return o});var i=r(\"OIYib\");function n(e){const t=i.a`\n    vec3 decodeNormal(vec2 f) {\n      float z = 1.0 - abs(f.x) - abs(f.y);\n      return vec3(f + sign(f) * min(z, 0.0), z);\n    }\n  `;e.fragment.code.add(t),e.vertex.code.add(t)}function o(e,t){0===t.normalType&&(e.attributes.add(\"normal\",\"vec3\"),e.vertex.code.add(i.a`\n      vec3 normalModel() {\n        return normal;\n      }\n    `)),1===t.normalType&&(e.include(n),e.attributes.add(\"normalCompressed\",\"vec2\"),e.vertex.code.add(i.a`\n      vec3 normalModel() {\n        return decodeNormal(normalCompressed);\n      }\n    `)),3===t.normalType&&(e.extensions.add(\"GL_OES_standard_derivatives\"),e.fragment.code.add(i.a`\n      vec3 screenDerivativeNormal(vec3 positionView) {\n        return normalize(cross(dFdx(positionView), dFdy(positionView)));\n      }\n    `))}},xRv2:function(e,t,r){\"use strict\";r.d(t,\"a\",function(){return n});var i=r(\"OIYib\");function n(e){e.vertex.code.add(i.a`\n    const float PI = 3.141592653589793;\n  `),e.fragment.code.add(i.a`\n    const float PI = 3.141592653589793;\n    const float LIGHT_NORMALIZATION = 1.0 / PI;\n    const float INV_PI = 0.3183098861837907;\n    const float HALF_PI = 1.570796326794897;\n    `)}}}]);","name":"38.50949463dfff7f87672f.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[38],{\n\n/***/ \"0BfS\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return i; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/* harmony import */ var _util_RgbaFloatEncoding_glsl_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"UBvB\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction i(i){i.fragment.include(_util_RgbaFloatEncoding_glsl_js__WEBPACK_IMPORTED_MODULE_1__[/* RgbaFloatEncoding */ \"a\"]),i.fragment.uniforms.add(\"depthTex\",\"sampler2D\"),i.fragment.uniforms.add(\"shadowMapNum\",\"int\"),i.fragment.uniforms.add(\"shadowMapDistance\",\"vec4\"),i.fragment.uniforms.add(\"shadowMapMatrix\",\"mat4\",4),i.fragment.uniforms.add(\"depthHalfPixelSz\",\"float\"),i.fragment.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      float halfPixelSize = depthHalfPixelSz;\n      vec4 distance = shadowMapDistance;\n      float depth = _linearDepth;\n\n      //choose correct cascade\n      int i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;\n\n      if (i >= shadowMapNum) { return 0.0; }\n\n      mat4 mat = i == 0 ? shadowMapMatrix[0] : i == 1 ? shadowMapMatrix[1] : i == 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];\n\n      vec4 lv = mat * vec4(_vpos, 1.0);\n      lv.xy /= lv.w;\n\n      // vertex completely outside? -> no shadow\n      vec3 lvpos = 0.5 * lv.xyz + vec3(0.5);\n      if (lvpos.z >= 1.0) { return 0.0; }\n      if (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv = vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n\n      float texSize = 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st = fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 = rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, -halfPixelSize))) < lvpos.z ? 1.0 : 0.0;\n      float s10 = rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, -halfPixelSize))) < lvpos.z ? 1.0 : 0.0;\n      float s11 = rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, halfPixelSize))) < lvpos.z ? 1.0 : 0.0;\n      float s01 = rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, halfPixelSize))) < lvpos.z ? 1.0 : 0.0;\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n  `)}!function(e){e.bindUniforms=function(e,a,i){a.shadowMappingEnabled&&(a.shadowMap.bind(e,i),a.shadowMap.bindView(e,a.origin))},e.bindViewCustomOrigin=function(e,a,i){a.shadowMappingEnabled&&a.shadowMap.bindView(e,i)},e.bindView=function(e,a){a.shadowMappingEnabled&&a.shadowMap.bindView(e,a.origin)}}(i||(i={}));\n\n\n/***/ }),\n\n/***/ \"0nJL\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return l; });\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"srIe\");\n/* harmony import */ var _chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"Cy1f\");\n/* harmony import */ var _chunks_vec3_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"5DEt\");\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction l(e,s){if(s.slicePlaneEnabled){e.extensions.add(\"GL_OES_standard_derivatives\"),s.sliceEnabledForVertexPrograms&&(e.vertex.uniforms.add(\"slicePlaneOrigin\",\"vec3\"),e.vertex.uniforms.add(\"slicePlaneBasis1\",\"vec3\"),e.vertex.uniforms.add(\"slicePlaneBasis2\",\"vec3\")),e.fragment.uniforms.add(\"slicePlaneOrigin\",\"vec3\"),e.fragment.uniforms.add(\"slicePlaneBasis1\",\"vec3\"),e.fragment.uniforms.add(\"slicePlaneBasis2\",\"vec3\");const i=_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__[/* glsl */ \"a\"]`\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel = pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot = dot(slicePlaneBasis1, rel);\n        float basis2Dot = dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front < 0.0\n          && factors.side0 < 0.0\n          && factors.side1 < 0.0\n          && factors.side2 < 0.0\n          && factors.side3 < 0.0;\n      }\n\n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    `,a=_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__[/* glsl */ \"a\"]`\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors = calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH = 1.0;\n        const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor = (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    `,l=s.sliceHighlightDisabled?_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__[/* glsl */ \"a\"]`#define highlightSlice(_color_, _pos_) (_color_)`:_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__[/* glsl */ \"a\"]`\n        ${a}\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      `;s.sliceEnabledForVertexPrograms&&e.vertex.code.add(i),e.fragment.code.add(i),e.fragment.code.add(l)}else{const i=_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__[/* glsl */ \"a\"]`\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    `;s.sliceEnabledForVertexPrograms&&e.vertex.code.add(i),e.fragment.code.add(i)}}!function(i){i.bindUniformsWithOrigin=function(e,s,a){i.bindUniforms(e,s,a.slicePlane,a.origin)},i.bindUniforms=function(i,o,l,r){o.slicePlaneEnabled&&(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__[/* isSome */ \"h\"])(l)?(r?(Object(_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_2__[/* f */ \"g\"])(c,l.origin,r),i.setUniform3fv(\"slicePlaneOrigin\",c)):i.setUniform3fv(\"slicePlaneOrigin\",l.origin),i.setUniform3fv(\"slicePlaneBasis1\",l.basis1),i.setUniform3fv(\"slicePlaneBasis2\",l.basis2)):(i.setUniform3fv(\"slicePlaneBasis1\",_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__[/* Z */ \"b\"]),i.setUniform3fv(\"slicePlaneBasis2\",_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__[/* Z */ \"b\"]),i.setUniform3fv(\"slicePlaneOrigin\",_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__[/* Z */ \"b\"])))}}(l||(l={}));const c=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__[/* c */ \"e\"])();\n\n\n/***/ }),\n\n/***/ \"1TnO\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return n; });\n/* harmony import */ var _chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"Cy1f\");\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"OIYib\");\n/* harmony import */ var _lib_doublePrecisionUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"mmTy\");\n/* harmony import */ var _util_DoublePrecision_glsl_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"aiF/\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction n(e,r){r.instanced&&r.instancedDoublePrecision&&(e.attributes.add(\"modelOriginHi\",\"vec3\"),e.attributes.add(\"modelOriginLo\",\"vec3\"),e.attributes.add(\"model\",\"mat3\"),e.attributes.add(\"modelNormal\",\"mat3\")),r.instancedDoublePrecision&&(e.vertex.include(_util_DoublePrecision_glsl_js__WEBPACK_IMPORTED_MODULE_3__[/* DoublePrecision */ \"a\"],r),e.vertex.uniforms.add(\"viewOriginHi\",\"vec3\"),e.vertex.uniforms.add(\"viewOriginLo\",\"vec3\"));const n=[_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__[/* glsl */ \"a\"]`\n    vec3 calculateVPos() {\n      ${r.instancedDoublePrecision?\"return model * localPosition().xyz;\":\"return localPosition().xyz;\"}\n    }\n    `,_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__[/* glsl */ \"a\"]`\n    vec3 subtractOrigin(vec3 _pos) {\n      ${r.instancedDoublePrecision?_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__[/* glsl */ \"a\"]`\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;`:\"return vpos;\"}\n    }\n    `,_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__[/* glsl */ \"a\"]`\n    vec3 dpNormal(vec4 _normal) {\n      ${r.instancedDoublePrecision?\"return normalize(modelNormal * _normal.xyz);\":\"return normalize(_normal.xyz);\"}\n    }\n    `,_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__[/* glsl */ \"a\"]`\n    vec3 dpNormalView(vec4 _normal) {\n      ${r.instancedDoublePrecision?\"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);\":\"return normalize((viewNormal * _normal).xyz);\"}\n    }\n    `,r.vertexTangets?_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__[/* glsl */ \"a\"]`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${r.instancedDoublePrecision?\"return vec4(modelNormal * _tangent.xyz, _tangent.w);\":\"return _tangent;\"}\n\n    }\n    `:_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__[/* glsl */ \"a\"]``];e.vertex.code.add(n[0]),e.vertex.code.add(n[1]),e.vertex.code.add(n[2]),2===r.output&&e.vertex.code.add(n[3]),e.vertex.code.add(n[4])}!function(e){e.Uniforms=class{},e.bindCustomOrigin=function(e,i){Object(_lib_doublePrecisionUtils_js__WEBPACK_IMPORTED_MODULE_2__[/* encodeDoubleArraySplit */ \"b\"])(i,t,a,3),e.setUniform3fv(\"viewOriginHi\",t),e.setUniform3fv(\"viewOriginLo\",a)}}(n||(n={}));const t=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_0__[/* c */ \"e\"])(),a=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_0__[/* c */ \"e\"])();\n\n\n/***/ }),\n\n/***/ \"1W42\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return u; });\n/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"wSAH\");\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction u(u,e){_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_1__[/* glsl */ \"a\"]`\n  /*\n  *  ${e.name}\n  *  ${0===e.output?\"RenderOutput: Color\":1===e.output?\"RenderOutput: Depth\":3===e.output?\"RenderOutput: Shadow\":2===e.output?\"RenderOutput: Normal\":4===e.output?\"RenderOutput: Highlight\":\"\"}\n  */\n  `}\n\n\n/***/ }),\n\n/***/ \"368d\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return t; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction t(t,d){1===d.attributeTextureCoordinates&&(t.attributes.add(\"uv0\",\"vec2\"),t.varyings.add(\"vuv0\",\"vec2\"),t.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardTextureCoordinates() {\n        vuv0 = uv0;\n      }\n    `)),2===d.attributeTextureCoordinates&&(t.attributes.add(\"uv0\",\"vec2\"),t.varyings.add(\"vuv0\",\"vec2\"),t.attributes.add(\"uvRegion\",\"vec4\"),t.varyings.add(\"vuvRegion\",\"vec4\"),t.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardTextureCoordinates() {\n        vuv0 = uv0;\n        vuvRegion = uvRegion;\n      }\n    `)),0===d.attributeTextureCoordinates&&t.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardTextureCoordinates() {}\n    `)}\n\n\n/***/ }),\n\n/***/ \"69UF\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return r; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return d; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return o; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst d=.1,o=.001;function r(d,o){const r=d.fragment;switch(o.alphaDiscardMode){case 0:r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        #define discardOrAdjustAlpha(color) { if (color.a < ${_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"].float(.001)}) { discard; } }\n      `);break;case 1:r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a = 1.0;\n        }\n      `);break;case 2:r.uniforms.add(\"textureAlphaCutoff\",\"float\"),r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }\n      `);break;case 3:d.fragment.uniforms.add(\"textureAlphaCutoff\",\"float\"),d.fragment.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }\n      `)}}\n\n\n/***/ }),\n\n/***/ \"6kvK\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ EvaluateSceneLighting_glsl_r; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl.js\nvar PiUtils_glsl = __webpack_require__(\"xRv2\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl.js\nvar ReadShadowMap_glsl = __webpack_require__(\"0BfS\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl.js + 1 modules\nvar PhysicallyBasedRendering_glsl = __webpack_require__(\"XV/G\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl.js\nvar EvaluateAmbientOcclusion_glsl = __webpack_require__(\"cIib\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientLighting.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction EvaluateAmbientLighting_glsl_n(n,t){const e=n.fragment,a=void 0!==t.lightingSphericalHarmonicsOrder?t.lightingSphericalHarmonicsOrder:2;0===a?(e.uniforms.add(\"lightingAmbientSH0\",\"vec3\"),e.code.add(interfaces[\"a\" /* glsl */]`\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight = 0.282095 * lightingAmbientSH0;\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    `)):1===a?(e.uniforms.add(\"lightingAmbientSH_R\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_G\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_B\",\"vec4\"),e.code.add(interfaces[\"a\" /* glsl */]`\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec4 sh0 = vec4(\n          0.282095,\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y\n        );\n        vec3 ambientLight = vec3(\n          dot(lightingAmbientSH_R, sh0),\n          dot(lightingAmbientSH_G, sh0),\n          dot(lightingAmbientSH_B, sh0)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    `)):2===a&&(e.uniforms.add(\"lightingAmbientSH0\",\"vec3\"),e.uniforms.add(\"lightingAmbientSH_R1\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_G1\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_B1\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_R2\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_G2\",\"vec4\"),e.uniforms.add(\"lightingAmbientSH_B2\",\"vec4\"),e.code.add(interfaces[\"a\" /* glsl */]`\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight = 0.282095 * lightingAmbientSH0;\n\n        vec4 sh1 = vec4(\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y,\n          1.092548 * normal.x * normal.y\n        );\n        vec4 sh2 = vec4(\n          1.092548 * normal.y * normal.z,\n          0.315392 * (3.0 * normal.z * normal.z - 1.0),\n          1.092548 * normal.x * normal.z,\n          0.546274 * (normal.x * normal.x - normal.y * normal.y)\n        );\n        ambientLight += vec3(\n          dot(lightingAmbientSH_R1, sh1),\n          dot(lightingAmbientSH_G1, sh1),\n          dot(lightingAmbientSH_B1, sh1)\n        );\n        ambientLight += vec3(\n          dot(lightingAmbientSH_R2, sh2),\n          dot(lightingAmbientSH_G2, sh2),\n          dot(lightingAmbientSH_B2, sh2)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    `),1!==t.pbrMode&&2!==t.pbrMode||e.code.add(interfaces[\"a\" /* glsl */]`\n        const vec3 skyTransmittance = vec3(0.9, 0.9, 1.0);\n\n        vec3 calculateAmbientRadiance(float ambientOcclusion)\n        {\n          vec3 ambientLight = 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;\n          return ambientLight *= (1.0 - ambientOcclusion) * skyTransmittance;\n        }\n      `))}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateMainLighting.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction EvaluateMainLighting_glsl_t(t){const n=t.fragment;n.uniforms.add(\"lightingMainDirection\",\"vec3\"),n.uniforms.add(\"lightingMainIntensity\",\"vec3\"),n.uniforms.add(\"lightingFixedFactor\",\"float\"),n.code.add(interfaces[\"a\" /* glsl */]`\n    vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {\n      float dotVal = clamp(-dot(normal_global, lightingMainDirection), 0.0, 1.0);\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal = mix(dotVal, 1.0, lightingFixedFactor);\n\n      return lightingMainIntensity * ((1.0 - shadowing) * dotVal);\n    }\n  `)}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction EvaluateSceneLighting_glsl_r(r,c){const d=r.fragment;r.include(EvaluateMainLighting_glsl_t),r.include(EvaluateAmbientOcclusion_glsl[\"a\" /* EvaluateAmbientOcclusion */],c),0!==c.pbrMode&&r.include(PhysicallyBasedRendering_glsl[\"a\" /* PhysicallyBasedRendering */],c),r.include(EvaluateAmbientLighting_glsl_n,c),c.receiveShadows&&r.include(ReadShadowMap_glsl[\"a\" /* ReadShadowMap */],c),d.uniforms.add(\"lightingGlobalFactor\",\"float\"),d.uniforms.add(\"ambientBoostFactor\",\"float\"),r.include(PiUtils_glsl[\"a\" /* PiUtils */]),d.code.add(interfaces[\"a\" /* glsl */]`\n    const float GAMMA_SRGB = 2.1;\n    const float INV_GAMMA_SRGB = 0.4761904;\n    ${0===c.pbrMode?\"\":\"const vec3 GROUND_REFLECTANCE = vec3(0.2);\"}\n  `),c.useOldSceneLightInterface?d.code.add(interfaces[\"a\" /* glsl */]`\n    vec3 evaluateSceneLightingExt(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight) {\n      // evaluate the main light\n      #if defined(TREE_RENDERING)\n        // Special case for tree rendering:\n        // We shift the Lambert lobe to the back, allowing it to reach part of the hemisphere\n        // facing away from the light. The idea is to get an effect where light is transmitted\n        // through the tree.\n        float minDot = -0.5;\n        float dotRange = 1.0 - minDot;\n        float dotNormalization = 0.66; // guessed & hand tweaked value, for an exact value we could precompute an integral over the sphere\n\n        float dotVal = dotNormalization * (clamp(-dot(normal, lightingMainDirection), 1.0 - dotRange, 1.0) - minDot) * (1.0 / dotRange);\n      #else\n        float dotVal = clamp(-dot(normal, lightingMainDirection), 0.0, 1.0);\n      #endif\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal = mix(dotVal, 1.0, lightingFixedFactor);\n\n      vec3 mainLight = (1.0 - shadow) * lightingMainIntensity * dotVal;\n      vec3 ambientLight = calculateAmbientIrradiance(normal, ssao);\n\n      // inverse gamma correction on the albedo color\n      vec3 albedoGammaC = pow(albedo, vec3(GAMMA_SRGB));\n\n      // physically correct BRDF normalizes by PI\n      vec3 totalLight = mainLight + ambientLight + additionalLight;\n      totalLight = min(totalLight, vec3(PI));\n      vec3 outColor = vec3((albedoGammaC / PI) * (totalLight));\n\n      // apply gamma correction to the computed color\n      outColor = pow(outColor, vec3(INV_GAMMA_SRGB));\n\n      return outColor;\n    }\n  `):(1===c.viewingMode?d.code.add(interfaces[\"a\" /* glsl */]`\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        vec3 shadingNormalWorld = normalize(vPosWorld);\n        float vndl = -dot(shadingNormalWorld, lightingMainDirection);\n\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    `):d.code.add(interfaces[\"a\" /* glsl */]`\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        float vndl = -dot(vec3(0.0, 0.0, 1.0), lightingMainDirection);\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    `),d.code.add(interfaces[\"a\" /* glsl */]`\n      vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\n        float additionalAmbientScale = _oldHeuristicLighting(vPosWorld);\n        return (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n      }\n    `),0===c.pbrMode||4===c.pbrMode?d.code.add(interfaces[\"a\" /* glsl */]`\n      vec3 evaluateSceneLighting(vec3 normalWorld, vec3 baseColor, float mainLightShadow, float ambientOcclusion, vec3 additionalLight)\n      {\n        vec3 mainLighting = evaluateMainLighting(normalWorld, mainLightShadow);\n        vec3 ambientLighting = calculateAmbientIrradiance(normalWorld, ambientOcclusion);\n        // inverse gamma correction on the base color\n        vec3 baseColorLinear = pow(baseColor, vec3(GAMMA_SRGB));\n\n        // physically correct BRDF normalizes by PI\n        vec3 totalLight = mainLighting + ambientLighting + additionalLight;\n        totalLight = min(totalLight, vec3(PI));\n        vec3 outColor = vec3((baseColorLinear / PI) * totalLight);\n\n        // apply gamma correction to the computed color\n        outColor = pow(outColor, vec3(INV_GAMMA_SRGB));\n\n        return outColor;\n      }\n      `):1!==c.pbrMode&&2!==c.pbrMode||(d.code.add(interfaces[\"a\" /* glsl */]`\n      const float fillLightIntensity = 0.25;\n      const float horizonLightDiffusion = 0.4;\n      const float additionalAmbientIrradianceFactor = 0.02;\n\n      vec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n      {\n        // Calculate half vector between view and light direction\n        vec3 viewDirection = -viewDir;\n        vec3 mainLightDirection = -lightingMainDirection;\n        vec3 h = normalize(viewDirection + mainLightDirection);\n\n        PBRShadingInfo inputs;\n        inputs.NdotL = clamp(dot(normal, mainLightDirection), 0.001, 1.0);\n        inputs.NdotV = clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\n        inputs.NdotH = clamp(dot(normal, h), 0.0, 1.0);\n        inputs.VdotH = clamp(dot(viewDirection, h), 0.0, 1.0);\n        inputs.NdotNG = clamp(dot(normal, normalGround), -1.0, 1.0);\n        vec3 reflectedView = normalize(reflect(viewDirection, normal));\n        inputs.RdotNG = clamp(dot(reflectedView, normalGround), -1.0, 1.0);\n\n        inputs.albedoLinear = pow(albedo, vec3(GAMMA_SRGB));\n        inputs.ssao = ssao;\n\n        inputs.metalness = mrr[0];\n        inputs.roughness = clamp(mrr[1] * mrr[1], 0.001, 0.99);\n      `),d.code.add(interfaces[\"a\" /* glsl */]`\n        inputs.f0 = (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\n        inputs.f90 = vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0)); // more accurate then using  f90 = 1.0\n        inputs.diffuseColor = inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);\n      `),d.code.add(interfaces[\"a\" /* glsl */]`\n        vec3 ambientDir = vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\n        ambientDir = ambientDir != vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\n\n        inputs.NdotAmbDir = abs(dot(normal, ambientDir));\n\n        // Calculate the irradiance components: sun, fill lights and the sky.\n        vec3 mainLightIrradianceComponent  = inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\n        vec3 fillLightsIrradianceComponent = inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\n        // calculateAmbientIrradiance for localView and additionalLight for gloabalView\n        vec3 ambientLightIrradianceComponent = calculateAmbientIrradiance(normal, ssao) + additionalLight;\n\n        // Assemble the overall irradiance of the sky that illuminates the surface\n        inputs.skyIrradianceToSurface    = ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n        // Assemble the overall irradiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky irradiance by the groundReflectance\n        inputs.groundIrradianceToSurface = GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n      `),d.code.add(interfaces[\"a\" /* glsl */]`\n        vec3 horizonRingDir = inputs.RdotNG * normalGround - reflectedView;\n        vec3 horizonRingH = normalize(viewDirection + horizonRingDir);\n        inputs.NdotH_Horizon = dot(normal, horizonRingH);\n\n        vec3 mainLightRadianceComponent  = normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\n        vec3 horizonLightRadianceComponent = normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\n        vec3 ambientLightRadianceComponent = calculateAmbientRadiance(ssao) + additionalLight; // calculateAmbientRadiance for localView and additionalLight for gloabalView\n\n        // Assemble the overall radiance of the sky that illuminates the surface\n        inputs.skyRadianceToSurface    =  ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\n        // Assemble the overall radiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky radince by the groundReflectance\n        inputs.groundRadianceToSurface = GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\n\n        // Calculate average ambient radiance - this is used int the gamut mapping part to deduce the black level that is soft compressed\n        inputs.averageAmbientRadiance = ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);\n        `),d.code.add(interfaces[\"a\" /* glsl */]`\n        vec3 reflectedColorComponent = evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent = inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent = pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear = reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ${2===c.pbrMode?interfaces[\"a\" /* glsl */]`vec3 outColor = pow(max(vec3(0.0), outColorLinear - 0.005 * inputs.averageAmbientRadiance), vec3(INV_GAMMA_SRGB));`:interfaces[\"a\" /* glsl */]`vec3 outColor = pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));`}\n        return outColor;\n      }\n    `)))}\n\n\n/***/ }),\n\n/***/ \"AxBq\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return _; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return P; });\n/* harmony import */ var _views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"Tbkp\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"aQrP\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"0nJL\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_VisualVariables_glsl_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"viRi\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"69UF\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_VerticalOffset_glsl_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"F7CJ\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_VertexColor_glsl_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"bVvB\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_ReadShadowMap_glsl_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(\"0BfS\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_ForwardLinearDepth_glsl_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(\"vXUg\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRendering_glsl_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(\"XV/G\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_InstancedDoublePrecision_glsl_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(\"1TnO\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_TextureCoordinateAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(\"368d\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRenderingParameters_glsl_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(\"p9cc\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_Offset_glsl_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(\"F8o4\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_NormalAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(\"wzLF\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_PositionAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(\"sJp1\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_SymbolColor_glsl_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(\"bLIi\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_VertexNormal_glsl_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(\"fRF2\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_default_DefaultMaterialAuxiliaryPasses_glsl_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(\"fiGu\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_ComputeNormalTexture_glsl_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(\"DXpj\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_EvaluateAmbientOcclusion_glsl_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(\"cIib\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_EvaluateSceneLighting_glsl_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(\"6kvK\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_Normals_glsl_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(\"qrV2\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_util_HeaderComment_glsl_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(\"1W42\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_util_MixExternalColor_glsl_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(\"NiZE\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction P(P){const _=new _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_2__[/* ShaderBuilder */ \"a\"],E=_.vertex.code,S=_.fragment.code;return _.include(_views_3d_webgl_engine_core_shaderLibrary_util_HeaderComment_glsl_js__WEBPACK_IMPORTED_MODULE_24__[/* HeaderComment */ \"a\"],{name:\"Default Material Shader\",output:P.output}),_.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\").add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\"),_.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_PositionAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_16__[/* PositionAttribute */ \"a\"]),_.varyings.add(\"vpos\",\"vec3\"),_.include(_views_3d_webgl_engine_core_shaderLibrary_shading_VisualVariables_glsl_js__WEBPACK_IMPORTED_MODULE_4__[/* VisualVariables */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_InstancedDoublePrecision_glsl_js__WEBPACK_IMPORTED_MODULE_11__[/* InstancedDoublePrecision */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_VerticalOffset_glsl_js__WEBPACK_IMPORTED_MODULE_6__[/* VerticalOffset */ \"a\"],P),0!==P.output&&7!==P.output||(_.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_NormalAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_15__[/* NormalAttribute */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_1__[/* Transform */ \"a\"],{linearDepth:!1}),0===P.normalType&&P.offsetBackfaces&&_.include(_views_3d_webgl_engine_core_shaderLibrary_Offset_glsl_js__WEBPACK_IMPORTED_MODULE_14__[/* Offset */ \"a\"]),_.include(_views_3d_webgl_engine_core_shaderLibrary_shading_ComputeNormalTexture_glsl_js__WEBPACK_IMPORTED_MODULE_20__[/* ComputeNormalTexture */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_VertexNormal_glsl_js__WEBPACK_IMPORTED_MODULE_18__[/* VertexNormal */ \"a\"],P),P.instancedColor&&_.attributes.add(\"instanceColor\",\"vec4\"),_.varyings.add(\"localvpos\",\"vec3\"),_.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_TextureCoordinateAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_12__[/* TextureCoordinateAttribute */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_ForwardLinearDepth_glsl_js__WEBPACK_IMPORTED_MODULE_9__[/* ForwardLinearDepth */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_SymbolColor_glsl_js__WEBPACK_IMPORTED_MODULE_17__[/* SymbolColor */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_VertexColor_glsl_js__WEBPACK_IMPORTED_MODULE_7__[/* VertexColor */ \"a\"],P),_.vertex.uniforms.add(\"externalColor\",\"vec4\"),_.varyings.add(\"vcolorExt\",\"vec4\"),E.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt = externalColor;\n        ${P.instancedColor?\"vcolorExt *= instanceColor;\":\"\"}\n        vcolorExt *= vvColor();\n        vcolorExt *= getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a < ${_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"].float(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_5__[/* symbolAlphaCutoff */ \"c\"])}) {\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        }\n        else {\n          vpos = calculateVPos();\n          localvpos = vpos - view[3].xyz;\n          vpos = subtractOrigin(vpos);\n          ${0===P.normalType?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n          vNormalWorld = dpNormal(vvLocalNormal(normalModel()));`:\"\"}\n          vpos = addVerticalOffset(vpos, localOrigin);\n          ${P.vertexTangets?\"vTangent = dpTransformVertexTangent(tangent);\":\"\"}\n          gl_Position = transformPosition(proj, view, vpos);\n          ${0===P.normalType&&P.offsetBackfaces?\"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);\":\"\"}\n        }\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    `)),7===P.output&&(_.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_3__[/* Slice */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_5__[/* DiscardOrAdjustAlpha */ \"a\"],P),_.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),P.hasColorTexture&&_.fragment.uniforms.add(\"tex\",\"sampler2D\"),_.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_util_MixExternalColor_glsl_js__WEBPACK_IMPORTED_MODULE_25__[/* MixExternalColor */ \"a\"]),S.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void main() {\n        discardBySlice(vpos);\n        ${P.hasColorTexture?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${P.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`vec4 texColor = vec4(1.0);`}\n        ${P.attributeColor?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        gl_FragColor = vec4(opacity_);\n      }\n    `)),0===P.output&&(_.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_3__[/* Slice */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_shading_EvaluateSceneLighting_glsl_js__WEBPACK_IMPORTED_MODULE_22__[/* EvaluateSceneLighting */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_shading_EvaluateAmbientOcclusion_glsl_js__WEBPACK_IMPORTED_MODULE_21__[/* EvaluateAmbientOcclusion */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_5__[/* DiscardOrAdjustAlpha */ \"a\"],P),P.receiveShadows&&_.include(_views_3d_webgl_engine_core_shaderLibrary_shading_ReadShadowMap_glsl_js__WEBPACK_IMPORTED_MODULE_8__[/* ReadShadowMap */ \"a\"],P),_.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"ambient\",\"vec3\").add(\"diffuse\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),P.hasColorTexture&&_.fragment.uniforms.add(\"tex\",\"sampler2D\"),_.include(_views_3d_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRenderingParameters_glsl_js__WEBPACK_IMPORTED_MODULE_13__[/* PhysicallyBasedRenderingParameters */ \"a\"],P),_.include(_views_3d_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRendering_glsl_js__WEBPACK_IMPORTED_MODULE_10__[/* PhysicallyBasedRendering */ \"a\"],P),_.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_util_MixExternalColor_glsl_js__WEBPACK_IMPORTED_MODULE_25__[/* MixExternalColor */ \"a\"]),_.include(_views_3d_webgl_engine_core_shaderLibrary_shading_Normals_glsl_js__WEBPACK_IMPORTED_MODULE_23__[/* Normals */ \"a\"],P),S.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void main() {\n        discardBySlice(vpos);\n        ${P.hasColorTexture?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${P.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`vec4 texColor = vec4(1.0);`}\n        shadingParams.viewDirection = normalize(vpos - camPos);\n        ${3===P.normalType?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec3 normal = screenDerivativeNormal(localvpos);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        shadingParams.normalView = vNormalWorld;\n        vec3 normal = shadingNormal(shadingParams);`}\n        ${1===P.pbrMode?\"applyPBRFactors();\":\"\"}\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ${P.receiveShadows?\"float shadow = readShadowMap(vpos, linearDepth);\":1===P.viewingMode?\"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);\":\"float shadow = 0.0;\"}\n        vec3 matColor = max(ambient, diffuse);\n        ${P.attributeColor?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec3 albedo_ = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec3 albedo_ = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        ${P.hasNormalTexture?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n              mat3 tangentSpace = ${P.vertexTangets?\"computeTangentSpace(normal);\":\"computeTangentSpace(normal, vpos, vuv0);\"}\n              vec3 shadedNormal = computeTextureNormal(tangentSpace, vuv0);`:\"vec3 shadedNormal = normal;\"}\n        ${1===P.pbrMode||2===P.pbrMode?1===P.viewingMode?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`vec3 normalGround = normalize(vpos + localOrigin);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`vec3 normalGround = vec3(0.0, 0.0, 1.0);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]``}\n        ${1===P.pbrMode||2===P.pbrMode?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor = evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);`:\"vec3 shadedColor = evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\"}\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ${P.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n      }\n    `)),_.include(_views_3d_webgl_engine_core_shaderLibrary_default_DefaultMaterialAuxiliaryPasses_glsl_js__WEBPACK_IMPORTED_MODULE_19__[/* DefaultMaterialAuxiliaryPasses */ \"a\"],P),_}var _=Object.freeze({__proto__:null,build:P});\n\n\n/***/ }),\n\n/***/ \"D6bk\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var _Util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"hTmG\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet e=0;/* harmony default export */ __webpack_exports__[\"a\"] = (class{constructor(t,i,s,n,r){this._context=t,this._locations=i,this._layout=s,this._buffers=n,this._indexBuffer=r,this._glName=null,this.id=e++,this._initialized=!1,t.instanceCounter.increment(2,this)}get glName(){return this._glName}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get size(){return Object.keys(this._buffers).reduce(((t,i)=>t+this._buffers[i].size),this._indexBuffer?this._indexBuffer.size:0)}get layout(){return this._layout}get locations(){return this._locations}dispose(t=!0){if(!this._context)return;const i=this._context.capabilities.vao;i&&this._glName&&(i.deleteVertexArray(this._glName),this._glName=null);if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),t){for(const t in this._buffers)this._buffers[t].dispose(),delete this._buffers[t];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context.instanceCounter.decrement(2,this),this._context=null}initialize(){if(this._initialized)return;const t=this._context.capabilities.vao;if(t){const i=t.createVertexArray();t.bindVertexArray(i),this._bindLayout(),t.bindVertexArray(null),this._glName=i}this._initialized=!0}bind(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const i=this._buffers,e=!!this._context.capabilities.vao,s=this._layout,n=this._indexBuffer;i||console.error(\"Vertex buffer dictionary is empty!\");const r=this._context.gl;for(const e in i){const n=i[e];n||console.error(\"Vertex buffer is uninitialized!\");const r=s[e];r||console.error(\"Vertex element descriptor is empty!\"),Object(_Util_js__WEBPACK_IMPORTED_MODULE_0__[/* bindVertexBufferLayout */ \"a\"])(this._context,this._locations,n,r)}n&&(e?r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n.glName):this._context.bindBuffer(n))}unbind(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const t=this._buffers,e=this._layout;t||console.error(\"Vertex buffer dictionary is empty!\");for(const s in t){const n=t[s];n||console.error(\"Vertex buffer is uninitialized!\");const r=e[s];Object(_Util_js__WEBPACK_IMPORTED_MODULE_0__[/* unbindVertexBufferLayout */ \"b\"])(this._context,this._locations,n,r)}const s=this._indexBuffer;s&&this._context.unbindBuffer(s.bufferType)}});\n\n\n/***/ }),\n\n/***/ \"D8Ta\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export O */\n/* unused harmony export U */\n/* unused harmony export Z */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return n; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return r; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return u; });\n/* unused harmony export d */\n/* unused harmony export e */\n/* unused harmony export f */\n/* unused harmony export g */\n/* unused harmony export h */\n/* unused harmony export i */\n/* unused harmony export j */\n/* unused harmony export k */\n/* unused harmony export o */\n/* unused harmony export u */\n/* unused harmony export v */\n/* unused harmony export z */\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction n(){return[0,0,0,0]}function t(n){return[n[0],n[1],n[2],n[3]]}function r(n,t,r,e){return[n,t,r,e]}function e(n){const t=[0,0,0,0],r=Math.min(4,n.length);for(let e=0;e<r;++e)t[e]=n[e];return t}function u(n,t){return new Float64Array(n,t,4)}function a(){return[0,0,0,0]}function o(){return r(1,1,1,1)}function s(){return r(1,0,0,0)}function c(){return r(0,1,0,0)}function i(){return r(0,0,1,0)}function f(){return r(0,0,0,1)}const _=[0,0,0,0],l=o(),N=s(),U=c(),I=i(),O=f();var T=Object.freeze({__proto__:null,create:n,clone:t,fromValues:r,fromArray:e,createView:u,zeros:a,ones:o,unitX:s,unitY:c,unitZ:i,unitW:f,ZEROS:_,ONES:l,UNIT_X:N,UNIT_Y:U,UNIT_Z:I,UNIT_W:O});\n\n\n/***/ }),\n\n/***/ \"DXpj\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return n; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/* harmony import */ var _attributes_VertexTextureCoordinates_glsl_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"fLTx\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction n(n,a){const o=n.fragment;o.uniforms.add(\"normalTexture\",\"sampler2D\"),o.uniforms.add(\"normalTextureSize\",\"vec2\"),a.vertexTangets?(n.attributes.add(\"tangent\",\"vec4\"),n.varyings.add(\"vTangent\",\"vec4\"),2===a.doubleSidedMode?o.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness = gl_FrontFacing ? vTangent.w : -vTangent.w;\n        vec3 tangent = normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\n        vec3 bitangent = cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    `):o.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness = vTangent.w;\n        vec3 tangent = normalize(vTangent.xyz);\n        vec3 bitangent = cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    `)):(n.extensions.add(\"GL_OES_standard_derivatives\"),o.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\n\n      vec3 Q1 = dFdx(pos);\n      vec3 Q2 = dFdy(pos);\n\n      vec2 stx = dFdx(st);\n      vec2 sty = dFdy(st);\n\n      float det = stx.t * sty.s - sty.t * stx.s;\n\n      vec3 T = stx.t * Q2 - sty.t * Q1; // compute tangent\n      T = T - normal * dot(normal, T); // orthogonalize tangent\n      T *= inversesqrt(max(dot(T,T), 1.e-10)); // \"soft\" normalize - goes to 0 when T goes to 0\n      vec3 B = sign(det) * cross(normal, T); // assume normal is normalized, B has the same lenght as B\n      return mat3(T, B, normal); // T and B go to 0 when the tangent space is not well defined by the uv coordinates\n    }\n  `)),0!==a.attributeTextureCoordinates&&(n.include(_attributes_VertexTextureCoordinates_glsl_js__WEBPACK_IMPORTED_MODULE_1__[/* VertexTextureCoordinates */ \"a\"],a),o.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv = uv;\n      ${a.supportsTextureAtlas?\"vtc.size = normalTextureSize;\":\"\"}\n      vec3 rawNormal = textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  `))}\n\n\n/***/ }),\n\n/***/ \"EVMh\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export AssertException */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return i; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return f; });\n/* unused harmony export createTranslationMatrix */\n/* unused harmony export dec2hex */\n/* unused harmony export encodeInt16 */\n/* unused harmony export encodeNormal */\n/* unused harmony export fallbackIfUndefined */\n/* unused harmony export fovd2fovx */\n/* unused harmony export fovd2fovy */\n/* unused harmony export fovx2fovd */\n/* unused harmony export fovx2fovy */\n/* unused harmony export fovy2fovd */\n/* unused harmony export fovy2fovx */\n/* unused harmony export getFirstObjectKey */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return E; });\n/* unused harmony export getMatrixTranslation */\n/* unused harmony export hex2rgb */\n/* unused harmony export inverseProjectionInfo */\n/* unused harmony export isTranslationMatrix */\n/* unused harmony export logWithBase */\n/* unused harmony export objectEmpty */\n/* unused harmony export packFloatRGBA */\n/* unused harmony export project */\n/* unused harmony export rayBoxTest */\n/* unused harmony export rayRay2D */\n/* unused harmony export rayTriangle3D */\n/* unused harmony export rgb2hex */\n/* unused harmony export setMatrixTranslation */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return j; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return L; });\n/* unused harmony export verify */\n/* harmony import */ var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OKTS\");\n/* harmony import */ var _chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"Cy1f\");\n/* harmony import */ var _chunks_mat4_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"15Hh\");\n/* harmony import */ var _chunks_vec2f64_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"AvGH\");\n/* harmony import */ var _chunks_vec4f64_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"D8Ta\");\n/* harmony import */ var _chunks_vec2_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"M0lq\");\n/* harmony import */ var _chunks_vec4_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"dXfX\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst s=Object(_chunks_vec4f64_js__WEBPACK_IMPORTED_MODULE_4__[\"a\"])();class e{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}const i={POSITION:\"position\",NORMAL:\"normal\",UV0:\"uv0\",UVMAPSPACE:\"uvMapSpace\",MEANVERTEXPOSITION:\"meanVertexPosition\",AUXPOS1:\"auxpos1\",AUXPOS2:\"auxpos2\",BOUND1:\"bound1\",BOUND2:\"bound2\",BOUND3:\"bound3\",COLOR:\"color\",SYMBOLCOLOR:\"symbolColor\",SIZE:\"size\",TANGENT:\"tangent\"};function f(t,n){if(!t){n=n||\"assert\";const t=new Error(n);throw t.stack&&console.log(t.stack),new e(n)}}function h(t,n){t||(n=n||\"\",console.warn(\"Verify failed: \"+n+\"\\n\"+new Error(\"verify\").stack))}function M(n){return Object(_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__[/* clamp */ \"c\"])(Math.round(32767*n),-32767,32767)}function l(t,n){const r=Math.abs(t[0]),o=Math.abs(t[1]),a=1/(r+o+Math.abs(t[2])),u=r*a,c=o*a,s=Math.min(t[2]*a,0);n[0]=(t[0]<0?-1:1)*(u-s),n[1]=(t[1]<0?-1:1)*(c-s)}function m(t,n){return void 0===t?n:t}function p(t){return[((t=Math.floor(t))>>16&255)/255,(t>>8&255)/255,(255&t)/255]}function O(n){return\"0x\"+((Object(_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__[/* clamp */ \"c\"])(Math.round(255*n[0]),0,255)<<16)+(Object(_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__[/* clamp */ \"c\"])(Math.round(255*n[1]),0,255)<<8)+Object(_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__[/* clamp */ \"c\"])(Math.round(255*n[2]),0,255)).toString(16)}function g(t){const n=t.toString(16);return\"00000000\".substr(0,8-n.length)+n}function S(t,r,o,a,u,c,s,e,i=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__[/* c */ \"e\"])()){const f=1e-5,h=a[s]-o[c],M=a[s+1]-o[c+1],l=a[s+2]-o[c+2],m=u[e]-o[c],p=u[e+1]-o[c+1],O=u[e+2]-o[c+2],g=r[1]*O-p*r[2],S=r[2]*m-O*r[0],d=r[0]*p-m*r[1],v=h*g+M*S+l*d;if(v>-f&&v<f)return!1;const k=1/v,A=t[0]-o[c],E=t[1]-o[c+1],N=t[2]-o[c+2];if(i[1]=k*(A*g+E*S+N*d),i[1]<0||i[1]>1)return!1;const U=E*l-M*N,b=N*h-l*A,j=A*M-h*E;return i[2]=k*(r[0]*U+r[1]*b+r[2]*j),!(i[2]<0||i[1]+i[2]>1)&&(i[0]=k*(m*U+p*b+O*j),!0)}function d(t,n,r,o){let a,u=(r[0]-t[0])/n[0],c=(o[0]-t[0])/n[0];u>c&&(a=u,u=c,c=a);let s=(r[1]-t[1])/n[1],e=(o[1]-t[1])/n[1];if(s>e&&(a=s,s=e,e=a),u>e||s>c)return!1;s>u&&(u=s),e<c&&(c=e);let i=(r[2]-t[2])/n[2],f=(o[2]-t[2])/n[2];return i>f&&(a=i,i=f,f=a),!(u>f||i>c)&&(f<c&&(c=f),!(c<0))}function v(t,n,r,a,u,c=Object(_chunks_vec2f64_js__WEBPACK_IMPORTED_MODULE_3__[\"a\"])()){const s=(a[u]-r[u])*(n[0]-t[0])-(a[0]-r[0])*(n[u]-t[u]),e=(a[0]-r[0])*(t[u]-r[u])-(a[u]-r[u])*(t[0]-r[0]);if(0===s)return!1;const i=e/s;return c[0]=t[0]+i*(n[0]-t[0]),c[1]=t[u]+i*(n[u]-t[u]),!0}function k(t,n,r,o,a){a||(a=t),s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=1,Object(_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_6__[/* t */ \"l\"])(s,s,n),a.length>2&&(a[2]=-s[2]),Object(_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_6__[/* t */ \"l\"])(s,s,r),f(0!==s[3]),a[0]=s[0]/s[3],a[1]=s[1]/s[3],a[2]=s[2]/s[3],a[0]=(.5*a[0]+.5)*o[2]+o[0],a[1]=(.5*a[1]+.5)*o[3]+o[1]}function A(t){for(const n in t)return n}function E(t){return t[A(t)]}function N(t){for(const n in t)return!1;return!0}function U(t,n){return Math.log(t)/Math.log(n)}function b(t,n){t[12]=n[0],t[13]=n[1],t[14]=n[2]}function j(t,n,r,o){t[12]=n,t[13]=r,t[14]=o}function P(t,r=Object(_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_1__[/* c */ \"e\"])()){return r[0]=t[12],r[1]=t[13],r[2]=t[14],r}function w(t,n){return b(t=Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_2__[/* i */ \"e\"])(t),n),t}function x(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]}function C(t,n,r){return 2*Math.atan(r*Math.tan(.5*t)/n)}function I(t,n,r){return 2*Math.atan(n*Math.tan(.5*t)/r)}function T(t,n,r){return 2*Math.atan(Math.sqrt(n*n+r*r)*Math.tan(.5*t)/n)}function V(t,n,r){return 2*Math.atan(Math.sqrt(n*n+r*r)*Math.tan(.5*t)/r)}function q(t,n,r){return 2*Math.atan(n*Math.tan(.5*t)/Math.sqrt(n*n+r*r))}function y(t,n,r){return 2*Math.atan(r*Math.tan(.5*t)/Math.sqrt(n*n+r*r))}function B(n,r,o=0){const a=Object(_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__[/* clamp */ \"c\"])(n,0,X);for(let t=0;t<4;t++)r[o+t]=Math.floor(256*((u=a*R[t])-Math.floor(u)));var u}function L(t,n=0){let r=0;for(let o=0;o<4;o++)r+=t[n+o]*D[o];return r}const R=[1,256,65536,16777216],D=[1/256,1/65536,1/16777216,1/4294967296],X=L(new Uint8ClampedArray([255,255,255,255]));function z(t,n,r,o,a){const c=t;0===t[11]?(o[0]=2/(n*c[0]),o[1]=2/(r*c[5]),o[2]=(1+c[12])/c[0],o[3]=(1+c[13])/c[5],Object(_chunks_vec2_js__WEBPACK_IMPORTED_MODULE_5__[/* s */ \"m\"])(a,0,1)):(o[0]=-2/(n*c[0]),o[1]=-2/(r*c[5]),o[2]=(1-c[8])/c[0],o[3]=(1-c[9])/c[5],Object(_chunks_vec2_js__WEBPACK_IMPORTED_MODULE_5__[/* s */ \"m\"])(a,1,0))}\n\n\n/***/ }),\n\n/***/ \"F7CJ\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ VerticalOffset_glsl_t; });\n\n// UNUSED EXPORTS: calculateVerticalOffsetFactors\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/MaterialUtil.js + 1 modules\nvar MaterialUtil = __webpack_require__(\"fFEv\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/ScreenSizePerspective.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction ScreenSizePerspective_glsl_a(r){r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    float screenSizePerspectiveMinSize(float size, vec4 factor) {\n      float nonZeroSize = 1.0 - step(size, 0.0);\n\n      return (\n        factor.z * (\n          1.0 +\n          // Multiply by nzs ensures if size is 0, then we ignore proportionally scaled padding\n          nonZeroSize *\n          2.0 * factor.w / (\n            size + (1.0 - nonZeroSize) // Adding 1 - nzs ensures we divide either by size, or by 1\n          )\n        )\n      );\n    }\n  `),r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\n      return absCosAngle * absCosAngle * absCosAngle;\n    }\n  `),r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\n      return vec4(\n        min(params.x / (distanceToCamera - params.y), 1.0),\n        screenSizePerspectiveViewAngleDependentFactor(absCosAngle),\n        params.z,\n        params.w\n      );\n    }\n  `),r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\n      return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n    }\n  `),r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorFloat(\n        size,\n        screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)\n      );\n    }\n  `),r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\n      return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n    }\n  `),r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n    }\n  `)}!function(e){e.bindUniforms=function(e,a){if(a.screenSizePerspective){Object(MaterialUtil[\"a\" /* bindScreenSizePerspective */])(a.screenSizePerspective,e,\"screenSizePerspective\");const s=a.screenSizePerspectiveAlignment||a.screenSizePerspective;Object(MaterialUtil[\"a\" /* bindScreenSizePerspective */])(s,e,\"screenSizePerspectiveAlignment\")}}}(ScreenSizePerspective_glsl_a||(ScreenSizePerspective_glsl_a={}));\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction VerticalOffset_glsl_t(t,l){const c=t.vertex.code;l.verticalOffsetEnabled?(t.vertex.uniforms.add(\"verticalOffset\",\"vec4\"),l.screenSizePerspectiveEnabled&&(t.include(ScreenSizePerspective_glsl_a),t.vertex.uniforms.add(\"screenSizePerspectiveAlignment\",\"vec4\")),c.add(interfaces[\"a\" /* glsl */]`\n    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);\n      ${1===l.viewingMode?interfaces[\"a\" /* glsl */]`vec3 worldNormal = normalize(worldPos + localOrigin);`:interfaces[\"a\" /* glsl */]`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}\n      ${l.screenSizePerspectiveEnabled?interfaces[\"a\" /* glsl */]`\n          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));\n          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:interfaces[\"a\" /* glsl */]`\n          float verticalOffsetScreenHeight = verticalOffset.x;`}\n      // Screen sized offset in world space, used for example for line callouts\n      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n      return worldNormal * worldOffset;\n    }\n\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n    }\n    `)):c.add(interfaces[\"a\" /* glsl */]`\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }\n    `)}function VerticalOffset_glsl_l(e,r,t,l=VerticalOffset_glsl_c){return l.screenLength=e.screenLength,l.perDistance=Math.tan(.5*r)/(.5*t),l.minWorldLength=e.minWorldLength,l.maxWorldLength=e.maxWorldLength,l}!function(e){e.bindUniforms=function(e,r,t){if(!r.verticalOffset)return;const c=VerticalOffset_glsl_l(r.verticalOffset,t.camera.fovY,t.camera.fullViewport[3]),i=t.camera.pixelRatio||1;e.setUniform4f(\"verticalOffset\",c.screenLength*i,c.perDistance,c.minWorldLength,c.maxWorldLength)}}(VerticalOffset_glsl_t||(VerticalOffset_glsl_t={}));const VerticalOffset_glsl_c={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0};\n\n\n/***/ }),\n\n/***/ \"F8o4\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return e; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction e(e){e.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\n      vec3 camToVert = posWorld - camPosWorld;\n\n      bool isBackface = dot(camToVert, normalWorld) > 0.0;\n      if (isBackface) {\n        posClip.z += 0.0000003 * posClip.w;\n      }\n      return posClip;\n    }\n  `)}\n\n\n/***/ }),\n\n/***/ \"NiZE\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ MixExternalColor_glsl_i; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction ColorConversion_glsl_c(c){c.code.add(interfaces[\"a\" /* glsl */]`\n    vec4 premultiplyAlpha(vec4 v) {\n      return vec4(v.rgb * v.a, v.a);\n    }\n\n    // Note: the min in the last line has been added to fix an instability in chrome.\n    // See https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/23911\n    // With proper floating point handling, the value could never be >1.\n    vec3 rgb2hsv(vec3 c) {\n      vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n      vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n      vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n      float d = q.x - min(q.w, q.y);\n      float e = 1.0e-10;\n      return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n    }\n\n    vec3 hsv2rgb(vec3 c) {\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n      vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n      return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }\n\n    float rgb2v(vec3 c) {\n      return max(c.x, max(c.y, c.z));\n    }\n  `)}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/MixExternalColor.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction MixExternalColor_glsl_i(i){i.include(ColorConversion_glsl_c),i.code.add(interfaces[\"a\" /* glsl */]`\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed = internalColor * textureColor;\n      vec3 allMixed = internalMixed * externalColor;\n\n      if (mode == ${interfaces[\"a\" /* glsl */].int(1)}) {\n        return allMixed;\n      }\n      else if (mode == ${interfaces[\"a\" /* glsl */].int(2)}) {\n        return internalMixed;\n      }\n      else if (mode == ${interfaces[\"a\" /* glsl */].int(3)}) {\n        return externalColor;\n      }\n      else {\n        // tint (or something invalid)\n        float vIn = rgb2v(internalMixed);\n        vec3 hsvTint = rgb2hsv(externalColor);\n        vec3 hsvOut = vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n        return hsv2rgb(hsvOut);\n      }\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed = internalOpacity * textureOpacity;\n      float allMixed = internalMixed * externalOpacity;\n\n      if (mode == ${interfaces[\"a\" /* glsl */].int(2)}) {\n        return internalMixed;\n      }\n      else if (mode == ${interfaces[\"a\" /* glsl */].int(3)}) {\n        return externalOpacity;\n      }\n      else {\n        // multiply or tint (or something invalid)\n        return allMixed;\n      }\n    }\n  `)}\n\n\n/***/ }),\n\n/***/ \"OIYib\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return t; });\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction t(t,...n){let o=\"\";for(let r=0;r<n.length;r++)o+=t[r]+n[r];return o+=t[t.length-1],o}!function(t){t.int=function(t){return Math.round(t).toString()},t.float=function(t){return t.toPrecision(8)}}(t||(t={}));\n\n\n/***/ }),\n\n/***/ \"Tbkp\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return r; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction r(r,o){o.linearDepth?r.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye = view * vec4(pos, 1.0);\n      depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    `):r.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    `)}\n\n\n/***/ }),\n\n/***/ \"UBvB\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return e; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction e(e){e.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT =\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat = 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS = vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0->1 back to 0->255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  `)}\n\n\n/***/ }),\n\n/***/ \"XV/G\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ PhysicallyBasedRendering_glsl_n; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl.js\nvar PiUtils_glsl = __webpack_require__(\"xRv2\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/AnalyticalSkyModel.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction AnalyticalSkyModel_glsl_t(t){const a=t.fragment.code;a.add(interfaces[\"a\" /* glsl */]`\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    `),a.add(interfaces[\"a\" /* glsl */]`\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    `),a.add(interfaces[\"a\" /* glsl */]`\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 = 1.0 - RdotNG * RdotNG;\n      float intRadTheta = integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky = 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    `)}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction PhysicallyBasedRendering_glsl_n(n,a){const r=n.fragment.code;n.include(PiUtils_glsl[\"a\" /* PiUtils */]),3===a.pbrMode||4===a.pbrMode?(r.add(interfaces[\"a\" /* glsl */]`\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent = ${a.useCustomDTRExponentForWater?\"2.2\":\"2.0\"};\n    `),r.add(interfaces[\"a\" /* glsl */]`\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    `),r.add(interfaces[\"a\" /* glsl */]`\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 = roughness * roughness;\n      float NdotH2 = NdotH * NdotH;\n      float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    `),r.add(interfaces[\"a\" /* glsl */]`\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    `),r.add(interfaces[\"a\" /* glsl */]`\n    vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F = fresnelReflection(props.VdotH, F0, F0Max);\n      float dSun = normalDistributionWater(props.NdotH, roughness);\n      float V = geometricOcclusionKelemen(props.LdotH);\n\n      float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);\n      float strengthSunHaze  = 1.2;\n      float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;\n\n      return ((dSun + dSunHaze) * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    `)):1!==a.pbrMode&&2!==a.pbrMode||(n.include(AnalyticalSkyModel_glsl_t),r.add(interfaces[\"a\" /* glsl */]`\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    `),r.add(interfaces[\"a\" /* glsl */]`\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a = NdotH * roughness;\n        float b = roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    `),r.add(interfaces[\"a\" /* glsl */]`\n    const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 = vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r = roughness * c0 + c1;\n        float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    `),r.add(interfaces[\"a\" /* glsl */]`\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent = specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    `),r.add(interfaces[\"a\" /* glsl */]`\n    float gamutMapChanel(float x, vec2 p){\n      return (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }`),r.add(interfaces[\"a\" /* glsl */]`\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x = gamutMapChanel(inColor.x, p) ;\n      outColor.y = gamutMapChanel(inColor.y, p) ;\n      outColor.z = gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    `))}\n\n\n/***/ }),\n\n/***/ \"aQrP\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export Code */\n/* unused harmony export Includes */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return r; });\n/* unused harmony export Stage */\n/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"6S2I\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst t=_core_Logger_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"].getLogger(\"esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder\");class s{constructor(){this.includedModules=new Map}include(e,s){this.includedModules.has(e)?this.includedModules.get(e)!==s&&t.error(\"Trying to include shader module multiple times with different sets of options.\"):(this.includedModules.set(e,s),e(this.builder,s))}}class r extends s{constructor(){super(...arguments),this.vertex=new o,this.fragment=new o,this.attributes=new a,this.varyings=new c,this.extensions=new u,this.defines=new d}get builder(){return this}generateSource(e){const t=this.extensions.generateSource(e),s=this.attributes.generateSource(e),r=this.varyings.generateSource(),n=\"vertex\"===e?this.vertex:this.fragment,i=n.uniforms.generateSource(),o=n.code.generateSource(),a=\"vertex\"===e?l:h,c=this.defines.generateSource().concat(n.defines.generateSource());return`\\n${t.join(\"\\n\")}\\n\\n${c.join(\"\\n\")}\\n\\n${a}\\n\\n${i.join(\"\\n\")}\\n\\n${s.join(\"\\n\")}\\n\\n${r.join(\"\\n\")}\\n\\n${o.join(\"\\n\")}`}}class n{constructor(){this._entries=new Array,this._set=new Set}add(e,t,s){const r=`${e}_${t}_${s}`;return this._set.has(r)||(this._entries.push([e,t,s]),this._set.add(r)),this}generateSource(){return this._entries.map((e=>{return`uniform ${e[1]} ${e[0]}${t=e[2],t?`[${t}]`:\"\"};`;var t}))}}class i{constructor(){this._entries=new Array}add(e){this._entries.push(e)}generateSource(){return this._entries}}class o extends s{constructor(){super(...arguments),this.uniforms=new n,this.code=new i,this.defines=new d}get builder(){return this}}class a{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(e){return\"fragment\"===e?[]:this._entries.map((e=>`attribute ${e[1]} ${e[0]};`))}}class c{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(){return this._entries.map((e=>`varying ${e[1]} ${e[0]};`))}}class u{constructor(){this._entries=new Set}add(e){this._entries.add(e)}generateSource(e){const t=\"vertex\"===e?u.ALLOWLIST_VERTEX:u.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((e=>t.includes(e))).map((e=>`#extension ${e} : enable`))}}u.ALLOWLIST_FRAGMENT=[\"GL_EXT_shader_texture_lod\",\"GL_OES_standard_derivatives\"],u.ALLOWLIST_VERTEX=[];class d{constructor(){this._entries=new Map}addInt(e,t){const s=t%1==0?t.toFixed(0):t.toString();this._entries.set(e,s)}addFloat(e,t){const s=t%1==0?t.toFixed(1):t.toString();this._entries.set(e,s)}generateSource(){return Array.from(this._entries,(([e,t])=>`#define ${e} ${t}`))}}const h=\"#ifdef GL_FRAGMENT_PRECISION_HIGH\\n  precision highp float;\\n  precision highp sampler2D;\\n#else\\n  precision mediump float;\\n  precision mediump sampler2D;\\n#endif\",l=\"precision highp float;\\nprecision highp sampler2D;\";\n\n\n/***/ }),\n\n/***/ \"agdK\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return i; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction i(i){i.fragment.uniforms.add(\"depthTex\",\"sampler2D\"),i.fragment.uniforms.add(\"highlightViewportPixelSz\",\"vec4\"),i.fragment.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    void outputHighlight() {\n      vec4 fragCoord = gl_FragCoord;\n\n      float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z > sceneDepth + 5e-7) {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  `)}!function(e){e.bindOutputHighlight=function(e,i,t){e.bindTexture(t.highlightDepthTexture,5),i.setUniform1i(\"depthTex\",5),i.setUniform4f(\"highlightViewportPixelSz\",0,0,t.inverseViewport[0],t.inverseViewport[1])}}(i||(i={}));\n\n\n/***/ }),\n\n/***/ \"aiF/\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ o; });\n__webpack_require__.d(__webpack_exports__, \"b\", function() { return /* binding */ DoublePrecision_glsl_r; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js\nvar has = __webpack_require__(\"wSAH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/maybe.js\nvar maybe = __webpack_require__(\"srIe\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/mathUtils.js\nvar mathUtils = __webpack_require__(\"OKTS\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3f64.js\nvar vec3f64 = __webpack_require__(\"Cy1f\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/Program.js + 2 modules\nvar Program = __webpack_require__(\"jjdI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Util.js\nvar Util = __webpack_require__(\"EVMh\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/BufferObject.js\nvar BufferObject = __webpack_require__(\"fOQB\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/VertexArrayObject.js\nvar VertexArrayObject = __webpack_require__(\"D6bk\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/doublePrecisionUtils.js\nvar doublePrecisionUtils = __webpack_require__(\"mmTy\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/FramebufferObject.js\nvar FramebufferObject = __webpack_require__(\"0meK\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/RenderingContext.js + 7 modules\nvar RenderingContext = __webpack_require__(\"bfJE\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/WebGLDriverTest.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass WebGLDriverTest_l{constructor(e){this.context=e,this._doublePrecisionRequiresObfuscation=null}get doublePrecisionRequiresObfuscation(){if(Object(maybe[\"g\" /* isNone */])(this._doublePrecisionRequiresObfuscation)){const e=WebGLDriverTest_p(this.context,!1),n=WebGLDriverTest_p(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==e&&(0===n||e/n>5)}return this._doublePrecisionRequiresObfuscation}}let WebGLDriverTest_u=null;function WebGLDriverTest_f(n){return(Object(maybe[\"g\" /* isNone */])(WebGLDriverTest_u)||WebGLDriverTest_u.context!==n)&&(WebGLDriverTest_u=new WebGLDriverTest_l(n)),WebGLDriverTest_u}function WebGLDriverTest_v(e){Object(maybe[\"h\" /* isSome */])(WebGLDriverTest_u)&&WebGLDriverTest_u.context===e&&(WebGLDriverTest_u=null)}function WebGLDriverTest_p(e,n){const l=new FramebufferObject[\"a\" /* default */](e,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1});const u=BufferObject[\"a\" /* default */].createVertex(e,35044,new Uint16Array([0,0,1,0,0,1,1,1])),f=new VertexArrayObject[\"a\" /* default */](e,{a_pos:0},{geometry:[{name:\"a_pos\",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:u}),v=Object(vec3f64[\"g\" /* f */])(5633261.287538229,2626832.878767164,1434988.0495278358),p=Object(vec3f64[\"g\" /* f */])(5633271.46742708,2626873.6381334523,1434963.231608387),d=function(t,i){const r=new Program[\"a\" /* default */](e,`\\n\\n  precision highp float;\\n\\n  attribute vec2 a_pos;\\n\\n  uniform vec3 u_highA;\\n  uniform vec3 u_lowA;\\n  uniform vec3 u_highB;\\n  uniform vec3 u_lowB;\\n\\n  varying vec4 v_color;\\n\\n  ${n?\"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION\":\"\"}\\n\\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\\n\\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\\n  }\\n\\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\\n  }\\n\\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\\n    vec3 t1 = dpPlusFrc(hiA, hiB);\\n    vec3 e = dpMinusFrc(t1, hiA);\\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\\n    return t1 + t2;\\n  }\\n\\n  #else\\n\\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\\n    vec3 t1 = hiA + hiB;\\n    vec3 e = t1 - hiA;\\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\\n    return t1 + t2;\\n  }\\n\\n  #endif\\n\\n  const float MAX_RGBA_FLOAT =\\n    255.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 / 256.0 +\\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\\n\\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\\n\\n  vec4 float2rgba(const float value) {\\n    // Make sure value is in the domain we can represent\\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\\n\\n    // Decompose value in 32bit fixed point parts represented as\\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\\n    // by a power of 256 (this removes the bits that are represented in the previous\\n    // component) and then converts the fractional part to 8bits.\\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\\n\\n    // Convert uint8 values (from 0 to 255) to floating point representation for\\n    // the shader\\n    const float toU8AsFloat = 1.0 / 255.0;\\n\\n    return fixedPointU8 * toU8AsFloat;\\n  }\\n\\n  void main() {\\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\\n\\n    v_color = float2rgba(val.z / 25.0);\\n\\n    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\\n  }\\n  `,\"\\n  precision highp float;\\n\\n  varying vec4 v_color;\\n\\n  void main() {\\n    gl_FragColor = v_color;\\n  }\\n  \",{a_pos:0}),s=new Float32Array(6);Object(doublePrecisionUtils[\"a\" /* encodeDoubleArray */])(t,s,3);const a=new Float32Array(6);return Object(doublePrecisionUtils[\"a\" /* encodeDoubleArray */])(i,a,3),e.bindProgram(r),r.setUniform3f(\"u_highA\",s[0],s[2],s[4]),r.setUniform3f(\"u_lowA\",s[1],s[3],s[5]),r.setUniform3f(\"u_highB\",a[0],a[2],a[4]),r.setUniform3f(\"u_lowB\",a[1],a[3],a[5]),r}(v,p),h=e.getBoundFramebufferObject(),{x:m,y:b,width:_,height:A}=e.getViewport();e.bindFramebuffer(l),e.setViewport(0,0,1,1),e.bindVAO(f),e.drawArrays(5,0,4);const g=new Uint8Array(4);l.readPixels(0,0,1,1,6408,5121,g),d.dispose(),f.dispose(!1),u.dispose(),l.dispose(),e.setViewport(m,b,_,A),e.bindFramebuffer(h);const w=(v[2]-p[2])/25,F=Object(Util[\"e\" /* unpackFloatRGBA */])(g);return Math.abs(w-F)}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/DoublePrecision.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction o({code:e},i){i.doublePrecisionRequiresObfuscation?e.add(interfaces[\"a\" /* glsl */]`\n      vec3 dpPlusFrc(vec3 a, vec3 b) {\n        return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n      }\n\n      vec3 dpMinusFrc(vec3 a, vec3 b) {\n        return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n      }\n\n      // based on https://www.thasler.com/blog/blog/glsl-part2-emu\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 = dpPlusFrc(hiA, hiB);\n        vec3 e = dpMinusFrc(t1, hiA);\n        vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n        return t1 + t2;\n      }\n    `):e.add(interfaces[\"a\" /* glsl */]`\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 = hiA + hiB;\n        vec3 e = t1 - hiA;\n        vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n        return t1 + t2;\n      }\n    `)}function DoublePrecision_glsl_r(c){return!!Object(has[\"a\" /* default */])(\"force-double-precision-obfuscation\")||WebGLDriverTest_f(c).doublePrecisionRequiresObfuscation}\n\n\n/***/ }),\n\n/***/ \"bLIi\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ SymbolColor_glsl_r; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/collections/Component/Material/shader/DecodeSymbolColor.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction DecodeSymbolColor_glsl_l(l){l.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha = 0.0;\n\n      const float maxTint = 85.0;\n      const float maxReplace = 170.0;\n      const float scaleAlpha = 3.0;\n\n      if (symbolColor.a > maxReplace) {\n        colorMixMode = ${interfaces[\"a\" /* glsl */].int(1)};\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a > maxTint) {\n        colorMixMode = ${interfaces[\"a\" /* glsl */].int(3)};\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a > 0.0) {\n        colorMixMode = ${interfaces[\"a\" /* glsl */].int(4)};\n        symbolAlpha = scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode = ${interfaces[\"a\" /* glsl */].int(1)};\n        symbolAlpha = 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  `)}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/SymbolColor.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction SymbolColor_glsl_r(r,l){l.symbolColor?(r.include(DecodeSymbolColor_glsl_l),r.attributes.add(\"symbolColor\",\"vec4\"),r.varyings.add(\"colorMixMode\",\"mediump float\")):r.fragment.uniforms.add(\"colorMixMode\",\"int\"),l.symbolColor?r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    int symbolColorMixMode;\n\n    vec4 getSymbolColor() {\n      return decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n    }\n\n    void forwardColorMixMode() {\n      colorMixMode = float(symbolColorMixMode) + 0.5;\n    }\n  `):r.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    vec4 getSymbolColor() { return vec4(1.0); }\n    void forwardColorMixMode() {}\n    `)}\n\n\n/***/ }),\n\n/***/ \"bVvB\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return r; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction r(r,e){e.attributeColor?(r.attributes.add(\"color\",\"vec4\"),r.varyings.add(\"vColor\",\"vec4\"),r.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardVertexColor() { vColor = color; }\n    `),r.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }\n    `)):r.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    `)}\n\n\n/***/ }),\n\n/***/ \"cIib\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return o; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction o(o,t){const r=o.fragment;t.receiveAmbientOcclusion?(r.uniforms.add(\"ssaoTex\",\"sampler2D\"),r.uniforms.add(\"viewportPixelSz\",\"vec4\"),r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      float evaluateAmbientOcclusion() {\n        return 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n      }\n\n      float evaluateAmbientOcclusionInverse() {\n        float ssao = texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n        return viewportPixelSz.z < 0.0 ? 1.0 : ssao;\n      }\n    `)):r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      float evaluateAmbientOcclusion() { return 0.0; } // no occlusion\n      float evaluateAmbientOcclusionInverse() { return 1.0; }\n    `)}\n\n\n/***/ }),\n\n/***/ \"fFEv\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ MaterialUtil_B; });\n__webpack_require__.d(__webpack_exports__, \"b\", function() { return /* binding */ MaterialUtil_N; });\n__webpack_require__.d(__webpack_exports__, \"c\", function() { return /* binding */ MaterialUtil_S; });\n__webpack_require__.d(__webpack_exports__, \"d\", function() { return /* binding */ MaterialUtil_g; });\n__webpack_require__.d(__webpack_exports__, \"e\", function() { return /* binding */ MaterialUtil_L; });\n__webpack_require__.d(__webpack_exports__, \"f\", function() { return /* binding */ MaterialUtil_O; });\n\n// UNUSED EXPORTS: computeInvDir, computeNormal, intersectAabbInvDir, intersectAabbInvDirBefore, intersectDrapedRenderLineGeometry, intersectTriangles\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/maybe.js\nvar maybe = __webpack_require__(\"srIe\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/mathUtils.js\nvar mathUtils = __webpack_require__(\"OKTS\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3f64.js\nvar vec3f64 = __webpack_require__(\"Cy1f\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3.js\nvar vec3 = __webpack_require__(\"5DEt\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js\nvar aaBoundingBox = __webpack_require__(\"QmHG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Util.js\nvar Util = __webpack_require__(\"EVMh\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/utils.js\nvar utils = __webpack_require__(\"tiP8\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/screenSizePerspectiveUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction screenSizePerspectiveUtils_i(e,t){return new screenSizePerspectiveUtils_f(e,screenSizePerspectiveUtils_m,t)}function screenSizePerspectiveUtils_r(e,t){const{curvatureDependent:a,scaleStart:i,scaleFallOffRange:r}=screenSizePerspectiveUtils_m;return new screenSizePerspectiveUtils_f(e,{curvatureDependent:{min:{curvature:a.min.curvature,tiltAngle:a.min.tiltAngle,scaleFallOffFactor:screenSizePerspectiveUtils_p.curvatureDependent.min.scaleFallOffFactor},max:{curvature:a.max.curvature,tiltAngle:a.max.tiltAngle,scaleFallOffFactor:screenSizePerspectiveUtils_p.curvatureDependent.max.scaleFallOffFactor}},scaleStart:i,scaleFallOffRange:r,minPixelSize:screenSizePerspectiveUtils_p.minPixelSize},t)}function screenSizePerspectiveUtils_n(e,t,a){const i=a.parameters,r=a.paddingPixelsOverride;return screenSizePerspectiveUtils_h.scale=Math.min(i.divisor/(t-i.offset),1),screenSizePerspectiveUtils_h.factor=function(e){return Math.abs(e*e*e)}(e),screenSizePerspectiveUtils_h.minPixelSize=i.minPixelSize,screenSizePerspectiveUtils_h.paddingPixels=r,screenSizePerspectiveUtils_h}function screenSizePerspectiveUtils_l(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}function screenSizePerspectiveUtils_s(t,a){return Math.max(Object(mathUtils[\"g\" /* lerp */])(t*a.scale,t,a.factor),screenSizePerspectiveUtils_l(t,a))}function screenSizePerspectiveUtils_c(t,a,i=[0,0]){const r=Math.min(Math.max(a.scale,screenSizePerspectiveUtils_l(t[1],a)/t[1]),1);return i[0]=Object(mathUtils[\"g\" /* lerp */])(t[0]*r,t[0],a.factor),i[1]=Object(mathUtils[\"g\" /* lerp */])(t[1]*r,t[1],a.factor),i}function screenSizePerspectiveUtils_o(e,t,a,i){i.scale=function(e,t,a){const i=screenSizePerspectiveUtils_n(e,t,a);return i.minPixelSize=0,i.paddingPixels=0,screenSizePerspectiveUtils_s(1,i)}(e,t,a),i.factor=0,i.minPixelSize=a.parameters.minPixelSize,i.paddingPixels=a.paddingPixelsOverride}function screenSizePerspectiveUtils_u(e,t,a=[0,0]){const i=Math.min(Math.max(t.scale,screenSizePerspectiveUtils_l(e[1],t)/e[1]),1);return a[0]=e[0]*i,a[1]=e[1]*i,a}function screenSizePerspectiveUtils_d(e,t,a,i){return screenSizePerspectiveUtils_s(e,screenSizePerspectiveUtils_n(t,a,i))}class screenSizePerspectiveUtils_f{constructor(e,t,a,i={camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0},r){this.viewingMode=e,this.description=t,this.ellipsoidRadius=a,this.parameters=i,this._paddingPixelsOverride=r,2===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}get paddingPixelsOverride(){return this._paddingPixelsOverride||this.parameters.paddingPixels}update(e){return(!this.parameters||this.parameters.camera.fovY!==e.fovY||this.parameters.camera.distance!==e.distance)&&(this.calculateParameters(e,this.ellipsoidRadius,this.parameters),!0)}overridePadding(e){return e!==this.paddingPixelsOverride?new screenSizePerspectiveUtils_f(this.viewingMode,this.description,this.ellipsoidRadius,this.parameters,e):this}calculateParameters(e,t,a){const{scaleStart:i,scaleFallOffRange:r,minPixelSize:n}=this.description,{fovY:l,distance:s}=e,c=this.calculateCurvatureDependentParameters(e,t),o=this.coverageCompensation(e,t,c),{tiltAngle:u,scaleFallOffFactor:d}=c,f=Math.sin(u)*s,m=.5*Math.PI-u-l*(.5-i*o),p=f/Math.cos(m),h=m+l*r*o,v=(p-d*(f/Math.cos(h)))/(1-d);return a.camera.fovY=e.fovY,a.camera.distance=e.distance,a.offset=v,a.divisor=p-v,a.minPixelSize=n,a}calculateCurvatureDependentParametersLocal(e,t,a=screenSizePerspectiveUtils_v){return a.tiltAngle=this.description.curvatureDependent.min.tiltAngle,a.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor,a}calculateCurvatureDependentParametersGlobal(t,i,r=screenSizePerspectiveUtils_v){const n=this.description.curvatureDependent,l=1+t.distance/i,s=Math.sqrt(l*l-1),[c,o]=[n.min.curvature,n.max.curvature],u=Object(mathUtils[\"c\" /* clamp */])((s-c)/(o-c),0,1),[d,f]=[n.min,n.max];return r.tiltAngle=Object(mathUtils[\"g\" /* lerp */])(d.tiltAngle,f.tiltAngle,u),r.scaleFallOffFactor=Object(mathUtils[\"g\" /* lerp */])(d.scaleFallOffFactor,f.scaleFallOffFactor,u),r}surfaceCoverageCompensationLocal(e,t,a){return(e.fovY-a.tiltAngle)/e.fovY}surfaceCoverageCompensationGlobal(e,t,a){const i=t*t,r=a.tiltAngle+.5*Math.PI,{fovY:n,distance:l}=e,s=l*l+i-2*Math.cos(r)*l*t,c=Math.sqrt(s),o=Math.sqrt(s-i);return(Math.acos(o/c)-Math.asin(t/(c/Math.sin(r)))+.5*n)/n}}const screenSizePerspectiveUtils_m={curvatureDependent:{min:{curvature:Object(mathUtils[\"d\" /* deg2rad */])(10),tiltAngle:Object(mathUtils[\"d\" /* deg2rad */])(12),scaleFallOffFactor:.5},max:{curvature:Object(mathUtils[\"d\" /* deg2rad */])(70),tiltAngle:Object(mathUtils[\"d\" /* deg2rad */])(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0},screenSizePerspectiveUtils_p={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14};const screenSizePerspectiveUtils_h={scale:0,factor:0,minPixelSize:0,paddingPixels:0},screenSizePerspectiveUtils_v={tiltAngle:0,scaleFallOffFactor:0};\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/MaterialUtil.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst MaterialUtil_d=Object(aaBoundingBox[\"b\" /* create */])(),MaterialUtil_h=Util[\"a\" /* VertexAttrConstants */];function MaterialUtil_g(t,n,e,o,i,r,s){const c=Object(utils[\"b\" /* isInstanceHidden */])(n),f=e.tolerance;if(!c)if(t.boundingInfo)Object(Util[\"b\" /* assert */])(\"triangle\"===t.data.primitiveType),MaterialUtil_M(t.boundingInfo,o,i,f,r,s);else{const n=t.getIndices(MaterialUtil_h.POSITION),e=t.getAttribute(MaterialUtil_h.POSITION);MaterialUtil_y(o,i,0,n.length/3,n,e,void 0,r,s)}}const MaterialUtil_x=Object(vec3f64[\"e\" /* c */])();function MaterialUtil_M(n,e,o,i,r,s){const c=MaterialUtil_j(e,o,MaterialUtil_x);if(Object(aaBoundingBox[\"l\" /* setMin */])(MaterialUtil_d,n.getBBMin()),Object(aaBoundingBox[\"k\" /* setMax */])(MaterialUtil_d,n.getBBMax()),Object(maybe[\"h\" /* isSome */])(r)&&r.applyToAabb(MaterialUtil_d),MaterialUtil_P(MaterialUtil_d,e,c,i)){const t=n.getPrimitiveIndices(),c=n.getIndices(),f=n.getPosition(),a=t?t.length:c.length/3;if(a>MaterialUtil_W){const t=n.getChildren();if(void 0!==t){for(let n=0;n<8;++n)void 0!==t[n]&&MaterialUtil_M(t[n],e,o,i,r,s);return}}MaterialUtil_y(e,o,0,a,c,f,t,r,s)}}const I=2**-52,b=Object(vec3f64[\"e\" /* c */])();function MaterialUtil_y(n,e,o,i,r,s,c,f,a){if(c)return function(n,e,o,i,r,s,c,f,a){const{data:l,offsetIdx:u,strideIdx:m}=s,p=n[0],d=n[1],h=n[2],g=e[0],x=e[1],M=e[2],y=g-p,v=x-d,T=M-h;for(let n=o;n<i;++n){const e=c[n];let o=3*e,i=u+m*r[o++],s=l[i++],g=l[i++],x=l[i];i=u+m*r[o++];let M=l[i++],j=l[i++],P=l[i];i=u+m*r[o];let V=l[i++],O=l[i++],B=l[i];Object(maybe[\"h\" /* isSome */])(f)&&([s,g,x]=f.applyToVertex(s,g,x,n),[M,j,P]=f.applyToVertex(M,j,P,n),[V,O,B]=f.applyToVertex(V,O,B,n));const S=M-s,L=j-g,U=P-x,E=V-s,N=O-g,W=B-x,k=v*W-N*T,z=T*E-W*y,C=y*N-E*v,R=S*k+L*z+U*C;if(Math.abs(R)<=I)continue;const H=p-s,X=d-g,Y=h-x,Z=H*k+X*z+Y*C;if(R>0){if(Z<0||Z>R)continue}else if(Z>0||Z<R)continue;const _=X*U-L*Y,q=Y*S-U*H,w=H*L-S*X,D=y*_+v*q+T*w;if(R>0){if(D<0||Z+D>R)continue}else if(D>0||Z+D<R)continue;const F=(E*_+N*q+W*w)/R;if(F>=0){a(F,A(S,L,U,E,N,W,b),e)}}}(n,e,o,i,r,s,c,f,a);const{data:l,offsetIdx:u,strideIdx:m}=s,p=n[0],d=n[1],h=n[2],g=e[0]-p,x=e[1]-d,M=e[2]-h;for(let n=o,e=3*o;n<i;++n){let o=u+m*r[e++],i=l[o++],s=l[o++],c=l[o];o=u+m*r[e++];let y=l[o++],v=l[o++],T=l[o];o=u+m*r[e++];let j=l[o++],P=l[o++],V=l[o];Object(maybe[\"h\" /* isSome */])(f)&&([i,s,c]=f.applyToVertex(i,s,c,n),[y,v,T]=f.applyToVertex(y,v,T,n),[j,P,V]=f.applyToVertex(j,P,V,n));const O=y-i,B=v-s,S=T-c,L=j-i,U=P-s,E=V-c,N=x*E-U*M,W=M*L-E*g,k=g*U-L*x,z=O*N+B*W+S*k;if(Math.abs(z)<=I)continue;const C=p-i,R=d-s,H=h-c,X=C*N+R*W+H*k;if(z>0){if(X<0||X>z)continue}else if(X>0||X<z)continue;const Y=R*S-B*H,Z=H*O-S*C,_=C*B-O*R,q=g*Y+x*Z+M*_;if(z>0){if(q<0||X+q>z)continue}else if(q>0||X+q<z)continue;const w=(L*Y+U*Z+E*_)/z;if(w>=0){a(w,A(O,B,S,L,U,E,b),n)}}}const MaterialUtil_v=Object(vec3f64[\"e\" /* c */])(),MaterialUtil_T=Object(vec3f64[\"e\" /* c */])();function A(t,n,e,o,c,f,a){return Object(vec3[\"r\" /* s */])(MaterialUtil_v,t,n,e),Object(vec3[\"r\" /* s */])(MaterialUtil_T,o,c,f),Object(vec3[\"d\" /* c */])(a,MaterialUtil_v,MaterialUtil_T),Object(vec3[\"o\" /* n */])(a,a),a}function MaterialUtil_j(t,n,e){return Object(vec3[\"r\" /* s */])(e,1/(n[0]-t[0]),1/(n[1]-t[1]),1/(n[2]-t[2]))}function MaterialUtil_P(t,n,e,o){return MaterialUtil_V(t,n,e,o,1/0)}function MaterialUtil_V(t,n,e,o,i){const r=(t[0]-o-n[0])*e[0],s=(t[3]+o-n[0])*e[0];let c=Math.min(r,s),f=Math.max(r,s);const a=(t[1]-o-n[1])*e[1],l=(t[4]+o-n[1])*e[1];if(f=Math.min(f,Math.max(a,l)),f<0)return!1;if(c=Math.max(c,Math.min(a,l)),c>f)return!1;const u=(t[2]-o-n[2])*e[2],m=(t[5]+o-n[2])*e[2];return f=Math.min(f,Math.max(u,m)),!(f<0)&&(c=Math.max(c,Math.min(u,m)),!(c>f)&&c<i)}function MaterialUtil_O(t,e,o,i,r){let s=(o.screenLength||0)*t.pixelRatio;r&&(s=screenSizePerspectiveUtils_d(s,i,e,r));const c=s*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return Object(mathUtils[\"e\" /* glClamp */])(c*e,o.minWorldLength||0,null!=o.maxWorldLength?o.maxWorldLength:1/0)}function MaterialUtil_B(t,n,e){if(!t)return;const o=t.parameters,i=t.paddingPixelsOverride;n.setUniform4f(e,o.divisor,o.offset,o.minPixelSize,i)}function MaterialUtil_S(t,n){const e=n?MaterialUtil_S(n):{};for(const n in t){let o=t[n];o&&o.forEach&&(o=MaterialUtil_E(o)),null==o&&n in e||(e[n]=o)}return e}function MaterialUtil_L(t,n){let e=!1;for(const o in n){const i=n[o];void 0!==i&&(e=!0,Array.isArray(i)?t[o]=i.slice():t[o]=i)}return e}function MaterialUtil_U(t,n,o,i,r){if(!n.options.selectionMode)return;const s=t.getAttribute(MaterialUtil_h.POSITION).data,c=t.getAttribute(MaterialUtil_h.SIZE),f=c&&c.data[0],a=o[0],l=o[1],u=((f+i)/2+4)*t.screenToWorldRatio;let m=Number.MAX_VALUE;for(let t=0;t<s.length-5;t+=3){const n=s[t],o=s[t+1],i=a-n,r=l-o,c=s[t+3]-n,f=s[t+4]-o,u=Object(mathUtils[\"c\" /* clamp */])((c*i+f*r)/(c*c+f*f),0,1),p=c*u-i,d=f*u-r,h=p*p+d*d;h<m&&(m=h)}m<u*u&&r()}function MaterialUtil_E(t){const n=[];return t.forEach((t=>n.push(t))),n}const MaterialUtil_N={multiply:1,ignore:2,replace:3,tint:4},MaterialUtil_W=1e3;\n\n\n/***/ }),\n\n/***/ \"fLTx\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ VertexTextureCoordinates_glsl_u; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\nvar TextureCoordinateAttribute_glsl = __webpack_require__(\"368d\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/TextureAtlasLookup.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction TextureAtlasLookup_glsl_t(t){t.extensions.add(\"GL_EXT_shader_texture_lod\"),t.extensions.add(\"GL_OES_standard_derivatives\"),t.fragment.code.add(interfaces[\"a\" /* glsl */]`\n    #ifndef GL_EXT_shader_texture_lod\n      float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\n        float deltaMaxSqr = max(dot(ddx, ddx), dot(ddy, ddy));\n        return max(0.0, 0.5 * log2(deltaMaxSqr));\n      }\n    #endif\n\n    vec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {\n      //[umin, vmin, umax, vmax]\n      vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;\n      vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;\n\n      // calculate derivative of continuous texture coordinate\n      // to avoid mipmapping artifacts caused by manual wrapping in shader\n      vec2 dUVdx = dFdx(textureCoordinates) * atlasScale;\n      vec2 dUVdy = dFdy(textureCoordinates) * atlasScale;\n\n      #ifdef GL_EXT_shader_texture_lod\n        return texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);\n      #else\n        // use bias to compensate for difference in automatic vs desired mipmap level\n        vec2 dUVdxAuto = dFdx(uvAtlas);\n        vec2 dUVdyAuto = dFdy(uvAtlas);\n        float mipMapLevel = calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);\n        float autoMipMapLevel = calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);\n\n        return texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);\n      #endif\n    }\n  `)}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexTextureCoordinates.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction VertexTextureCoordinates_glsl_u(u,a){u.include(TextureCoordinateAttribute_glsl[\"a\" /* TextureCoordinateAttribute */],a),u.fragment.code.add(interfaces[\"a\" /* glsl */]`\n  struct TextureLookupParameter {\n    vec2 uv;\n    ${a.supportsTextureAtlas?\"vec2 size;\":\"\"}\n  } vtc;\n  `),1===a.attributeTextureCoordinates&&u.fragment.code.add(interfaces[\"a\" /* glsl */]`\n      vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return texture2D(tex, params.uv);\n      }\n    `),2===a.attributeTextureCoordinates&&(u.include(TextureAtlasLookup_glsl_t),u.fragment.code.add(interfaces[\"a\" /* glsl */]`\n    vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return textureAtlasLookup(tex, params.size, params.uv, vuvRegion);\n      }\n    `))}\n\n\n/***/ }),\n\n/***/ \"fOQB\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var _core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"ohva\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass i{constructor(e,t,i,n,r){this._context=null,this._glName=null,this._bufferType=void 0,this._usage=35044,this._size=-1,this._indexType=void 0,this.id=s++,e.instanceCounter.increment(1,this),this._context=e,this._bufferType=t,this._usage=i,this._glName=this._context.gl.createBuffer(),n&&this.setData(n,r)}static createIndex(e,t,s,n){return new i(e,34963,t,s,n)}static createVertex(e,t,s){return new i(e,34962,t,s)}get glName(){return this._glName}get size(){return this._size}get usage(){return this._usage}get bufferType(){return this._bufferType}get indexType(){return this._indexType}get byteSize(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}dispose(){if(this._context){if(this._glName){this._context.gl.deleteBuffer(this._glName),this._glName=null}this._context.instanceCounter.decrement(1,this),this._context=null}}setData(i,s){if(!i)return;if(\"number\"==typeof i){if(i<0&&console.error(\"Buffer size cannot be negative!\"),34963===this._bufferType&&s)switch(this._indexType=s,this._size=i,s){case 5123:i*=2;break;case 5125:i*=4}}else{let s=i.byteLength;Object(_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__[/* isUint16Array */ \"i\"])(i)&&(s/=2,this._indexType=5123),Object(_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__[/* isUint32Array */ \"j\"])(i)&&(s/=4,this._indexType=5125),this._size=s}const n=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,i,this._usage),this._context.bindVAO(n)}setSubData(i,s=0,n=0,r){if(!i)return;(s<0||s>=this._size)&&console.error(\"offset is out of range!\");let h=s,o=n,u=r,f=i.byteLength;Object(_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__[/* isUint16Array */ \"i\"])(i)&&(f/=2,h*=2,o*=2,u*=2),Object(_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__[/* isUint32Array */ \"j\"])(i)&&(f/=4,h*=4,o*=4,u*=4),void 0===r&&(r=f-1),n>=r&&console.error(\"end must be bigger than start!\"),s+n-r>this._size&&console.error(\"An attempt to write beyond the end of the buffer!\");const _=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);const a=this._context.gl,c=ArrayBuffer.isView(i)?i.buffer:i;a.bufferSubData(this._bufferType,h,c.slice(o,u)),this._context.bindVAO(_)}}let s=0;/* harmony default export */ __webpack_exports__[\"a\"] = (i);\n\n\n/***/ }),\n\n/***/ \"fRF2\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ VertexNormal_glsl_l; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js + 1 modules\nvar NormalAttribute_glsl = __webpack_require__(\"wzLF\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3f64.js\nvar vec3f64 = __webpack_require__(\"Cy1f\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat3f64.js\nvar mat3f64 = __webpack_require__(\"2uVf\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat4f64.js\nvar mat4f64 = __webpack_require__(\"r+FG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/DoublePrecision.glsl.js + 1 modules\nvar DoublePrecision_glsl = __webpack_require__(\"aiF/\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/PositionAttribute.glsl.js\nvar PositionAttribute_glsl = __webpack_require__(\"sJp1\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexPosition.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction t(o,r){o.include(PositionAttribute_glsl[\"a\" /* PositionAttribute */]),o.vertex.include(DoublePrecision_glsl[\"a\" /* DoublePrecision */],r),o.varyings.add(\"vPositionWorldCameraRelative\",\"vec3\"),o.varyings.add(\"vPosition_view\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_WorldFromModel_RS\",\"mat3\"),o.vertex.uniforms.add(\"uTransform_WorldFromModel_TH\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_WorldFromModel_TL\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_WorldFromView_TH\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_WorldFromView_TL\",\"vec3\"),o.vertex.uniforms.add(\"uTransform_ViewFromCameraRelative_RS\",\"mat3\"),o.vertex.uniforms.add(\"uTransform_ProjFromView\",\"mat4\"),o.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    // compute position in world space orientation, but relative to the camera position\n    vec3 positionWorldCameraRelative() {\n      vec3 rotatedModelPosition = uTransform_WorldFromModel_RS * positionModel();\n\n      vec3 transform_CameraRelativeFromModel = dpAdd(\n        uTransform_WorldFromModel_TL,\n        uTransform_WorldFromModel_TH,\n        -uTransform_WorldFromView_TL,\n        -uTransform_WorldFromView_TH\n      );\n\n      return transform_CameraRelativeFromModel + rotatedModelPosition;\n    }\n\n    // position in view space, that is relative to the camera position and orientation\n    vec3 position_view() {\n      return uTransform_ViewFromCameraRelative_RS * positionWorldCameraRelative();\n    }\n\n    // compute gl_Position and forward related varyings to fragment shader\n    void forwardPosition() {\n      vPositionWorldCameraRelative = positionWorldCameraRelative();\n      vPosition_view = position_view();\n      gl_Position = uTransform_ProjFromView * vec4(vPosition_view, 1.0);\n    }\n\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  `),o.fragment.uniforms.add(\"uTransform_WorldFromView_TL\",\"vec3\"),o.fragment.code.add(interfaces[\"a\" /* glsl */]`\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  `)}!function(i){i.ModelTransform=class{constructor(){this.worldFromModel_RS=Object(mat3f64[\"a\"])(),this.worldFromModel_TH=Object(vec3f64[\"e\" /* c */])(),this.worldFromModel_TL=Object(vec3f64[\"e\" /* c */])()}};i.ViewProjectionTransform=class{constructor(){this.worldFromView_TH=Object(vec3f64[\"e\" /* c */])(),this.worldFromView_TL=Object(vec3f64[\"e\" /* c */])(),this.viewFromCameraRelative_RS=Object(mat3f64[\"a\"])(),this.projFromView=Object(mat4f64[\"b\" /* a */])()}},i.bindModelTransform=function(o,r){o.setUniformMatrix3fv(\"uTransform_WorldFromModel_RS\",r.worldFromModel_RS),o.setUniform3fv(\"uTransform_WorldFromModel_TH\",r.worldFromModel_TH),o.setUniform3fv(\"uTransform_WorldFromModel_TL\",r.worldFromModel_TL)},i.bindViewProjTransform=function(o,r){o.setUniform3fv(\"uTransform_WorldFromView_TH\",r.worldFromView_TH),o.setUniform3fv(\"uTransform_WorldFromView_TL\",r.worldFromView_TL),o.setUniformMatrix4fv(\"uTransform_ProjFromView\",r.projFromView),o.setUniformMatrix3fv(\"uTransform_ViewFromCameraRelative_RS\",r.viewFromCameraRelative_RS)}}(t||(t={}));\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexNormal.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction VertexNormal_glsl_l(l,e){0===e.normalType||1===e.normalType?(l.include(NormalAttribute_glsl[\"a\" /* NormalAttribute */],e),l.varyings.add(\"vNormalWorld\",\"vec3\"),l.varyings.add(\"vNormalView\",\"vec3\"),l.vertex.uniforms.add(\"uTransformNormal_GlobalFromModel\",\"mat3\"),l.vertex.uniforms.add(\"uTransformNormal_ViewFromGlobal\",\"mat3\"),l.vertex.code.add(interfaces[\"a\" /* glsl */]`\n      void forwardNormal() {\n        vNormalWorld = uTransformNormal_GlobalFromModel * normalModel();\n        vNormalView = uTransformNormal_ViewFromGlobal * vNormalWorld;\n      }\n    `)):2===e.normalType?(l.include(t,e),l.varyings.add(\"vNormalWorld\",\"vec3\"),l.vertex.code.add(interfaces[\"a\" /* glsl */]`\n    void forwardNormal() {\n      vNormalWorld = ${1===e.viewingMode?interfaces[\"a\" /* glsl */]`normalize(vPositionWorldCameraRelative);`:interfaces[\"a\" /* glsl */]`vec3(0.0, 0.0, 1.0);`}\n    }\n    `)):l.vertex.code.add(interfaces[\"a\" /* glsl */]`\n      void forwardNormal() {}\n    `)}!function(o){o.bindUniforms=function(o,r){o.setUniformMatrix4fv(\"viewNormal\",r)}}(VertexNormal_glsl_l||(VertexNormal_glsl_l={}));\n\n\n/***/ }),\n\n/***/ \"fiGu\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ DefaultMaterialAuxiliaryPasses_glsl_u; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\nvar Transform_glsl = __webpack_require__(\"Tbkp\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\nvar Slice_glsl = __webpack_require__(\"0nJL\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\nvar OutputHighlight_glsl = __webpack_require__(\"agdK\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\nvar VisualVariables_glsl = __webpack_require__(\"viRi\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\nvar AlphaDiscard_glsl = __webpack_require__(\"69UF\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl.js\nvar RgbaFloatEncoding_glsl = __webpack_require__(\"UBvB\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction OutputDepth_glsl_o(o,e){o.fragment.include(RgbaFloatEncoding_glsl[\"a\" /* RgbaFloatEncoding */]),3===e.output?(o.extensions.add(\"GL_OES_standard_derivatives\"),o.fragment.code.add(interfaces[\"a\" /* glsl */]`\n      float _calculateFragDepth(const in float depth) {\n        // calc polygon offset\n        const float SLOPE_SCALE = 2.0;\n        const float BIAS = 2.0 * .000015259;    // 1 / (2^16 - 1)\n        float m = max(abs(dFdx(depth)), abs(dFdy(depth)));\n        float result = depth + SLOPE_SCALE * m + BIAS;\n        return clamp(result, .0, .999999);\n      }\n\n      void outputDepth(float _linearDepth) {\n        gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));\n      }\n    `)):1===e.output&&o.fragment.code.add(interfaces[\"a\" /* glsl */]`\n      void outputDepth(float _linearDepth) {\n        gl_FragColor = float2rgba(_linearDepth);\n      }\n    `)}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\nvar TextureCoordinateAttribute_glsl = __webpack_require__(\"368d\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js + 1 modules\nvar NormalAttribute_glsl = __webpack_require__(\"wzLF\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexNormal.glsl.js + 1 modules\nvar VertexNormal_glsl = __webpack_require__(\"fRF2\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction DefaultMaterialAuxiliaryPasses_glsl_u(u,p){const v=u.vertex.code,c=u.fragment.code;1!==p.output&&3!==p.output||(u.include(Transform_glsl[\"a\" /* Transform */],{linearDepth:!0}),u.include(TextureCoordinateAttribute_glsl[\"a\" /* TextureCoordinateAttribute */],p),u.include(VisualVariables_glsl[\"a\" /* VisualVariables */],p),u.include(OutputDepth_glsl_o,p),u.include(Slice_glsl[\"a\" /* Slice */],p),u.vertex.uniforms.add(\"nearFar\",\"vec2\"),u.varyings.add(\"depth\",\"float\"),p.hasColorTexture&&u.fragment.uniforms.add(\"tex\",\"sampler2D\"),v.add(interfaces[\"a\" /* glsl */]`\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPositionWithDepth(proj, view, vpos, nearFar, depth);\n        forwardTextureCoordinates();\n      }\n    `),u.include(AlphaDiscard_glsl[\"a\" /* DiscardOrAdjustAlpha */],p),c.add(interfaces[\"a\" /* glsl */]`\n      void main(void) {\n        discardBySlice(vpos);\n        ${p.hasColorTexture?interfaces[\"a\" /* glsl */]`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n        outputDepth(depth);\n      }\n    `)),2===p.output&&(u.include(Transform_glsl[\"a\" /* Transform */],{linearDepth:!1}),u.include(NormalAttribute_glsl[\"a\" /* NormalAttribute */],p),u.include(VertexNormal_glsl[\"a\" /* VertexNormal */],p),u.include(TextureCoordinateAttribute_glsl[\"a\" /* TextureCoordinateAttribute */],p),u.include(VisualVariables_glsl[\"a\" /* VisualVariables */],p),p.hasColorTexture&&u.fragment.uniforms.add(\"tex\",\"sampler2D\"),u.vertex.uniforms.add(\"viewNormal\",\"mat4\"),u.varyings.add(\"vPositionView\",\"vec3\"),v.add(interfaces[\"a\" /* glsl */]`\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        ${0===p.normalType?interfaces[\"a\" /* glsl */]`\n        vNormalWorld = dpNormalView(vvLocalNormal(normalModel()));`:\"\"}\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    `),u.include(Slice_glsl[\"a\" /* Slice */],p),u.include(AlphaDiscard_glsl[\"a\" /* DiscardOrAdjustAlpha */],p),c.add(interfaces[\"a\" /* glsl */]`\n      void main() {\n        discardBySlice(vpos);\n        ${p.hasColorTexture?interfaces[\"a\" /* glsl */]`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n\n        ${3===p.normalType?interfaces[\"a\" /* glsl */]`\n            vec3 normal = screenDerivativeNormal(vPositionView);`:interfaces[\"a\" /* glsl */]`\n            vec3 normal = normalize(vNormalWorld);\n            if (gl_FrontFacing == false) normal = -normal;`}\n        gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    `)),4===p.output&&(u.include(Transform_glsl[\"a\" /* Transform */],{linearDepth:!1}),u.include(TextureCoordinateAttribute_glsl[\"a\" /* TextureCoordinateAttribute */],p),u.include(VisualVariables_glsl[\"a\" /* VisualVariables */],p),p.hasColorTexture&&u.fragment.uniforms.add(\"tex\",\"sampler2D\"),v.add(interfaces[\"a\" /* glsl */]`\n      void main(void) {\n        vpos = calculateVPos();\n        vpos = subtractOrigin(vpos);\n        vpos = addVerticalOffset(vpos, localOrigin);\n        gl_Position = transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    `),u.include(Slice_glsl[\"a\" /* Slice */],p),u.include(AlphaDiscard_glsl[\"a\" /* DiscardOrAdjustAlpha */],p),u.include(OutputHighlight_glsl[\"a\" /* OutputHighlight */]),c.add(interfaces[\"a\" /* glsl */]`\n      void main() {\n        discardBySlice(vpos);\n        ${p.hasColorTexture?interfaces[\"a\" /* glsl */]`\n        vec4 texColor = texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);`:\"\"}\n        outputHighlight();\n      }\n    `))}\n\n\n/***/ }),\n\n/***/ \"hTmG\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export addDescriptor */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return f; });\n/* unused harmony export copyFramebufferToTexture */\n/* unused harmony export findAttribute */\n/* unused harmony export getBytesPerElement */\n/* unused harmony export getBytesPerElementFormat */\n/* unused harmony export getGpuMemoryUsage */\n/* unused harmony export getStride */\n/* unused harmony export getTypedArrayConstructor */\n/* unused harmony export hasAttribute */\n/* unused harmony export setBaseInstanceOffset */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return d; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return r; });\n/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"wSAH\");\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"srIe\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction r(e,r){return e.vertexBuffers[r].size/t(e.layout[r])}function t(e){return e[0].stride}function n(e){switch(e){case 5126:case 5124:case 5125:return 4;case 5122:case 5123:return 2;case 5120:case 5121:return 1;default:throw new Error(\"Unknown data type\")}}function i(e){switch(e){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array;default:throw new Error(\"Unknown data type\")}}function o(e,r,t,i,o,s){const a=n(i);if(e.length>0){const n=e[0].stride,c=n+a*t;e.forEach((e=>e.stride=c)),e.push({name:r,count:t,type:i,offset:n,stride:c,normalized:o,divisor:s})}else e.push({name:r,count:t,type:i,offset:0,stride:a*t,normalized:o,divisor:s})}function s(e,r){for(let t=0;t<e.length;t++)if(e[t].name===r)return!0;return!1}function a(e,r){for(let t=0;t<e.length;t++)if(e[t].name===r)return e[t];return null}function c(e,r,t,n,i=0){const o=e.getBoundFramebufferObject(),s=e.getBoundTexture(0);e.bindFramebuffer(r),e.bindTexture(t,0),e.gl.copyTexImage2D(e.gl.TEXTURE_2D,i,t.descriptor.pixelFormat,n[0],n[1],n[2],n[3],0),e.gl.flush(),e.bindFramebuffer(o),e.bindTexture(s,0)}function u(e,r){const t={};for(const n in e)t[n]=e[n].map((e=>e.divisor?{...e,baseInstance:r}:e));return t}function f(e,r,t,n,i){const o=e.gl,s=e.capabilities.instancing;e.bindBuffer(t);for(const e of n){const t=r[e.name],n=(i||(0+e.baseInstance?e.baseInstance:0))*e.stride;if(void 0===t&&console.error(`There is no location for vertex attribute '${e.name}' defined.`),e.baseInstance&&!e.divisor&&console.error(`Vertex attribute '${e.name}' uses baseInstanceOffset without divisor.`),e.count<=4)o.vertexAttribPointer(t,e.count,e.type,e.normalized,e.stride,e.offset+n),o.enableVertexAttribArray(t),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(t,e.divisor);else if(9===e.count)for(let r=0;r<3;r++)o.vertexAttribPointer(t+r,3,e.type,e.normalized,e.stride,e.offset+12*r+n),o.enableVertexAttribArray(t+r),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(t+r,e.divisor);else if(16===e.count)for(let r=0;r<4;r++)o.vertexAttribPointer(t+r,4,e.type,e.normalized,e.stride,e.offset+16*r+n),o.enableVertexAttribArray(t+r),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(t+r,e.divisor);else console.error(\"Unsupported vertex attribute element count: \"+e.count)}}function d(e,r,t,n){const i=e.gl,o=e.capabilities.instancing;e.bindBuffer(t);for(const e of n){const t=r[e.name];if(e.count<=4)i.disableVertexAttribArray(t),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(t,0);else if(9===e.count)for(let r=0;r<3;r++)i.disableVertexAttribArray(t+r),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(t+r,0);else if(16===e.count)for(let r=0;r<4;r++)i.disableVertexAttribArray(t+r),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(t+r,0);else console.error(\"Unsupported vertex attribute element count: \"+e.count)}e.unbindBuffer(34962)}function l(e){switch(e){case 6406:case 6409:return 1;case 6410:return 2;case 6407:return 3;case 6408:case 34041:return 4;case 33325:return 2;case 33326:case 35898:case 33327:return 4;case 33328:case 34842:return 8;case 34836:return 16;case 33189:return 2;case 34041:return 4;case 32854:return 2;case 36168:return 1}return 0}function b(r){if(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__[/* isNone */ \"g\"])(r))return 0;if(\"colorAttachment\"in r)return r.glName?b(r.colorAttachment)+b(r.depthStencilAttachment):0;if(\"descriptor\"in r)return r.glName?b(r.descriptor):0;const t=r.internalFormat||\"pixelFormat\"in r&&r.pixelFormat;if(!t)return 0;const n=\"hasMipmap\"in r&&r.hasMipmap?1.3:1,i=r.width*r.height;return l(t)*i*n}\n\n\n/***/ }),\n\n/***/ \"jjdI\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js\nvar has = __webpack_require__(\"wSAH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/maybe.js\nvar maybe = __webpack_require__(\"srIe\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/webgl/reservedWordsGLSL3.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\n/* harmony default export */ var reservedWordsGLSL3 = ([\"layout\",\"centroid\",\"smooth\",\"case\",\"mat2x2\",\"mat2x3\",\"mat2x4\",\"mat3x2\",\"mat3x3\",\"mat3x4\",\"mat4x2\",\"mat4x3\",\"mat4x4\",\"uint\",\"uvec2\",\"uvec3\",\"uvec4\",\"samplerCubeShadow\",\"sampler2DArray\",\"sampler2DArrayShadow\",\"isampler2D\",\"isampler3D\",\"isamplerCube\",\"isampler2DArray\",\"usampler2D\",\"usampler3D\",\"usamplerCube\",\"usampler2DArray\",\"coherent\",\"restrict\",\"readonly\",\"writeonly\",\"resource\",\"atomic_uint\",\"noperspective\",\"patch\",\"sample\",\"subroutine\",\"common\",\"partition\",\"active\",\"filter\",\"image1D\",\"image2D\",\"image3D\",\"imageCube\",\"iimage1D\",\"iimage2D\",\"iimage3D\",\"iimageCube\",\"uimage1D\",\"uimage2D\",\"uimage3D\",\"uimageCube\",\"image1DArray\",\"image2DArray\",\"iimage1DArray\",\"iimage2DArray\",\"uimage1DArray\",\"uimage2DArray\",\"image1DShadow\",\"image2DShadow\",\"image1DArrayShadow\",\"image2DArrayShadow\",\"imageBuffer\",\"iimageBuffer\",\"uimageBuffer\",\"sampler1DArray\",\"sampler1DArrayShadow\",\"isampler1D\",\"isampler1DArray\",\"usampler1D\",\"usampler1DArray\",\"isampler2DRect\",\"usampler2DRect\",\"samplerBuffer\",\"isamplerBuffer\",\"usamplerBuffer\",\"sampler2DMS\",\"isampler2DMS\",\"usampler2DMS\",\"sampler2DMSArray\",\"isampler2DMSArray\",\"usampler2DMSArray\",\"trunc\",\"round\",\"roundEven\",\"isnan\",\"isinf\",\"floatBitsToInt\",\"floatBitsToUint\",\"intBitsToFloat\",\"uintBitsToFloat\",\"packSnorm2x16\",\"unpackSnorm2x16\",\"packUnorm2x16\",\"unpackUnorm2x16\",\"packHalf2x16\",\"unpackHalf2x16\",\"outerProduct\",\"transpose\",\"determinant\",\"inverse\",\"texture\",\"textureSize\",\"textureProj\",\"textureLod\",\"textureOffset\",\"texelFetch\",\"texelFetchOffset\",\"textureProjOffset\",\"textureLodOffset\",\"textureProjLod\",\"textureProjLodOffset\",\"textureGrad\",\"textureGradOffset\",\"textureProjGrad\",\"textureProjGradOffset\"]);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/builtins.js\nvar builtins = __webpack_require__(\"n4uK\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/webgl/ShaderTranspiler.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nvar ShaderTranspiler_n=[\"block-comment\",\"line-comment\",\"preprocessor\",\"operator\",\"integer\",\"float\",\"ident\",\"builtin\",\"keyword\",\"whitespace\",\"eof\",\"integer\"];function ShaderTranspiler_o(){var t,o,i,s=0,c=0,d=999,f=[],p=[],u=1,l=0,h=0,y=!1,g=!1,w=\"\";return function(e){return p=[],null!==e?function(e){var a;s=0,i=(w+=e).length;for(;t=w[s],s<i;){switch(a=s,d){case 0:s=x();break;case 1:s=_();break;case 2:s=v();break;case 3:s=j();break;case 4:s=L();break;case 11:s=O();break;case 5:s=D();break;case 9999:s=G();break;case 9:s=b();break;case 999:s=k()}if(a!==s)switch(w[a]){case\"\\n\":l=0,++u;break;default:++l}}return c+=s,w=w.slice(s),p}(e.replace?e.replace(/\\r\\n/g,\"\\n\"):e):function(t){f.length&&m(f.join(\"\"));return d=10,m(\"(eof)\"),p}()};function m(t){t.length&&p.push({type:ShaderTranspiler_n[d],data:t,position:h,line:u,column:l})}function k(){return f=f.length?[]:f,\"/\"===o&&\"*\"===t?(h=c+s-1,d=0,o=t,s+1):\"/\"===o&&\"/\"===t?(h=c+s-1,d=1,o=t,s+1):\"#\"===t?(d=2,h=c+s,s):/\\s/.test(t)?(d=9,h=c+s,s):(y=/\\d/.test(t),g=/[^\\w_]/.test(t),h=c+s,d=y?4:g?3:9999,s)}function b(){return/[^\\s]/g.test(t)?(m(f.join(\"\")),d=999,s):(f.push(t),o=t,s+1)}function v(){return\"\\r\"!==t&&\"\\n\"!==t||\"\\\\\"===o?(f.push(t),o=t,s+1):(m(f.join(\"\")),d=999,s)}function _(){return v()}function x(){return\"/\"===t&&\"*\"===o?(f.push(t),m(f.join(\"\")),d=999,s+1):(f.push(t),o=t,s+1)}function j(){if(\".\"===o&&/\\d/.test(t))return d=5,s;if(\"/\"===o&&\"*\"===t)return d=0,s;if(\"/\"===o&&\"/\"===t)return d=1,s;if(\".\"===t&&f.length){for(;E(f););return d=5,s}if(\";\"===t||\")\"===t||\"(\"===t){if(f.length)for(;E(f););return m(t),d=999,s+1}var e=2===f.length&&\"=\"!==t;if(/[\\w_\\d\\s]/.test(t)||e){for(;E(f););return d=999,s}return f.push(t),o=t,s+1}function E(t){for(var a,r,n=0;;){if(a=builtins[\"c\" /* o */].indexOf(t.slice(0,t.length+n).join(\"\")),r=builtins[\"c\" /* o */][a],-1===a){if(n--+t.length>0)continue;r=t.slice(0,1).join(\"\")}return m(r),h+=r.length,(f=f.slice(r.length)).length}}function O(){return/[^a-fA-F0-9]/.test(t)?(m(f.join(\"\")),d=999,s):(f.push(t),o=t,s+1)}function L(){return\".\"===t||/[eE]/.test(t)?(f.push(t),d=5,o=t,s+1):\"x\"===t&&1===f.length&&\"0\"===f[0]?(d=11,f.push(t),o=t,s+1):/[^\\d]/.test(t)?(m(f.join(\"\")),d=999,s):(f.push(t),o=t,s+1)}function D(){return\"f\"===t&&(f.push(t),o=t,s+=1),/[eE]/.test(t)||\"-\"===t&&/[eE]/.test(o)?(f.push(t),o=t,s+1):/[^\\d]/.test(t)?(m(f.join(\"\")),d=999,s):(f.push(t),o=t,s+1)}function G(){if(/[^\\d\\w_]/.test(t)){var e=f.join(\"\");return d=builtins[\"b\" /* l */].indexOf(e)>-1?8:builtins[\"a\" /* b */].indexOf(e)>-1?7:6,m(f.join(\"\")),d=999,s}return f.push(t),o=t,s+1}}function ShaderTranspiler_i(t){return e=t,a=ShaderTranspiler_o(),[].concat(a(e)).concat(a(null));var e,a}const ShaderTranspiler_s=[\"GL_OES_standard_derivatives\",\"GL_EXT_frag_depth\",\"GL_EXT_draw_buffers\",\"GL_EXT_shader_texture_lod\"];function ShaderTranspiler_c(t,e){for(let a=e-1;a>=0;a--){const e=t[a];if(\"whitespace\"!==e.type&&\"block-comment\"!==e.type){if(\"keyword\"!==e.type)break;if(\"attribute\"===e.data||\"in\"===e.data)return!0}}return!1}function ShaderTranspiler_d(t,e,a,r){r=r||a;for(const n of t)if(\"ident\"===n.type&&n.data===a){r in e?e[r]++:e[r]=0;return ShaderTranspiler_d(t,e,r+\"_\"+e[r],r)}return a}function ShaderTranspiler_f(t,e,a=\"afterVersion\"){function r(t,e){for(let a=e;a<t.length;a++){const e=t[a];if(\"operator\"===e.type&&\";\"===e.data)return a}return null}const n={data:\"\\n\",type:\"whitespace\"},o=e=>e<t.length&&/[^\\r\\n]$/.test(t[e].data);let i=function(t){let e=-1,n=0,o=-1;for(let i=0;i<t.length;i++){const s=t[i];if(\"preprocessor\"===s.type&&(s.data.match(/\\#(if|ifdef|ifndef)\\s+.+/)?++n:s.data.match(/\\#endif\\s*.*/)&&--n),\"afterVersion\"!==a&&\"afterPrecision\"!==a||\"preprocessor\"===s.type&&/^#version/.test(s.data)&&(o=Math.max(o,i)),\"afterPrecision\"===a&&\"keyword\"===s.type&&\"precision\"===s.data){const e=r(t,i);if(null===e)throw new Error(\"precision statement not followed by any semicolons!\");o=Math.max(o,e)}e<o&&0===n&&(e=i)}return e+1}(t);o(i-1)&&t.splice(i++,0,n);for(const a of e)t.splice(i++,0,a);o(i-1)&&o(i)&&t.splice(i,0,n)}function ShaderTranspiler_p(t,e,a,r=\"lowp\"){ShaderTranspiler_f(t,[{type:\"keyword\",data:\"out\"},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:r},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:a},{type:\"whitespace\",data:\" \"},{type:\"ident\",data:e},{type:\"operator\",data:\";\"}],\"afterPrecision\")}function ShaderTranspiler_u(t,e,a,r,n=\"lowp\"){ShaderTranspiler_f(t,[{type:\"keyword\",data:\"layout\"},{type:\"operator\",data:\"(\"},{type:\"keyword\",data:\"location\"},{type:\"whitespace\",data:\" \"},{type:\"operator\",data:\"=\"},{type:\"whitespace\",data:\" \"},{type:\"integer\",data:r.toString()},{type:\"operator\",data:\")\"},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:\"out\"},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:n},{type:\"whitespace\",data:\" \"},{type:\"keyword\",data:a},{type:\"whitespace\",data:\" \"},{type:\"ident\",data:e},{type:\"operator\",data:\";\"}],\"afterPrecision\")}function ShaderTranspiler_l(t,e){let a,r,n=-1;for(let o=e;o<t.length;o++){const e=t[o];if(\"operator\"===e.type&&(\"[\"===e.data&&(a=o),\"]\"===e.data)){r=o;break}\"integer\"===e.type&&(n=parseInt(e.data,10))}return a&&r&&t.splice(a,r-a+1),n}function ShaderTranspiler_h(e,a){const r=ShaderTranspiler_i(e);if(\"300 es\"===function(t,e=\"100\",a=\"300 es\"){const r=/^\\s*\\#version\\s+([0-9]+(\\s+[a-zA-Z]+)?)\\s*/;for(const n of t)if(\"preprocessor\"===n.type){const t=r.exec(n.data);if(t){const r=t[1].replace(/\\s\\s+/g,\" \");if(r===a)return r;if(r===e)return n.data=\"#version \"+a,e;throw new Error(\"unknown glsl version: \"+r)}}return t.splice(0,0,{type:\"preprocessor\",data:\"#version \"+a},{type:\"whitespace\",data:\"\\n\"}),null}(r,\"100\",\"300 es\"))throw new Error(\"shader is already glsl 300 es\");let n=null,o=null;const f={},h={};for(let e=0;e<r.length;++e){const i=r[e];switch(i.type){case\"keyword\":\"vertex\"===a&&\"attribute\"===i.data?i.data=\"in\":\"varying\"===i.data&&(i.data=\"vertex\"===a?\"out\":\"in\");break;case\"builtin\":if(/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(i.data.trim())&&(i.data=i.data.replace(/(2D|Cube|EXT)/g,\"\")),\"fragment\"===a&&\"gl_FragColor\"===i.data&&(n||(n=ShaderTranspiler_d(r,f,\"fragColor\"),ShaderTranspiler_p(r,n,\"vec4\")),i.data=n),\"fragment\"===a&&\"gl_FragData\"===i.data){const t=ShaderTranspiler_l(r,e+1),a=ShaderTranspiler_d(r,f,\"fragData\");ShaderTranspiler_u(r,a,\"vec4\",t,\"mediump\"),i.data=a}else\"fragment\"===a&&\"gl_FragDepthEXT\"===i.data&&(o||(o=ShaderTranspiler_d(r,f,\"gl_FragDepth\")),i.data=o);break;case\"ident\":if(reservedWordsGLSL3.indexOf(i.data)>=0){if(\"vertex\"===a&&ShaderTranspiler_c(r,e))throw new Error(\"attribute in vertex shader uses a name that is a reserved word in glsl 300 es\");i.data in h||(h[i.data]=ShaderTranspiler_d(r,f,i.data)),i.data=h[i.data]}}}for(let t=r.length-1;t>=0;--t){const e=r[t];if(\"preprocessor\"===e.type){const a=e.data.match(/\\#extension\\s+(.*)\\:/);if(a&&a[1]&&ShaderTranspiler_s.indexOf(a[1].trim())>=0){const e=r[t+1];r.splice(t,e&&\"whitespace\"===e.type?2:1)}const n=e.data.match(/\\#ifdef\\s+(.*)/);n&&n[1]&&ShaderTranspiler_s.indexOf(n[1].trim())>=0&&(e.data=\"#if 1\");const o=e.data.match(/\\#ifndef\\s+(.*)/);o&&o[1]&&ShaderTranspiler_s.indexOf(o[1].trim())>=0&&(e.data=\"#if 0\")}}return function(t){return t.map((t=>\"eof\"!==t.type?t.data:\"\")).join(\"\")}(r)}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/webgl/Program.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass Program_o{constructor(t,i,o,n,e={}){if(this._context=null,this._glName=null,this._locations={},this.id=Program_r++,this._initialized=!1,this._vShader=null,this._fShader=null,this._defines={},this._nameToUniformLocation={},this._nameToAttribLocation={},this._nameToUniform1={},this._nameToUniform1v={},this._nameToUniform2={},this._nameToUniform3={},this._nameToUniform4={},this._nameToUniformMatrix3={},this._nameToUniformMatrix4={},t||console.error(\"RenderingContext isn't initialized!\"),0===i.length&&console.error(\"Shaders source should not be empty!\"),t.instanceCounter.increment(3,this),this._context=t,this._vertexShaderSource=i,this._fragmentShaderSource=o,Array.isArray(e))for(const t of e)this._defines[t]=\"1\";else this._defines=e;this._locations=n}get glName(){return this._glName}get locations(){return this._locations}getDefine(t){return this._defines[t]}dispose(){if(!this._context)return;const t=this._context.gl;if(this._vShader){const i=this._vShader;t.deleteShader(i),this._vShader=null}if(this._fShader){const i=this._fShader;t.deleteShader(i),this._fShader=null}this._glName&&(t.deleteProgram(this._glName),this._glName=null),this._context.instanceCounter.decrement(3,this),this._context=null}initialize(){if(this._initialized)return;this._vShader=this._loadShader(35633),this._fShader=this._loadShader(35632),this._vShader&&this._fShader||console.error(\"Error loading shaders!\");const t=this._context.gl,i=t.createProgram();t.attachShader(i,this._vShader),t.attachShader(i,this._fShader);for(const o in this._locations){const n=this._locations[o];t.bindAttribLocation(i,n,o)}t.linkProgram(i),this._glName=i,this._initialized=!0}getUniformLocation(t){return this.initialize(),void 0===this._nameToUniformLocation[t]&&(this._nameToUniformLocation[t]=this._context.gl.getUniformLocation(this._glName,t)),this._nameToUniformLocation[t]}hasUniform(t){return null!==this.getUniformLocation(t)}getAttribLocation(t){return this.initialize(),void 0===this._nameToAttribLocation[t]&&(this._nameToAttribLocation[t]=this._context.gl.getAttribLocation(this._glName,t)),this._nameToAttribLocation[t]}setUniform1i(t,i){const o=this._nameToUniform1[t];if(void 0===o||i!==o){this._context.bindProgram(this);this._context.gl.uniform1i(this.getUniformLocation(t),i),this._nameToUniform1[t]=i}}setUniform1iv(t,i){const r=this._nameToUniform1v[t];if(Program_n(r,i)){this._context.bindProgram(this);this._context.gl.uniform1iv(this.getUniformLocation(t),i),void 0===r?this._nameToUniform1v[t]=Program_o._arrayCopy(i):Program_o._arrayAssign(i,r)}}setUniform2iv(t,i){const r=this._nameToUniform2[t];if(Program_n(r,i)){this._context.bindProgram(this);this._context.gl.uniform2iv(this.getUniformLocation(t),i),void 0===r?this._nameToUniform2[t]=Program_o._arrayCopy(i):Program_o._arrayAssign(i,r)}}setUniform3iv(t,i){const r=this._nameToUniform3[t];if(Program_n(r,i)){this._context.bindProgram(this);this._context.gl.uniform3iv(this.getUniformLocation(t),i),void 0===r?this._nameToUniform3[t]=Program_o._arrayCopy(i):Program_o._arrayAssign(i,r)}}setUniform4iv(t,i){const r=this._nameToUniform4[t];if(Program_n(r,i)){this._context.bindProgram(this);this._context.gl.uniform4iv(this.getUniformLocation(t),i),void 0===r?this._nameToUniform4[t]=Program_o._arrayCopy(i):Program_o._arrayAssign(i,r)}}setUniform1f(t,i){const o=this._nameToUniform1[t];if(void 0===o||i!==o){this._context.bindProgram(this);this._context.gl.uniform1f(this.getUniformLocation(t),i),this._nameToUniform1[t]=i}}setUniform1fv(t,i){const r=this._nameToUniform1v[t];if(Program_n(r,i)){this._context.bindProgram(this);this._context.gl.uniform1fv(this.getUniformLocation(t),i),void 0===r?this._nameToUniform1v[t]=Program_o._arrayCopy(i):Program_o._arrayAssign(i,r)}}setUniform2f(t,i,o){const n=this._nameToUniform2[t];if(void 0===n||i!==n[0]||o!==n[1]){this._context.bindProgram(this);this._context.gl.uniform2f(this.getUniformLocation(t),i,o),void 0===n?this._nameToUniform2[t]=[i,o]:(n[0]=i,n[1]=o)}}setUniform2fv(t,i){const r=this._nameToUniform2[t];if(Program_n(r,i)){this._context.bindProgram(this);this._context.gl.uniform2fv(this.getUniformLocation(t),i),void 0===r?this._nameToUniform2[t]=Program_o._arrayCopy(i):Program_o._arrayAssign(i,r)}}setUniform3f(t,i,o,n){const r=this._nameToUniform3[t];if(void 0===r||i!==r[0]||o!==r[1]||n!==r[2]){this._context.bindProgram(this);this._context.gl.uniform3f(this.getUniformLocation(t),i,o,n),void 0===r?this._nameToUniform3[t]=[i,o,n]:(r[0]=i,r[1]=o,r[2]=n)}}setUniform3fv(t,i){const r=this._nameToUniform3[t];if(Program_n(r,i)){this._context.bindProgram(this);this._context.gl.uniform3fv(this.getUniformLocation(t),i),void 0===r?this._nameToUniform3[t]=Program_o._arrayCopy(i):Program_o._arrayAssign(i,r)}}setUniform4f(t,i,o,n,r){const e=this._nameToUniform4[t];if(void 0===e||i!==e[0]||o!==e[1]||n!==e[2]||r!==e[3]){this._context.bindProgram(this);this._context.gl.uniform4f(this.getUniformLocation(t),i,o,n,r),void 0===e?this._nameToUniform4[t]=[i,o,n,r]:(e[0]=i,e[1]=o,e[2]=n,e[3]=r)}}setUniform4fv(t,i){const r=this._nameToUniform4[t];if(Program_n(r,i)){this._context.bindProgram(this);this._context.gl.uniform4fv(this.getUniformLocation(t),i),void 0===r?this._nameToUniform4[t]=Program_o._arrayCopy(i):Program_o._arrayAssign(i,r)}}setUniformMatrix3fv(i,r,e=!1){const s=this._nameToUniformMatrix3[i];if(function(i,o){if(Object(maybe[\"g\" /* isNone */])(i))return!0;if(9!==i.length)return Program_n(i,o);return 9!==i.length||i[0]!==o[0]||i[1]!==o[1]||i[2]!==o[2]||i[3]!==o[3]||i[4]!==o[4]||i[5]!==o[5]||i[6]!==o[6]||i[7]!==o[7]||i[8]!==o[8]}(s,r)){this._context.bindProgram(this);this._context.gl.uniformMatrix3fv(this.getUniformLocation(i),e,r),void 0===s?this._nameToUniformMatrix3[i]=Program_o._arrayCopy(r):Program_o._arrayAssign(r,s)}}setUniformMatrix4fv(i,r,e=!1){const s=this._nameToUniformMatrix4[i];if(function(i,o){if(Object(maybe[\"g\" /* isNone */])(i))return!0;if(16!==i.length)return Program_n(i,o);return 16!==i.length||i[0]!==o[0]||i[1]!==o[1]||i[2]!==o[2]||i[3]!==o[3]||i[4]!==o[4]||i[5]!==o[5]||i[6]!==o[6]||i[7]!==o[7]||i[8]!==o[8]||i[9]!==o[9]||i[10]!==o[10]||i[11]!==o[11]||i[12]!==o[12]||i[13]!==o[13]||i[14]!==o[14]||i[15]!==o[15]}(s,r)){this._context.bindProgram(this);this._context.gl.uniformMatrix4fv(this.getUniformLocation(i),e,r),void 0===s?this._nameToUniformMatrix4[i]=Program_o._arrayCopy(r):Program_o._arrayAssign(r,s)}}assertCompatibleVertexAttributeLocations(t){const i=t.locations===this.locations;return i||console.error(\"VertexAttributeLocations are incompatible\"),i}static _padToThree(t){let i=t.toString();return t<1e3&&(i=(\"  \"+t).slice(-3)),i}_addLineNumbers(t){let i=2;return t.replace(/\\n/g,(()=>\"\\n\"+Program_o._padToThree(i++)+\":\"))}_loadShader(t){const o=35633===t;let n=o?this._vertexShaderSource:this._fragmentShaderSource,r=\"\";for(const t in this._defines)r+=`#define ${t} ${this._defines[t]}\\n`;n=r+n,\"webgl2\"===this._context.contextVersion&&(n=ShaderTranspiler_h(n,o?\"vertex\":\"fragment\"));const e=this._context.gl,s=e.createShader(t);return e.shaderSource(s,n),e.compileShader(s),s}static _arrayCopy(t){const i=[];for(let o=0;o<t.length;++o)i.push(t[o]);return i}static _arrayAssign(t,i){for(let o=0;o<t.length;++o)i[o]=t[o]}}function Program_n(i,o){if(Object(maybe[\"g\" /* isNone */])(i)||i.length!==o.length)return!0;for(let t=0;t<i.length;++t)if(i[t]!==o[t])return!0;return!1}let Program_r=0;/* harmony default export */ var Program = __webpack_exports__[\"a\"] = (Program_o);\n\n\n/***/ }),\n\n/***/ \"lKY1\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"fetch\", function() { return /* binding */ objectResourceUtils_q; });\n__webpack_require__.d(__webpack_exports__, \"gltfToEngineResources\", function() { return /* binding */ objectResourceUtils_Q; });\n__webpack_require__.d(__webpack_exports__, \"parseUrl\", function() { return /* binding */ objectResourceUtils_K; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/maybe.js\nvar maybe = __webpack_require__(\"srIe\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3f64.js\nvar vec3f64 = __webpack_require__(\"Cy1f\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3.js\nvar vec3 = __webpack_require__(\"5DEt\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat4.js\nvar mat4 = __webpack_require__(\"15Hh\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/devEnvironmentUtils.js\nvar devEnvironmentUtils = __webpack_require__(\"SbiP\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat3f64.js\nvar mat3f64 = __webpack_require__(\"2uVf\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat4f64.js\nvar mat4f64 = __webpack_require__(\"r+FG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat3.js\nvar mat3 = __webpack_require__(\"HJJS\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/support/buffer/BufferView.js + 6 modules\nvar BufferView = __webpack_require__(\"VeZB\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Logger.js\nvar Logger = __webpack_require__(\"6S2I\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/support/buffer/math/common.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst common_e=Logger[\"a\" /* default */].getLogger(\"esri.views.3d.support.buffer.math\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/vec32.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction vec32_t(t,r,f){if(t.count!==r.count)return void common_e.error(\"source and destination buffers need to have the same number of elements\");const o=t.count,n=f[0],u=f[1],d=f[2],s=f[4],c=f[5],i=f[6],a=f[8],p=f[9],y=f[10],B=f[12],m=f[13],h=f[14],l=t.typedBuffer,S=t.typedBufferStride,b=r.typedBuffer,v=r.typedBufferStride;for(let e=0;e<o;e++){const t=e*S,r=e*v,f=b[r],o=b[r+1],M=b[r+2];l[t]=n*f+s*o+a*M+B,l[t+1]=u*f+c*o+p*M+m,l[t+2]=d*f+i*o+y*M+h}}function vec32_r(t,r,f){if(t.count!==r.count)return void common_e.error(\"source and destination buffers need to have the same number of elements\");const o=t.count,n=f[0],u=f[1],d=f[2],s=f[3],c=f[4],i=f[5],a=f[6],p=f[7],y=f[8],B=t.typedBuffer,m=t.typedBufferStride,h=r.typedBuffer,l=r.typedBufferStride;for(let e=0;e<o;e++){const t=e*m,r=e*l,f=h[r],o=h[r+1],S=h[r+2];B[t]=n*f+s*o+a*S,B[t+1]=u*f+c*o+p*S,B[t+2]=d*f+i*o+y*S}}function vec32_f(e,t,r){const f=Math.min(e.count,t.count),o=e.typedBuffer,n=e.typedBufferStride,u=t.typedBuffer,d=t.typedBufferStride;for(let e=0;e<f;e++){const t=e*n,f=e*d;o[t]=r*u[f],o[t+1]=r*u[f+1],o[t+2]=r*u[f+2]}}function vec32_o(e,t,r){const f=Math.min(e.count,t.count),o=e.typedBuffer,n=e.typedBufferStride,u=t.typedBuffer,d=t.typedBufferStride;for(let e=0;e<f;e++){const t=e*n,f=e*d;o[t]=u[f]>>r,o[t+1]=u[f+1]>>r,o[t+2]=u[f+2]>>r}}var vec32_n=Object.freeze({__proto__:null,transformMat4:vec32_t,transformMat3:vec32_r,scale:vec32_f,shiftRight:vec32_o});\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js\nvar aaBoundingBox = __webpack_require__(\"QmHG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/nextTick.js\nvar nextTick = __webpack_require__(\"KrcW\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/core/ObjectStack.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass ObjectStack_s{constructor(t){this.allocator=t,this.items=[],this.itemsPtr=0,this.tickHandle=nextTick[\"a\" /* default */].before((()=>this.reset())),this.grow()}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(maybe[\"l\" /* nullifyNonnullableForDispose */])(this.tickHandle)),this.items=Object(maybe[\"l\" /* nullifyNonnullableForDispose */])(this.items)}get(){return 0===this.itemsPtr&&Object(nextTick[\"a\" /* default */])((()=>{})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}reset(){const t=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*ObjectStack_e);this.items.length=Math.min(t,this.items.length),this.itemsPtr=0}grow(){for(let t=0;t<Math.max(8,Math.min(this.items.length,ObjectStack_e));t++)this.items.push(this.allocator())}}const ObjectStack_e=1024;/* harmony default export */ var ObjectStack = (ObjectStack_s);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec2.js\nvar vec2 = __webpack_require__(\"M0lq\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/quatf64.js\nvar quatf64 = __webpack_require__(\"sTkM\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec2f64.js\nvar vec2f64 = __webpack_require__(\"AvGH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec4f64.js\nvar vec4f64 = __webpack_require__(\"D8Ta\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/core/VectorStack.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass VectorStack_c{constructor(t,s,i){this.itemByteSize=t,this.itemCreate=s,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(i/this.itemByteSize),this.tickHandle=nextTick[\"a\" /* default */].before((()=>this.reset()))}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(maybe[\"l\" /* nullifyNonnullableForDispose */])(this.tickHandle)),this.itemsPtr=0,this.items=Object(maybe[\"l\" /* nullifyNonnullableForDispose */])(this.items),this.buffers=Object(maybe[\"l\" /* nullifyNonnullableForDispose */])(this.buffers)}get(){0===this.itemsPtr&&Object(nextTick[\"a\" /* default */])((()=>{}));const t=Math.floor(this.itemsPtr/this.itemsPerBuffer);for(;this.buffers.length<=t;){const t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize);for(let e=0;e<this.itemsPerBuffer;++e)this.items.push(this.itemCreate(t,e*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]}reset(){const t=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);for(;this.buffers.length>t;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}static createVec2f64(t=VectorStack_a){return new VectorStack_c(16,vec2f64[\"b\" /* c */],t)}static createVec3f64(t=VectorStack_a){return new VectorStack_c(24,vec3f64[\"c\" /* a */],t)}static createVec4f64(t=VectorStack_a){return new VectorStack_c(32,vec4f64[\"c\"],t)}static createMat3f64(t=VectorStack_a){return new VectorStack_c(72,mat3f64[\"b\" /* c */],t)}static createMat4f64(t=VectorStack_a){return new VectorStack_c(128,mat4f64[\"d\" /* c */],t)}static createQuatf64(t=VectorStack_a){return new VectorStack_c(32,quatf64[\"b\" /* c */],t)}get test(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}const VectorStack_a=4096;\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/support/stack.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst stack_t=VectorStack_c.createVec2f64(),stack_c=VectorStack_c.createVec3f64(),stack_r=VectorStack_c.createVec4f64(),stack_a=VectorStack_c.createMat3f64(),stack_f=VectorStack_c.createMat4f64(),stack_o=VectorStack_c.createQuatf64();\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/mathUtils.js\nvar mathUtils = __webpack_require__(\"OKTS\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/lineSegment.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction lineSegment_p(t){return t?{origin:Object(vec3f64[\"d\" /* b */])(t.origin),vector:Object(vec3f64[\"d\" /* b */])(t.vector)}:{origin:Object(vec3f64[\"e\" /* c */])(),vector:Object(vec3f64[\"e\" /* c */])()}}function lineSegment_v(t,r){const n=lineSegment_S.get();return n.origin=t,n.vector=r,n}function lineSegment_l(t,r=lineSegment_p()){return lineSegment_m(t.origin,t.vector,r)}function lineSegment_m(t,r,n=lineSegment_p()){return Object(vec3[\"h\" /* g */])(n.origin,t),Object(vec3[\"h\" /* g */])(n.vector,r),n}function lineSegment_b(t,r,n=lineSegment_p()){return Object(vec3[\"h\" /* g */])(n.origin,t),Object(vec3[\"g\" /* f */])(n.vector,r,t),n}function lineSegment_h(r,n){const e=Object(vec3[\"g\" /* f */])(stack_c.get(),n,r.origin),s=Object(vec3[\"e\" /* d */])(r.vector,e),a=Object(vec3[\"e\" /* d */])(r.vector,r.vector),u=Object(mathUtils[\"c\" /* clamp */])(s/a,0,1),g=Object(vec3[\"g\" /* f */])(stack_c.get(),Object(vec3[\"b\" /* a */])(stack_c.get(),r.vector,u),e);return Object(vec3[\"e\" /* d */])(g,g)}function lineSegment_d(t,r){return Math.sqrt(lineSegment_h(t,r))}function lineSegment_j(t,r,n){return lineSegment_A(t,r,0,1,n)}function lineSegment_M(t,r,n){return Object(vec3[\"c\" /* b */])(n,t.origin,Object(vec3[\"b\" /* a */])(n,t.vector,r))}function lineSegment_A(r,n,e,u,g){const{vector:p,origin:v}=r,l=Object(vec3[\"g\" /* f */])(stack_c.get(),n,v),m=Object(vec3[\"m\" /* l */])(p),b=Object(vec3[\"e\" /* d */])(p,l)/m;return Object(vec3[\"b\" /* a */])(g,p,Object(mathUtils[\"c\" /* clamp */])(b,e,u)),Object(vec3[\"c\" /* b */])(g,g,r.origin)}function lineSegment_B(t,r){if(lineSegment_(t,lineSegment_v(r.origin,r.direction),!1,lineSegment_k)){const{tA:r,pB:n,distance2:e}=lineSegment_k;if(r>=0&&r<=1)return e;if(r<0)return Object(vec3[\"i\" /* h */])(t.origin,n);if(r>1)return Object(vec3[\"i\" /* h */])(Object(vec3[\"c\" /* b */])(stack_c.get(),t.origin,t.vector),n)}return null}function lineSegment_w(t,r,n){return!!lineSegment_(t,r,!0,lineSegment_k)&&(Object(vec3[\"h\" /* g */])(n,lineSegment_k.pA),!0)}function lineSegment_P(t,r){return lineSegment_(t,r,!0,lineSegment_k)?lineSegment_k.distance2:null}function lineSegment_(r,n,e,o){const i=1e-6,c=r.origin,a=Object(vec3[\"c\" /* b */])(stack_c.get(),c,r.vector),g=n.origin,p=Object(vec3[\"c\" /* b */])(stack_c.get(),g,n.vector),v=stack_c.get(),l=stack_c.get();if(v[0]=c[0]-g[0],v[1]=c[1]-g[1],v[2]=c[2]-g[2],l[0]=p[0]-g[0],l[1]=p[1]-g[1],l[2]=p[2]-g[2],Math.abs(l[0])<i&&Math.abs(l[1])<i&&Math.abs(l[2])<i)return!1;const m=stack_c.get();if(m[0]=a[0]-c[0],m[1]=a[1]-c[1],m[2]=a[2]-c[2],Math.abs(m[0])<i&&Math.abs(m[1])<i&&Math.abs(m[2])<i)return!1;const b=v[0]*l[0]+v[1]*l[1]+v[2]*l[2],h=l[0]*m[0]+l[1]*m[1]+l[2]*m[2],d=v[0]*m[0]+v[1]*m[1]+v[2]*m[2],j=l[0]*l[0]+l[1]*l[1]+l[2]*l[2],M=(m[0]*m[0]+m[1]*m[1]+m[2]*m[2])*j-h*h;if(Math.abs(M)<i)return!1;let A=(b*h-d*j)/M,B=(b+h*A)/j;e&&(A=Object(mathUtils[\"c\" /* clamp */])(A,0,1),B=Object(mathUtils[\"c\" /* clamp */])(B,0,1));const w=stack_c.get(),P=stack_c.get();return w[0]=c[0]+A*m[0],w[1]=c[1]+A*m[1],w[2]=c[2]+A*m[2],P[0]=g[0]+B*l[0],P[1]=g[1]+B*l[1],P[2]=g[2]+B*l[2],o.tA=A,o.tB=B,o.pA=w,o.pB=P,o.distance2=Object(vec3[\"i\" /* h */])(w,P),!0}const lineSegment_k={tA:0,tB:0,pA:Object(vec3f64[\"e\" /* c */])(),pB:Object(vec3f64[\"e\" /* c */])(),distance2:0},lineSegment_S=new ObjectStack_s((()=>({origin:null,vector:null})));var lineSegment_y=Object.freeze({__proto__:null,create:lineSegment_p,wrap:lineSegment_v,copy:lineSegment_l,fromValues:lineSegment_m,fromPoints:lineSegment_b,distance2:lineSegment_h,distance:lineSegment_d,projectPoint:lineSegment_j,pointAt:lineSegment_M,projectPointClamp:lineSegment_A,closestRayDistance2:lineSegment_B,closestLineSegmentPoint:lineSegment_w,closestLineSegmentDistance2:lineSegment_P});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/triangle.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction triangle_d(e){return e?{p0:Object(vec3f64[\"d\" /* b */])(e.p0),p1:Object(vec3f64[\"d\" /* b */])(e.p1),p2:Object(vec3f64[\"d\" /* b */])(e.p2)}:{p0:Object(vec3f64[\"e\" /* c */])(),p1:Object(vec3f64[\"e\" /* c */])(),p2:Object(vec3f64[\"e\" /* c */])()}}function triangle_j(t,n,e){const r=triangle_O.get();return r.p0=t,r.p1=n,r.p2=e,r}function triangle_b(t,n=triangle_d()){return triangle_v(t.p0,t.p1,t.p2,n)}function triangle_v(t,n,r,s=triangle_d()){return Object(vec3[\"h\" /* g */])(s.p0,t),Object(vec3[\"h\" /* g */])(s.p1,n),Object(vec3[\"h\" /* g */])(s.p2,r),s}function triangle_w(t,n){const e=t.p0,a=t.p1,o=t.p2,c=Object(vec3[\"g\" /* f */])(stack_c.get(),a,e),i=Object(vec3[\"g\" /* f */])(stack_c.get(),o,a),u=Object(vec3[\"g\" /* f */])(stack_c.get(),e,o),l=Object(vec3[\"g\" /* f */])(stack_c.get(),n,e),d=Object(vec3[\"g\" /* f */])(stack_c.get(),n,a),j=Object(vec3[\"g\" /* f */])(stack_c.get(),n,o),b=Object(vec3[\"d\" /* c */])(c,c,u),v=Object(vec3[\"e\" /* d */])(Object(vec3[\"d\" /* c */])(stack_c.get(),c,b),l),w=Object(vec3[\"e\" /* d */])(Object(vec3[\"d\" /* c */])(stack_c.get(),i,b),d),_=Object(vec3[\"e\" /* d */])(Object(vec3[\"d\" /* c */])(stack_c.get(),u,b),j);if(v>0&&w>0&&_>0){const t=Object(vec3[\"e\" /* d */])(b,l);return t*t/Object(vec3[\"e\" /* d */])(b,b)}const h=lineSegment_h(lineSegment_m(e,c,triangle_M.get()),n),k=lineSegment_h(lineSegment_m(a,i,triangle_M.get()),n),y=lineSegment_h(lineSegment_m(o,u,triangle_M.get()),n);return Math.min(h,k,y)}function triangle_(t,n,e){const r=1e-5,{direction:s,origin:p}=n,{p0:c,p1:i,p2:u}=t,f=i[0]-c[0],g=i[1]-c[1],m=i[2]-c[2],l=u[0]-c[0],d=u[1]-c[1],j=u[2]-c[2],b=s[1]*j-d*s[2],v=s[2]*l-j*s[0],w=s[0]*d-l*s[1],_=f*b+g*v+m*w;if(_>-r&&_<r)return!1;const h=1/_,k=p[0]-c[0],y=p[1]-c[1],M=p[2]-c[2],O=h*(k*b+y*v+M*w);if(O<0||O>1)return!1;const P=y*m-g*M,S=M*f-m*k,q=k*g-f*y,x=h*(s[0]*P+s[1]*S+s[2]*q);if(x<0||O+x>1)return!1;if(e){Object(vec3[\"b\" /* a */])(e,s,h*(l*P+d*S+j*q)),Object(vec3[\"c\" /* b */])(e,p,e)}return!0}function triangle_h(t,n,e){const r=Object(vec2[\"i\"])(t,n),s=Object(vec2[\"i\"])(n,e),p=Object(vec2[\"i\"])(e,t),a=(r+s+p)/2,o=a*(a-r)*(a-s)*(a-p);return o<=0?0:Math.sqrt(o)}function triangle_k(t){return triangle_h(t.p0,t.p1,t.p2)}function triangle_y(t,n,e){return Object(vec3[\"g\" /* f */])(triangle_P,n,t),Object(vec3[\"g\" /* f */])(triangle_S,e,t),Object(vec3[\"m\" /* l */])(Object(vec3[\"d\" /* c */])(triangle_P,triangle_P,triangle_S))/2}const triangle_M=new ObjectStack_s(lineSegment_p),triangle_O=new ObjectStack_s((()=>({p0:null,p1:null,p2:null}))),triangle_P=Object(vec3f64[\"e\" /* c */])(),triangle_S=Object(vec3f64[\"e\" /* c */])();var triangle_q=Object.freeze({__proto__:null,create:triangle_d,wrap:triangle_j,copy:triangle_b,fromValues:triangle_v,distance2:triangle_w,intersectRay:triangle_,areaPoints2d:triangle_h,area2d:triangle_k,areaPoints3d:triangle_y});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/geometryDataUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet geometryDataUtils_f=1,geometryDataUtils_c=null;const geometryDataUtils_i=new Uint32Array([0]);function geometryDataUtils_u(t){if(1===t)return geometryDataUtils_i;if(t>geometryDataUtils_f||null==geometryDataUtils_c){for(;t>geometryDataUtils_f;)geometryDataUtils_f*=2;geometryDataUtils_c=new Uint32Array(geometryDataUtils_f);for(let t=0;t<geometryDataUtils_f;t++)geometryDataUtils_c[t]=t}return new Uint32Array(geometryDataUtils_c.buffer,0,t)}function geometryDataUtils_a(t,o,f){if(!t)return!1;const{strideIdx:c,offsetIdx:i,data:u}=t;Object(vec3[\"r\" /* s */])(f,0,0,0),Object(vec3[\"r\" /* s */])(geometryDataUtils_p,0,0,0);let a=0,l=0;for(let t=0;t<o.length-2;t+=3){const d=o[t+0]*c+i,h=o[t+1]*c+i,x=o[t+2]*c+i;Object(vec3[\"r\" /* s */])(geometryDataUtils_m,u[d+0],u[d+1],u[d+2]),Object(vec3[\"r\" /* s */])(I,u[h+0],u[h+1],u[h+2]),Object(vec3[\"r\" /* s */])(geometryDataUtils_g,u[x+0],u[x+1],u[x+2]);const w=triangle_y(geometryDataUtils_m,I,geometryDataUtils_g);w?(Object(vec3[\"c\" /* b */])(geometryDataUtils_m,geometryDataUtils_m,I),Object(vec3[\"c\" /* b */])(geometryDataUtils_m,geometryDataUtils_m,geometryDataUtils_g),Object(vec3[\"b\" /* a */])(geometryDataUtils_m,geometryDataUtils_m,1/3*w),Object(vec3[\"c\" /* b */])(f,f,geometryDataUtils_m),a+=w):(Object(vec3[\"c\" /* b */])(geometryDataUtils_p,geometryDataUtils_p,geometryDataUtils_m),Object(vec3[\"c\" /* b */])(geometryDataUtils_p,geometryDataUtils_p,I),Object(vec3[\"c\" /* b */])(geometryDataUtils_p,geometryDataUtils_p,geometryDataUtils_g),l+=3)}return(0!==l||0!==a)&&(0!==a?(Object(vec3[\"b\" /* a */])(f,f,1/a),!0):0!==l&&(Object(vec3[\"b\" /* a */])(f,geometryDataUtils_p,1/l),!0))}function geometryDataUtils_l(t,r,o){if(!t||!r)return!1;const{strideIdx:s,offsetIdx:f,data:c}=t;Object(vec3[\"r\" /* s */])(o,0,0,0);let i=-1,u=0;for(let t=0;t<r.length;t++){const n=r[t]*s+f;i!==n&&(o[0]+=c[n+0],o[1]+=c[n+1],o[2]+=c[n+2],u++),i=n}return u>1&&Object(vec3[\"b\" /* a */])(o,o,1/u),u>0}function geometryDataUtils_d(t,s,f,c){if(!t)return!1;const{strideIdx:i,offsetIdx:u,data:a}=t;Object(vec3[\"r\" /* s */])(c,0,0,0),Object(vec3[\"r\" /* s */])(geometryDataUtils_p,0,0,0);let l=0,d=0;const h=s?s.length-1:a.length/i-1,x=h+(f?2:0);for(let t=0;t<x;t+=2){const n=t<h?t:h,f=t<h?t+1:0,x=(s?s[n]:n)*i+u,g=(s?s[f]:f)*i+u;geometryDataUtils_m[0]=a[x+0],geometryDataUtils_m[1]=a[x+1],geometryDataUtils_m[2]=a[x+2],I[0]=a[g+0],I[1]=a[g+1],I[2]=a[g+2],Object(vec3[\"b\" /* a */])(geometryDataUtils_m,Object(vec3[\"c\" /* b */])(geometryDataUtils_m,geometryDataUtils_m,I),.5);const w=Object(vec3[\"t\" /* w */])(geometryDataUtils_m,I);w>0?(Object(vec3[\"c\" /* b */])(c,c,Object(vec3[\"b\" /* a */])(geometryDataUtils_m,geometryDataUtils_m,w)),l+=w):(Object(vec3[\"c\" /* b */])(geometryDataUtils_p,geometryDataUtils_p,geometryDataUtils_m),d++)}return 0!==l?(Object(vec3[\"b\" /* a */])(c,c,1/l),!0):0!==d&&(Object(vec3[\"b\" /* a */])(c,geometryDataUtils_p,1/d),!0)}let geometryDataUtils_h=0;function geometryDataUtils_x(){return geometryDataUtils_h++}const geometryDataUtils_m=Object(vec3f64[\"e\" /* c */])(),I=Object(vec3f64[\"e\" /* c */])(),geometryDataUtils_g=Object(vec3f64[\"e\" /* c */])(),geometryDataUtils_p=Object(vec3f64[\"e\" /* c */])();\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Util.js\nvar Util = __webpack_require__(\"EVMh\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GeometryData.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass GeometryData_n{constructor(t,i=GeometryData_n.DefaultIndices,e=\"triangle\"){this.initialize(t,i,e)}get id(){return this._id}get vertexAttributes(){return this._vertexAttributes}get indices(){return this._indices}get indexCount(){const t=Object(Util[\"c\" /* getFirstObjectValue */])(this._indices);return null==t?0:t.length}get primitiveType(){return this._primitiveType}getVertexAttr(){return this.vertexAttributes}initialize(s,r=GeometryData_n.DefaultIndices,c=\"triangle\"){const d={};for(const t in s){const{data:i,size:e}=s[t];d[t]={data:i,size:e,offsetIdx:0,strideIdx:e}}if(r===GeometryData_n.DefaultIndices){const i=function(t){const i=Object(Util[\"c\" /* getFirstObjectValue */])(t);if(null==i)return 0;return i.data.length/i.size}(d),s=geometryDataUtils_u(i);r={};for(const t in d)r[t]=s}this._id=geometryDataUtils_x(),this._vertexAttributes=d,this._indices=r,this._primitiveType=c}toRenderData(){return{id:this._id.toString(),indices:this._indices,vertexAttr:this._vertexAttributes}}getIndices(t){return this._indices[t]}getAttribute(t){return this._vertexAttributes[t]}estimateGpuMemoryUsage(){let t=0;if(this._indices[Util[\"a\" /* VertexAttrConstants */].POSITION]){const i=3;t+=this._indices[Util[\"a\" /* VertexAttrConstants */].POSITION].length*i*4}if(this._indices[Util[\"a\" /* VertexAttrConstants */].NORMAL]){const i=3;t+=this._indices[Util[\"a\" /* VertexAttrConstants */].NORMAL].length*i*4}if(this._indices[Util[\"a\" /* VertexAttrConstants */].UV0]){const i=2;t+=this._indices[Util[\"a\" /* VertexAttrConstants */].UV0].length*i*4}if(this._indices[Util[\"a\" /* VertexAttrConstants */].COLOR]){const i=1;t+=this._indices[Util[\"a\" /* VertexAttrConstants */].COLOR].length*i*4}return t}}GeometryData_n.DefaultIndices={};\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/IdGen.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass IdGen_t{constructor(){this._count=0}gen(t){return null==t&&(t=\"a\"),t+\"_\"+this._count++}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/PooledArray.js + 1 modules\nvar PooledArray = __webpack_require__(\"ikTR\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/BoundingInfo.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass BoundingInfo_b{constructor(i,h,a,o){this.primitiveIndices=i,this._numIndexPerPrimitive=h,this.indices=a,this._position=o,this.center=Object(vec3f64[\"e\" /* c */])(),Object(Util[\"b\" /* assert */])(i.length>=1),Object(Util[\"b\" /* assert */])(a.length%this._numIndexPerPrimitive==0),Object(Util[\"b\" /* assert */])(a.length>=i.length*this._numIndexPerPrimitive),Object(Util[\"b\" /* assert */])(3===this._position.size||4===this._position.size);const{data:c,offsetIdx:d,strideIdx:m}=this._position;let M=0;const l=i.length;let u=d+m*a[this._numIndexPerPrimitive*i[M]];for(BoundingInfo_b.tmpIndices.clear(),BoundingInfo_b.tmpIndices.push(u),this.bbMin=Object(vec3f64[\"g\" /* f */])(c[u],c[u+1],c[u+2]),this.bbMax=Object(vec3f64[\"d\" /* b */])(this.bbMin);M<l;++M){const t=this._numIndexPerPrimitive*i[M];for(let i=0;i<this._numIndexPerPrimitive;++i){u=d+m*a[t+i],BoundingInfo_b.tmpIndices.push(u);let s=c[u];this.bbMin[0]=Math.min(s,this.bbMin[0]),this.bbMax[0]=Math.max(s,this.bbMax[0]),s=c[u+1],this.bbMin[1]=Math.min(s,this.bbMin[1]),this.bbMax[1]=Math.max(s,this.bbMax[1]),s=c[u+2],this.bbMin[2]=Math.min(s,this.bbMin[2]),this.bbMax[2]=Math.max(s,this.bbMax[2])}}Object(vec3[\"f\" /* e */])(this.center,this.bbMin,this.bbMax,.5),this.bsRadius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);let x=this.bsRadius*this.bsRadius;for(M=0;M<BoundingInfo_b.tmpIndices.length;++M){u=BoundingInfo_b.tmpIndices.data[M];const i=c[u]-this.center[0],t=c[u+1]-this.center[1],s=c[u+2]-this.center[2],e=i*i+t*t+s*s;if(e<=x)continue;const n=Math.sqrt(e),h=.5*(n-this.bsRadius);this.bsRadius=this.bsRadius+h,x=this.bsRadius*this.bsRadius;const r=h/n;this.center[0]+=i*r,this.center[1]+=t*r,this.center[2]+=s*r}BoundingInfo_b.tmpIndices.clear()}getCenter(){return this.center}getBSRadius(){return this.bsRadius}getBBMin(){return this.bbMin}getBBMax(){return this.bbMax}getPrimitiveIndices(){return this.primitiveIndices}getIndices(){return this.indices}getPosition(){return this._position}getChildren(){if(this._children)return this._children;if(Object(vec3[\"i\" /* h */])(this.bbMin,this.bbMax)>1){const i=Object(vec3[\"f\" /* e */])(Object(vec3f64[\"e\" /* c */])(),this.bbMin,this.bbMax,.5),s=this.primitiveIndices.length,e=new Uint8Array(s),h=new Array(8);for(let i=0;i<8;++i)h[i]=0;const{data:r,offsetIdx:a,strideIdx:o}=this._position;for(let t=0;t<s;++t){let s=0;const n=this._numIndexPerPrimitive*this.primitiveIndices[t];let b=a+o*this.indices[n],c=r[b],d=r[b+1],m=r[b+2];for(let i=1;i<this._numIndexPerPrimitive;++i){b=a+o*this.indices[n+i];const t=r[b],s=r[b+1],e=r[b+2];t<c&&(c=t),s<d&&(d=s),e<m&&(m=e)}c<i[0]&&(s|=1),d<i[1]&&(s|=2),m<i[2]&&(s|=4),e[t]=s,++h[s]}let c=0;for(let i=0;i<8;++i)h[i]>0&&++c;if(c<2)return;const d=new Array(8);for(let i=0;i<8;++i)d[i]=h[i]>0?new Uint32Array(h[i]):void 0;for(let i=0;i<8;++i)h[i]=0;for(let i=0;i<s;++i){const t=e[i];d[t][h[t]++]=this.primitiveIndices[i]}this._children=new Array(8);for(let i=0;i<8;++i)void 0!==d[i]&&(this._children[i]=new BoundingInfo_b(d[i],this._numIndexPerPrimitive,this.indices,this._position))}return this._children}}!function(t){t.tmpIndices=new PooledArray[\"a\" /* default */]({deallocator:null})}(BoundingInfo_b||(BoundingInfo_b={}));var BoundingInfo_a=BoundingInfo_b;/* harmony default export */ var BoundingInfo = (BoundingInfo_a);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Geometry.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass Geometry_u{constructor(t,n){this._boundingInfo=null,this._id=Geometry_u.__idGen.gen(n),this._data=t}get id(){return this._id}get data(){return this._data}getIndices(t){return this.data.getIndices(t)}get indexCount(){return this.data.indexCount}getAttribute(t){return this.data.getAttribute(t)}get vertexCount(){return this.data.indexCount}get faceCount(){return this.data.indexCount/3}get boundingInfo(){return Object(maybe[\"g\" /* isNone */])(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(t){return\"triangle\"===this.data.primitiveType?this.computeAttachmentOriginTriangles(t):this.computeAttachmentOriginPoints(t)}computeAttachmentOriginTriangles(t){const i=this.getIndices(Util[\"a\" /* VertexAttrConstants */].POSITION),e=this.getAttribute(Util[\"a\" /* VertexAttrConstants */].POSITION);return geometryDataUtils_a(e,i,t)}computeAttachmentOriginPoints(t){const n=this.getIndices(Util[\"a\" /* VertexAttrConstants */].POSITION),e=this.getAttribute(Util[\"a\" /* VertexAttrConstants */].POSITION);return geometryDataUtils_l(e,n,t)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){let t=this.data.getIndices(Util[\"a\" /* VertexAttrConstants */].POSITION);const n=this.data.getAttribute(Util[\"a\" /* VertexAttrConstants */].POSITION),i=\"triangle\"===this.data.primitiveType?3:1;if(0===t.length){t=new Uint32Array(i);for(let n=0;n<i;++n)t[n]=n}const s=t.length;Object(Util[\"b\" /* assert */])(s%i==0,\"Indexing error: \"+s.toFixed(0)+\" not divisible by \"+i.toFixed(0));const u=geometryDataUtils_u(s/i);return new BoundingInfo(u,i,t,n)}}Geometry_u.__idGen=new IdGen_t;/* harmony default export */ var Geometry = (Geometry_u);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/support/buffer/InterleavedLayout.js\nvar InterleavedLayout = __webpack_require__(\"/ADo\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec4.js\nvar vec4 = __webpack_require__(\"dXfX\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/quat.js\nvar quat = __webpack_require__(\"BPBZ\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3f32.js\nvar vec3f32 = __webpack_require__(\"R/jG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js\nvar has = __webpack_require__(\"wSAH\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/support/mathUtils.js\nvar support_mathUtils = __webpack_require__(\"aAs6\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/vector.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction vector_c(t,n,r){const a=Object(vec3[\"e\" /* d */])(t,n)/Object(vec3[\"e\" /* d */])(t,t);return Object(vec3[\"b\" /* a */])(r,t,a)}function vector_i(t,n){return Object(vec3[\"e\" /* d */])(t,n)/Object(vec3[\"m\" /* l */])(t)}function vector_u(n,s){const a=Object(vec3[\"e\" /* d */])(n,s)/(Object(vec3[\"m\" /* l */])(n)*Object(vec3[\"m\" /* l */])(s));return-Object(mathUtils[\"a\" /* acosClamped */])(a)}function vector_f(n,r,s){Object(vec3[\"o\" /* n */])(vector_p,n),Object(vec3[\"o\" /* n */])(vector_m,r);const c=Object(vec3[\"e\" /* d */])(vector_p,vector_m),i=Object(mathUtils[\"a\" /* acosClamped */])(c),u=Object(vec3[\"d\" /* c */])(vector_p,vector_p,vector_m);return Object(vec3[\"e\" /* d */])(u,s)<0?2*Math.PI-i:i}const vector_p=Object(vec3f64[\"e\" /* c */])(),vector_m=Object(vec3f64[\"e\" /* c */])();var vector_j=Object.freeze({__proto__:null,projectPoint:vector_c,projectPointSignedLength:vector_i,angle:vector_u,angleAroundAxis:vector_f});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/plane.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction plane_l(n=plane_Q){return[n[0],n[1],n[2],n[3]]}function plane_p(n,t,r,e){return plane_y(n,t,r,e,stack_r.get())}function plane_d(n,t=plane_l()){return plane_y(n[0],n[1],n[2],n[3],t)}function plane_y(n,t,r,e,o=plane_l()){return o[0]=n,o[1]=t,o[2]=r,o[3]=e,o}function plane_h(n,t,r=plane_l()){return Object(vec3[\"h\" /* g */])(r,n),r[3]=t,r}function plane_P(n,t,r=plane_l()){Object(vec3[\"h\" /* g */])(r,t);const s=Object(vec3[\"e\" /* d */])(t,t);return Math.abs(s-1)>1e-5&&s>1e-12&&Object(vec3[\"b\" /* a */])(r,r,1/Math.sqrt(s)),plane_F(r,n,r),r}function plane_j(n,t,r,e=plane_l()){return plane_(Object(vec3[\"g\" /* f */])(stack_c.get(),n,t),Object(vec3[\"g\" /* f */])(stack_c.get(),r,t),n,e)}function plane_M(n,t){return plane_b(n,t,0,1,2)}function plane_b(n,t,r,e,i){if(n.count<3)return!1;n.getVec(r,plane_A);let a=e,f=!1;for(;a<n.count-1&&!f;)n.getVec(a,V),a++,f=!Object(vec3[\"n\" /* m */])(plane_A,V);if(!f)return!1;for(a=Math.max(a,i),f=!1;a<n.count&&!f;)n.getVec(a,plane_O),a++,Object(vec3[\"g\" /* f */])(plane_S,plane_A,V),Object(vec3[\"o\" /* n */])(plane_S,plane_S),Object(vec3[\"g\" /* f */])(plane_x,V,plane_O),Object(vec3[\"o\" /* n */])(plane_x,plane_x),f=!Object(vec3[\"n\" /* m */])(plane_A,plane_O)&&!Object(vec3[\"n\" /* m */])(V,plane_O)&&Math.abs(Object(vec3[\"e\" /* d */])(plane_S,plane_x))<plane_v;return f?(plane_j(plane_A,V,plane_O,t),!0):(0!==r||1!==e||2!==i)&&plane_b(n,t,0,1,2)}const plane_v=.99619469809,plane_A=Object(vec3f64[\"e\" /* c */])(),V=Object(vec3f64[\"e\" /* c */])(),plane_O=Object(vec3f64[\"e\" /* c */])(),plane_S=Object(vec3f64[\"e\" /* c */])(),plane_x=Object(vec3f64[\"e\" /* c */])();function plane_F(n,t,r){return n!==r&&plane_d(n,r),r[3]=-Object(vec3[\"e\" /* d */])(r,t),r}function plane_I(n,t){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function plane_(n,t,r,e=plane_l()){return plane_P(r,Object(vec3[\"d\" /* c */])(stack_c.get(),t,n),e)}function plane_w(t,r,e){return!!Object(maybe[\"h\" /* isSome */])(r)&&J(t,r.origin,r.direction,!0,!1,e)}function plane_B(n,t,r){return J(n,t.origin,t.vector,!1,!1,r)}function plane_U(n,t,r){return J(n,t.origin,t.vector,!1,!0,r)}function plane_k(n,t){const{center:r,radius:e}=t;return H(n,r)-e>=0}function plane_q(n,t){const{center:r,radius:e}=t;return H(n,r)+e<0}function z(n,t){return H(n,t)>=0}function L(n,t){return H(n,t)<0}function plane_N(n,t){const r=t[0],e=t[1],o=t[2],i=t[3],s=t[4],c=t[5];return n[0]*(n[0]>0?r:i)+n[1]*(n[1]>0?e:s)+n[2]*(n[2]>0?o:c)+n[3]>=0}function plane_C(n,t){const r=Object(vec3[\"e\" /* d */])(n,t.ray.direction),e=-H(n,t.ray.origin);if(e<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return e>0;if((e<0||r<0)&&!(e<0&&r<0))return!0;const i=e/r;return r>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function plane_D(n,t){const r=Object(vec3[\"e\" /* d */])(n,t.ray.direction),e=-H(n,t.ray.origin);if(r>-1e-6&&r<1e-6)return e>0;const i=e/r;return r>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function plane_R(n,t,r){const e=Object(vec3[\"b\" /* a */])(stack_c.get(),n,-n[3]),o=plane_E(n,Object(vec3[\"g\" /* f */])(stack_c.get(),t,e),stack_c.get());return Object(vec3[\"c\" /* b */])(r,o,e),r}function plane_E(n,t,r){const e=Object(vec3[\"b\" /* a */])(stack_c.get(),n,Object(vec3[\"e\" /* d */])(n,t));return Object(vec3[\"g\" /* f */])(r,t,e),r}function plane_G(n,t){return Math.abs(H(n,t))}function H(n,t){return Object(vec3[\"e\" /* d */])(n,t)+n[3]}function J(n,r,e,s,c,u){const a=Object(vec3[\"e\" /* d */])(n,e);if(0===a)return!1;let m=-(Object(vec3[\"e\" /* d */])(n,r)+n[3])/a;return c&&(m=s?Math.max(0,m):Object(mathUtils[\"c\" /* clamp */])(m,0,1)),!(m<0||!s&&m>1)&&(Object(vec3[\"c\" /* b */])(u,r,Object(vec3[\"b\" /* a */])(u,e,m)),!0)}function plane_K(n){return n}const plane_Q=[0,0,1,0];var plane_T=Object.freeze({__proto__:null,create:plane_l,wrap:plane_p,copy:plane_d,fromValues:plane_y,fromNormalAndOffset:plane_h,fromPositionAndNormal:plane_P,fromPoints:plane_j,fromManyPoints:plane_M,fromManyPointsSampleAt:plane_b,setOffsetFromPoint:plane_F,negate:plane_I,fromVectorsAndPoint:plane_,intersectRay:plane_w,intersectLineSegment:plane_B,intersectLineSegmentClamp:plane_U,isSphereFullyInside:plane_k,isSphereFullyOutside:plane_q,isPointInside:z,isPointOutside:L,isAABBFullyInside:plane_N,clip:plane_C,clipInfinite:plane_D,projectPoint:plane_R,projectVector:plane_E,distance:plane_G,signedDistance:H,normal:plane_K,UP:plane_Q});\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/screenUtils.js\nvar screenUtils = __webpack_require__(\"qRWG\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/ray.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction ray_l(r){return r?{origin:Object(vec3f64[\"d\" /* b */])(r.origin),direction:Object(vec3f64[\"d\" /* b */])(r.direction)}:{origin:Object(vec3f64[\"e\" /* c */])(),direction:Object(vec3f64[\"e\" /* c */])()}}function ray_j(r,n){const e=ray_E.get();return e.origin=r,e.direction=n,e}function ray_R(r,n=ray_l()){return ray_S(r.origin,r.direction,n)}function ray_b(r,n,e=ray_l()){return Object(vec3[\"h\" /* g */])(e.origin,r),Object(vec3[\"g\" /* f */])(e.direction,n,r),e}function ray_S(r,n,e=ray_l()){return Object(vec3[\"h\" /* g */])(e.origin,r),Object(vec3[\"h\" /* g */])(e.direction,n),e}function ray_v(r,e,o=ray_l()){return ray_y(r,r.screenToRender(e,Object(screenUtils[\"a\" /* castRenderScreenPointArray3 */])(stack_c.get())),o)}function ray_y(e,o,t=ray_l()){const c=Object(screenUtils[\"a\" /* castRenderScreenPointArray3 */])(Object(vec2[\"c\"])(stack_c.get(),o));if(c[2]=0,!e.unprojectFromRenderScreen(c,t.origin))return null;const s=Object(screenUtils[\"a\" /* castRenderScreenPointArray3 */])(Object(vec2[\"c\"])(stack_c.get(),o));s[2]=1;const a=e.unprojectFromRenderScreen(s,stack_c.get());return Object(maybe[\"g\" /* isNone */])(a)?null:(Object(vec3[\"g\" /* f */])(t.direction,a,t.origin),t)}function ray_w(r,e,o=ray_l()){return ray_(r,r.screenToRender(e,Object(screenUtils[\"a\" /* castRenderScreenPointArray3 */])(stack_c.get())),o)}function ray_(n,e,o=ray_l()){Object(vec3[\"h\" /* g */])(o.origin,n.eye);const s=Object(vec3[\"r\" /* s */])(stack_c.get(),e[0],e[1],1),a=n.unprojectFromRenderScreen(s,stack_c.get());return Object(maybe[\"g\" /* isNone */])(a)?null:(Object(vec3[\"g\" /* f */])(o.direction,a,o.origin),o)}function ray_k(r,n){const e=Object(vec3[\"d\" /* c */])(stack_c.get(),Object(vec3[\"o\" /* n */])(stack_c.get(),r.direction),Object(vec3[\"g\" /* f */])(stack_c.get(),n,r.origin));return Object(vec3[\"e\" /* d */])(e,e)}function ray_F(r,n){return Math.sqrt(ray_k(r,n))}function ray_h(r,n,e){const o=Object(vec3[\"e\" /* d */])(r.direction,Object(vec3[\"g\" /* f */])(e,n,r.origin));return Object(vec3[\"c\" /* b */])(e,r.origin,Object(vec3[\"b\" /* a */])(e,r.direction,o)),e}function ray_A(){return{origin:null,direction:null}}const ray_E=new ObjectStack_s(ray_A);var ray_O=Object.freeze({__proto__:null,create:ray_l,wrap:ray_j,copy:ray_R,fromPoints:ray_b,fromValues:ray_S,fromScreen:ray_v,fromRender:ray_y,fromScreenAtEye:ray_w,fromRenderAtEye:ray_,distance2:ray_k,distance:ray_F,closestPoint:ray_h,createWrapper:ray_A});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/boundedPlane.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst boundedPlane_L=Logger[\"a\" /* default */].getLogger(\"esri.views.3d.support.geometryUtils.boundedPlane\");class boundedPlane_R{constructor(){this.plane=plane_l(),this.origin=Object(vec3f64[\"e\" /* c */])(),this.basis1=Object(vec3f64[\"e\" /* c */])(),this.basis2=Object(vec3f64[\"e\" /* c */])()}}function boundedPlane_z(s=js){return{plane:plane_l(s.plane),origin:Object(vec3f64[\"d\" /* b */])(s.origin),basis1:Object(vec3f64[\"d\" /* b */])(s.basis1),basis2:Object(vec3f64[\"d\" /* b */])(s.basis2)}}function boundedPlane_G(s,i,n){const t=Ps.get();return t.origin=s,t.basis1=i,t.basis2=n,t.plane=plane_p(0,0,0,0),boundedPlane_J(t),t}function boundedPlane_D(s,i=boundedPlane_z()){return boundedPlane_H(s.origin,s.basis1,s.basis2,i)}function boundedPlane_H(s,i,n,t=boundedPlane_z()){return Object(vec3[\"h\" /* g */])(t.origin,s),Object(vec3[\"h\" /* g */])(t.basis1,i),Object(vec3[\"h\" /* g */])(t.basis2,n),boundedPlane_J(t),function(s,i){Math.abs(Object(vec3[\"e\" /* d */])(s.basis1,s.basis2)/(Object(vec3[\"m\" /* l */])(s.basis1)*Object(vec3[\"m\" /* l */])(s.basis2)))>1e-6&&boundedPlane_L.warn(i,\"Provided basis vectors are not perpendicular\");Math.abs(Object(vec3[\"e\" /* d */])(s.basis1,ls(s)))>1e-6&&boundedPlane_L.warn(i,\"Basis vectors and plane normal are not perpendicular\");Math.abs(-Object(vec3[\"e\" /* d */])(ls(s),s.origin)-s.plane[3])>1e-6&&boundedPlane_L.warn(i,\"Plane offset is not consistent with plane origin\")}(t,\"fromValues()\"),t}function boundedPlane_J(s){plane_(s.basis2,s.basis1,s.origin,s.plane)}function boundedPlane_K(s,i,n){s!==n&&boundedPlane_D(s,n);const t=Object(vec3[\"b\" /* a */])(stack_c.get(),ls(s),i);return Object(vec3[\"c\" /* b */])(n.origin,n.origin,t),n.plane[3]-=i,n}function boundedPlane_Q(s,i,n){return boundedPlane_W(i,n),boundedPlane_K(n,cs(s,s.origin),n),n}function boundedPlane_W(s,i=boundedPlane_z()){const n=(s[2]-s[0])/2,t=(s[3]-s[1])/2;return Object(vec3[\"r\" /* s */])(i.origin,s[0]+n,s[1]+t,0),Object(vec3[\"r\" /* s */])(i.basis1,n,0,0),Object(vec3[\"r\" /* s */])(i.basis2,0,t,0),plane_y(0,0,1,0,i.plane),i}function X(s,i,n){return!!plane_w(s.plane,i,n)&&ps(s,n)}function Z(s,i,n){if(X(s,i,n))return n;const t=boundedPlane_$(s,i,stack_c.get());return Object(vec3[\"c\" /* b */])(n,i.origin,Object(vec3[\"b\" /* a */])(stack_c.get(),i.direction,Object(vec3[\"l\" /* k */])(i.origin,t)/Object(vec3[\"m\" /* l */])(i.direction))),n}function boundedPlane_$(s,n,t){const a=Is.get();hs(s,n,a,Is.get());let r=Number.POSITIVE_INFINITY;for(const e of Ns){const c=ds(s,e,vs.get()),u=stack_c.get();if(plane_B(a,c,u)){const s=Object(support_mathUtils[\"c\" /* directionFromTo */])(stack_c.get(),n.origin,u),a=Math.abs(Object(mathUtils[\"a\" /* acosClamped */])(Object(vec3[\"e\" /* d */])(n.direction,s)));a<r&&(r=a,Object(vec3[\"h\" /* g */])(t,u))}}return r===Number.POSITIVE_INFINITY?ss(s,n,t):t}function ss(s,i,n){if(X(s,i,n))return n;const t=Is.get(),a=Is.get();hs(s,i,t,a);let r=Number.POSITIVE_INFINITY;for(const e of Ns){const c=ds(s,e,vs.get()),u=stack_c.get();if(plane_U(t,c,u)){const s=ray_k(i,u);if(!z(a,u))continue;s<r&&(r=s,Object(vec3[\"h\" /* g */])(n,u))}}return ts(s,i.origin)<r&&is(s,i.origin,n),n}function is(s,i,n){const t=plane_R(s.plane,i,stack_c.get()),a=lineSegment_A(ms(s,s.basis1),t,-1,1,stack_c.get()),o=lineSegment_A(ms(s,s.basis2),t,-1,1,stack_c.get());return Object(vec3[\"g\" /* f */])(n,Object(vec3[\"c\" /* b */])(stack_c.get(),a,o),s.origin),n}function ns(s,i,n){const{origin:t,basis1:a,basis2:o}=s,r=Object(vec3[\"g\" /* f */])(stack_c.get(),i,t),e=vector_i(a,r),u=vector_i(o,r),g=vector_i(ls(s),r);return Object(vec3[\"r\" /* s */])(n,e,u,g)}function ts(s,i){const n=ns(s,i,stack_c.get()),{basis1:t,basis2:a}=s,o=Object(vec3[\"m\" /* l */])(t),r=Object(vec3[\"m\" /* l */])(a),e=Math.max(Math.abs(n[0])-o,0),c=Math.max(Math.abs(n[1])-r,0),u=n[2];return e*e+c*c+u*u}function as(s,i){return Math.sqrt(ts(s,i))}function os(s,i){let n=Number.NEGATIVE_INFINITY;for(const t of Ns){const a=ds(s,t,vs.get()),o=lineSegment_h(a,i);o>n&&(n=o)}return Math.sqrt(n)}function rs(s,i){return z(s.plane,i)&&ps(s,i)}function es(s,i,n,t){return function(s,i,n){switch(i){case 0:Object(vec3[\"h\" /* g */])(n,s.basis1),Object(vec3[\"o\" /* n */])(n,n);break;case 1:Object(vec3[\"h\" /* g */])(n,s.basis2),Object(vec3[\"o\" /* n */])(n,n);break;case 2:Object(vec3[\"h\" /* g */])(n,ls(s))}return n}(s,n,t)}function cs(s,i){const n=-s.plane[3];return vector_i(ls(s),i)-n}function us(s,i,n,t){const a=cs(s,i),o=Object(vec3[\"b\" /* a */])(ws,ls(s),n-a);return Object(vec3[\"c\" /* b */])(t,i,o),t}function gs(s,i){return Object(vec3[\"n\" /* m */])(s.basis1,i.basis1)&&Object(vec3[\"n\" /* m */])(s.basis2,i.basis2)&&Object(vec3[\"n\" /* m */])(s.origin,i.origin)}function bs(s,i,n){return s!==n&&boundedPlane_D(s,n),Object(mat4[\"a\"])(Ms,i),Object(mat4[\"b\"])(Ms,Ms),Object(vec3[\"j\" /* i */])(n.basis1,s.basis1,Ms),Object(vec3[\"j\" /* i */])(n.basis2,s.basis2,Ms),Object(vec3[\"j\" /* i */])(plane_K(n.plane),plane_K(s.plane),Ms),Object(vec3[\"j\" /* i */])(n.origin,s.origin,i),plane_F(n.plane,n.origin,n.plane),n}function fs(s,i,n,t){return s!==t&&boundedPlane_D(s,t),Object(mat4[\"h\" /* r */])(Ts,Object(mat4[\"e\" /* i */])(Ts),i,n),Object(vec3[\"j\" /* i */])(t.basis1,s.basis1,Ts),Object(vec3[\"j\" /* i */])(t.basis2,s.basis2,Ts),boundedPlane_J(t),t}function ls(s){return plane_K(s.plane)}function ps(s,i){const n=Object(vec3[\"g\" /* f */])(stack_c.get(),i,s.origin),t=Object(vec3[\"p\" /* o */])(s.basis1),a=Object(vec3[\"p\" /* o */])(s.basis2),o=Object(vec3[\"e\" /* d */])(s.basis1,n),r=Object(vec3[\"e\" /* d */])(s.basis2,n);return-o-t<0&&o-t<0&&-r-a<0&&r-a<0}function ms(s,i){const n=vs.get();return Object(vec3[\"h\" /* g */])(n.origin,s.origin),Object(vec3[\"h\" /* g */])(n.vector,i),n}function ds(s,i,n){const{basis1:t,basis2:a,origin:o}=s,c=Object(vec3[\"b\" /* a */])(stack_c.get(),t,i.origin[0]),u=Object(vec3[\"b\" /* a */])(stack_c.get(),a,i.origin[1]);Object(vec3[\"c\" /* b */])(n.origin,c,u),Object(vec3[\"c\" /* b */])(n.origin,n.origin,o);const g=Object(vec3[\"b\" /* a */])(stack_c.get(),t,i.direction[0]),b=Object(vec3[\"b\" /* a */])(stack_c.get(),a,i.direction[1]);return Object(vec3[\"b\" /* a */])(n.vector,Object(vec3[\"c\" /* b */])(g,g,b),2),n}function hs(s,i,n,t){const a=ls(s);plane_(a,i.direction,i.origin,n),plane_(plane_K(n),a,i.origin,t)}const js={plane:plane_l(),origin:Object(vec3f64[\"g\" /* f */])(0,0,0),basis1:Object(vec3f64[\"g\" /* f */])(1,0,0),basis2:Object(vec3f64[\"g\" /* f */])(0,1,0)},Is=new ObjectStack_s(plane_l),vs=new ObjectStack_s(lineSegment_p),ws=Object(vec3f64[\"e\" /* c */])(),Ps=new ObjectStack_s((()=>({origin:null,basis1:null,basis2:null,plane:null}))),Ns=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Ms=Object(mat4f64[\"b\" /* a */])(),Ts=Object(mat4f64[\"b\" /* a */])();var Ss=Object.freeze({__proto__:null,BoundedPlaneClass:boundedPlane_R,create:boundedPlane_z,wrap:boundedPlane_G,copy:boundedPlane_D,fromValues:boundedPlane_H,updateUnboundedPlane:boundedPlane_J,elevate:boundedPlane_K,setExtent:boundedPlane_Q,fromAABoundingRect:boundedPlane_W,intersectRay:X,intersectRayClosestSilhouette:Z,closestPointOnSilhouette:boundedPlane_$,closestPoint:ss,projectPoint:is,projectPointLocal:ns,distance2:ts,distance:as,distanceToSilhouette:os,extrusionContainsPoint:rs,axisAt:es,altitudeAt:cs,setAltitudeAt:us,equals:gs,transform:bs,rotate:fs,normal:ls,UP:js});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/sphere.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst sphere_O=Logger[\"a\" /* default */].getLogger(\"esri.views.3d.support.geometryUtils.sphere\");function sphere_(t){return t?{radius:t.radius,center:Object(vec3f64[\"d\" /* b */])(t.center)}:{radius:1,center:Object(vec3f64[\"e\" /* c */])()}}function sphere_q(t,r){const e=sphere_N.get();return e.radius=t,e.center=r||sphere_W,e}function sphere_P(t,r=sphere_()){return sphere_R(t.radius,t.center,r)}function sphere_R(t,r,e=sphere_()){return Object(vec3[\"h\" /* g */])(e.center,r),e.radius=t,e}function sphere_U(t,r,e){return t!==e&&Object(vec3[\"h\" /* g */])(e.center,t.center),e.radius=t.radius+r,e}function sphere_z(t,r,e){return sphere_O.error(\"sphere.setExtent is not yet supported\"),t===e?e:sphere_P(t,e)}function sphere_E(r,e,s){if(Object(maybe[\"g\" /* isNone */])(e))return!1;const n=Object(vec3[\"g\" /* f */])(stack_c.get(),e.origin,r.center),i=Object(vec3[\"e\" /* d */])(e.direction,e.direction),f=2*Object(vec3[\"e\" /* d */])(e.direction,n),d=f*f-4*i*(Object(vec3[\"e\" /* d */])(n,n)-r.radius*r.radius);if(d<0)return!1;const m=Math.sqrt(d);let g=(-f-m)/(2*i);const p=(-f+m)/(2*i);return(g<0||p<g&&p>0)&&(g=p),!(g<0)&&(s&&Object(vec3[\"c\" /* b */])(s,e.origin,Object(vec3[\"b\" /* a */])(stack_c.get(),e.direction,g)),!0)}function sphere_L(t,r,e,s){return sphere_E(t,ray_w(r,e,sphere_Q),s)}function sphere_T(t,r){return sphere_E(t,r,null)}function sphere_C(t,r,e){if(sphere_E(t,r,e))return e;const s=sphere_V(t,r,stack_c.get());return Object(vec3[\"c\" /* b */])(e,r.origin,Object(vec3[\"b\" /* a */])(stack_c.get(),r.direction,Object(vec3[\"l\" /* k */])(r.origin,s)/Object(vec3[\"m\" /* l */])(r.direction))),e}function sphere_V(t,r,e){const s=stack_c.get(),n=stack_f.get();Object(vec3[\"d\" /* c */])(s,r.origin,r.direction),Object(vec3[\"d\" /* c */])(e,s,r.origin),Object(vec3[\"b\" /* a */])(e,e,1/Object(vec3[\"m\" /* l */])(e)*t.radius);const i=sphere_G(t,r.origin),o=vector_u(r.origin,e);return Object(mat4[\"e\" /* i */])(n),Object(mat4[\"h\" /* r */])(n,n,o+i,s),Object(vec3[\"j\" /* i */])(e,e,n),e}function sphere_B(t,r,e){return sphere_E(t,r,e)?e:(ray_h(r,t.center,e),sphere_D(t,e,e))}function sphere_D(t,r,e){const s=Object(vec3[\"g\" /* f */])(stack_c.get(),r,t.center),n=Object(vec3[\"b\" /* a */])(stack_c.get(),s,t.radius/Object(vec3[\"m\" /* l */])(s));return Object(vec3[\"c\" /* b */])(e,n,t.center)}function sphere_F(t,r){const e=Object(vec3[\"g\" /* f */])(stack_c.get(),r,t.center),s=Object(vec3[\"p\" /* o */])(e),n=t.radius*t.radius;return Math.sqrt(Math.abs(s-n))}function sphere_G(t,r){const s=Object(vec3[\"g\" /* f */])(stack_c.get(),r,t.center),n=Object(vec3[\"m\" /* l */])(s),i=t.radius+Math.abs(t.radius-n);return Object(mathUtils[\"a\" /* acosClamped */])(t.radius/i)}const sphere_H=Object(vec3f64[\"e\" /* c */])();function sphere_I(t,r,e,s){const n=Object(vec3[\"g\" /* f */])(sphere_H,r,t.center);switch(e){case 0:{const t=Object(support_mathUtils[\"a\" /* cartesianToSpherical */])(n,sphere_H)[2];return Object(vec3[\"r\" /* s */])(s,-Math.sin(t),Math.cos(t),0)}case 1:{const t=Object(support_mathUtils[\"a\" /* cartesianToSpherical */])(n,sphere_H),r=t[1],e=t[2],i=Math.sin(r);return Object(vec3[\"r\" /* s */])(s,-i*Math.cos(e),-i*Math.sin(e),Math.cos(r))}case 2:return Object(vec3[\"o\" /* n */])(s,n);default:return}}function sphere_J(t,r){const e=Object(vec3[\"g\" /* f */])(sphere_X,r,t.center);return Object(vec3[\"m\" /* l */])(e)-t.radius}function sphere_K(t,r,e,s){const n=sphere_J(t,r),i=sphere_I(t,r,2,sphere_X),o=Object(vec3[\"b\" /* a */])(sphere_X,i,e-n);return Object(vec3[\"c\" /* b */])(s,r,o),s}const sphere_N=new ObjectStack_s((()=>({center:null,radius:0}))),sphere_Q=ray_l(),sphere_W=Object(vec3f64[\"e\" /* c */])(),sphere_X=Object(vec3f64[\"e\" /* c */])();Object.freeze(sphere_W);var Y=Object.freeze({__proto__:null,create:sphere_,wrap:sphere_q,copy:sphere_P,fromValues:sphere_R,elevate:sphere_U,setExtent:sphere_z,intersectRay:sphere_E,intersectScreen:sphere_L,intersectsRay:sphere_T,intersectRayClosestSilhouette:sphere_C,closestPointOnSilhouette:sphere_V,closestPoint:sphere_B,projectPoint:sphere_D,distanceToSilhouette:sphere_F,angleToSilhouette:sphere_G,axisAt:sphere_I,altitudeAt:sphere_J,setAltitudeAt:sphere_K});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/axisAngle.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction axisAngle_e(r=axisAngle_g){return[r[0],r[1],r[2],r[3]]}function axisAngle_a(r,n,t,o){return axisAngle_f(r,n,t,o,stack_r.get())}function axisAngle_u(r,n){return axisAngle_f(r[0],r[1],r[2],n,stack_r.get())}function axisAngle_c(r,n=axisAngle_e()){return axisAngle_f(r[0],r[1],r[2],r[3],n)}function axisAngle_f(r,n,t,s,o=axisAngle_e()){return o[0]=r,o[1]=n,o[2]=t,o[3]=s,o}function axisAngle_i(n,t,s=axisAngle_e()){return Object(vec3[\"h\" /* g */])(s,n),s[3]=t,s}function axisAngle_p(r,s,a=axisAngle_e()){return Object(vec3[\"d\" /* c */])(a,r,s),Object(vec3[\"o\" /* n */])(a,a),a[3]=vector_u(r,s),a}function axisAngle_m(r){return r}const axisAngle_g=[0,0,1,0];var axisAngle_l=Object.freeze({__proto__:null,create:axisAngle_e,wrap:axisAngle_a,wrapAxisAngle:axisAngle_u,copy:axisAngle_c,fromValues:axisAngle_f,fromAxisAndAngle:axisAngle_i,fromPoints:axisAngle_p,axis:axisAngle_m,UP:axisAngle_g});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/clipRay.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction clipRay_u(r){return r?{ray:ray_l(r.ray),c0:r.c0,c1:r.c1}:{ray:ray_l(),c0:0,c1:Number.MAX_VALUE}}function clipRay_f(r,t,c){const n=clipRay_.get();return n.ray=r,n.c0=t,n.c1=c,n}function clipRay_m(r,t=clipRay_u()){return clipRay_y(r.ray,r.c0,r.c1,t)}function clipRay_y(r,t,c,n=clipRay_u()){return ray_R(r,n.ray),n.c0=t,n.c1=c,n}function clipRay_g(r,t=clipRay_u()){return ray_R(r,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t}function clipRay_p(t,c=clipRay_u()){return clipRay_b(t,Object(vec3[\"o\" /* n */])(stack_c.get(),t.vector),c)}function clipRay_b(r,c,n=clipRay_u()){const e=Object(vec3[\"m\" /* l */])(r.vector);return ray_S(r.origin,c,n.ray),n.c0=0,n.c1=e,n}function clipRay_j(r,t){return clipRay_A(r,r.c0,t)}function clipRay_l(r,t){return clipRay_A(r,r.c1,t)}function clipRay_A(r,t,e){return Object(vec3[\"c\" /* b */])(e,r.ray.origin,Object(vec3[\"b\" /* a */])(e,r.ray.direction,t))}const clipRay_=new ObjectStack_s((()=>({c0:0,c1:0,ray:null})));var clipRay_d=Object.freeze({__proto__:null,create:clipRay_u,wrap:clipRay_f,copy:clipRay_m,fromValues:clipRay_y,fromRay:clipRay_g,fromLineSegment:clipRay_p,fromLineSegmentAndDirection:clipRay_b,getStart:clipRay_j,getEnd:clipRay_l,getAt:clipRay_A});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/frustum.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction frustum_d(s){if(s){const{planes:r,points:e}=s;return{planes:[plane_l(r[0]),plane_l(r[1]),plane_l(r[2]),plane_l(r[3]),plane_l(r[4]),plane_l(r[5])],points:[Object(vec3f64[\"d\" /* b */])(e[0]),Object(vec3f64[\"d\" /* b */])(e[1]),Object(vec3f64[\"d\" /* b */])(e[2]),Object(vec3f64[\"d\" /* b */])(e[3]),Object(vec3f64[\"d\" /* b */])(e[4]),Object(vec3f64[\"d\" /* b */])(e[5]),Object(vec3f64[\"d\" /* b */])(e[6]),Object(vec3f64[\"d\" /* b */])(e[7])]}}return{planes:[plane_l(),plane_l(),plane_l(),plane_l(),plane_l(),plane_l()],points:[Object(vec3f64[\"e\" /* c */])(),Object(vec3f64[\"e\" /* c */])(),Object(vec3f64[\"e\" /* c */])(),Object(vec3f64[\"e\" /* c */])(),Object(vec3f64[\"e\" /* c */])(),Object(vec3f64[\"e\" /* c */])(),Object(vec3f64[\"e\" /* c */])(),Object(vec3f64[\"e\" /* c */])()]}}function frustum_P(t,r=frustum_d()){return frustum_R(t.planes,t.points,r)}function frustum_R(t,r,e=frustum_d()){for(let r=0;r<6;r++)plane_d(t[r],e.planes[r]);for(let t=0;t<8;t++)Object(vec3[\"h\" /* g */])(e.points[t],r[t]);return e}function frustum_S(t,r,s=frustum_d()){const{points:a}=s,i=Object(mat4[\"g\" /* m */])(stack_f.get(),r,t);Object(mat4[\"a\"])(i,i);for(let t=0;t<8;++t){const r=Object(vec4[\"l\" /* t */])(stack_r.get(),frustum_L[t],i);Object(vec3[\"r\" /* s */])(a[t],r[0]/r[3],r[1]/r[3],r[2]/r[3])}return frustum_w(s),s}function frustum_w(t){const{planes:r,points:s}=t;plane_j(s[4],s[0],s[3],r[0]),plane_j(s[1],s[5],s[6],r[1]),plane_j(s[4],s[5],s[1],r[2]),plane_j(s[3],s[2],s[6],r[3]),plane_j(s[0],s[1],s[2],r[4]),plane_j(s[5],s[4],s[7],r[5])}function frustum_x(t,r){for(let s=0;s<6;s++)if(plane_k(t[s],r))return!1;return!0}function frustum_A(t,r){return frustum_C(t,clipRay_g(r,frustum_M.get()))}function frustum_B(t,r){for(let s=0;s<6;s++){const e=t[s];if(!plane_D(e,r))return!1}return!0}function frustum_O(t,r,s){return frustum_C(t,clipRay_b(r,s,frustum_M.get()))}function frustum_q(t,r){for(let s=0;s<6;s++){if(H(t[s],r)>0)return!1}return!0}function frustum_z(t,r){for(let s=0;s<6;s++)if(plane_N(t[s],r))return!1;return!0}function frustum_C(t,r){for(let s=0;s<6;s++)if(!plane_C(t[s],r))return!1;return!0}const frustum_I={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]},frustum_L=[Object(vec4f64[\"b\"])(-1,-1,-1,1),Object(vec4f64[\"b\"])(1,-1,-1,1),Object(vec4f64[\"b\"])(1,1,-1,1),Object(vec4f64[\"b\"])(-1,1,-1,1),Object(vec4f64[\"b\"])(-1,-1,1,1),Object(vec4f64[\"b\"])(1,-1,1,1),Object(vec4f64[\"b\"])(1,1,1,1),Object(vec4f64[\"b\"])(-1,1,1,1)],frustum_M=new ObjectStack_s(clipRay_u);var frustum_V=Object.freeze({__proto__:null,create:frustum_d,copy:frustum_P,fromValues:frustum_R,fromMatrix:frustum_S,recomputePlanes:frustum_w,intersectsSphere:frustum_x,intersectsRay:frustum_A,intersectClipRay:frustum_B,intersectsLineSegment:frustum_O,intersectsPoint:frustum_q,intersectsAABB:frustum_z,planePointIndices:frustum_I});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/support/geometryUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst geometryUtils_u=plane_T,geometryUtils_e=Ss,geometryUtils_f=triangle_q,geometryUtils_h=lineSegment_y,geometryUtils_j=ray_O,geometryUtils_k=clipRay_d,geometryUtils_l=Y,geometryUtils_g=frustum_V,geometryUtils_b=vector_j,geometryUtils_d=axisAngle_l;\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/ObjectPool.js\nvar ObjectPool = __webpack_require__(\"7Nfj\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GeometryRecord.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass GeometryRecord_a{acquire(t,i,r,e,n,o){this.id=GeometryRecord_a._idGen.gen(t&&t.id),this.geometry=t,this.material=i,this.transformation=r,this.instanceParameters=e,this.origin=n,this.shaderTransformation=o}getStaticTransformation(){return this.transformation}getShaderTransformation(){return this.shaderTransformation?this.shaderTransformation(this.transformation):this.transformation}computeAttachmentOrigin(t){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,t):this.geometry.computeAttachmentOrigin(t))&&(Object(vec3[\"j\" /* i */])(t,t,this.getStaticTransformation()),!0)}}GeometryRecord_a._idGen=new IdGen_t,GeometryRecord_a.pool=new ObjectPool[\"a\" /* default */](GeometryRecord_a);/* harmony default export */ var GeometryRecord = (GeometryRecord_a);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Object3DStateSet.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst Object3DStateSet_t=new IdGen_t;function Object3DStateSet_s(e){const s=0===e?\"highlight\":\"occludee\";return{id:Object3DStateSet_t.gen(s),channel:e}}class Object3DStateSet_o{constructor(){this.items=[]}addObject(e,t){this.items.push({type:0,objectStateId:t,object:e})}addRenderGeometry(e,t,s){this.items.push({type:1,objectStateId:t,renderGeometry:e,owner:s})}addExternal(e,t){this.items.push({type:2,objectStateId:t,remove:e})}remove(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];s.objectStateId===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeObject(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];0===s.type&&s.object===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeRenderGeometry(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];1===s.type&&s.renderGeometry===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeAll(){this.items.forEach((e=>{this._removeObjectStateItem(e)})),this.items=[]}_removeObjectStateItem(e){switch(e.type){case 0:0===e.objectStateId.channel?e.object.removeHighlight(e.objectStateId):1===e.objectStateId.channel&&e.object.removeOcclude(e.objectStateId);break;case 1:e.owner.removeRenderGeometryObjectState(e.renderGeometry,e.objectStateId);break;case 2:e.remove(e.objectStateId)}}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/utils.js\nvar utils = __webpack_require__(\"tiP8\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Object3D.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass Object3D_M{constructor(e={}){this._objectTransformation=Object(mat4f64[\"b\" /* a */])(),this._bvObjectSpace=new Object3D_S,this._bvWorldSpace=new Object3D_S,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.id=Object3D_M._idGen.gen(e.idHint),this.castShadow=null==e.castShadow||e.castShadow,this.metadata=e.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new Object3D_R),this.objectTransformation=Object(mat4f64[\"b\" /* a */])(),this._initializeGeometryRecords(e.geometries,e.materials,e.transformations,e.origins)}get geometryRecords(){return this._geometryRecords}get geometries(){return this._geometries}get objectTransformation(){return this._objectTransformation}set objectTransformation(e){Object(mat4[\"c\"])(this._objectTransformation,e),this._invalidateBoundingVolume(),this._notifyDirty(\"objTransformation\")}dispose(){for(const e of this._geometryRecords)GeometryRecord.pool.release(e);this._geometryRecords=null,this._geometries=null}_initializeGeometryRecords(e,t,i,s){if(!Array.isArray(e))return this._geometryRecords=[],void(this._geometries=[]);Object(Util[\"b\" /* assert */])(t.length===e.length,\"Object3D: materials don't match geometries\"),Object(Util[\"b\" /* assert */])(i.length===e.length,\"Object3D: transformations don't match geometries\"),this._geometryRecords=new Array(e.length),this._geometries=e.slice();for(let r=0;r<e.length;r++){const o={highlights:null,occludees:null,visible:!0};this._geometryRecords[r]=GeometryRecord.pool.acquire(e[r],t[r],Object(mat4f64[\"c\" /* b */])(i[r]),o,s&&s[r])}this._hasVolatileTransformation=!1}get parentLayer(){return this._parentLayer}set parentLayer(e){Object(Util[\"b\" /* assert */])(null==this._parentLayer||null==e,\"Object3D can only be added to a single Layer\"),this._parentLayer=e}getNumGeometryRecords(){return this._geometryRecords.length}getGeometryRecord(e){return Object(Util[\"b\" /* assert */])(e>=0&&e<this._geometryRecords.length,\"Object3d.getGeometryDataByIndex: index out of range\"),this._geometryRecords[e]}addGeometry(e,t,i,s,r,o){i=i||mat4f64[\"a\" /* I */],this._geometries.push(e);const a=GeometryRecord.pool.acquire(e,t,i,s||{highlights:null,occludees:null,visible:!0},r,o);return this._geometryRecords.push(a),this._hasVolatileTransformation=this._geometryRecords.some((e=>!!e.shaderTransformation)),this._notifyDirty(\"objGeometryAdded\",a),this._invalidateBoundingVolume(),a}removeGeometry(e){const t=this._geometryRecords.splice(e,1)[0];return GeometryRecord.pool.release(t),this._hasVolatileTransformation=this._geometryRecords.some((e=>!!e.shaderTransformation)),this._geometries.splice(e,1),this._notifyDirty(\"objGeometryRemoved\",t),this._invalidateBoundingVolume(),t}removeAllGeometries(){for(;this.getNumGeometryRecords()>0;)this.removeGeometry(0)}geometryVertexAttrsUpdated(e){this._notifyDirty(\"vertexAttrsUpdated\",this._geometryRecords[e]),this._invalidateBoundingVolume()}get isVisible(){return this._visible}setVisible(e){this._visible=e;for(const e of this._geometryRecords)e.instanceParameters.visible=this._visible;this._notifyDirty(\"visibilityChanged\")}maskOccludee(){const e=Object3DStateSet_s(1);for(const t of this._geometryRecords)t.instanceParameters.occludees=Object(utils[\"a\" /* addObject3DStateID */])(t.instanceParameters.occludees,e);return this._notifyDirty(\"occlusionChanged\"),e}removeOcclude(e){for(const t of this._geometryRecords)t.instanceParameters.occludees=Object(utils[\"c\" /* removeObject3DStateID */])(t.instanceParameters.occludees,e);this._notifyDirty(\"occlusionChanged\")}highlight(){const e=Object3DStateSet_s(0);for(const t of this._geometryRecords)t.instanceParameters.highlights=Object(utils[\"a\" /* addObject3DStateID */])(t.instanceParameters.highlights,e);return this._notifyDirty(\"highlightChanged\"),e}removeHighlight(e){for(const t of this._geometryRecords)t.instanceParameters.highlights=Object(utils[\"c\" /* removeObject3DStateID */])(t.instanceParameters.highlights,e);this._notifyDirty(\"highlightChanged\")}getCombinedStaticTransformation(t,i){return Object(mat4[\"g\" /* m */])(Object(maybe[\"o\" /* unwrapOr */])(i,Object(mat4f64[\"b\" /* a */])()),this.objectTransformation,t.getStaticTransformation())}getCombinedShaderTransformation(e,t){return t=t||Object(mat4f64[\"b\" /* a */])(),Object(mat4[\"g\" /* m */])(t,this.objectTransformation,e.getShaderTransformation()),t}hasVolativeTransformation(){return this._hasVolatileTransformation}getBBMin(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin}getBBMax(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax}getCenter(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.center:this._bvWorldSpace.center}getBSRadius(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius}_validateBoundingVolume(){if(!this._bvDirty&&!this._hasVolatileTransformation)return;this._bvObjectSpace.init(),this._bvWorldSpace.init();for(let e=0;e<this._geometryRecords.length;++e){const t=this._geometries[e],i=this._geometryRecords[e],s=t.boundingInfo;this._calculateTransformedBoundingVolume(s,this._bvObjectSpace,i.getShaderTransformation()),this._calculateTransformedBoundingVolume(s,this._bvWorldSpace,this.getCombinedShaderTransformation(i))}Object(vec3[\"f\" /* e */])(this._bvObjectSpace.center,this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5),Object(vec3[\"f\" /* e */])(this._bvWorldSpace.center,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);const e=Object(vec3f64[\"e\" /* c */])(),t=Object(vec3f64[\"e\" /* c */])(),i=Object(support_mathUtils[\"d\" /* maxScale */])(this.objectTransformation);for(let s=0;s<this._geometryRecords.length;++s){const r=this._geometries[s],n=this._geometryRecords[s].getShaderTransformation(),h=Object(support_mathUtils[\"d\" /* maxScale */])(n),m=r.boundingInfo;Object(vec3[\"j\" /* i */])(e,m.getCenter(),n);const b=Object(vec3[\"l\" /* k */])(e,this._bvObjectSpace.center),d=m.getBSRadius()*h;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,b+d),Object(vec3[\"j\" /* i */])(t,e,this.objectTransformation);const l=Object(vec3[\"l\" /* k */])(t,this._bvWorldSpace.center),_=d*i;this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,l+_)}this._bvDirty=!1}_calculateTransformedBoundingVolume(e,i,s){const r=e.getBBMin(),a=e.getBBMax(),h=Object(vec3f64[\"d\" /* b */])(r),c=Object(vec3f64[\"d\" /* b */])(a);Object(vec3[\"j\" /* i */])(h,h,s),Object(vec3[\"j\" /* i */])(c,c,s);for(let e=0;e<3;++e)i.bbMin[e]=Math.min(i.bbMin[e],h[e],c[e]),i.bbMax[e]=Math.max(i.bbMax[e],h[e],c[e]);for(let e=0;e<3;++e){Object(vec3[\"h\" /* g */])(h,r),Object(vec3[\"h\" /* g */])(c,a),h[e]=a[e],c[e]=r[e],Object(vec3[\"j\" /* i */])(h,h,s),Object(vec3[\"j\" /* i */])(c,c,s);for(let e=0;e<3;++e)i.bbMin[e]=Math.min(i.bbMin[e],h[e],c[e]),i.bbMax[e]=Math.max(i.bbMax[e],h[e],c[e])}}_invalidateBoundingVolume(){this._bvDirty=!0,this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,{center:this._bvWorldSpace.center,radius:this._bvWorldSpace.bsRadius})}_notifyDirty(e,t,i,s){if(this._parentLayer){i=i||1;const r=s||this;this._parentLayer.notifyDirty(e,t,i,r)}}get test(){const e=this;return{hasGeometry:t=>e._geometries.indexOf(t)>-1,getGeometryIndex:t=>e._geometries.indexOf(t)}}}Object3D_M._idGen=new IdGen_t;class Object3D_R{constructor(){this.bbMin=Object(vec3f64[\"g\" /* f */])(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.bbMax=Object(vec3f64[\"g\" /* f */])(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]}}class Object3D_S extends Object3D_R{constructor(){super(),this.center=Object(vec3f64[\"e\" /* c */])(),this.bsRadius=0}init(){Object(vec3[\"r\" /* s */])(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),Object(vec3[\"r\" /* s */])(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),Object(vec3[\"r\" /* s */])(this.center,0,0,0),this.bsRadius=0}getCenter(){return this.center}getBSRadius(){return this.bsRadius}}/* harmony default export */ var Object3D = (Object3D_M);\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/intersectorUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction intersectorUtils_q(t){return(s,r,e)=>(Object(vec3[\"f\" /* e */])(intersectorUtils_K,s,r,e),!rs(t,intersectorUtils_K))}class intersectorUtils_V{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=2}}class intersectorUtils_j{constructor(){this._transform=Object(mat4f64[\"b\" /* a */])(),this._transformInverse=new intersectorUtils_w({value:this._transform},mat4[\"a\"],mat4f64[\"b\" /* a */]),this._transformInverseTranspose=new intersectorUtils_w(this._transformInverse,mat4[\"b\"],mat4f64[\"b\" /* a */]),this._transformTranspose=new intersectorUtils_w({value:this._transform},mat4[\"b\"],mat4f64[\"b\" /* a */]),this._transformInverseRotation=new intersectorUtils_w({value:this._transform},mat3[\"b\"],mat3f64[\"a\"])}invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(t){Object(mat4[\"c\"])(this._transform,t)}multiplyTransform(t){Object(mat4[\"g\" /* m */])(this._transform,this._transform,t)}set(t){Object(mat4[\"c\"])(this._transform,t),this.invalidateLazyTransforms()}setAndInvalidateLazyTransforms(t,s){this.setTransformMatrix(t),this.multiplyTransform(s),this.invalidateLazyTransforms()}}class intersectorUtils_w{constructor(t,s,r){this.original=t,this.update=s,this.dirty=!0,this.transform=r()}invalidate(){this.dirty=!0}get value(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}class intersectorUtils_k{constructor(){this.min=new intersectorUtils_G,this.max=new intersectorUtils_G,this.hud=new intersectorUtils_G,this.ground=new intersectorUtils_G}init(t){this.min.init(t),this.max.init(t),this.hud.init(t),this.ground.init(t),this.all=[]}}class intersectorUtils_G{constructor(t){this.normal=Object(vec3f64[\"e\" /* c */])(),this.transformation=Object(mat4f64[\"b\" /* a */])(),this._ray=geometryUtils_j.create(),this.init(t)}get ray(){return this._ray}get hasIntersectionPoint(){return null!=this.dist}get distanceInRenderSpace(){if(null!=this.dist)return Object(vec3[\"b\" /* a */])(intersectorUtils_Q,this.ray.direction,this.dist),Object(vec3[\"m\" /* l */])(intersectorUtils_Q)}getIntersectionPoint(t){return!!this.hasIntersectionPoint&&(Object(vec3[\"b\" /* a */])(intersectorUtils_Q,this.ray.direction,this.dist),Object(vec3[\"c\" /* b */])(t,this.ray.origin,intersectorUtils_Q),!0)}getTransformedNormal(t){return Object(vec3[\"h\" /* g */])(intersectorUtils_W,this.normal),intersectorUtils_W[3]=0,Object(vec4[\"l\" /* t */])(intersectorUtils_W,intersectorUtils_W,this.transformation),Object(vec3[\"h\" /* g */])(t,intersectorUtils_W),Object(vec3[\"o\" /* n */])(t,t),t}init(t){this.dist=void 0,this.target=void 0,this.name=void 0,this.drapedLayerOrder=void 0,this.drapedLayerGraphicOrder=void 0,this.center=null,this.geometryId=null,this.triangleNr=null,this.intersector=\"Stage\",t?geometryUtils_j.copy(t,this._ray):this._ray=geometryUtils_j.create()}set(t,s,r,e,a,n,h,o,l,f){t instanceof Object3D&&(t={type:\"stage\",obj:t}),this.dist=r,Object(vec3[\"h\" /* g */])(this.normal,e),Object(mat4[\"c\"])(this.transformation,a),this.target=t,this.name=s,this.drapedLayerOrder=n,this.center=h?Object(vec3f64[\"d\" /* b */])(h):null,this.geometryId=o,this.triangleNr=l,this.drapedLayerGraphicOrder=f}copyFrom(t){geometryUtils_j.copy(t._ray,this._ray),this.dist=t.dist,this.target=t.target,this.name=t.name,this.drapedLayerOrder=t.drapedLayerOrder,this.center=t.center?Object(vec3f64[\"d\" /* b */])(t.center):null,this.geometryId=t.geometryId,this.triangleNr=t.triangleNr,this.intersector=t.intersector,this.drapedLayerGraphicOrder=t.drapedLayerGraphicOrder,Object(vec3[\"h\" /* g */])(this.normal,t.normal),Object(mat4[\"c\"])(this.transformation,t.transformation)}toOwner(t){if(!this.target)return null;switch(this.target.type){case\"stage\":return intersectorUtils_U(this.target.obj.metadata,t);case\"external\":switch(this.intersector){case\"PointRenderer\":return function(t,s){const r=t.metadata.layerUid;return null!=r?s.map.findLayerByUid(r):null}(this.target,t);case\"I3S\":case\"IM\":case\"LodRenderer\":case\"OverlayRenderer\":return intersectorUtils_U(this.target.metadata,t);case\"TerrainRenderer\":return t.map&&t.map.ground}}return null}toGraphic(t){if(!this.target)return null;switch(this.target.type){case\"stage\":return intersectorUtils_R(this.target.obj.metadata,t);case\"external\":switch(this.intersector){case\"PointRenderer\":return this.target.metadata.createGraphic();case\"I3S\":case\"IM\":case\"LodRenderer\":case\"OverlayRenderer\":return intersectorUtils_R(this.target.metadata,t)}}return null}}function intersectorUtils_U(r,e){return Object(maybe[\"g\" /* isNone */])(r)||null==r.layerUid?null:Object(maybe[\"h\" /* isSome */])(e.graphicsView)&&r.layerUid===e.graphicsView.mockLayerId?e.graphics:e.map.findLayerByUid(r.layerUid)}function intersectorUtils_R(e,i){if(Object(maybe[\"g\" /* isNone */])(e))return null;const a=intersectorUtils_U(e,i);if(Object(maybe[\"g\" /* isNone */])(a))return null;if(a===i.graphics)return Object(maybe[\"h\" /* isSome */])(i.graphicsView)?Object(maybe[\"n\" /* unwrap */])(i.graphicsView.getGraphicFromGraphicUid(e.graphicUid)):null;const n=i.allLayerViews.find((t=>t.layer===a));return n?function(t,s){if(!t||t.suspended)return null;if(\"getGraphicFromIntersectorMetadata\"in t&&s)return t.getGraphicFromIntersectorMetadata(s);if(\"getGraphicFromGraphicUid\"in t&&null!=s.graphicUid)return t.getGraphicFromGraphicUid(s.graphicUid);return null}(n,e):null}class intersectorUtils_F{constructor(t=0){this.offset=t,this.tmpVertex=Object(vec3f64[\"e\" /* c */])()}applyToVertex(t,s,r){const e=t+this.localOrigin[0],i=s+this.localOrigin[1],a=r+this.localOrigin[2],n=this.offset/Math.sqrt(e*e+i*i+a*a);return this.tmpVertex[0]=t+e*n,this.tmpVertex[1]=s+i*n,this.tmpVertex[2]=r+a*n,this.tmpVertex}applyToAabb(t){const s=t[0]+this.localOrigin[0],r=t[1]+this.localOrigin[1],e=t[2]+this.localOrigin[2],i=t[3]+this.localOrigin[0],a=t[4]+this.localOrigin[1],n=t[5]+this.localOrigin[2],h=this.offset/Math.sqrt(s*s+r*r+e*e);t[0]+=s*h,t[1]+=r*h,t[2]+=e*h;const o=this.offset/Math.sqrt(i*i+a*a+n*n);return t[3]+=i*o,t[4]+=a*o,t[5]+=n*o,t}}class intersectorUtils_P{constructor(t=0){this.offset=t,this.componentLocalOriginLength=0,this.tmpVertex=Object(vec3f64[\"e\" /* c */])(),this.mbs=Object(vec4f64[\"a\"])(),this.obb={center:Object(vec3f64[\"e\" /* c */])(),halfSize:Object(vec3f32[\"a\" /* c */])(),quaternion:null}}set localOrigin(t){this.componentLocalOriginLength=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}applyToVertex(t,s,r){const e=t,i=s,a=r+this.componentLocalOriginLength,n=this.offset/Math.sqrt(e*e+i*i+a*a);return this.tmpVertex[0]=t+e*n,this.tmpVertex[1]=s+i*n,this.tmpVertex[2]=r+a*n,this.tmpVertex}applyToAabb(t){const s=t[0],r=t[1],e=t[2]+this.componentLocalOriginLength,i=t[3],a=t[4],n=t[5]+this.componentLocalOriginLength,h=this.offset/Math.sqrt(s*s+r*r+e*e);t[0]+=s*h,t[1]+=r*h,t[2]+=e*h;const o=this.offset/Math.sqrt(i*i+a*a+n*n);return t[3]+=i*o,t[4]+=a*o,t[5]+=n*o,t}applyToMbs(t){const s=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=this.offset/s;return this.mbs[0]=t[0]+t[0]*r,this.mbs[1]=t[1]+t[1]*r,this.mbs[2]=t[2]+t[2]*r,this.mbs[3]=t[3]+t[3]*this.offset/s,this.mbs}applyToObb(t){const s=t.center,r=this.offset/Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);this.obb.center[0]=s[0]+s[0]*r,this.obb.center[1]=s[1]+s[1]*r,this.obb.center[2]=s[2]+s[2]*r,Object(vec3[\"q\"])(this.obb.halfSize,t.halfSize,t.quaternion),Object(vec3[\"c\" /* b */])(this.obb.halfSize,this.obb.halfSize,t.center);const e=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*e,this.obb.halfSize[1]+=this.obb.halfSize[1]*e,this.obb.halfSize[2]+=this.obb.halfSize[2]*e,Object(vec3[\"g\" /* f */])(this.obb.halfSize,this.obb.halfSize,t.center),Object(quat[\"a\" /* c */])(intersectorUtils_X,t.quaternion),Object(vec3[\"q\"])(this.obb.halfSize,this.obb.halfSize,intersectorUtils_X),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=t.quaternion,this.obb}}class intersectorUtils_N{constructor(t=0){this.offset=t,this.sphere=sphere_(),this.tmpVertex=Object(vec3f64[\"e\" /* c */])()}applyToVertex(t,s,r){const e=this.objectTransform.transform;let i=e[0]*t+e[4]*s+e[8]*r+e[12],a=e[1]*t+e[5]*s+e[9]*r+e[13],n=e[2]*t+e[6]*s+e[10]*r+e[14];const h=this.offset/Math.sqrt(i*i+a*a+n*n);i+=i*h,a+=a*h,n+=n*h;const o=this.objectTransform.inverse;return this.tmpVertex[0]=o[0]*i+o[4]*a+o[8]*n+o[12],this.tmpVertex[1]=o[1]*i+o[5]*a+o[9]*n+o[13],this.tmpVertex[2]=o[2]*i+o[6]*a+o[10]*n+o[14],this.tmpVertex}applyToMinMax(t,s){const r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*r,t[1]+=t[1]*r,t[2]+=t[2]*r;const e=this.offset/Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);s[0]+=s[0]*e,s[1]+=s[1]*e,s[2]+=s[2]*e}applyToAabb(t){const s=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*s,t[1]+=t[1]*s,t[2]+=t[2]*s;const r=this.offset/Math.sqrt(t[3]*t[3]+t[4]*t[4]+t[5]*t[5]);return t[3]+=t[3]*r,t[4]+=t[4]*r,t[5]+=t[5]*r,t}applyToBoundingSphere(t,s){const r=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]),e=this.offset/r;return this.sphere.center[0]=s[0]+s[0]*e,this.sphere.center[1]=s[1]+s[1]*e,this.sphere.center[2]=s[2]+s[2]*e,this.sphere.radius=t+t*this.offset/r,this.sphere}}const intersectorUtils_A=new intersectorUtils_N;function intersectorUtils_B(t){return Object(maybe[\"h\" /* isSome */])(t)?(intersectorUtils_A.offset=t,intersectorUtils_A):null}const intersectorUtils_D=new intersectorUtils_P;function intersectorUtils_C(t){return Object(maybe[\"h\" /* isSome */])(t)?(intersectorUtils_D.offset=t,intersectorUtils_D):null}const intersectorUtils_E=new intersectorUtils_F;function intersectorUtils_H(t){return Object(maybe[\"h\" /* isSome */])(t)?(intersectorUtils_E.offset=t,intersectorUtils_E):null}const intersectorUtils_J=\"terrain\",intersectorUtils_K=Object(vec3f64[\"e\" /* c */])(),intersectorUtils_Q=Object(vec3f64[\"e\" /* c */])(),intersectorUtils_W=Object(vec4f64[\"a\"])(),intersectorUtils_X=Object(quatf64[\"a\"])();\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DefaultTextureUnits.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst DefaultTextureUnits_S={DIFFUSE:0,NORMAL:1,EMISSION:2,OCCLUSION:3,METALLIC_ROUGHNESS:4,SSAO:6,SHADOW_MAP:7};\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/AutoDisposable.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst AutoDisposable_s=s=>class extends s{constructor(){super(...arguments),this._isDisposed=!1}dispose(){for(const e of null!=(s=this._managedDisposables)?s:[]){var s;const i=this[e];this[e]=null,i&&\"function\"==typeof i.dispose&&i.dispose()}this._isDisposed=!0}get isDisposed(){return this._isDisposed}};class AutoDisposable_e extends(AutoDisposable_s(class{})){}function AutoDisposable_i(){return(s,e)=>{var i,o;s.hasOwnProperty(\"_managedDisposables\")||(s._managedDisposables=null!=(i=null==(o=s._managedDisposables)?void 0:o.slice())?i:[]);s._managedDisposables.unshift(e)}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterial.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\n/* harmony default export */ var GLMaterial = (class extends AutoDisposable_e{constructor(e){super(),this.material=e.material,this.techniqueRep=e.techniqueRep,this.output=e.output}getTechnique(){return this.technique}getPipelineState(e,t){return this.getTechnique().pipeline}ensureResources(e){return 2}ensureParameters(e){}});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterialTexture.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\n/* harmony default export */ var GLMaterialTexture = (class extends GLMaterial{constructor(e){super(e),this._textureIDs=new Set,this._textureRepository=e.textureRep,this._textureId=e.textureId,this._initTransparent=!!e.initTextureTransparent,this._texture=this._acquireIfNotUndefined(this._textureId),this._textureNormal=this._acquireIfNotUndefined(e.normalTextureId),this._textureEmissive=this._acquireIfNotUndefined(e.emissiveTextureId),this._textureOcclusion=this._acquireIfNotUndefined(e.occlusionTextureId),this._textureMetallicRoughness=this._acquireIfNotUndefined(e.metallicRoughnessTextureId)}dispose(){this._textureIDs.forEach((e=>this._textureRepository.release(e))),this._textureIDs.clear()}updateTexture(e){e!==this._textureId&&(this._releaseIfNotUndefined(this._textureId),this._textureId=e,this._texture=this._acquireIfNotUndefined(this._textureId))}bindTexture(t,r){Object(maybe[\"h\" /* isSome */])(this._texture)&&(r.setUniform1i(\"tex\",DefaultTextureUnits_S.DIFFUSE),t.bindTexture(this._texture.glTexture,DefaultTextureUnits_S.DIFFUSE)),Object(maybe[\"h\" /* isSome */])(this._textureNormal)&&(r.setUniform1i(\"normalTexture\",DefaultTextureUnits_S.NORMAL),t.bindTexture(this._textureNormal.glTexture,DefaultTextureUnits_S.NORMAL)),Object(maybe[\"h\" /* isSome */])(this._textureEmissive)&&(r.setUniform1i(\"texEmission\",DefaultTextureUnits_S.EMISSION),t.bindTexture(this._textureEmissive.glTexture,DefaultTextureUnits_S.EMISSION)),Object(maybe[\"h\" /* isSome */])(this._textureOcclusion)&&(r.setUniform1i(\"texOcclusion\",DefaultTextureUnits_S.OCCLUSION),t.bindTexture(this._textureOcclusion.glTexture,DefaultTextureUnits_S.OCCLUSION)),Object(maybe[\"h\" /* isSome */])(this._textureMetallicRoughness)&&(r.setUniform1i(\"texMetallicRoughness\",DefaultTextureUnits_S.METALLIC_ROUGHNESS),t.bindTexture(this._textureMetallicRoughness.glTexture,DefaultTextureUnits_S.METALLIC_ROUGHNESS))}bindTextureScale(t,i){const r=Object(maybe[\"h\" /* isSome */])(this._texture)&&this._texture.glTexture;r&&r.descriptor.textureCoordinateScaleFactor?i.setUniform2fv(\"textureCoordinateScaleFactor\",r.descriptor.textureCoordinateScaleFactor):i.setUniform2f(\"textureCoordinateScaleFactor\",1,1)}_acquireIfNotUndefined(e){if(!Object(maybe[\"g\" /* isNone */])(e))return this._textureIDs.add(e),this._textureRepository.acquire(e,this._initTransparent)}_releaseIfNotUndefined(e){void 0!==e&&(this._textureIDs.delete(e),this._textureRepository.release(e))}});\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/MaterialUtil.js + 1 modules\nvar MaterialUtil = __webpack_require__(\"fFEv\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst DefaultVertexAttributeLocations_o={position:0,normal:1,uv0:2,color:3,size:4,tangent:4,uvMapSpace:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,instanceColor:7,bound1:5,bound2:6,bound3:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15};\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Material.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass Material_a{constructor(e,t,s){this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=DefaultVertexAttributeLocations_o,this.id=Material_a._idGen.gen(e),this._params=Object(MaterialUtil[\"c\" /* copyParameters */])(t,s),this.validateParameterValues(this._params)}dispose(){}get params(){return this._params}update(){return!1}setParameterValues(e){Object(MaterialUtil[\"e\" /* updateParameters */])(this._params,e)&&(this.validateParameterValues(this._params),this.parametersChanged())}validateParameterValues(){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}isVisibleInPass(e){return!0}get renderOccluded(){return this.params.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){Object(maybe[\"h\" /* isSome */])(this.materialRepository)&&this.materialRepository.materialChanged(this)}}function Material_n(e,r){return e.isVisible()&&e.isVisibleInPass(r.pass)&&0!=(e.renderOccluded&r.renderOccludedMask)}Material_a._idGen=new IdGen_t;const Material_d={renderOccluded:1};\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/bufferWriterUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction bufferWriterUtils_l(e,t,f,o,s){const n=f.typedBuffer,l=f.typedBufferStride,r=e.length;if(o*=l,null==s||1===s)for(let f=0;f<r;++f){const s=2*e[f];n[o]=t[s],n[o+1]=t[s+1],o+=l}else for(let f=0;f<r;++f){const r=2*e[f];for(let e=0;e<s;++e)n[o]=t[r],n[o+1]=t[r+1],o+=l}}function bufferWriterUtils_r(e,t,f,o,s){const n=f.typedBuffer,l=f.typedBufferStride,r=e.length;if(o*=l,null==s||1===s)for(let f=0;f<r;++f){const s=3*e[f];n[o]=t[s],n[o+1]=t[s+1],n[o+2]=t[s+2],o+=l}else for(let f=0;f<r;++f){const r=3*e[f];for(let e=0;e<s;++e)n[o]=t[r],n[o+1]=t[r+1],n[o+2]=t[r+2],o+=l}}function bufferWriterUtils_i(e,t,f,o,s){const n=f.typedBuffer,l=f.typedBufferStride,r=e.length;if(o*=l,null==s||1===s)for(let f=0;f<r;++f){const s=4*e[f];n[o]=t[s],n[o+1]=t[s+1],n[o+2]=t[s+2],n[o+3]=t[s+3],o+=l}else for(let f=0;f<r;++f){const r=4*e[f];for(let e=0;e<s;++e)n[o]=t[r],n[o+1]=t[r+1],n[o+2]=t[r+2],n[o+3]=t[r+3],o+=l}}function bufferWriterUtils_c(e,t,f,o){const s=f.typedBuffer,n=f.typedBufferStride,l=e.length;o*=n;for(let f=0;f<l;++f){const l=9*e[f];for(let e=0;e<9;++e)s[o+e]=t[l+e];o+=n}}function bufferWriterUtils_a(e,t,f,o){const s=f.typedBuffer,n=f.typedBufferStride,l=e.length;o*=n;for(let f=0;f<l;++f){const l=16*e[f];for(let e=0;e<16;++e)s[o+e]=t[l+e];o+=n}}function bufferWriterUtils_d(e,t,f,o,s,n){if(f){const l=f,r=o.typedBuffer,i=o.typedBufferStride,c=e.length;if(s*=i,null==n||1===n)for(let f=0;f<c;++f){const o=3*e[f],n=t[o],c=t[o+1],a=t[o+2];r[s]=l[0]*n+l[4]*c+l[8]*a+l[12],r[s+1]=l[1]*n+l[5]*c+l[9]*a+l[13],r[s+2]=l[2]*n+l[6]*c+l[10]*a+l[14],s+=i}else for(let f=0;f<c;++f){const o=3*e[f],c=t[o],a=t[o+1],d=t[o+2],u=l[0]*c+l[4]*a+l[8]*d+l[12],p=l[1]*c+l[5]*a+l[9]*d+l[13],B=l[2]*c+l[6]*a+l[10]*d+l[14];for(let e=0;e<n;++e)r[s]=u,r[s+1]=p,r[s+2]=B,s+=i}}else bufferWriterUtils_r(e,t,o,s,n)}function bufferWriterUtils_u(e,t,f,o,s,n){if(f){const l=f,r=o.typedBuffer,i=o.typedBufferStride,c=e.length,a=l[0],d=l[1],u=l[2],p=l[4],B=l[5],g=l[6],y=l[8],h=l[9],b=l[10],z=Math.abs(1-a*a+p*p+y*y)>1e-5||Math.abs(1-d*d+B*B+h*h)>1e-5||Math.abs(1-u*u+g*g+b*b)>1e-5;if(s*=i,null==n||1===n)for(let f=0;f<c;++f){const o=3*e[f],n=t[o],l=t[o+1],c=t[o+2];let O=a*n+p*l+y*c,S=d*n+B*l+h*c,N=u*n+g*l+b*c;if(z){const e=O*O+S*S+N*N;if(e<.999999&&e>1e-6){const t=Math.sqrt(e);O/=t,S/=t,N/=t}}r[s+0]=O,r[s+1]=S,r[s+2]=N,s+=i}else for(let f=0;f<c;++f){const o=3*e[f],l=t[o],c=t[o+1],O=t[o+2];let S=a*l+p*c+y*O,N=d*l+B*c+h*O,k=u*l+g*c+b*O;if(z){const e=S*S+N*N+k*k;if(e<.999999&&e>1e-6){const t=Math.sqrt(e);S/=t,N/=t,k/=t}}for(let e=0;e<n;++e)r[s+0]=S,r[s+1]=N,r[s+2]=k,s+=i}}else bufferWriterUtils_r(e,t,o,s,n)}function bufferWriterUtils_p(e,t,f,o,s,n){const l=o.typedBuffer,r=o.typedBufferStride,i=e.length;if(s*=r,null==n||1===n){if(4===f)for(let f=0;f<i;++f){const o=4*e[f];l[s]=t[o],l[s+1]=t[o+1],l[s+2]=t[o+2],l[s+3]=t[o+3],s+=r}else if(3===f)for(let f=0;f<i;++f){const o=3*e[f];l[s]=t[o],l[s+1]=t[o+1],l[s+2]=t[o+2],l[s+3]=255,s+=r}}else if(4===f)for(let f=0;f<i;++f){const o=4*e[f];for(let e=0;e<n;++e)l[s]=t[o],l[s+1]=t[o+1],l[s+2]=t[o+2],l[s+3]=t[o+3],s+=r}else if(3===f)for(let f=0;f<i;++f){const o=3*e[f];for(let e=0;e<n;++e)l[s]=t[o],l[s+1]=t[o+1],l[s+2]=t[o+2],l[s+3]=255,s+=r}}function bufferWriterUtils_B(e,t,f,o,s,n,l){const r=s.typedBuffer,i=s.typedBufferStride,c=e.length;if(n*=i,null==l||1===l){if(4===f)for(let f=0;f<c;++f){const s=4*e[f];r[n]=t[s]*o[0],r[n+1]=t[s+1]*o[1],r[n+2]=t[s+2]*o[2],r[n+3]=t[s+3]*o[3],n+=i}else if(3===f){const f=255*o[3];for(let s=0;s<c;++s){const l=3*e[s];r[n]=t[l]*o[0],r[n+1]=t[l+1]*o[1],r[n+2]=t[l+2]*o[2],r[n+3]=f,n+=i}}}else if(4===f)for(let f=0;f<c;++f){const s=4*e[f];for(let e=0;e<l;++e)r[n]=t[s]*o[0],r[n+1]=t[s+1]*o[1],r[n+2]=t[s+2]*o[2],r[n+3]=t[s+3]*o[3],n+=i}else if(3===f){const f=255*o[3];for(let s=0;s<c;++s){const c=3*e[s];for(let e=0;e<l;++e)r[n]=t[c]*o[0],r[n+1]=t[c+1]*o[1],r[n+2]=t[c+2]*o[2],r[n+3]=f,n+=i}}}function bufferWriterUtils_g(r,c,a,B,g,y){for(const h of c.fieldNames){const c=r.vertexAttr[h],b=r.indices[h];if(c&&b)switch(h){case Util[\"a\" /* VertexAttrConstants */].POSITION:{Object(Util[\"b\" /* assert */])(3===c.size);const e=g.getField(h,BufferView[\"u\" /* BufferViewVec3f */]);e&&bufferWriterUtils_d(b,c.data,a,e,y);break}case Util[\"a\" /* VertexAttrConstants */].NORMAL:{Object(Util[\"b\" /* assert */])(3===c.size);const e=g.getField(h,BufferView[\"u\" /* BufferViewVec3f */]);e&&bufferWriterUtils_u(b,c.data,B,e,y);break}case Util[\"a\" /* VertexAttrConstants */].UV0:{Object(Util[\"b\" /* assert */])(2===c.size);const e=g.getField(h,BufferView[\"m\" /* BufferViewVec2f */]);e&&bufferWriterUtils_l(b,c.data,e,y);break}case Util[\"a\" /* VertexAttrConstants */].UVMAPSPACE:{Object(Util[\"b\" /* assert */])(4===c.size);const t=g.getField(h,BufferView[\"C\" /* BufferViewVec4f */]);t&&bufferWriterUtils_i(b,c.data,t,y);break}case Util[\"a\" /* VertexAttrConstants */].MEANVERTEXPOSITION:{Object(Util[\"b\" /* assert */])(3===c.size);const e=g.getField(h,BufferView[\"u\" /* BufferViewVec3f */]);e&&bufferWriterUtils_d(b,c.data,a,e,y);break}case Util[\"a\" /* VertexAttrConstants */].BOUND1:case Util[\"a\" /* VertexAttrConstants */].BOUND2:case Util[\"a\" /* VertexAttrConstants */].BOUND3:{Object(Util[\"b\" /* assert */])(3===c.size);const e=g.getField(h,BufferView[\"u\" /* BufferViewVec3f */]);e&&bufferWriterUtils_d(b,c.data,a,e,y);break}case Util[\"a\" /* VertexAttrConstants */].COLOR:{Object(Util[\"b\" /* assert */])(3===c.size||4===c.size);const e=g.getField(h,BufferView[\"J\" /* BufferViewVec4u8 */]);e&&bufferWriterUtils_p(b,c.data,c.size,e,y);break}case Util[\"a\" /* VertexAttrConstants */].SYMBOLCOLOR:{Object(Util[\"b\" /* assert */])(3===c.size||4===c.size);const e=g.getField(h,BufferView[\"J\" /* BufferViewVec4u8 */]);e&&bufferWriterUtils_p(b,c.data,c.size,e,y);break}case Util[\"a\" /* VertexAttrConstants */].TANGENT:{Object(Util[\"b\" /* assert */])(4===c.size);const t=g.getField(h,BufferView[\"C\" /* BufferViewVec4f */]);t&&bufferWriterUtils_i(b,c.data,t,y);break}}}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\nvar AlphaDiscard_glsl = __webpack_require__(\"69UF\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/renderState.js\nvar renderState = __webpack_require__(\"GJyJ\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/OrderIndependentTransparency.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst OrderIndependentTransparency_u=Object(renderState[\"e\" /* separateBlendingParams */])(770,1,771,771),OrderIndependentTransparency_e=Object(renderState[\"f\" /* simpleBlendingParams */])(1,1),OrderIndependentTransparency_o=Object(renderState[\"f\" /* simpleBlendingParams */])(0,771);function OrderIndependentTransparency_c(n){return 2===n?null:1===n?OrderIndependentTransparency_o:OrderIndependentTransparency_e}function OrderIndependentTransparency_l(n){return 2===n?renderState[\"c\" /* defaultDepthWriteParams */]:null}const OrderIndependentTransparency_f=5e5,OrderIndependentTransparency_i={factor:-1,units:-2};function OrderIndependentTransparency_s(n){return n?OrderIndependentTransparency_i:null}function OrderIndependentTransparency_a(n){return 3===n||2===n?513:515}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"pO5D\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass ReloadableShaderModule_t{constructor(t,o){this._module=t,this._loadModule=o}get(){return this._module}async reload(){return this._module=await this._loadModule(),this._module}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass ShaderTechnique_i{constructor(i,r){r&&(this._config=r.snapshot()),this._program=this.initializeProgram(i),i.commonUniformStore&&(this._commonUniformStore=i.commonUniformStore,this._commonUniformStore.subscribeProgram(this._program)),this._pipeline=this.initializePipeline(i)}dispose(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),this._program=null)}reload(i){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose()),this._program=this.initializeProgram(i),this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)}get program(){return this._program}get pipeline(){return this._pipeline}get key(){return this._config.key}get configuration(){return this._config}bindPass(i,r,o){}bindMaterial(i,r,o){}bindDraw(i,r,o){}bindPipelineState(i){i.setPipelineState(this.pipeline)}ensureAttributeLocations(i){this.program.assertCompatibleVertexAttributeLocations(i)}get primitiveType(){return 4}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass ShaderTechniqueConfiguration_e{constructor(){this._key=\"\",this._keyDirty=!1,this._parameterBits=this._parameterBits.map((()=>0))}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){const t=this._parameterNames,e={key:this.key};for(const r of t)e[r]=this[r];return e}}function ShaderTechniqueConfiguration_r(e={}){return(r,s)=>{var a,i;r._parameterNames=null!=(a=r._parameterNames)?a:[],r._parameterNames.push(s);const o=r._parameterNames.length-1,h=e.count||2,n=Math.ceil(Object(mathUtils[\"h\" /* log2 */])(h)),m=null!=(i=r._parameterBits)?i:[0];let p=0;for(;m[p]+n>16;)p++,p>=m.length&&m.push(0);r._parameterBits=m;const _=m[p],y=(1<<n)-1<<_;m[p]+=n,Object.defineProperty(r,s,{get(){return this[o]},set(t){if(this[o]!==t&&(this[o]=t,this._keyDirty=!0,this._parameterBits[p]=this._parameterBits[p]&~y|+t<<_&y,\"number\"!=typeof t&&\"boolean\"!=typeof t))throw\"Configuration values must be booleans or numbers!\"}})}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/Program.js + 2 modules\nvar Program = __webpack_require__(\"jjdI\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat4f32.js\nvar mat4f32 = __webpack_require__(\"lwwL\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nvar View_glsl_o;!function(n){function o(n,o,t){Object(mat4[\"j\" /* t */])(View_glsl_r,t,o),n.setUniform3fv(\"localOrigin\",o),n.setUniformMatrix4fv(\"view\",View_glsl_r)}n.bindCamPosition=function(i,n,o){i.setUniform3f(\"camPos\",o[3]-n[0],o[7]-n[1],o[11]-n[2])},n.bindProjectionMatrix=function(i,n){i.setUniformMatrix4fv(\"proj\",n)},n.bindNearFar=function(i,n){i.setUniform2fv(\"nearFar\",n)},n.bindViewCustomOrigin=o,n.bindView=function(i,n){o(i,n.origin,n.camera.viewMatrix)},n.bindViewport=function(i,n){i.setUniform4fv(\"viewport\",n.camera.fullViewport)}}(View_glsl_o||(View_glsl_o={}));const View_glsl_r=Object(mat4f32[\"a\" /* c */])();\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\nvar Slice_glsl = __webpack_require__(\"0nJL\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\nvar OutputHighlight_glsl = __webpack_require__(\"agdK\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\nvar VisualVariables_glsl = __webpack_require__(\"viRi\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl.js + 1 modules\nvar VerticalOffset_glsl = __webpack_require__(\"F7CJ\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/StencilUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst StencilUtils_a={func:513},StencilUtils_n={func:519},StencilUtils_f={mask:255},StencilUtils_i={mask:0},StencilUtils_s=a=>({function:{func:517,ref:a,mask:a},operation:{fail:7680,zFail:7680,zPass:7680}}),StencilUtils_o=a=>({function:{func:519,ref:a,mask:a},operation:{fail:7680,zFail:7680,zPass:7681}}),StencilUtils_c={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},StencilUtils_t={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},StencilUtils_u={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},StencilUtils_e={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl.js\nvar ReadShadowMap_glsl = __webpack_require__(\"0BfS\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/DoublePrecision.glsl.js + 1 modules\nvar DoublePrecision_glsl = __webpack_require__(\"aiF/\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\nvar InstancedDoublePrecision_glsl = __webpack_require__(\"1TnO\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\nvar PhysicallyBasedRenderingParameters_glsl = __webpack_require__(\"p9cc\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/DefaultMaterial.glsl.js\nvar DefaultMaterial_glsl = __webpack_require__(\"AxBq\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/DefaultMaterialTechnique.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass DefaultMaterialTechnique_A extends ShaderTechnique_i{initializeProgram(e){const t=DefaultMaterialTechnique_A.shader.get(),i=this.configuration,r=t.build({OITEnabled:0===i.transparencyPassType,output:i.output,viewingMode:e.viewingMode,receiveShadows:i.receiveShadows,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:i.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:i.symbolColors,vvSize:i.vvSize,vvColor:i.vvColor,vvInstancingEnabled:!0,instanced:i.instanced,instancedColor:i.instancedColor,instancedDoublePrecision:i.instancedDoublePrecision,useOldSceneLightInterface:!1,pbrMode:i.usePBR?i.isSchematic?2:1:0,hasMetalnessAndRoughnessTexture:i.hasMetalnessAndRoughnessTexture,hasEmissionTexture:i.hasEmissionTexture,hasOcclusionTexture:i.hasOcclusionTexture,hasNormalTexture:i.hasNormalTexture,hasColorTexture:i.hasColorTexture,receiveAmbientOcclusion:i.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:i.normalsTypeDerivate?3:0,doubleSidedMode:i.doubleSidedMode,vertexTangets:i.vertexTangents,attributeTextureCoordinates:i.hasMetalnessAndRoughnessTexture||i.hasEmissionTexture||i.hasOcclusionTexture||i.hasNormalTexture||i.hasColorTexture?1:0,textureAlphaPremultiplied:i.textureAlphaPremultiplied,attributeColor:i.vertexColors,screenSizePerspectiveEnabled:i.screenSizePerspective,verticalOffsetEnabled:i.verticalOffset,offsetBackfaces:i.offsetBackfaces,doublePrecisionRequiresObfuscation:Object(DoublePrecision_glsl[\"b\" /* doublePrecisionRequiresObfuscation */])(e.rctx),alphaDiscardMode:i.alphaDiscardMode,supportsTextureAtlas:!1});return new Program[\"a\" /* default */](e.rctx,r.generateSource(\"vertex\"),r.generateSource(\"fragment\"),DefaultVertexAttributeLocations_o)}bindPass(e,t,i){View_glsl_o.bindProjectionMatrix(this.program,i.camera.projectionMatrix);const r=this.configuration.output;7===r&&(this.program.setUniform1f(\"opacity\",t.opacity),this.program.setUniform1f(\"layerOpacity\",t.layerOpacity),this.program.setUniform4fv(\"externalColor\",t.externalColor),this.program.setUniform1i(\"colorMixMode\",MaterialUtil[\"b\" /* colorMixModes */][t.colorMixMode])),0===r?(i.lighting.setUniforms(this.program,!1),this.program.setUniform3fv(\"ambient\",t.ambient),this.program.setUniform3fv(\"diffuse\",t.diffuse),this.program.setUniform4fv(\"externalColor\",t.externalColor),this.program.setUniform1i(\"colorMixMode\",MaterialUtil[\"b\" /* colorMixModes */][t.colorMixMode]),this.program.setUniform1f(\"opacity\",t.opacity),this.program.setUniform1f(\"layerOpacity\",t.layerOpacity),this.configuration.usePBR&&PhysicallyBasedRenderingParameters_glsl[\"a\" /* PhysicallyBasedRenderingParameters */].bindUniforms(this.program,t,this.configuration.isSchematic)):1===r||3===r?this.program.setUniform2fv(\"nearFar\",i.camera.nearFar):4===r&&OutputHighlight_glsl[\"a\" /* OutputHighlight */].bindOutputHighlight(e,this.program,i),VisualVariables_glsl[\"a\" /* VisualVariables */].bindUniformsForSymbols(this.program,t),VerticalOffset_glsl[\"a\" /* VerticalOffset */].bindUniforms(this.program,t,i),Object(MaterialUtil[\"a\" /* bindScreenSizePerspective */])(t.screenSizePerspective,this.program,\"screenSizePerspectiveAlignment\"),2!==t.textureAlphaMode&&3!==t.textureAlphaMode||this.program.setUniform1f(\"textureAlphaCutoff\",t.textureAlphaCutoff)}bindDraw(e){const i=this.configuration.instancedDoublePrecision?Object(vec3f64[\"g\" /* f */])(e.camera.viewInverseTransposeMatrix[3],e.camera.viewInverseTransposeMatrix[7],e.camera.viewInverseTransposeMatrix[11]):e.origin;View_glsl_o.bindViewCustomOrigin(this.program,i,e.camera.viewMatrix),(0===this.configuration.output||7===this.configuration.output||1===this.configuration.output&&this.configuration.screenSizePerspective||2===this.configuration.output&&this.configuration.screenSizePerspective||4===this.configuration.output&&this.configuration.screenSizePerspective)&&View_glsl_o.bindCamPosition(this.program,i,e.camera.viewInverseTransposeMatrix),2===this.configuration.output&&this.program.setUniformMatrix4fv(\"viewNormal\",e.camera.viewInverseTransposeMatrix),this.configuration.instancedDoublePrecision&&InstancedDoublePrecision_glsl[\"a\" /* InstancedDoublePrecision */].bindCustomOrigin(this.program,i),Slice_glsl[\"a\" /* Slice */].bindUniforms(this.program,this.configuration,e.slicePlane,i),0===this.configuration.output&&ReadShadowMap_glsl[\"a\" /* ReadShadowMap */].bindViewCustomOrigin(this.program,e,i)}setPipeline(e,t){const i=this.configuration,r=3===e,o=2===e;return Object(renderState[\"d\" /* makePipelineState */])({blending:0!==i.output&&7!==i.output||!i.transparent?null:r?OrderIndependentTransparency_u:OrderIndependentTransparency_c(e),culling:DefaultMaterialTechnique_U(i),depthTest:{func:OrderIndependentTransparency_a(e)},depthWrite:r||o?i.writeDepth&&renderState[\"c\" /* defaultDepthWriteParams */]:null,colorWrite:renderState[\"b\" /* defaultColorWriteParams */],stencilWrite:i.sceneHasOcludees?StencilUtils_f:null,stencilTest:i.sceneHasOcludees?t?StencilUtils_t:StencilUtils_c:null,polygonOffset:r||o?null:OrderIndependentTransparency_s(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipeline(this.configuration.transparencyPassType,!0),this.setPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}DefaultMaterialTechnique_A.shader=new ReloadableShaderModule_t(DefaultMaterial_glsl[\"a\" /* D */],(()=>__webpack_require__.e(/* import() */ 161).then(__webpack_require__.bind(null, \"SjXz\"))));const DefaultMaterialTechnique_U=e=>function(e){return e.cullFace?0!==e.cullFace:!e.slicePlaneEnabled&&!e.transparent&&!e.doubleSidedMode}(e)&&{face:1===e.cullFace?1028:1029,mode:2305};class DefaultMaterialTechnique_E extends ShaderTechniqueConfiguration_e{constructor(){super(...arguments),this.output=0,this.alphaDiscardMode=1,this.doubleSidedMode=0,this.isSchematic=!1,this.vertexColors=!1,this.offsetBackfaces=!1,this.symbolColors=!1,this.vvSize=!1,this.vvColor=!1,this.verticalOffset=!1,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.sliceHighlightDisabled=!1,this.receiveAmbientOcclusion=!1,this.screenSizePerspective=!1,this.textureAlphaPremultiplied=!1,this.hasColorTexture=!1,this.usePBR=!1,this.hasMetalnessAndRoughnessTexture=!1,this.hasEmissionTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1,this.instanced=!1,this.instancedColor=!1,this.instancedDoublePrecision=!1,this.vertexTangents=!1,this.normalsTypeDerivate=!1,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparent=!1,this.enableOffset=!0,this.cullFace=0,this.transparencyPassType=3}}Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r({count:8})],DefaultMaterialTechnique_E.prototype,\"output\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r({count:4})],DefaultMaterialTechnique_E.prototype,\"alphaDiscardMode\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r({count:3})],DefaultMaterialTechnique_E.prototype,\"doubleSidedMode\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"isSchematic\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"vertexColors\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"offsetBackfaces\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"symbolColors\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"vvSize\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"vvColor\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"verticalOffset\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"receiveShadows\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"slicePlaneEnabled\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"sliceHighlightDisabled\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"receiveAmbientOcclusion\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"screenSizePerspective\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"textureAlphaPremultiplied\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"hasColorTexture\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"usePBR\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"hasMetalnessAndRoughnessTexture\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"hasEmissionTexture\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"hasOcclusionTexture\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"hasNormalTexture\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"instanced\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"instancedColor\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"instancedDoublePrecision\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"vertexTangents\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"normalsTypeDerivate\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"writeDepth\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"sceneHasOcludees\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"transparent\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r()],DefaultMaterialTechnique_E.prototype,\"enableOffset\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r({count:3})],DefaultMaterialTechnique_E.prototype,\"cullFace\",void 0),Object(tslib_es6[\"a\" /* _ */])([ShaderTechniqueConfiguration_r({count:4})],DefaultMaterialTechnique_E.prototype,\"transparencyPassType\",void 0);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/RealisticTree.glsl.js\nvar RealisticTree_glsl = __webpack_require__(\"sKsC\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/RealisticTreeTechnique.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass RealisticTreeTechnique_a extends DefaultMaterialTechnique_A{initializeProgram(e){const i=RealisticTreeTechnique_a.shader.get(),o=this.configuration,l=i.build({OITEnabled:0===o.transparencyPassType,output:o.output,viewingMode:e.viewingMode,receiveShadows:o.receiveShadows,slicePlaneEnabled:o.slicePlaneEnabled,sliceHighlightDisabled:o.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:o.symbolColors,vvSize:o.vvSize,vvColor:o.vvColor,vvInstancingEnabled:!0,instanced:o.instanced,instancedColor:o.instancedColor,instancedDoublePrecision:o.instancedDoublePrecision,useOldSceneLightInterface:!1,pbrMode:o.usePBR?1:0,hasMetalnessAndRoughnessTexture:!1,hasEmissionTexture:!1,hasOcclusionTexture:!1,hasNormalTexture:!1,hasColorTexture:o.hasColorTexture,receiveAmbientOcclusion:o.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:0,doubleSidedMode:2,vertexTangets:!1,attributeTextureCoordinates:o.hasColorTexture?1:0,textureAlphaPremultiplied:o.textureAlphaPremultiplied,attributeColor:o.vertexColors,screenSizePerspectiveEnabled:o.screenSizePerspective,verticalOffsetEnabled:o.verticalOffset,offsetBackfaces:o.offsetBackfaces,doublePrecisionRequiresObfuscation:Object(DoublePrecision_glsl[\"b\" /* doublePrecisionRequiresObfuscation */])(e.rctx),alphaDiscardMode:o.alphaDiscardMode,supportsTextureAtlas:!1});return new Program[\"a\" /* default */](e.rctx,l.generateSource(\"vertex\"),l.generateSource(\"fragment\"),DefaultVertexAttributeLocations_o)}}RealisticTreeTechnique_a.shader=new ReloadableShaderModule_t(RealisticTree_glsl[\"a\" /* R */],(()=>__webpack_require__.e(/* import() */ 159).then(__webpack_require__.bind(null, \"FmK6\"))));\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultMaterial.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass DefaultMaterial_y extends Material_a{constructor(e,t){super(t,e,DefaultMaterial_M),this.supportsEdges=!0,this.techniqueConfig=new DefaultMaterialTechnique_E,this.vertexBufferLayout=DefaultMaterial_y.getVertexBufferLayout(this.params),this.instanceBufferLayout=e.instanced?DefaultMaterial_y.getInstanceBufferLayout(this.params):null}isVisibleInPass(e){return 4!==e||this.params.castShadows}isVisible(){const e=this.params;if(!super.isVisible()||0===e.layerOpacity)return!1;const t=e.instanced,i=e.vertexColors,s=e.symbolColors,a=!!t&&t.indexOf(\"color\")>-1,r=e.vvColorEnabled,n=\"replace\"===e.colorMixMode,o=e.opacity>0,l=e.externalColor&&e.externalColor[3]>0;return i&&(a||r||s)?!!n||o:i?n?l:o:a||r||s?!!n||o:n?l:o}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.hasNormalTexture=!!this.params.normalTextureId,this.techniqueConfig.hasColorTexture=!!this.params.textureId,this.techniqueConfig.vertexTangents=this.params.vertexTangents,this.techniqueConfig.instanced=!!this.params.instanced,this.techniqueConfig.instancedDoublePrecision=this.params.instancedDoublePrecision,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.verticalOffset=null!==this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=null!==this.params.screenSizePerspective,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sliceHighlightDisabled=this.params.sliceHighlightDisabled,this.techniqueConfig.alphaDiscardMode=this.params.textureAlphaMode,this.techniqueConfig.normalsTypeDerivate=\"screenDerivative\"===this.params.normals,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.cullFace=null!=this.params.cullFace?this.params.cullFace:0,0!==e&&7!==e||(this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.symbolColors=this.params.symbolColors,this.params.treeRendering?this.techniqueConfig.doubleSidedMode=2:this.techniqueConfig.doubleSidedMode=this.params.doubleSided&&\"normal\"===this.params.doubleSidedType?1:this.params.doubleSided&&\"winding-order\"===this.params.doubleSidedType?2:0,this.techniqueConfig.instancedColor=!!this.params.instanced&&this.params.instanced.indexOf(\"color\")>-1,this.techniqueConfig.receiveShadows=this.params.receiveShadows&&this.params.shadowMappingEnabled,this.techniqueConfig.receiveAmbientOcclusion=this.params.receiveSSAO,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.textureAlphaPremultiplied=!!this.params.textureAlphaPremultiplied,this.techniqueConfig.usePBR=this.params.usePBR,this.techniqueConfig.hasMetalnessAndRoughnessTexture=!!this.params.metallicRoughnessTextureId,this.techniqueConfig.hasEmissionTexture=!!this.params.emissiveTextureId,this.techniqueConfig.hasOcclusionTexture=!!this.params.occlusionTextureId,this.techniqueConfig.offsetBackfaces=!(!this.params.transparent||!this.params.offsetTransparentBackfaces),this.techniqueConfig.isSchematic=this.params.usePBR&&this.params.isSchematic,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<OrderIndependentTransparency_f),this.techniqueConfig}intersect(e,t,c,h,d,v,g){if(null!==this.params.verticalOffset){const e=h.camera;Object(vec3[\"r\" /* s */])(DefaultMaterial_A,c[12],c[13],c[14]);let t=null;switch(h.viewingMode){case 1:t=Object(vec3[\"o\" /* n */])(DefaultMaterial_L,DefaultMaterial_A);break;case 2:t=Object(vec3[\"h\" /* g */])(DefaultMaterial_L,DefaultMaterial_E)}let p=0;if(null!==this.params.verticalOffset){const i=Object(vec3[\"g\" /* f */])(DefaultMaterial_D,DefaultMaterial_A,e.eye),s=Object(vec3[\"m\" /* l */])(i),a=Object(vec3[\"b\" /* a */])(i,i,1/s);let u=null;this.params.screenSizePerspective&&(u=Object(vec3[\"e\" /* d */])(t,a)),p+=Object(MaterialUtil[\"f\" /* verticalOffsetAtDistance */])(e,s,this.params.verticalOffset,u,this.params.screenSizePerspective)}Object(vec3[\"b\" /* a */])(t,t,p),Object(vec3[\"s\" /* t */])(DefaultMaterial_R,t,h.transform.inverseRotation),d=Object(vec3[\"g\" /* f */])(DefaultMaterial_B,d,DefaultMaterial_R),v=Object(vec3[\"g\" /* f */])(DefaultMaterial_I,v,DefaultMaterial_R)}Object(MaterialUtil[\"d\" /* intersectTriangleGeometry */])(e,t,h,d,v,intersectorUtils_B(h.verticalOffset),g)}getGLMaterial(e){if(0===e.output||7===e.output||1===e.output||2===e.output||3===e.output||4===e.output)return new DefaultMaterial_P(e)}createBufferWriter(){return new DefaultMaterial_w(this.vertexBufferLayout,this.instanceBufferLayout)}static getVertexBufferLayout(e){const t=e.textureId||e.normalTextureId||e.metallicRoughnessTextureId||e.emissiveTextureId||e.occlusionTextureId,i=Object(InterleavedLayout[\"a\" /* newLayout */])().vec3f(\"position\").vec3f(\"normal\");return e.vertexTangents&&i.vec4f(\"tangent\"),t&&i.vec2f(\"uv0\"),e.vertexColors&&i.vec4u8(\"color\"),e.symbolColors&&i.vec4u8(\"symbolColor\"),i}static getInstanceBufferLayout(e){let t=Object(InterleavedLayout[\"a\" /* newLayout */])();return t=e.instancedDoublePrecision?t.vec3f(\"modelOriginHi\").vec3f(\"modelOriginLo\").mat3f(\"model\").mat3f(\"modelNormal\"):t.mat4f(\"model\").mat4f(\"modelNormal\"),e.instanced&&e.instanced.indexOf(\"color\")>-1&&(t=t.vec4f(\"instanceColor\")),e.instanced&&e.instanced.indexOf(\"featureAttribute\")>-1&&(t=t.vec4f(\"instanceFeatureAttribute\")),t}}class DefaultMaterial_P extends GLMaterialTexture{constructor(e){const t=e.material;super({...e,...t.params}),this.updateParameters()}updateParameters(e){const t=this.material.params;this.updateTexture(t.textureId),this.technique=t.treeRendering?this.techniqueRep.acquireAndReleaseExisting(RealisticTreeTechnique_a,this.material.getTechniqueConfig(this.output,e),this.technique):this.techniqueRep.acquireAndReleaseExisting(DefaultMaterialTechnique_A,this.material.getTechniqueConfig(this.output,e),this.technique)}selectPipelines(){}_updateShadowState(e){e.shadowMappingEnabled!==this.material.params.shadowMappingEnabled&&this.material.setParameterValues({shadowMappingEnabled:e.shadowMappingEnabled})}_updateOccludeeState(e){e.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:e.hasOccludees})}ensureParameters(e){0!==this.output&&7!==this.output||(this._updateShadowState(e),this._updateOccludeeState(e)),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.params,t),this.bindTexture(e,this.technique.program)}beginSlot(e){return e===(this.material.params.transparent?this.material.params.writeDepth?5:8:3)}getPipelineState(e,t){return this.technique.getPipelineState(t)}}const DefaultMaterial_O=2.1,DefaultMaterial_M={textureId:void 0,initTextureTransparent:!1,isSchematic:!1,usePBR:!1,normalTextureId:void 0,vertexTangents:!1,occlusionTextureId:void 0,emissiveTextureId:void 0,metallicRoughnessTextureId:void 0,emissiveFactor:[0,0,0],mrrFactors:[0,1,.5],ambient:[.2,.2,.2],diffuse:[.8,.8,.8],externalColor:[1,1,1,1],colorMixMode:\"multiply\",opacity:1,layerOpacity:1,vertexColors:!1,symbolColors:!1,doubleSided:!1,doubleSidedType:\"normal\",cullFace:void 0,instanced:void 0,instancedDoublePrecision:!1,normals:\"default\",receiveSSAO:!0,receiveShadows:!0,castShadows:!0,shadowMappingEnabled:!1,verticalOffset:null,screenSizePerspective:null,slicePlaneEnabled:!1,sliceHighlightDisabled:!1,offsetTransparentBackfaces:!1,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvSizeValue:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:Object(mat3f64[\"a\"])(),transparent:!1,writeDepth:!0,textureAlphaMode:0,textureAlphaCutoff:AlphaDiscard_glsl[\"b\" /* defaultMaskAlphaCutoff */],textureAlphaPremultiplied:!1,sceneHasOcludees:!1,...Material_d};class DefaultMaterial_w{constructor(e,t){this.vertexBufferLayout=e,this.instanceBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.position.length}write(e,t,i,s){bufferWriterUtils_g(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,s)}}const DefaultMaterial_B=Object(vec3f64[\"e\" /* c */])(),DefaultMaterial_I=Object(vec3f64[\"e\" /* c */])(),DefaultMaterial_E=Object(vec3f64[\"g\" /* f */])(0,0,1),DefaultMaterial_L=Object(vec3f64[\"e\" /* c */])(),DefaultMaterial_R=Object(vec3f64[\"e\" /* c */])(),DefaultMaterial_A=Object(vec3f64[\"e\" /* c */])(),DefaultMaterial_D=Object(vec3f64[\"e\" /* c */])();\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/compilerUtils.js\nvar compilerUtils = __webpack_require__(\"bJda\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/typedArrayUtil.js\nvar typedArrayUtil = __webpack_require__(\"ohva\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Error.js\nvar Error = __webpack_require__(\"zlDU\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/urlUtils.js\nvar urlUtils = __webpack_require__(\"4EHJ\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/promiseUtils.js\nvar promiseUtils = __webpack_require__(\"9MzC\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Evented.js\nvar Evented = __webpack_require__(\"zm0L\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/support/requestUtils.js\nvar requestUtils = __webpack_require__(\"Ioo4\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/support/requestImageUtils.js\nvar requestImageUtils = __webpack_require__(\"LbAs\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/Texture.js\nvar Texture = __webpack_require__(\"of9L\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/Util.js\nvar webgl_Util = __webpack_require__(\"hTmG\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/BufferObject.js\nvar BufferObject = __webpack_require__(\"fOQB\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/VertexArrayObject.js\nvar VertexArrayObject = __webpack_require__(\"D6bk\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst DefaultVertexBufferLayouts_e=[{name:\"position\",count:3,type:5126,offset:0,stride:12,normalized:!1}],DefaultVertexBufferLayouts_t=[{name:\"position\",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:\"uv0\",count:2,type:5126,offset:12,stride:20,normalized:!1}],DefaultVertexBufferLayouts_o=[{name:\"position\",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:\"normal\",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:\"uv0\",count:2,type:5126,offset:24,stride:32,normalized:!1}],DefaultVertexBufferLayouts_n=[{name:\"position\",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:\"color\",count:4,type:5121,offset:12,stride:16,normalized:!1}],DefaultVertexBufferLayouts_i=[{name:\"position\",count:2,type:5126,offset:0,stride:8,normalized:!1}],DefaultVertexBufferLayouts_s=[{name:\"position\",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:\"uv0\",count:2,type:5126,offset:8,stride:16,normalized:!1}];\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/glUtil3D.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction glUtil3D_i(r,i=DefaultVertexBufferLayouts_i,l=DefaultVertexAttributeLocations_o,m=-1,f=1){let u=null;switch(i){case DefaultVertexBufferLayouts_s:u=new Float32Array([m,m,0,0,f,m,1,0,m,f,0,1,f,f,1,1]);break;case DefaultVertexBufferLayouts_i:default:u=new Float32Array([m,m,f,m,m,f,f,f])}return new VertexArrayObject[\"a\" /* default */](r,l,{geometry:i},{geometry:BufferObject[\"a\" /* default */].createVertex(r,35044,u)})}function glUtil3D_l(e,t=4){return new Texture[\"a\" /* default */](e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:t,height:t})}function glUtil3D_m(e,t,a=4){const o=new Uint8Array(a*a*4);for(let e=0;e<o.length;e+=4)o[e+0]=255*t[0],o[e+1]=255*t[1],o[e+2]=255*t[2],o[e+3]=255*t[3];return new Texture[\"a\" /* default */](e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:a,height:a},o)}function glUtil3D_f(e){return new Texture[\"a\" /* default */](e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/FramebufferObject.js\nvar FramebufferObject = __webpack_require__(\"0meK\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/webgl/capabilities/isWebGL2Context.js\nvar isWebGL2Context = __webpack_require__(\"xRQN\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DDSUtil.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst DDSUtil_n=Logger[\"a\" /* default */].getLogger(\"esri.views.3d.webgl-engine.lib.DDSUtil\");function DDSUtil_o(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}const DDSUtil_a=DDSUtil_o(\"DXT1\"),DDSUtil_i=DDSUtil_o(\"DXT3\"),DDSUtil_s=DDSUtil_o(\"DXT5\");function DDSUtil_l(e,t,n,o){const{textureData:a,internalFormat:i,width:s,height:l}=DDSUtil_u(n,o);t.samplingMode=a.levels.length>1?9987:9729,t.hasMipmap=a.levels.length>1,t.internalFormat=i,t.width=s,t.height=l;const c=new Texture[\"a\" /* default */](e,t,a);return e.bindTexture(c,0),c}function DDSUtil_u(e,r){const o=new Int32Array(e,0,31);if(542327876!==o[0])return DDSUtil_n.error(\"Invalid magic number in DDS header\"),null;if(!(4&o[20]))return DDSUtil_n.error(\"Unsupported format, must contain a FourCC code\"),null;const l=o[21];let u,c;switch(l){case DDSUtil_a:u=8,c=33776;break;case DDSUtil_i:u=16,c=33778;break;case DDSUtil_s:u=16,c=33779;break;default:return DDSUtil_n.error(\"Unsupported FourCC code:\",(m=l,String.fromCharCode(255&m,m>>8&255,m>>16&255,m>>24&255))),null}var m;let h=1,d=o[4],p=o[3];0==(3&d)&&0==(3&p)||(DDSUtil_n.warn(\"Rounding up compressed texture size to nearest multiple of 4.\"),d=d+3&-4,p=p+3&-4);const g=d,f=p;let w,x;131072&o[2]&&!1!==r&&(h=Math.max(1,o[7])),1===h||Object(mathUtils[\"f\" /* isPowerOfTwo */])(d)&&Object(mathUtils[\"f\" /* isPowerOfTwo */])(p)||(DDSUtil_n.warn(\"Ignoring mipmaps of non power of two sized compressed texture.\"),h=1);let C=o[1]+4;const D=[];for(let t=0;t<h;++t)x=(d+3>>2)*(p+3>>2)*u,w=new Uint8Array(e,C,x),D.push(w),C+=x,d=Math.max(1,d>>1),p=Math.max(1,p>>1);return{textureData:{type:\"compressed\",levels:D},internalFormat:c,width:g,height:f}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Texture.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass Texture_E{constructor(e,t,r){this.data=e,this.glTexture=null,this.powerOfTwoStretchInfo=null,this.loadingPromise=null,this.loadingController=null,this.events=new Evented[\"a\" /* default */],this.data=e,this.id=Texture_E.idGen.gen(t),this.params=r||{},this.params.mipmap=!1!==this.params.mipmap,this.params.noUnpackFlip=this.params.noUnpackFlip||!1,this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1,this.params.wrap=this.params.wrap||{s:10497,t:10497},this.params.powerOfTwoResizeMode=this.params.powerOfTwoResizeMode||1,this.estimatedTexMemRequired=Texture_E.estimateTexMemRequired(this.data,this.params),this.startPreload()}startPreload(){const e=this.data;Object(maybe[\"g\" /* isNone */])(e)||(e instanceof HTMLVideoElement?this.startPreloadVideoElement(e):e instanceof HTMLImageElement&&this.startPreloadImageElement(e))}startPreloadVideoElement(e){Object(urlUtils[\"t\" /* isBlobProtocol */])(e.src)||\"auto\"===e.preload&&e.crossOrigin||(e.preload=\"auto\",e.crossOrigin=\"anonymous\",e.src=e.src)}startPreloadImageElement(e){Object(urlUtils[\"u\" /* isDataProtocol */])(e.src)||Object(urlUtils[\"t\" /* isBlobProtocol */])(e.src)||e.crossOrigin||(e.crossOrigin=\"anonymous\",e.src=e.src)}static getDataDimensions(e){return e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e}static estimateTexMemRequired(e,s){if(Object(maybe[\"g\" /* isNone */])(e))return 0;if(Object(typedArrayUtil[\"c\" /* isArrayBuffer */])(e)||Object(typedArrayUtil[\"k\" /* isUint8Array */])(e))return e.byteLength;const{width:a,height:o}=e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement?Texture_E.getDataDimensions(e):s;return(s.mipmap?4/3:1)*a*o*(s.components||4)||0}dispose(){this.data=void 0}get width(){return this.params.width}get height(){return this.params.height}createDescriptor(e){const t=this.params.mipmap&&!this.params.disableAnisotropy;return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:t?e.parameters.maxMaxAnisotropy:void 0}}load(e,a){if(Object(maybe[\"h\" /* isSome */])(this.glTexture))return this.glTexture;if(Object(maybe[\"h\" /* isSome */])(this.loadingPromise))return this.loadingPromise;const o=this.data;return Object(maybe[\"g\" /* isNone */])(o)?(this.glTexture=new Texture[\"a\" /* default */](e,this.createDescriptor(e),null),e.bindTexture(this.glTexture,0),this.glTexture):\"string\"==typeof o?this.loadFromURL(e,a,o):o instanceof Image?this.loadFromImageElement(e,a,o):o instanceof HTMLVideoElement?this.loadFromVideoElement(e,a,o):o instanceof ImageData||o instanceof HTMLCanvasElement?this.loadFromImage(e,o,a):(Object(typedArrayUtil[\"c\" /* isArrayBuffer */])(o)||Object(typedArrayUtil[\"k\" /* isUint8Array */])(o))&&this.params.encoding===Texture_E.DDS_ENCODING?this.loadFromDDSData(e,o):Object(typedArrayUtil[\"k\" /* isUint8Array */])(o)?this.loadFromPixelData(e,o):Object(typedArrayUtil[\"c\" /* isArrayBuffer */])(o)?this.loadFromPixelData(e,new Uint8Array(o)):null}get requiresFrameUpdates(){return this.data instanceof HTMLVideoElement}frameUpdate(e,t,r){if(!(this.data instanceof HTMLVideoElement)||Object(maybe[\"g\" /* isNone */])(this.glTexture))return r;if(this.data.readyState<2||r===this.data.currentTime)return r;if(Object(maybe[\"h\" /* isSome */])(this.powerOfTwoStretchInfo)){const{framebuffer:r,vao:i,sourceTexture:s}=this.powerOfTwoStretchInfo;s.setData(this.data),this.drawStretchedTexture(e,t,r,i,s,this.glTexture)}else{const{width:e,height:t}=this.data,{width:r,height:i}=this.glTexture.descriptor;e!==r||t!==i?this.glTexture.updateData(0,0,0,Math.min(e,r),Math.min(t,i),this.data):this.glTexture.setData(this.data)}return this.glTexture.descriptor.hasMipmap&&this.glTexture.generateMipmap(),this.data.currentTime}loadFromDDSData(e,t){return this.glTexture=DDSUtil_l(e,this.createDescriptor(e),t,this.params.mipmap),e.bindTexture(this.glTexture,0),this.glTexture}loadFromPixelData(e,t){Object(Util[\"b\" /* assert */])(this.params.width>0&&this.params.height>0);const r=this.createDescriptor(e);return r.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408,r.width=this.params.width,r.height=this.params.height,this.glTexture=new Texture[\"a\" /* default */](e,r,t),e.bindTexture(this.glTexture,0),this.glTexture}async loadAsync(e){const t=Object(promiseUtils[\"d\" /* createAbortController */])();this.loadingController=t;const r=e(t.signal);this.loadingPromise=r;const i=()=>{this.loadingController===t&&(this.loadingController=null),this.loadingPromise===r&&(this.loadingPromise=null)};return r.then(i,i),r}loadFromURL(e,t,r){return this.loadAsync((async i=>{const s=await Object(requestImageUtils[\"a\" /* requestImage */])(r,{signal:i});return this.loadFromImage(e,s,t)}))}loadFromImageElement(e,t,r){return r.complete?this.loadFromImage(e,r,t):this.loadAsync((async i=>{const s=await Object(requestUtils[\"a\" /* loadImageAsync */])(r,r.src,!1,i);return this.loadFromImage(e,s,t)}))}loadFromVideoElement(e,t,r){return r.readyState>=2?this.loadFromImage(e,r,t):this.loadFromVideoElementAsync(e,t,r)}loadFromVideoElementAsync(e,t,r){return this.loadAsync((i=>Object(promiseUtils[\"c\" /* create */])(((o,n)=>{const h=()=>{r.removeEventListener(\"loadeddata\",l),r.removeEventListener(\"error\",d),Object(maybe[\"h\" /* isSome */])(u)&&u.remove()},l=()=>{r.readyState>=2&&(h(),o(this.loadFromImage(e,r,t)))},d=e=>{h(),n(e||new Error[\"a\" /* default */](\"Failed to load video\"))};r.addEventListener(\"loadeddata\",l),r.addEventListener(\"error\",d);const u=Object(promiseUtils[\"r\" /* onAbort */])(i,(()=>d(Object(promiseUtils[\"e\" /* createAbortError */])())))}))))}loadFromImage(e,t,r){const i=Texture_E.getDataDimensions(t);this.params.width=i.width,this.params.height=i.height;const s=this.createDescriptor(e);return s.pixelFormat=3===this.params.components?6407:6408,!this.requiresPowerOfTwo(e,s)||Object(mathUtils[\"f\" /* isPowerOfTwo */])(i.width)&&Object(mathUtils[\"f\" /* isPowerOfTwo */])(i.height)?(s.width=i.width,s.height=i.height,this.glTexture=new Texture[\"a\" /* default */](e,s,t),e.bindTexture(this.glTexture,0),this.glTexture):(this.glTexture=this.makePowerOfTwoTexture(e,t,i,s,r),e.bindTexture(this.glTexture,0),this.glTexture)}requiresPowerOfTwo(e,t){const r=33071,i=\"number\"==typeof t.wrapMode?t.wrapMode===r:t.wrapMode.s===r&&t.wrapMode.t===r;return!Object(isWebGL2Context[\"a\" /* default */])(e.gl)&&(t.hasMipmap||!i)}makePowerOfTwoTexture(t,r,i,s,a){const{width:o,height:n}=i,h=Object(mathUtils[\"i\" /* nextHighestPowerOfTwo */])(o),l=Object(mathUtils[\"i\" /* nextHighestPowerOfTwo */])(n);let m;switch(s.width=h,s.height=l,this.params.powerOfTwoResizeMode){case 2:s.textureCoordinateScaleFactor=[o/h,n/l],m=new Texture[\"a\" /* default */](t,s),m.updateData(0,0,0,o,n,r);break;case 1:case null:case void 0:m=this.stretchToPowerOfTwo(t,r,s,a);break;default:Object(compilerUtils[\"a\" /* neverReached */])(this.params.powerOfTwoResizeMode)}return s.hasMipmap&&m.generateMipmap(),m}stretchToPowerOfTwo(e,t,r,i){const s=new Texture[\"a\" /* default */](e,r),a=new FramebufferObject[\"a\" /* default */](e,{colorTarget:0,depthStencilTarget:0},s),o=new Texture[\"a\" /* default */](e,{target:3553,pixelFormat:r.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!r.flipped,maxAnisotropy:8,preMultiplyAlpha:r.preMultiplyAlpha},t),n=glUtil3D_i(e);return this.drawStretchedTexture(e,i,a,n,o,s),this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:n,sourceTexture:o,framebuffer:a}:(n.dispose(!0),o.dispose(),a.detachColorTexture(),e.bindFramebuffer(null),a.dispose()),s}drawStretchedTexture(e,t,r,i,s,a){e.bindFramebuffer(r);const o=e.getViewport();e.setViewport(0,0,a.descriptor.width,a.descriptor.height);const n=t.program;e.bindProgram(n),n.setUniform4f(\"color\",1,1,1,1),n.setUniform1i(\"tex\",0),e.bindTexture(s,0),e.bindVAO(i),e.setPipelineState(t.pipeline),e.drawArrays(5,0,Object(webgl_Util[\"c\" /* vertexCount */])(i,\"geometry\")),e.bindFramebuffer(null),e.setViewport(o.x,o.y,o.width,o.height)}unload(){if(Object(maybe[\"h\" /* isSome */])(this.powerOfTwoStretchInfo)){const{framebuffer:e,vao:t,sourceTexture:r}=this.powerOfTwoStretchInfo;t.dispose(!0),r.dispose(),e.dispose(),this.glTexture=null,this.powerOfTwoStretchInfo=null}if(Object(maybe[\"h\" /* isSome */])(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null),Object(maybe[\"h\" /* isSome */])(this.loadingController)){const e=this.loadingController;this.loadingController=null,this.loadingPromise=null,e.abort()}this.events.emit(\"unloaded\")}}Texture_E.idGen=new IdGen_t,Texture_E.DDS_ENCODING=\"image/vnd-ms.dds\";/* harmony default export */ var lib_Texture = (Texture_E);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/request.js\nvar request = __webpack_require__(\"Lqtk\");\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/asyncUtils.js\nvar asyncUtils = __webpack_require__(\"eSsm\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/DefaultLoadingContext.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass DefaultLoadingContext_n{constructor(r){this.streamDataRequester=r}async loadJSON(r,e){return this.load(\"json\",r,e)}async loadBinary(r,e){return Object(urlUtils[\"u\" /* isDataProtocol */])(r)?(Object(promiseUtils[\"w\" /* throwIfAborted */])(e),Object(urlUtils[\"j\" /* dataToArrayBuffer */])(r)):this.load(\"binary\",r,e)}async loadImage(r,e){return this.load(\"image\",r,e)}async load(o,s,t){if(Object(maybe[\"g\" /* isNone */])(this.streamDataRequester))return(await Object(request[\"default\"])(s,{responseType:DefaultLoadingContext_c[o]})).data;const n=await Object(asyncUtils[\"c\" /* result */])(this.streamDataRequester.request(s,o,t));if(!0===n.ok)return n.value;throw Object(promiseUtils[\"v\" /* throwIfAbortError */])(n.error),new Error[\"a\" /* default */](\"\",`Request for resource failed: ${n.error}`)}}const DefaultLoadingContext_c={image:\"image\",binary:\"array-buffer\",json:\"json\"};\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/support/buffer/types.js\nvar types = __webpack_require__(\"grla\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/vec22.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction vec22_f(e,t,r){const f=e.typedBuffer,n=e.typedBufferStride,d=t.typedBuffer,o=t.typedBufferStride,s=r?r.count:t.count;let u=(r&&r.dstIndex?r.dstIndex:0)*n,p=(r&&r.srcIndex?r.srcIndex:0)*o;for(let e=0;e<s;++e)f[u]=d[p],f[u+1]=d[p+1],u+=n,p+=o}function vec22_n(n,d,o){const s=n.typedBuffer,u=n.typedBufferStride,p=d.typedBuffer,c=d.typedBufferStride,l=o?o.count:d.count;let y=(o&&o.dstIndex?o.dstIndex:0)*u,i=(o&&o.srcIndex?o.srcIndex:0)*c;if(Object(types[\"b\" /* isInteger */])(d.elementType)){const e=Object(types[\"d\" /* maximumValue */])(d.elementType);if(Object(types[\"c\" /* isSigned */])(d.elementType))for(let t=0;t<l;++t)s[y]=Math.max(p[i]/e,-1),s[y+1]=Math.max(p[i+1]/e,-1),y+=u,i+=c;else for(let t=0;t<l;++t)s[y]=p[i]/e,s[y+1]=p[i+1]/e,y+=u,i+=c}else vec22_f(n,d,o);return n}var vec22_d=Object.freeze({__proto__:null,copy:vec22_f,normalizeIntegerBuffer:vec22_n});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/vec33.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction vec33_e(e,t,r){const d=e.typedBuffer,f=e.typedBufferStride,n=t.typedBuffer,c=t.typedBufferStride,o=r?r.count:t.count;let u=(r&&r.dstIndex?r.dstIndex:0)*f,p=(r&&r.srcIndex?r.srcIndex:0)*c;for(let e=0;e<o;++e)d[u]=n[p],d[u+1]=n[p+1],d[u+2]=n[p+2],u+=f,p+=c}var vec33_t=Object.freeze({__proto__:null,copy:vec33_e});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/vec43.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction vec43_e(e,t,d){const f=e.typedBuffer,n=e.typedBufferStride,r=t.typedBuffer,o=t.typedBufferStride,c=d?d.count:t.count;let u=(d&&d.dstIndex?d.dstIndex:0)*n,s=(d&&d.srcIndex?d.srcIndex:0)*o;for(let e=0;e<c;++e)f[u]=r[s],f[u+1]=r[s+1],f[u+2]=r[s+2],f[u+3]=r[s+3],u+=n,s+=o}function vec43_t(e,t,d,f,n,r){const o=e.typedBuffer,c=e.typedBufferStride,u=r?r.count:e.count;let s=(r&&r.dstIndex?r.dstIndex:0)*c;for(let e=0;e<u;++e)o[s]=t,o[s+1]=d,o[s+2]=f,o[s+3]=n,s+=c}var vec43_d=Object.freeze({__proto__:null,copy:vec43_e,fill:vec43_t});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/mat32.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction mat32_e(e,t,r){const d=e.typedBuffer,f=e.typedBufferStride,n=t.typedBuffer,o=t.typedBufferStride,c=r?r.count:t.count;let u=(r&&r.dstIndex?r.dstIndex:0)*f,p=(r&&r.srcIndex?r.srcIndex:0)*o;for(let e=0;e<c;++e){for(let e=0;e<9;++e)d[u+e]=n[p+e];u+=f,p+=o}}var mat32_t=Object.freeze({__proto__:null,copy:mat32_e});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/mat42.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction mat42_e(e,t,r){const d=e.typedBuffer,f=e.typedBufferStride,n=t.typedBuffer,o=t.typedBufferStride,c=r?r.count:t.count;let u=(r&&r.dstIndex?r.dstIndex:0)*f,p=(r&&r.srcIndex?r.srcIndex:0)*o;for(let e=0;e<c;++e){for(let e=0;e<16;++e)d[u+e]=n[p+e];u+=f,p+=o}}var mat42_t=Object.freeze({__proto__:null,copy:mat42_e});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/scalar.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction scalar_e(e,t,r){const n=e.typedBuffer,o=e.typedBufferStride,c=t.typedBuffer,d=t.typedBufferStride,f=r?r.count:t.count;let s=(r&&r.dstIndex?r.dstIndex:0)*o,u=(r&&r.srcIndex?r.srcIndex:0)*d;for(let e=0;e<f;++e)n[s]=c[u],s+=o,u+=d}function scalar_t(e,t){const r=e.count;t||(t=new e.TypedArrayConstructor(r));for(let n=0;n<r;n++)t[n]=e.get(n);return t}var scalar_r=Object.freeze({__proto__:null,copy:scalar_e,makeDense:scalar_t});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/support/buffer/utils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction utils_r(s,r){return new s(new ArrayBuffer(r*s.ElementCount*Object(types[\"a\" /* elementTypeSize */])(s.ElementType)))}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/DefaultErrorContext.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst DefaultErrorContext_o=Logger[\"a\" /* default */].getLogger(\"esri.views.3d.glTF\");class DefaultErrorContext_t{error(r){throw new Error[\"a\" /* default */](\"gltf-loader-error\",r)}errorUnsupported(r){throw new Error[\"a\" /* default */](\"gltf-loader-unsupported-feature\",r)}errorUnsupportedIf(r,e){r&&this.errorUnsupported(e)}assert(r,e){r||this.error(e)}warn(r){DefaultErrorContext_o.warn(r)}warnUnsupported(r){this.warn(\"[Unsupported Feature] \"+r)}warnUnsupportedIf(r,e){r&&this.warnUnsupported(e)}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/LoaderResult.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction LoaderResult_e(e={}){return{color:[1,1,1],opacity:1,alphaMode:\"OPAQUE\",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:\"multiply\",...e}}function LoaderResult_t(e,t={}){return{data:e,parameters:{wrap:{s:10497,t:10497,...t.wrap},noUnpackFlip:!0,mipmap:!1,...t}}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/core/Version.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass Version_r{constructor(t,r,o=\"\"){this.major=t,this.minor=r,this._context=o}lessThan(t,r){return this.major<t||t===this.major&&this.minor<r}since(t,r){return!this.lessThan(t,r)}validate(r){if(this.major!==r.major){const o=this._context&&this._context+\":\",s=this._context&&this._context+\" \";throw new Error[\"a\" /* default */](o+\"unsupported-version\",`Required major ${s}version is '${this.major}', but got '\\${version.major}.\\${version.minor}'`,{version:r})}}clone(){return new Version_r(this.major,this.minor,this._context)}static parse(o,s=\"\"){const[e,i]=o.split(\".\"),n=/^\\s*\\d+\\s*$/;if(!e||!e.match||!e.match(n)){throw new Error[\"a\" /* default */]((s&&s+\":\")+\"invalid-version\",\"Expected major version to be a number, but got '${version}'\",{version:o})}if(!i||!i.match||!i.match(n)){throw new Error[\"a\" /* default */]((s&&s+\":\")+\"invalid-version\",\"Expected minor version to be a number, but got '${version}'\",{version:o})}const a=parseInt(e,10),h=parseInt(i,10);return new Version_r(a,h,s)}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/internal/BinaryStreamReader.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nclass BinaryStreamReader_t{constructor(t){this.data=t,this.offset4=0,this.dataUint32=new Uint32Array(this.data,0,Math.floor(this.data.byteLength/4))}readUint32(){const t=this.offset4;return this.offset4+=1,this.dataUint32[t]}readUint8Array(t){const s=4*this.offset4;return this.offset4+=t/4,new Uint8Array(this.data,s,t)}remainingBytes(){return this.data.byteLength-4*this.offset4}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/internal/fillDefaults.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst fillDefaults_o={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},fillDefaults_r={pbrMetallicRoughness:fillDefaults_o,emissiveFactor:[0,0,0],alphaMode:\"OPAQUE\",alphaCutoff:.5,doubleSided:!1},fillDefaults_t={ESRI_externalColorMixMode:\"tint\"},fillDefaults_a=(a={})=>{const l={...fillDefaults_o,...a.pbrMetallicRoughness},i=function(o){switch(o.ESRI_externalColorMixMode){case\"multiply\":case\"tint\":case\"ignore\":case\"replace\":break;default:Object(compilerUtils[\"a\" /* neverReached */])(o.ESRI_externalColorMixMode),o.ESRI_externalColorMixMode=\"tint\"}return o}({...fillDefaults_t,...a.extras});return{...fillDefaults_r,...a,pbrMetallicRoughness:l,extras:i}};const fillDefaults_l={magFilter:9729,minFilter:9987,wrapS:10497,wrapT:10497},fillDefaults_i=e=>({...fillDefaults_l,...e});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/internal/pathUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction pathUtils_r(r){let e,t;return r.replace(/^(.*\\/)?([^/]*)$/,((r,a,i)=>(e=a||\"\",t=i||\"\",\"\"))),{dirPart:e,filePart:t}}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/internal/Resource.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst Resource_M=1179937895,Resource_G=1313821514,Resource_F=5130562;class Resource_k{constructor(e,t,r,n,o){this.context=e,this.errorContext=t,this.uri=r,this.json=n,this.glbBuffer=o,this.bufferCache=new Map,this.textureCache=new Map,this.materialCache=new Map,this.nodeParentMap=new Map,this.nodeTransformCache=new Map,this.baseUri=pathUtils_r(this.uri).dirPart,this.checkVersionSupported(),this.checkRequiredExtensionsSupported(),t.errorUnsupportedIf(null==n.scenes,\"Scenes must be defined.\"),t.errorUnsupportedIf(null==n.meshes,\"Meshes must be defined\"),t.errorUnsupportedIf(null==n.nodes,\"Nodes must be defined.\"),this.computeNodeParents()}static async load(e,o,s,a){if(Object(urlUtils[\"u\" /* isDataProtocol */])(s)){const t=Object(urlUtils[\"i\" /* dataComponents */])(s);if(\"model/gltf-binary\"!==t.mediaType)try{const r=JSON.parse(t.isBase64?atob(t.data):t.data);return new Resource_k(e,o,s,r)}catch{}const a=Object(urlUtils[\"j\" /* dataToArrayBuffer */])(s);if(Resource_k.isGLBData(a))return this.fromGLBData(e,o,s,a)}if(s.endsWith(\".gltf\")){const t=await e.loadJSON(s,a);return new Resource_k(e,o,s,t)}const i=await e.loadBinary(s,a);if(Resource_k.isGLBData(i))return this.fromGLBData(e,o,s,i);const u=await e.loadJSON(s,a);return new Resource_k(e,o,s,u)}static isGLBData(e){const t=new BinaryStreamReader_t(e);return t.remainingBytes()>=4&&t.readUint32()===Resource_M}static async fromGLBData(e,t,r,n){const o=await Resource_k.parseGLBData(t,n);return new Resource_k(e,t,r,o.json,o.binaryData)}static async parseGLBData(e,t){const r=new BinaryStreamReader_t(t);e.assert(r.remainingBytes()>=12,\"GLB binary data is insufficiently large.\");const n=r.readUint32(),o=r.readUint32(),s=r.readUint32();e.assert(n===Resource_M,\"Magic first 4 bytes do not fit to expected GLB value.\"),e.assert(t.byteLength>=s,\"GLB binary data is smaller than header specifies.\"),e.errorUnsupportedIf(2!==o,\"An unsupported GLB container version was detected. Only version 2 is supported.\");let a,i,u=0;for(;r.remainingBytes()>=8;){const t=r.readUint32(),n=r.readUint32();0===u?(e.assert(n===Resource_G,\"First GLB chunk must be JSON.\"),e.assert(t>=0,\"No JSON data found.\"),a=await Resource_J(r.readUint8Array(t))):1===u?(e.errorUnsupportedIf(n!==Resource_F,\"Second GLB chunk expected to be BIN.\"),i=r.readUint8Array(t)):e.warnUnsupported(\"More than 2 GLB chunks detected. Skipping.\"),u+=1}return a||e.error(\"No GLB JSON chunk detected.\"),{json:a,binaryData:i}}async getBuffer(e,t){const r=this.json.buffers[e],n=this.errorContext;if(null==r.uri)return n.assert(null!=this.glbBuffer,\"GLB buffer not present\"),this.glbBuffer;let o=this.bufferCache.get(e);if(!o){const s=await this.context.loadBinary(this.resolveUri(r.uri),t);o=new Uint8Array(s),this.bufferCache.set(e,o),n.assert(o.byteLength===r.byteLength,\"Buffer byte lengths should match.\")}return o}async getAccessor(e,t){const r=this.json.accessors[e],n=this.errorContext;n.errorUnsupportedIf(null==r.bufferView,\"Some accessor does not specify a bufferView.\"),n.errorUnsupportedIf(r.type in[\"MAT2\",\"MAT3\",\"MAT4\"],`AttributeType ${r.type} is not supported`);const o=this.json.bufferViews[r.bufferView],s=await this.getBuffer(o.buffer,t),a=Resource_X[r.type],i=Resource_q[r.componentType],u=a*i,c=o.byteStride||u;return{raw:s.buffer,byteStride:c,byteOffset:s.byteOffset+(o.byteOffset||0)+(r.byteOffset||0),entryCount:r.count,isDenselyPacked:c===u,componentCount:a,componentByteSize:i,componentType:r.componentType,min:r.min,max:r.max,normalized:!!r.normalized}}async getIndexData(e,t){if(null==e.indices)return null;const r=await this.getAccessor(e.indices,t);if(r.isDenselyPacked)switch(r.componentType){case 5121:return new Uint8Array(r.raw,r.byteOffset,r.entryCount);case 5123:return new Uint16Array(r.raw,r.byteOffset,r.entryCount);case 5125:return new Uint32Array(r.raw,r.byteOffset,r.entryCount)}else switch(r.componentType){case 5121:return scalar_t(this.wrapAccessor(BufferView[\"l\" /* BufferViewUint8 */],r));case 5123:return scalar_t(this.wrapAccessor(BufferView[\"j\" /* BufferViewUint16 */],r));case 5125:return scalar_t(this.wrapAccessor(BufferView[\"k\" /* BufferViewUint32 */],r))}}async getPositionData(e,t){const r=this.errorContext;r.errorUnsupportedIf(null==e.attributes.POSITION,\"No POSITION vertex data found.\");const n=await this.getAccessor(e.attributes.POSITION,t);return r.errorUnsupportedIf(5126!==n.componentType,\"Expected type FLOAT for POSITION vertex attribute, but found \"+Resource_z[n.componentType]),r.errorUnsupportedIf(3!==n.componentCount,\"POSITION vertex attribute must have 3 components, but found \"+n.componentCount.toFixed()),this.wrapAccessor(BufferView[\"u\" /* BufferViewVec3f */],n)}async getNormalData(e,t){const r=this.errorContext;r.assert(null!=e.attributes.NORMAL,\"No NORMAL vertex data found.\");const n=await this.getAccessor(e.attributes.NORMAL,t);return r.errorUnsupportedIf(5126!==n.componentType,\"Expected type FLOAT for NORMAL vertex attribute, but found \"+Resource_z[n.componentType]),r.errorUnsupportedIf(3!==n.componentCount,\"NORMAL vertex attribute must have 3 components, but found \"+n.componentCount.toFixed()),this.wrapAccessor(BufferView[\"u\" /* BufferViewVec3f */],n)}async getTangentData(e,t){const r=this.errorContext;r.assert(null!=e.attributes.TANGENT,\"No TANGENT vertex data found.\");const n=await this.getAccessor(e.attributes.TANGENT,t);return r.errorUnsupportedIf(5126!==n.componentType,\"Expected type FLOAT for TANGENT vertex attribute, but found \"+Resource_z[n.componentType]),r.errorUnsupportedIf(4!==n.componentCount,\"TANGENT vertex attribute must have 4 components, but found \"+n.componentCount.toFixed()),new BufferView[\"C\" /* BufferViewVec4f */](n.raw,n.byteOffset,n.byteStride,n.byteOffset+n.byteStride*n.entryCount)}async getTextureCoordinates(t,r){const n=this.errorContext;n.assert(null!=t.attributes.TEXCOORD_0,\"No TEXCOORD_0 vertex data found.\");const o=await this.getAccessor(t.attributes.TEXCOORD_0,r);return n.errorUnsupportedIf(2!==o.componentCount,\"TEXCOORD_0 vertex attribute must have 2 components, but found \"+o.componentCount.toFixed()),5126===o.componentType?this.wrapAccessor(BufferView[\"m\" /* BufferViewVec2f */],o):(n.errorUnsupportedIf(!o.normalized,\"Integer component types are only supported for a normalized accessor for TEXCOORD_0.\"),function(t){switch(t.componentType){case 5120:return new BufferView[\"q\" /* BufferViewVec2i8 */](t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case 5121:return new BufferView[\"t\" /* BufferViewVec2u8 */](t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case 5122:return new BufferView[\"o\" /* BufferViewVec2i16 */](t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case 5123:return new BufferView[\"r\" /* BufferViewVec2u16 */](t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case 5125:return new BufferView[\"s\" /* BufferViewVec2u32 */](t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);case 5126:return new BufferView[\"m\" /* BufferViewVec2f */](t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*t.entryCount);default:return void Object(compilerUtils[\"a\" /* neverReached */])(t.componentType)}}(o))}async getVertexColors(e,t){const r=this.errorContext;r.assert(null!=e.attributes.COLOR_0,\"No COLOR_0 vertex data found.\");const n=await this.getAccessor(e.attributes.COLOR_0,t);if(r.errorUnsupportedIf(4!==n.componentCount&&3!==n.componentCount,\"COLOR_0 attribute must have 3 or 4 components, but found \"+n.componentCount.toFixed()),4===n.componentCount){if(5126===n.componentType)return this.wrapAccessor(BufferView[\"C\" /* BufferViewVec4f */],n);if(5121===n.componentType)return this.wrapAccessor(BufferView[\"J\" /* BufferViewVec4u8 */],n);if(5123===n.componentType)return this.wrapAccessor(BufferView[\"H\" /* BufferViewVec4u16 */],n)}else if(3===n.componentCount){if(5126===n.componentType)return this.wrapAccessor(BufferView[\"u\" /* BufferViewVec3f */],n);if(5121===n.componentType)return this.wrapAccessor(BufferView[\"B\" /* BufferViewVec3u8 */],n);if(5123===n.componentType)return this.wrapAccessor(BufferView[\"z\" /* BufferViewVec3u16 */],n)}r.errorUnsupported(\"Unsupported component type for COLOR_0 attribute: \"+Resource_z[n.componentType])}hasPositions(e){return void 0!==e.attributes.POSITION}hasNormals(e){return void 0!==e.attributes.NORMAL}hasVertexColors(e){return void 0!==e.attributes.COLOR_0}hasTextureCoordinates(e){return void 0!==e.attributes.TEXCOORD_0}hasTangents(e){return void 0!==e.attributes.TANGENT}async getMaterial(e,t){const r=this.errorContext;let n=this.materialCache.get(e.material);if(!n){const o=null!=e.material?fillDefaults_a(this.json.materials[e.material]):fillDefaults_a(),s=o.pbrMetallicRoughness,a=this.hasVertexColors(e);let i,u,c,p,d;s.baseColorTexture&&(r.errorUnsupportedIf(0!==(s.baseColorTexture.texCoord||0),\"Only TEXCOORD with index 0 is supported.\"),i=await this.getTexture(s.baseColorTexture.index,t)),o.normalTexture&&(0!==(o.normalTexture.texCoord||0)?r.warnUnsupported(\"Only TEXCOORD with index 0 is supported for the normal map texture.\"):u=await this.getTexture(o.normalTexture.index,t)),o.occlusionTexture&&(0!==(o.occlusionTexture.texCoord||0)?r.warnUnsupported(\"Only TEXCOORD with index 0 is supported for the occlusion texture.\"):c=await this.getTexture(o.occlusionTexture.index,t)),o.emissiveTexture&&(0!==(o.emissiveTexture.texCoord||0)?r.warnUnsupported(\"Only TEXCOORD with index 0 is supported for the emissive texture.\"):p=await this.getTexture(o.emissiveTexture.index,t)),s.metallicRoughnessTexture&&(0!==(s.metallicRoughnessTexture.texCoord||0)?r.warnUnsupported(\"Only TEXCOORD with index 0 is supported for the metallicRoughness texture.\"):d=await this.getTexture(s.metallicRoughnessTexture.index,t));const f=null!=e.material?e.material:-1;n={alphaMode:o.alphaMode,alphaCutoff:o.alphaCutoff,color:s.baseColorFactor,doubleSided:!!o.doubleSided,colorTexture:i,normalTexture:u,name:o.name,id:f,occlusionTexture:c,emissiveTexture:p,emissiveFactor:o.emissiveFactor,metallicFactor:s.metallicFactor,roughnessFactor:s.roughnessFactor,metallicRoughnessTexture:d,vertexColors:a,ESRI_externalColorMixMode:o.extras.ESRI_externalColorMixMode}}return n}async getTexture(e,t){const r=this.errorContext,n=this.json.textures[e],o=fillDefaults_i(null!=n.sampler?this.json.samplers[n.sampler]:{});r.errorUnsupportedIf(null==n.source,\"Source is expected to be defined for a texture.\");const a=this.json.images[n.source];let i=this.textureCache.get(e);if(!i){let n;if(a.uri)n=await this.context.loadImage(this.resolveUri(a.uri),t);else{r.errorUnsupportedIf(null==a.bufferView,\"Image bufferView must be defined.\"),r.errorUnsupportedIf(null==a.mimeType,\"Image mimeType must be defined.\");const e=this.json.bufferViews[a.bufferView],o=await this.getBuffer(e.buffer,t);r.errorUnsupportedIf(null!=e.byteStride,\"byteStride not supported for image buffer\"),n=await async function(e,t){return Object(promiseUtils[\"c\" /* create */])(((r,n)=>{const o=new Blob([e],{type:t}),s=URL.createObjectURL(o),a=new Image;a.addEventListener(\"load\",(()=>{URL.revokeObjectURL(s),\"decode\"in a?a.decode().then((()=>r(a)),(()=>r(a))):r(a)})),a.addEventListener(\"error\",(e=>{URL.revokeObjectURL(s),n(e)})),a.src=s}))}(new Uint8Array(o.buffer,o.byteOffset+(e.byteOffset||0),e.byteLength),a.mimeType)}i={data:n,wrapS:o.wrapS,wrapT:o.wrapT,minFilter:o.minFilter,name:a.name,id:e},this.textureCache.set(e,i)}return i}getNodeTransform(e){if(void 0===e)return Resource_V;let t=this.nodeTransformCache.get(e);if(!t){const r=this.getNodeTransform(this.getNodeParent(e)),n=this.json.nodes[e];n.matrix?t=Object(mat4[\"g\" /* m */])(Object(mat4f64[\"b\" /* a */])(),r,n.matrix):n.translation||n.rotation||n.scale?(t=Object(mat4f64[\"c\" /* b */])(r),n.translation&&Object(mat4[\"j\" /* t */])(t,t,n.translation),n.rotation&&(Resource_[3]=Object(quat[\"b\" /* g */])(Resource_,n.rotation),Object(mat4[\"h\" /* r */])(t,t,Resource_[3],Resource_)),n.scale&&Object(mat4[\"i\" /* s */])(t,t,n.scale)):t=r,this.nodeTransformCache.set(e,t)}return t}wrapAccessor(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}resolveUri(e){return Object(urlUtils[\"y\" /* makeAbsolute */])(e,this.baseUri)}getNodeParent(e){return this.nodeParentMap.get(e)}checkVersionSupported(){const e=Version_r.parse(this.json.asset.version,\"glTF\");Resource_P.validate(e)}checkRequiredExtensionsSupported(){const e=this.json,t=this.errorContext;e.extensionsRequired&&0!==e.extensionsRequired.length&&t.errorUnsupported(\"gltf loader was not able to load unsupported feature. Required extensions: \"+e.extensionsRequired.join(\", \"))}computeNodeParents(){this.json.nodes.forEach(((e,t)=>{e.children&&e.children.forEach((e=>{this.nodeParentMap.set(e,t)}))}))}}const Resource_P=new Version_r(2,0,\"glTF\"),Resource_V=Object(mat4[\"f\" /* k */])(Object(mat4f64[\"b\" /* a */])(),Math.PI/2),Resource_=Object(quatf64[\"a\"])(),Resource_X={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},Resource_q={5120:1,5121:1,5122:2,5123:2,5126:4,5125:4};async function Resource_J(e){return Object(promiseUtils[\"c\" /* create */])(((t,r)=>{const n=new Blob([e]),o=new FileReader;o.onload=()=>{const e=o.result;t(JSON.parse(e))},o.onerror=e=>{r(e)},o.readAsText(n)}))}const Resource_z={5120:\"BYTE\",5121:\"UNSIGNED_BYTE\",5122:\"SHORT\",5123:\"UNSIGNED_SHORT\",5125:\"UNSIGNED_INT\",5126:\"FLOAT\"};\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/loader.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nlet loader_l=0;async function loader_u(s,a,i={}){const u=await Resource_k.load(s,loader_x,a,i),p=\"gltf_\"+loader_l++,f={lods:[],materials:new Map,textures:new Map,meta:loader_c(u)},T=!(!u.json.asset.extras||\"symbolResource\"!==u.json.asset.extras.ESRI_type);return await async function(e,t){const r=e.json,s=r.scenes[r.scene||0].nodes,a=s.length>1;for(const e of s){const t=r.nodes[e],s=[i(e,0)];if(loader_m(t)&&!a){const e=t.extensions.MSFT_lod.ids;s.push(...e.map(((e,t)=>i(e,t+1))))}await Object(promiseUtils[\"b\" /* all */])(s)}async function i(o,s){const a=r.nodes[o],n=e.getNodeTransform(o);if(loader_x.warnUnsupportedIf(null!=a.weights,\"Morph targets are not supported.\"),null!=a.mesh){const e=r.meshes[a.mesh];for(const o of e.primitives)await t(o,n,s,e.name)}for(const e of a.children||[])await i(e,s)}}(u,(async(o,s,a,n)=>{const l=void 0!==o.mode?o.mode:4,c=function(e){switch(e){case 4:case 5:case 6:return e;default:return null}}(l);if(Object(maybe[\"g\" /* isNone */])(c))return void loader_x.warnUnsupported(\"Unsupported primitive mode (\"+loader_h[l]+\"). Skipping primitive.\");if(!u.hasPositions(o))return void loader_x.warn(\"Skipping primitive without POSITION vertex attribute.\");const m=await u.getMaterial(o,i),T={transform:Object(mat4f64[\"c\" /* b */])(s),attributes:{position:await u.getPositionData(o,i),normal:null,texCoord0:null,color:null,tangent:null},indices:await u.getIndexData(o,i),primitiveType:c,material:loader_d(f,m,p)};u.hasNormals(o)&&(T.attributes.normal=await u.getNormalData(o,i)),u.hasTangents(o)&&(T.attributes.tangent=await u.getTangentData(o,i)),u.hasTextureCoordinates(o)&&(T.attributes.texCoord0=await u.getTextureCoordinates(o,i)),u.hasVertexColors(o)&&(T.attributes.color=await u.getVertexColors(o,i));let w=null;Object(maybe[\"h\" /* isSome */])(f.meta)&&Object(maybe[\"h\" /* isSome */])(f.meta.ESRI_lod)&&\"screenSpaceRadius\"===f.meta.ESRI_lod.metric&&(w=f.meta.ESRI_lod.thresholds[a]),f.lods[a]=f.lods[a]||{parts:[],name:n,lodThreshold:w},f.lods[a].parts.push(T)})),{model:f,meta:{isEsriSymbolResource:T,uri:u.uri},customMeta:{}}}function loader_c(t){const o=t.json;let r=null;return o.nodes.forEach((t=>{const o=t.extras;Object(maybe[\"h\" /* isSome */])(o)&&(o.ESRI_proxyEllipsoid||o.ESRI_lod)&&(r=o)})),r}function loader_m(e){return e.extensions&&e.extensions.MSFT_lod&&Array.isArray(e.extensions.MSFT_lod.ids)}function loader_d(e,t,o){const r=t=>{const r=`${o}_tex_${t&&t.id}${t&&t.name?\"_\"+t.name:\"\"}`;if(t&&!e.textures.has(r)){const o=LoaderResult_t(t.data,{wrap:{s:loader_p(t.wrapS),t:loader_p(t.wrapT)},mipmap:loader_f.some((e=>e===t.minFilter)),noUnpackFlip:!0});e.textures.set(r,o)}return r},s=`${o}_mat_${t.id}_${t.name}`;if(!e.materials.has(s)){const o=LoaderResult_e({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?r(t.colorTexture):void 0,textureNormal:t.normalTexture?r(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?r(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?r(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?r(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});e.materials.set(s,o)}return s}function loader_p(e){if(33071===e||33648===e||10497===e)return e;loader_x.error(`Unexpected TextureSampler WrapMode: ${e}`)}const loader_x=new DefaultErrorContext_t,loader_f=[9987,9985],loader_h=[\"POINTS\",\"LINES\",\"LINE_LOOP\",\"LINE_STRIP\",\"TRIANGLES\",\"TRIANGLE_STRIP\",\"TRIANGLE_FAN\"];\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/glTF/internal/indexUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction indexUtils_r(t){return geometryDataUtils_u(t)}function indexUtils_o(n){return\"number\"==typeof n?indexUtils_r(n):Object(typedArrayUtil[\"i\" /* isUint16Array */])(n)||Object(typedArrayUtil[\"k\" /* isUint8Array */])(n)?new Uint32Array(n):n}function indexUtils_f(t){const e=\"number\"==typeof t?t:t.length;if(e<3)return new Uint32Array(0);const n=e-2,r=new Uint32Array(3*n);if(\"number\"==typeof t){let t=0;for(let e=0;e<n;e+=1)e%2==0?(r[t++]=e,r[t++]=e+1,r[t++]=e+2):(r[t++]=e+1,r[t++]=e,r[t++]=e+2)}else{let e=0;for(let o=0;o<n;o+=1)if(o%2==0){const n=t[o],f=t[o+1],i=t[o+2];r[e++]=n,r[e++]=f,r[e++]=i}else{const n=t[o+1],f=t[o],i=t[o+2];r[e++]=n,r[e++]=f,r[e++]=i}}return r}function indexUtils_i(t){const e=\"number\"==typeof t?t:t.length;if(e<3)return new Uint32Array(0);const n=e-2,r=new Uint32Array(3*n);if(\"number\"==typeof t){let t=0;for(let e=0;e<n;++e)r[t++]=0,r[t++]=e+1,r[t++]=e+2;return r}{const e=t[0];let o=t[1],f=0;for(let i=0;i<n;++i){const n=t[i+2];r[f++]=e,r[f++]=o,r[f++]=n,o=n}return r}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/lang.js\nvar lang = __webpack_require__(\"f/qv\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/layers/graphics/wosrLoader.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst wosrLoader_b=Logger[\"a\" /* default */].getLogger(\"esri.views.3d.layers.graphics.objectResourceUtils\");async function wosrLoader_h(e,n){const a=await async function(e,n){const a=Object(maybe[\"h\" /* isSome */])(n)&&n.streamDataRequester;if(a)return async function(e,t,r){const n=await Object(asyncUtils[\"c\" /* result */])(t.request(e,\"json\",r));if(!0===n.ok)return n.value;return Object(promiseUtils[\"v\" /* throwIfAbortError */])(n.error),void wosrLoader_v(n.error.details.url)}(e,a,n);const o=await Object(asyncUtils[\"c\" /* result */])(Object(request[\"default\"])(e,Object(maybe[\"n\" /* unwrap */])(n)));if(!0===o.ok)return o.value.data;return Object(promiseUtils[\"v\" /* throwIfAbortError */])(o.error),void wosrLoader_v(o.error)}(e,n);return{resource:a,textures:await wosrLoader_M(a.textureDefinitions,n)}}function wosrLoader_v(e){throw new Error[\"a\" /* default */](\"\",`Request for object resource failed: ${e}`)}function wosrLoader_j(e){const t=e.params,r=t.topology;let n=!0;switch(t.vertexAttributes||(wosrLoader_b.warn(\"Geometry must specify vertex attributes\"),n=!1),t.topology){case\"PerAttributeArray\":break;case\"Indexed\":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const r in t.vertexAttributes){const t=e[r];t&&t.values?(null!=t.valueType&&\"UInt32\"!==t.valueType&&(wosrLoader_b.warn(`Unsupported indexed geometry indices type '${t.valueType}', only UInt32 is currently supported`),n=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(wosrLoader_b.warn(`Unsupported indexed geometry values per element '${t.valuesPerElement}', only 1 is currently supported`),n=!1)):(wosrLoader_b.warn(`Indexed geometry does not specify face indices for '${r}' attribute`),n=!1)}}else wosrLoader_b.warn(\"Indexed geometries must specify faces\"),n=!1;break}default:wosrLoader_b.warn(`Unsupported topology '${r}'`),n=!1}e.params.material||(wosrLoader_b.warn(\"Geometry requires material\"),n=!1);const a=e.params.vertexAttributes;for(const e in a){a[e].values||(wosrLoader_b.warn(\"Geometries with externally defined attributes are not yet supported\"),n=!1)}return n}function wosrLoader_A(r,n){const a=[],s=[],o=[],i=[],u=r.resource,l=Version_r.parse(u.version||\"1.0\",\"wosr\");wosrLoader_P.validate(l);const m=u.model.name,f=u.model.geometries,d=u.materialDefinitions,b=r.textures;let h=0;const v=new Map;for(let r=0;r<f.length;r++){const u=f[r];if(!wosrLoader_j(u))continue;const l=wosrLoader_T(u),p=u.params.vertexAttributes,A={};for(const e in p){const t=p[e],r=t.values;A[e]={data:r,size:t.valuesPerElement}}const U={};if(\"PerAttributeArray\"===u.params.topology){const e=wosrLoader_k(A.position.data.length/A.position.size);for(const t in A)U[t]=e}else{const e=u.params.faces;for(const t in e)U[t]=new Uint32Array(e[t].values)}const M=b&&b[l.texture];if(M&&!v.has(l.texture)){const{image:e,params:t}=M,r=new lib_Texture(e,m,t);i.push(r),v.set(l.texture,r)}const P=v.get(l.texture),B=P?P.id:void 0;let E=o[l.material]?o[l.material][l.texture]:null;if(!E){const r=d[l.material.substring(l.material.lastIndexOf(\"/\")+1)].params;1===r.transparency&&(r.transparency=0);const a=M&&M.alphaChannelUsage,s=r.transparency>0||\"transparency\"===a||\"maskAndTransparency\"===a,i={ambient:Object(vec3f64[\"f\" /* d */])(r.diffuse),diffuse:Object(vec3f64[\"f\" /* d */])(r.diffuse),opacity:1-(r.transparency||0),transparent:s,textureAlphaMode:M?wosrLoader_I(M.alphaChannelUsage):void 0,textureAlphaCutoff:.33,textureId:B,initTextureTransparent:!0,doubleSided:!0,cullFace:0,colorMixMode:r.externalColorMixMode||\"tint\",textureAlphaPremultiplied:!0};Object(maybe[\"h\" /* isSome */])(n)&&n.materialParamsMixin&&Object(lang[\"d\" /* mixin */])(i,n.materialParamsMixin),E=new DefaultMaterial_y(i,m),o[l.material]||(o[l.material]={}),o[l.material][l.texture]=E}s.push(E);const q=new Geometry(new GeometryData_n(A,U),m);h+=U.position?U.position.length:0,a.push(q)}return{name:m,stageResources:{textures:i,materials:s,geometries:a},pivotOffset:u.model.pivotOffset,boundingBox:wosrLoader_U(a),numberOfVertices:h,lodThreshold:null}}function wosrLoader_U(e){const t=Object(aaBoundingBox[\"c\" /* empty */])();return e.forEach((e=>{const r=e.boundingInfo;Object(aaBoundingBox[\"g\" /* expandWithVec3 */])(t,r.getBBMin()),Object(aaBoundingBox[\"g\" /* expandWithVec3 */])(t,r.getBBMax())})),t}async function wosrLoader_M(e,r){const n=[];for(const a in e){const s=e[a],i=s.images[0].data;if(!i){wosrLoader_b.warn(\"Externally referenced texture data is not yet supported\");continue}const u=s.encoding+\";base64,\"+i,l=\"/textureDefinitions/\"+a,c={noUnpackFlip:!0,wrap:{s:10497,t:10497},preMultiplyAlpha:!0},p=Object(maybe[\"h\" /* isSome */])(r)&&r.disableTextures?Object(promiseUtils[\"u\" /* resolve */])(null):Object(requestImageUtils[\"a\" /* requestImage */])(u,r);n.push(p.then((e=>({refId:l,image:e,params:c,alphaChannelUsage:\"rgba\"===s.channels?s.alphaChannelUsage||\"transparency\":\"none\"}))))}const a=await Object(promiseUtils[\"b\" /* all */])(n),s={};for(const e of a)s[e.refId]=e;return s}function wosrLoader_I(e){switch(e){case\"mask\":return 2;case\"maskAndTransparency\":return 3;case\"none\":return 1;case\"transparency\":default:return 0}}function wosrLoader_T(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}function wosrLoader_k(e){const t=new Uint32Array(e);for(let r=0;r<e;r++)t[r]=r;return t}const wosrLoader_P=new Version_r(1,2,\"wosr\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/chunks/vec42.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction vec42_t(t,r,f){if(t.count!==r.count)return void common_e.error(\"source and destination buffers need to have the same number of elements\");const o=t.count,n=f[0],u=f[1],d=f[2],s=f[3],c=f[4],i=f[5],a=f[6],p=f[7],y=f[8],B=f[9],m=f[10],h=f[11],l=f[12],S=f[13],b=f[14],v=f[15],M=t.typedBuffer,_=t.typedBufferStride,j=r.typedBuffer,g=r.typedBufferStride;for(let e=0;e<o;e++){const t=e*_,r=e*g,f=j[r],o=j[r+1],w=j[r+2],x=j[r+3];M[t]=n*f+c*o+y*w+l*x,M[t+1]=u*f+i*o+B*w+S*x,M[t+2]=d*f+a*o+m*w+b*x,M[t+3]=s*f+p*o+h*w+v*x}}function vec42_r(t,r,f){if(t.count!==r.count)return void common_e.error(\"source and destination buffers need to have the same number of elements\");const o=t.count,n=f[0],u=f[1],d=f[2],s=f[3],c=f[4],i=f[5],a=f[6],p=f[7],y=f[8],B=t.typedBuffer,m=t.typedBufferStride,h=r.typedBuffer,l=r.typedBufferStride;for(let e=0;e<o;e++){const t=e*m,r=e*l,f=h[r],o=h[r+1],S=h[r+2],b=h[r+3];B[t]=n*f+s*o+a*S,B[t+1]=u*f+c*o+p*S,B[t+2]=d*f+i*o+y*S,B[t+3]=b}}function vec42_f(e,t,r){const f=Math.min(e.count,t.count),o=e.typedBuffer,n=e.typedBufferStride,u=t.typedBuffer,d=t.typedBufferStride;for(let e=0;e<f;e++){const t=e*n,f=e*d;o[t]=r*u[f],o[t+1]=r*u[f+1],o[t+2]=r*u[f+2],o[t+3]=r*u[f+3]}}function vec42_o(e,t,r){const f=Math.min(e.count,t.count),o=e.typedBuffer,n=e.typedBufferStride,u=t.typedBuffer,d=t.typedBufferStride;for(let e=0;e<f;e++){const t=e*n,f=e*d;o[t]=u[f]>>r,o[t+1]=u[f+1]>>r,o[t+2]=u[f+2]>>r,o[t+3]=u[f+3]>>r}}var vec42_n=Object.freeze({__proto__:null,transformMat4:vec42_t,transformMat3:vec42_r,scale:vec42_f,shiftRight:vec42_o});\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/layers/graphics/objectResourceUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nasync function objectResourceUtils_q(d,p){const g=objectResourceUtils_K(Object(devEnvironmentUtils[\"a\" /* adjustStaticAGOUrl */])(d));if(\"wosr\"===g.fileType){const e=await(p.cache?p.cache.loadWOSR(g.url,p):wosrLoader_h(g.url,p)),t=wosrLoader_A(e,p);return{lods:[t],referenceBoundingBox:t.boundingBox,isEsriSymbolResource:!1,isWosr:!0,remove:e.remove}}const h=await(p.cache?p.cache.loadGLTF(g.url,p):loader_u(new DefaultLoadingContext_n(p.streamDataRequester),g.url,p)),v=Object(maybe[\"f\" /* get */])(h.model.meta,\"ESRI_proxyEllipsoid\");h.meta.isEsriSymbolResource&&Object(maybe[\"h\" /* isSome */])(v)&&-1!==h.meta.uri.indexOf(\"/RealisticTrees/\")&&function(e,t){for(let m=0;m<e.model.lods.length;++m){const d=e.model.lods[m];e.customMeta.esriTreeRendering=!0;for(const p of d.parts){const d=p.attributes.normal;if(Object(maybe[\"g\" /* isNone */])(d))return;const g=p.attributes.position,h=g.count,v=Object(vec3f64[\"e\" /* c */])(),M=Object(vec3f64[\"e\" /* c */])(),w=Object(vec3f64[\"e\" /* c */])(),R=utils_r(BufferView[\"J\" /* BufferViewVec4u8 */],h),y=utils_r(BufferView[\"u\" /* BufferViewVec3f */],h),B=Object(mat4[\"a\"])(Object(mat4f64[\"b\" /* a */])(),p.transform);for(let r=0;r<h;r++){g.getVec(r,M),d.getVec(r,v),Object(vec3[\"j\" /* i */])(M,M,p.transform),Object(vec3[\"g\" /* f */])(w,M,t.center),Object(vec3[\"a\" /* C */])(w,w,t.radius);const o=w[2],c=Object(vec3[\"m\" /* l */])(w),f=Math.min(.45+.55*c*c,1);Object(vec3[\"a\" /* C */])(w,w,t.radius),Object(vec3[\"j\" /* i */])(w,w,B),Object(vec3[\"o\" /* n */])(w,w),m+1!==e.model.lods.length&&e.model.lods.length>1&&Object(vec3[\"f\" /* e */])(w,w,v,o>-1?.2:Math.min(-4*o-3.8,1)),y.setVec(r,w),R.set(r,0,255*f),R.set(r,1,255*f),R.set(r,2,255*f),R.set(r,3,255)}p.attributes.normal=y,p.attributes.color=R}}}(h,v);const M=h.meta.isEsriSymbolResource?{usePBR:p.usePBR,isSchematic:!1,treeRendering:h.customMeta.esriTreeRendering,mrrFactors:[0,1,.2]}:{usePBR:!0,isSchematic:!1,mrrFactors:[0,1,.5]},w={...p.materialParamsMixin,treeRendering:h.customMeta.esriTreeRendering};if(null!=g.specifiedLodIndex){const e=objectResourceUtils_Q(h,M,w,g.specifiedLodIndex);let t=e[0].boundingBox;if(0!==g.specifiedLodIndex){t=objectResourceUtils_Q(h,M,w,0)[0].boundingBox}return{lods:e,referenceBoundingBox:t,isEsriSymbolResource:h.meta.isEsriSymbolResource,isWosr:!1,remove:h.remove}}const R=objectResourceUtils_Q(h,M,w);return{lods:R,referenceBoundingBox:R[0].boundingBox,isEsriSymbolResource:h.meta.isEsriSymbolResource,isWosr:!1,remove:h.remove}}function objectResourceUtils_K(e){const t=e.match(/(.*\\.(gltf|glb))(\\?lod=([0-9]+))?$/);if(t)return{fileType:\"gltf\",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null};return e.match(/(.*\\.(json|json\\.gz))$/)?{fileType:\"wosr\",url:e,specifiedLodIndex:null}:{fileType:\"unknown\",url:e,specifiedLodIndex:null}}function objectResourceUtils_Q(e,r,o,s){const i=e.model,a=Object(mat3f64[\"a\"])(),n=new Array,u=new Map,l=new Map;return i.lods.forEach(((e,c)=>{if(void 0!==s&&c!==s)return;let m=0;const d={name:e.name,stageResources:{textures:new Array,materials:new Array,geometries:new Array},lodThreshold:Object(maybe[\"h\" /* isSome */])(e.lodThreshold)?e.lodThreshold:null,pivotOffset:[0,0,0],numberOfVertices:0,boundingBox:Object(aaBoundingBox[\"c\" /* empty */])()};n.push(d),e.parts.forEach((s=>{const n=s.material+(s.attributes.normal?\"_normal\":\"\")+(s.attributes.color?\"_color\":\"\")+(s.attributes.texCoord0?\"_texCoord0\":\"\")+(s.attributes.tangent?\"_tangent\":\"\"),c=i.materials.get(s.material),f=Object(maybe[\"h\" /* isSome */])(s.attributes.texCoord0),j=Object(maybe[\"h\" /* isSome */])(s.attributes.normal);if(!u.has(n)){if(f){if(Object(maybe[\"h\" /* isSome */])(c.textureColor)&&!l.has(c.textureColor)){const e=i.textures.get(c.textureColor),t={...e.parameters,preMultiplyAlpha:!0};l.set(c.textureColor,new lib_Texture(e.data,c.textureColor,t))}if(Object(maybe[\"h\" /* isSome */])(c.textureNormal)&&!l.has(c.textureNormal)){const e=i.textures.get(c.textureNormal),t={...e.parameters,preMultiplyAlpha:!0};l.set(c.textureNormal,new lib_Texture(e.data,c.textureNormal,t))}if(Object(maybe[\"h\" /* isSome */])(c.textureOcclusion)&&!l.has(c.textureOcclusion)){const e=i.textures.get(c.textureOcclusion),t={...e.parameters,preMultiplyAlpha:!0};l.set(c.textureOcclusion,new lib_Texture(e.data,c.textureOcclusion,t))}if(Object(maybe[\"h\" /* isSome */])(c.textureEmissive)&&!l.has(c.textureEmissive)){const e=i.textures.get(c.textureEmissive),t={...e.parameters,preMultiplyAlpha:!0};l.set(c.textureEmissive,new lib_Texture(e.data,c.textureEmissive,t))}if(Object(maybe[\"h\" /* isSome */])(c.textureMetallicRoughness)&&!l.has(c.textureMetallicRoughness)){const e=i.textures.get(c.textureMetallicRoughness),t={...e.parameters,preMultiplyAlpha:!0};l.set(c.textureMetallicRoughness,new lib_Texture(e.data,c.textureMetallicRoughness,t))}}const e=Math.pow(c.color[0],1/DefaultMaterial_O),a=Math.pow(c.color[1],1/DefaultMaterial_O),m=Math.pow(c.color[2],1/DefaultMaterial_O),d=Math.pow(c.emissiveFactor[0],1/DefaultMaterial_O),p=Math.pow(c.emissiveFactor[1],1/DefaultMaterial_O),x=Math.pow(c.emissiveFactor[2],1/DefaultMaterial_O);u.set(n,new DefaultMaterial_y({...r,transparent:\"BLEND\"===c.alphaMode,textureAlphaMode:objectResourceUtils_H(c.alphaMode),textureAlphaCutoff:c.alphaCutoff,diffuse:[e,a,m],ambient:[e,a,m],opacity:c.opacity,doubleSided:c.doubleSided,doubleSidedType:\"winding-order\",cullFace:c.doubleSided?0:2,vertexColors:!!s.attributes.color,vertexTangents:!!s.attributes.tangent,normals:j?\"default\":\"screenDerivative\",castShadows:!0,receiveSSAO:!0,textureId:Object(maybe[\"h\" /* isSome */])(c.textureColor)&&f?l.get(c.textureColor).id:void 0,colorMixMode:c.colorMixMode,normalTextureId:Object(maybe[\"h\" /* isSome */])(c.textureNormal)&&f?l.get(c.textureNormal).id:void 0,textureAlphaPremultiplied:!0,occlusionTextureId:Object(maybe[\"h\" /* isSome */])(c.textureOcclusion)&&f?l.get(c.textureOcclusion).id:void 0,emissiveTextureId:Object(maybe[\"h\" /* isSome */])(c.textureEmissive)&&f?l.get(c.textureEmissive).id:void 0,metallicRoughnessTextureId:Object(maybe[\"h\" /* isSome */])(c.textureMetallicRoughness)&&f?l.get(c.textureMetallicRoughness).id:void 0,emissiveFactor:[d,p,x],mrrFactors:[c.metallicFactor,c.roughnessFactor,r.mrrFactors[2]],isSchematic:!1,...o},n))}const F=function(e,t){switch(t){case 4:return indexUtils_o(e);case 5:return indexUtils_f(e);case 6:return indexUtils_i(e)}}(s.indices||s.attributes.position.count,s.primitiveType),_={},W={},$=s.attributes.position.count,q=utils_r(BufferView[\"u\" /* BufferViewVec3f */],$);if(vec32_t(q,s.attributes.position,s.transform),W.position={data:q.typedBuffer,size:q.elementCount},_.position=F,Object(maybe[\"h\" /* isSome */])(s.attributes.normal)){const e=utils_r(BufferView[\"u\" /* BufferViewVec3f */],$);Object(mat3[\"g\" /* n */])(a,s.transform),vec32_r(e,s.attributes.normal,a),W.normal={data:e.typedBuffer,size:e.elementCount},_.normal=F}if(Object(maybe[\"h\" /* isSome */])(s.attributes.tangent)){const e=utils_r(BufferView[\"C\" /* BufferViewVec4f */],$);Object(mat3[\"g\" /* n */])(a,s.transform),vec42_r(e,s.attributes.tangent,a),W.tangent={data:e.typedBuffer,size:e.elementCount},_.tangent=F}if(Object(maybe[\"h\" /* isSome */])(s.attributes.texCoord0)){const e=utils_r(BufferView[\"m\" /* BufferViewVec2f */],$);vec22_n(e,s.attributes.texCoord0),W.uv0={data:e.typedBuffer,size:e.elementCount},_.uv0=F}if(Object(maybe[\"h\" /* isSome */])(s.attributes.color)){const e=utils_r(BufferView[\"J\" /* BufferViewVec4u8 */],$);if(4===s.attributes.color.elementCount)s.attributes.color instanceof BufferView[\"C\" /* BufferViewVec4f */]?vec42_f(e,s.attributes.color,255):s.attributes.color instanceof BufferView[\"J\" /* BufferViewVec4u8 */]?vec43_e(e,s.attributes.color):s.attributes.color instanceof BufferView[\"H\" /* BufferViewVec4u16 */]&&vec42_f(e,s.attributes.color,1/256);else{vec43_t(e,255,255,255,255);const t=new BufferView[\"B\" /* BufferViewVec3u8 */](e.buffer,0,4);s.attributes.color instanceof BufferView[\"u\" /* BufferViewVec3f */]?vec32_f(t,s.attributes.color,255):s.attributes.color instanceof BufferView[\"B\" /* BufferViewVec3u8 */]?vec33_e(t,s.attributes.color):s.attributes.color instanceof BufferView[\"z\" /* BufferViewVec3u16 */]&&vec32_f(t,s.attributes.color,1/256)}W.color={data:e.typedBuffer,size:e.elementCount},_.color=F}const K=new Geometry(new GeometryData_n(W,_),`gltf_${e.name}_${m++}`);d.stageResources.geometries.push(K),d.stageResources.materials.push(u.get(n)),f&&(Object(maybe[\"h\" /* isSome */])(c.textureColor)&&d.stageResources.textures.push(l.get(c.textureColor)),Object(maybe[\"h\" /* isSome */])(c.textureNormal)&&d.stageResources.textures.push(l.get(c.textureNormal)),Object(maybe[\"h\" /* isSome */])(c.textureOcclusion)&&d.stageResources.textures.push(l.get(c.textureOcclusion)),Object(maybe[\"h\" /* isSome */])(c.textureEmissive)&&d.stageResources.textures.push(l.get(c.textureEmissive)),Object(maybe[\"h\" /* isSome */])(c.textureMetallicRoughness)&&d.stageResources.textures.push(l.get(c.textureMetallicRoughness))),d.numberOfVertices+=$;const Q=K.boundingInfo;Object(aaBoundingBox[\"g\" /* expandWithVec3 */])(d.boundingBox,Q.getBBMin()),Object(aaBoundingBox[\"g\" /* expandWithVec3 */])(d.boundingBox,Q.getBBMax())}))})),n}function objectResourceUtils_H(e){switch(e){case\"BLEND\":return 0;case\"MASK\":return 2;case\"OPAQUE\":return 1;default:return 0}}\n\n\n/***/ }),\n\n/***/ \"lwwL\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export I */\n/* unused harmony export a */\n/* unused harmony export b */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return r; });\n/* unused harmony export f */\n/* unused harmony export m */\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction r(){const r=new Float32Array(16);return r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function n(r){const n=new Float32Array(16);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n}function t(r,n,t,e,a,o,c,s,u,l,f,i,w,y,A,F){const _=new Float32Array(16);return _[0]=r,_[1]=n,_[2]=t,_[3]=e,_[4]=a,_[5]=o,_[6]=c,_[7]=s,_[8]=u,_[9]=l,_[10]=f,_[11]=i,_[12]=w,_[13]=y,_[14]=A,_[15]=F,_}function e(r,n){return new Float32Array(r,n,16)}const a=r();var o=Object.freeze({__proto__:null,create:r,clone:n,fromValues:t,createView:e,IDENTITY:a});\n\n\n/***/ }),\n\n/***/ \"mmTy\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export decodeDoubleArray */\n/* unused harmony export encodeDouble */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return o; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return r; });\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction n(n,o){e[0]=n,e[1]=n-e[0],o[0]=e[0],o[1]=e[1]}function o(n,o,t){for(let r=0;r<t;++r)o[2*r]=n[r],o[2*r+1]=n[r]-o[2*r]}function t(n,o,t){for(let r=0;r<t;++r)o[r]=n[2*r]+n[2*r+1]}function r(n,t,r,c){for(let l=0;l<c;++l)f[0]=n[l],o(f,e,1),t[l]=e[0],r[l]=e[1]}const f=new Float64Array(1),e=new Float32Array(2);\n\n\n/***/ }),\n\n/***/ \"p9cc\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export PBRSchematicMRRValues */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return r; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/* harmony import */ var _chunks_vec3f32_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"R/jG\");\n/* harmony import */ var _attributes_VertexTextureCoordinates_glsl_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"fLTx\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nconst t=Object(_chunks_vec3f32_js__WEBPACK_IMPORTED_MODULE_1__[/* f */ \"b\"])(0,.6,.2);function r(s,t){const r=s.fragment,a=t.hasMetalnessAndRoughnessTexture||t.hasEmissionTexture||t.hasOcclusionTexture;1===t.pbrMode&&a&&s.include(_attributes_VertexTextureCoordinates_glsl_js__WEBPACK_IMPORTED_MODULE_2__[/* VertexTextureCoordinates */ \"a\"],t),2!==t.pbrMode?(0===t.pbrMode&&r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      float getBakedOcclusion() { return 1.0; }\n  `),1===t.pbrMode&&(r.uniforms.add(\"emissionFactor\",\"vec3\"),r.uniforms.add(\"mrrFactors\",\"vec3\"),r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec3 mrr;\n      vec3 emission;\n      float occlusion;\n    `),t.hasMetalnessAndRoughnessTexture&&(r.uniforms.add(\"texMetallicRoughness\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texMetallicRoughnessSize\",\"vec2\"),r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void applyMetallnessAndRoughness(TextureLookupParameter params) {\n        vec3 metallicRoughness = textureLookup(texMetallicRoughness, params).rgb;\n\n        mrr[0] *= metallicRoughness.b;\n        mrr[1] *= metallicRoughness.g;\n      }`)),t.hasEmissionTexture&&(r.uniforms.add(\"texEmission\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texEmissionSize\",\"vec2\"),r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void applyEmission(TextureLookupParameter params) {\n        emission *= textureLookup(texEmission, params).rgb;\n      }`)),t.hasOcclusionTexture?(r.uniforms.add(\"texOcclusion\",\"sampler2D\"),t.supportsTextureAtlas&&r.uniforms.add(\"texOcclusionSize\",\"vec2\"),r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void applyOcclusion(TextureLookupParameter params) {\n        occlusion *= textureLookup(texOcclusion, params).r;\n      }\n\n      float getBakedOcclusion() {\n        return occlusion;\n      }\n      `)):r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      float getBakedOcclusion() { return 1.0; }\n      `),r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    void applyPBRFactors() {\n      mrr = mrrFactors;\n      emission = emissionFactor;\n      occlusion = 1.0;\n      ${a?\"vtc.uv = vuv0;\":\"\"}\n      ${t.hasMetalnessAndRoughnessTexture?t.supportsTextureAtlas?\"vtc.size = texMetallicRoughnessSize; applyMetallnessAndRoughness(vtc);\":\"applyMetallnessAndRoughness(vtc);\":\"\"}\n      ${t.hasEmissionTexture?t.supportsTextureAtlas?\"vtc.size = texEmissionSize; applyEmission(vtc);\":\"applyEmission(vtc);\":\"\"}\n      ${t.hasOcclusionTexture?t.supportsTextureAtlas?\"vtc.size = texOcclusionSize; applyOcclusion(vtc);\":\"applyOcclusion(vtc);\":\"\"}\n    }\n  `))):r.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      const vec3 mrr = vec3(0.0, 0.6, 0.2);\n      const vec3 emission = vec3(0.0);\n      float occlusion = 1.0;\n\n      void applyPBRFactors() {}\n\n      float getBakedOcclusion() { return 1.0; }\n    `)}!function(e){e.bindUniforms=function(e,s,o=!1){o||(e.setUniform3fv(\"mrrFactors\",s.mrrFactors),e.setUniform3fv(\"emissionFactor\",s.emissiveFactor))}}(r||(r={}));\n\n\n/***/ }),\n\n/***/ \"qrV2\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return r; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction r(r,e){const m=r.fragment;m.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    struct ShadingNormalParameters {\n      vec3 normalView;\n      vec3 viewDirection;\n    } shadingParams;\n    `),1===e.doubleSidedMode?m.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return dot(params.normalView, params.viewDirection) > 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n      }\n    `):2===e.doubleSidedMode?m.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n      }\n    `):m.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return normalize(params.normalView);\n      }\n    `)}\n\n\n/***/ }),\n\n/***/ \"r+FG\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return a; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return e; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return r; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return t; });\n/* unused harmony export f */\n/* unused harmony export m */\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function n(e,r,n,t,a,o,c,u,s,f,i,l,_,I,b,m){return[e,r,n,t,a,o,c,u,s,f,i,l,_,I,b,m]}function t(e,r){return new Float64Array(e,r,16)}const a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var o=Object.freeze({__proto__:null,create:e,clone:r,fromValues:n,createView:t,IDENTITY:a});\n\n\n/***/ }),\n\n/***/ \"sJp1\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return o; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction o(o){o.attributes.add(\"position\",\"vec3\"),o.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    vec3 positionModel() { return position; }\n  `)}\n\n\n/***/ }),\n\n/***/ \"sKsC\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return M; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return L; });\n/* harmony import */ var _views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"Tbkp\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"aQrP\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"0nJL\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_VisualVariables_glsl_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"viRi\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"69UF\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_VerticalOffset_glsl_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"F7CJ\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_VertexColor_glsl_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"bVvB\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_ReadShadowMap_glsl_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(\"0BfS\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_ForwardLinearDepth_glsl_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(\"vXUg\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRendering_glsl_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(\"XV/G\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_InstancedDoublePrecision_glsl_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(\"1TnO\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_TextureCoordinateAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(\"368d\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRenderingParameters_glsl_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(\"p9cc\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_Offset_glsl_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(\"F8o4\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_NormalAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(\"wzLF\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_PositionAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(\"sJp1\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_attributes_SymbolColor_glsl_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(\"bLIi\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_default_DefaultMaterialAuxiliaryPasses_glsl_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(\"fiGu\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_EvaluateAmbientOcclusion_glsl_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(\"cIib\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_shading_EvaluateSceneLighting_glsl_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(\"6kvK\");\n/* harmony import */ var _views_3d_webgl_engine_core_shaderLibrary_util_MixExternalColor_glsl_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(\"NiZE\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction L(L){const M=new _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_2__[/* ShaderBuilder */ \"a\"],j=M.vertex.code,O=M.fragment.code;return M.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\").add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\"),M.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_PositionAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_16__[/* PositionAttribute */ \"a\"]),M.varyings.add(\"vpos\",\"vec3\"),M.include(_views_3d_webgl_engine_core_shaderLibrary_shading_VisualVariables_glsl_js__WEBPACK_IMPORTED_MODULE_4__[/* VisualVariables */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_InstancedDoublePrecision_glsl_js__WEBPACK_IMPORTED_MODULE_11__[/* InstancedDoublePrecision */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_VerticalOffset_glsl_js__WEBPACK_IMPORTED_MODULE_6__[/* VerticalOffset */ \"a\"],L),0!==L.output&&7!==L.output||(M.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_NormalAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_15__[/* NormalAttribute */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_1__[/* Transform */ \"a\"],{linearDepth:!1}),L.offsetBackfaces&&M.include(_views_3d_webgl_engine_core_shaderLibrary_Offset_glsl_js__WEBPACK_IMPORTED_MODULE_14__[/* Offset */ \"a\"]),L.instancedColor&&M.attributes.add(\"instanceColor\",\"vec4\"),M.varyings.add(\"vNormalWorld\",\"vec3\"),M.varyings.add(\"localvpos\",\"vec3\"),M.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_TextureCoordinateAttribute_glsl_js__WEBPACK_IMPORTED_MODULE_12__[/* TextureCoordinateAttribute */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_ForwardLinearDepth_glsl_js__WEBPACK_IMPORTED_MODULE_9__[/* ForwardLinearDepth */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_SymbolColor_glsl_js__WEBPACK_IMPORTED_MODULE_17__[/* SymbolColor */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_attributes_VertexColor_glsl_js__WEBPACK_IMPORTED_MODULE_7__[/* VertexColor */ \"a\"],L),M.vertex.uniforms.add(\"externalColor\",\"vec4\"),M.varyings.add(\"vcolorExt\",\"vec4\"),j.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt = externalColor;\n          ${L.instancedColor?\"vcolorExt *= instanceColor;\":\"\"}\n          vcolorExt *= vvColor();\n          vcolorExt *= getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a < ${_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"].float(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_5__[/* symbolAlphaCutoff */ \"c\"])}) {\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          }\n          else {\n            vpos = calculateVPos();\n            localvpos = vpos - view[3].xyz;\n            vpos = subtractOrigin(vpos);\n            vNormalWorld = dpNormal(vvLocalNormal(normalModel()));\n            vpos = addVerticalOffset(vpos, localOrigin);\n            gl_Position = transformPosition(proj, view, vpos);\n            ${L.offsetBackfaces?\"gl_Position = offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);\":\"\"}\n          }\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      `)),7===L.output&&(M.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_3__[/* Slice */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_5__[/* DiscardOrAdjustAlpha */ \"a\"],L),M.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),M.fragment.uniforms.add(\"view\",\"mat4\"),L.hasColorTexture&&M.fragment.uniforms.add(\"tex\",\"sampler2D\"),M.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_util_MixExternalColor_glsl_js__WEBPACK_IMPORTED_MODULE_21__[/* MixExternalColor */ \"a\"]),O.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void main() {\n        discardBySlice(vpos);\n        ${L.hasColorTexture?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${L.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`vec4 texColor = vec4(1.0);`}\n        ${L.attributeColor?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n\n        gl_FragColor = vec4(opacity_);\n      }\n    `)),0===L.output&&(M.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_3__[/* Slice */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_shading_EvaluateSceneLighting_glsl_js__WEBPACK_IMPORTED_MODULE_20__[/* EvaluateSceneLighting */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_shading_EvaluateAmbientOcclusion_glsl_js__WEBPACK_IMPORTED_MODULE_19__[/* EvaluateAmbientOcclusion */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_5__[/* DiscardOrAdjustAlpha */ \"a\"],L),L.receiveShadows&&M.include(_views_3d_webgl_engine_core_shaderLibrary_shading_ReadShadowMap_glsl_js__WEBPACK_IMPORTED_MODULE_8__[/* ReadShadowMap */ \"a\"],L),M.fragment.uniforms.add(\"camPos\",\"vec3\").add(\"localOrigin\",\"vec3\").add(\"ambient\",\"vec3\").add(\"diffuse\",\"vec3\").add(\"opacity\",\"float\").add(\"layerOpacity\",\"float\"),M.fragment.uniforms.add(\"view\",\"mat4\"),L.hasColorTexture&&M.fragment.uniforms.add(\"tex\",\"sampler2D\"),M.include(_views_3d_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRenderingParameters_glsl_js__WEBPACK_IMPORTED_MODULE_13__[/* PhysicallyBasedRenderingParameters */ \"a\"],L),M.include(_views_3d_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRendering_glsl_js__WEBPACK_IMPORTED_MODULE_10__[/* PhysicallyBasedRendering */ \"a\"],L),M.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_util_MixExternalColor_glsl_js__WEBPACK_IMPORTED_MODULE_21__[/* MixExternalColor */ \"a\"]),O.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void main() {\n        discardBySlice(vpos);\n        ${L.hasColorTexture?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec4 texColor = texture2D(tex, vuv0);\n        ${L.textureAlphaPremultiplied?\"texColor.rgb /= texColor.a;\":\"\"}\n        discardOrAdjustAlpha(texColor);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`vec4 texColor = vec4(1.0);`}\n        vec3 viewDirection = normalize(vpos - camPos);\n        ${1===L.pbrMode?\"applyPBRFactors();\":\"\"}\n        float ssao = evaluateAmbientOcclusionInverse();\n        ssao *= getBakedOcclusion();\n\n        float additionalAmbientScale = _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight = ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ${L.receiveShadows?\"float shadow = readShadowMap(vpos, linearDepth);\":1===L.viewingMode?\"float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);\":\"float shadow = 0.0;\"}\n        vec3 matColor = max(ambient, diffuse);\n        ${L.attributeColor?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec3 albedo_ = mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec3 albedo_ = mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ = layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        `}\n        ${_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n        vec3 shadedNormal = normalize(vNormalWorld);\n        albedo_ *= 1.2;\n        vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\n        float alignmentLightView = clamp(dot(-viewForward, lightingMainDirection), 0.0, 1.0);\n        float transmittance = 1.0 - clamp(dot(-viewForward, shadedNormal), 0.0, 1.0);\n        float treeRadialFalloff = vColor.r;\n        float backLightFactor = 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n        additionalLight += backLightFactor * lightingMainIntensity;`}\n        ${1===L.pbrMode||2===L.pbrMode?1===L.viewingMode?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`vec3 normalGround = normalize(vpos + localOrigin);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`vec3 normalGround = vec3(0.0, 0.0, 1.0);`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]``}\n        ${1===L.pbrMode||2===L.pbrMode?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n            float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor = evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);`:\"vec3 shadedColor = evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\"}\n        gl_FragColor = highlightSlice(vec4(shadedColor, opacity_), vpos);\n        ${L.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n      }\n    `)),M.include(_views_3d_webgl_engine_core_shaderLibrary_default_DefaultMaterialAuxiliaryPasses_glsl_js__WEBPACK_IMPORTED_MODULE_18__[/* DefaultMaterialAuxiliaryPasses */ \"a\"],L),M}var M=Object.freeze({__proto__:null,build:L});\n\n\n/***/ }),\n\n/***/ \"tiP8\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export acquireMaterials */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return u; });\n/* unused harmony export calculateTransformRelToOrigin */\n/* unused harmony export encodeDoubleVec3 */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return f; });\n/* unused harmony export releaseMaterials */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return l; });\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"srIe\");\n/* harmony import */ var _chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"15Hh\");\n/* harmony import */ var _chunks_mat4f64_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"r+FG\");\n/* harmony import */ var _lib_Util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"EVMh\");\n/* harmony import */ var _lib_doublePrecisionUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"mmTy\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction u(t,r){return Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__[/* isNone */ \"g\"])(t)&&(t=[]),t.push(r),t}function l(t,r){if(Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__[/* isNone */ \"g\"])(t))return t;const s=t.filter((e=>e!==r));return 0===s.length?null:s}function f(e){return!!Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__[/* isSome */ \"h\"])(e)&&!e.visible}function m(e,t){const r=new Map;return r.set(0,t.acquire(e,0)),r.set(1,t.acquire(e,7)),r.set(4,t.acquire(e,3)),r.set(3,t.acquire(e,2)),r.set(2,t.acquire(e,1)),r.set(5,t.acquire(e,4)),r}function p(e,t){t.release(e,0),t.release(e,7),t.release(e,3),t.release(e,2),t.release(e,1),t.release(e,4)}function b(e,o,c){const u=e.origin.vec3;Object(_lib_Util_js__WEBPACK_IMPORTED_MODULE_3__[/* setMatrixTranslation3 */ \"d\"])(h,-u[0],-u[1],-u[2]),Object(_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__[/* isSome */ \"h\"])(e.transformation)?Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__[/* m */ \"g\"])(o,h,e.transformation):Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__[\"c\"])(o,h),c&&(Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__[\"a\"])(c,o),Object(_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__[\"b\"])(c,c))}function q(e,t,r,s,n){g[0]=e.get(t,0),g[1]=e.get(t,1),g[2]=e.get(t,2),Object(_lib_doublePrecisionUtils_js__WEBPACK_IMPORTED_MODULE_4__[/* encodeDoubleArray */ \"a\"])(g,j,3),r.set(n,0,j[0]),s.set(n,0,j[1]),r.set(n,1,j[2]),s.set(n,1,j[3]),r.set(n,2,j[4]),s.set(n,2,j[5])}const g=new Float64Array(3),j=new Float32Array(6),h=Object(_chunks_mat4f64_js__WEBPACK_IMPORTED_MODULE_2__[/* a */ \"b\"])();\n\n\n/***/ }),\n\n/***/ \"vXUg\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return a; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction a(a,r){0===r.output&&r.receiveShadows?(a.varyings.add(\"linearDepth\",\"float\"),a.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardLinearDepth() { linearDepth = gl_Position.w; }\n    `)):1===r.output||3===r.output?(a.varyings.add(\"linearDepth\",\"float\"),a.vertex.uniforms.add(\"uCameraNearFar\",\"vec2\"),a.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardLinearDepth() {\n        linearDepth = (-position_view().z - uCameraNearFar[0]) / (uCameraNearFar[1] - uCameraNearFar[0]);\n      }\n    `)):a.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      void forwardLinearDepth() {}\n    `)}\n\n\n/***/ }),\n\n/***/ \"viRi\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return v; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction v(v,o){o.vvInstancingEnabled&&(o.vvSize||o.vvColor)&&v.attributes.add(\"instanceFeatureAttribute\",\"vec4\"),o.vvSize?(v.vertex.uniforms.add(\"vvSizeMinSize\",\"vec3\"),v.vertex.uniforms.add(\"vvSizeMaxSize\",\"vec3\"),v.vertex.uniforms.add(\"vvSizeOffset\",\"vec3\"),v.vertex.uniforms.add(\"vvSizeFactor\",\"vec3\"),v.vertex.uniforms.add(\"vvSymbolRotationMatrix\",\"mat3\"),v.vertex.uniforms.add(\"vvSymbolAnchor\",\"vec3\"),v.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    `),v.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ${o.vvInstancingEnabled?_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }`:\"\"}\n    `)):v.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    `),o.vvColor?(v.vertex.defines.addInt(\"VV_COLOR_N\",8),v.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < VV_COLOR_N; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ${o.vvInstancingEnabled?_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }`:\"\"}\n    `)):v.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n      vec4 vvColor() { return vec4(1.0); }\n    `)}!function(e){function v(e,v){v.vvSizeEnabled&&(e.setUniform3fv(\"vvSizeMinSize\",v.vvSizeMinSize),e.setUniform3fv(\"vvSizeMaxSize\",v.vvSizeMaxSize),e.setUniform3fv(\"vvSizeOffset\",v.vvSizeOffset),e.setUniform3fv(\"vvSizeFactor\",v.vvSizeFactor)),v.vvColorEnabled&&(e.setUniform1fv(\"vvColorValues\",v.vvColorValues),e.setUniform4fv(\"vvColorColors\",v.vvColorColors))}e.bindUniforms=v,e.bindUniformsWithOpacity=function(e,o){v(e,o),o.vvOpacityEnabled&&(e.setUniform1fv(\"vvOpacityValues\",o.vvOpacityValues),e.setUniform1fv(\"vvOpacityOpacities\",o.vvOpacityOpacities))},e.bindUniformsForSymbols=function(e,o){v(e,o),o.vvSizeEnabled&&(e.setUniform3fv(\"vvSymbolAnchor\",o.vvSymbolAnchor),e.setUniformMatrix3fv(\"vvSymbolRotationMatrix\",o.vvSymbolRotationMatrix))}}(v||(v={}));\n\n\n/***/ }),\n\n/***/ \"wzLF\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"a\", function() { return /* binding */ NormalAttribute_glsl_o; });\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js\nvar interfaces = __webpack_require__(\"OIYib\");\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/DecodeNormal.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction DecodeNormal_glsl_o(o){const d=interfaces[\"a\" /* glsl */]`\n    vec3 decodeNormal(vec2 f) {\n      float z = 1.0 - abs(f.x) - abs(f.y);\n      return vec3(f + sign(f) * min(z, 0.0), z);\n    }\n  `;o.fragment.code.add(d),o.vertex.code.add(d)}\n\n// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction NormalAttribute_glsl_o(o,d){0===d.normalType&&(o.attributes.add(\"normal\",\"vec3\"),o.vertex.code.add(interfaces[\"a\" /* glsl */]`\n      vec3 normalModel() {\n        return normal;\n      }\n    `)),1===d.normalType&&(o.include(DecodeNormal_glsl_o),o.attributes.add(\"normalCompressed\",\"vec2\"),o.vertex.code.add(interfaces[\"a\" /* glsl */]`\n      vec3 normalModel() {\n        return decodeNormal(normalCompressed);\n      }\n    `)),3===d.normalType&&(o.extensions.add(\"GL_OES_standard_derivatives\"),o.fragment.code.add(interfaces[\"a\" /* glsl */]`\n      vec3 screenDerivativeNormal(vec3 positionView) {\n        return normalize(cross(dFdx(positionView), dFdy(positionView)));\n      }\n    `))}\n\n\n/***/ }),\n\n/***/ \"xRv2\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return t; });\n/* harmony import */ var _shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"OIYib\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction t(t){t.vertex.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    const float PI = 3.141592653589793;\n  `),t.fragment.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__[/* glsl */ \"a\"]`\n    const float PI = 3.141592653589793;\n    const float LIGHT_NORMALIZATION = 1.0 / PI;\n    const float INV_PI = 0.3183098861837907;\n    const float HALF_PI = 1.570796326794897;\n    `)}\n\n\n/***/ })\n\n}]);","inputSourceMap":null}