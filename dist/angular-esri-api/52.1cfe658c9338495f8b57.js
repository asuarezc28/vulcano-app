(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{"1Rg/":function(t,e,i){"use strict";i.d(e,"a",function(){return w}),i.d(e,"b",function(){return v}),i.d(e,"c",function(){return C}),i.d(e,"d",function(){return N}),i.d(e,"e",function(){return B}),i.d(e,"f",function(){return T}),i.d(e,"g",function(){return q}),i.d(e,"h",function(){return x}),i.d(e,"i",function(){return M});var r=i("srIe"),n=i("+opI"),s=i("zlDU"),o=i("9MzC"),a=i("f4Nx"),l=i("IXLn"),u=i("PNY3"),c=i("+NQI"),f=i("qatw"),h=i("gEht"),d=i("qNUd"),m=i("gVKr"),p=i("ZlUD"),y=(i("2X7Z"),i("HsO1"));function b(t,e){return t?e?4:3:e?3:2}function g(t,e,i,r,n){if(!t)return!1;const s=b(e,i),{coords:o,lengths:a}=t;let l=!1,u=0;for(const c of a)l=O(l,o,s,u,c,r,n),u+=c*s;return l}function O(t,e,i,r,n,s,o){let a=t,l=r;for(let u=r,c=r+n*i;u<c;u+=i){l=u+i,l===c&&(l=r);const t=e[u],n=e[u+1],f=e[l],h=e[l+1];(n<o&&h>=o||h<o&&n>=o)&&t+(o-n)/(h-n)*(f-t)<s&&(a=!a)}return a}const _=new n.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),w=Object.freeze({}),I=new m.a,j=new m.a,S=new m.a,R={esriGeometryPoint:p.m,esriGeometryPolyline:p.o,esriGeometryPolygon:p.n,esriGeometryMultipoint:p.l};function M(t,e,i,r=t.hasZ,n=t.hasM){const s=t.hasZ&&r,o=t.hasM&&n;if(i){const a=Object(p.u)(S,e,t.hasZ,t.hasM,"esriGeometryPoint",i,r,n);return Object(p.m)(a,s,o)}return Object(p.m)(e,s,o)}function T(t,e,i,r,n,s,o=e,a=i){const l=e&&o,u=i&&a,c=r?"coords"in r?r:r.geometry:null;if(!c)return null;if(n){let r=Object(p.q)(j,c,e,i,t,n,o,a);return s&&(r=Object(p.u)(S,r,l,u,t,s)),R[t](r,l,u)}if(s){const r=Object(p.u)(S,c,e,i,t,s,o,a);return R[t](r,l,u)}return Object(p.x)(I,c,e,i,o,a),R[t](I,l,u)}async function v(t,e,i){const{outFields:r,orderByFields:n,groupByFieldsForStatistics:s,outStatistics:o}=t;if(r)for(let a=0;a<r.length;a++)r[a]=r[a].trim();if(n)for(let a=0;a<n.length;a++)n[a]=n[a].trim();if(s)for(let a=0;a<s.length;a++)s[a]=s[a].trim();if(o)for(let a=0;a<o.length;a++)o[a].onStatisticField&&(o[a].onStatisticField=o[a].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),x(t,e,i)}async function x(t,e,i){if(!t)return null;let{where:n}=t;if(t.where=n=n&&n.trim(),(!n||/^1 *= *1$/.test(n)||e&&e===n)&&(t.where=null),!t.geometry)return t;let s=await async function(t){const{geometry:e,distance:i,units:r}=t;if(null==i||"vertexAttributes"in e)return e;const n=e.spatialReference,s=r?_.fromJSON(r):Object(h.e)(n),o=n&&(Object(a.f)(n)||Object(a.m)(n))?e:await Object(y.a)(n,a.a).then(()=>Object(y.b)(e,a.a));return(await V().then(t=>t.geodesicBuffer))(o.spatialReference,o,i,s)}(t);if(t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel){const{spatialReference:e}=t.geometry;s=Object(c.a)(s),s.spatialReference=e}t.geometry=s,await Object(y.a)(s.spatialReference,i);const o=(await Object(d.a)(Object(f.a)(s)))[0];if(Object(r.g)(o))throw w;const l=o.toJSON(),u=await Object(y.b)(l,l.spatialReference,i);if(!u)throw w;return u.spatialReference=i,t.geometry=u,t}function N(t){return t&&F in t?JSON.parse(JSON.stringify(t,E)):t}const F="_geVersion",E=(t,e)=>t!==F?e:void 0,G={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},A={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},U={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},P={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function V(){return Promise.all([i.e(12),i.e(0),i.e(28)]).then(i.bind(null,"AKzY"))}function q(t,e,i,r,n){if(Object(f.g)(e)&&"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t)){const t=Object(p.g)(new m.a,e,!1,!1);return Object(o.u)(e=>function(t,e,i,r){return g(t,!1,!1,r.coords[0],r.coords[1])}(t,0,0,e))}if(Object(f.g)(e)&&"esriGeometryMultipoint"===i){const i=Object(p.g)(new m.a,e,!1,!1);if("esriSpatialRelContains"===t)return Object(o.u)(t=>function(t,e,i,r,n,s){const o=b(n,s),{coords:a,lengths:l}=r;if(!l)return!1;for(let u=0,c=0;u<l.length;u++,c+=o)if(!g(t,!1,!1,a[c],a[c+1]))return!1;return!0}(i,0,0,t,r,n))}if(Object(f.d)(e)&&"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t))return Object(o.u)(t=>Object(l.e)(e,T(i,r,n,t)));if(Object(f.d)(e)&&"esriGeometryMultipoint"===i&&"esriSpatialRelContains"===t)return Object(o.u)(t=>Object(l.d)(e,T(i,r,n,t)));if(Object(f.d)(e)&&"esriSpatialRelIntersects"===t){const t=Object(u.b)(i);return Object(o.u)(s=>t(e,T(i,r,n,s)))}return V().then(s=>{const o=s[G[t]].bind(null,e.spatialReference,e);return t=>o(T(i,r,n,t))})}async function B(t,e,i){const{spatialRel:r,geometry:n}=t;if(n){if(!0!==A[r])throw new s.a("feature-store:unsupported-query","Unsupported query spatial relationship",{query:t});if(Object(a.i)(n.spatialReference)&&Object(a.i)(i)){if(!function(t){return!0===U[Object(f.c)(t)]}(n))throw new s.a("feature-store:unsupported-query","Unsupported query geometry type",{query:t});if(!function(t){return!0===P[t]}(e))throw new s.a("feature-store:unsupported-query","Unsupported layer geometry type",{query:t});if(t.outSR)return Object(y.a)(t.geometry&&t.geometry.spatialReference,t.outSR)}}}function C(t){if(Object(f.d)(t))return!0;if(Object(f.g)(t)){for(const e of t.rings){if(5!==e.length)return!1;if(e[0][0]!==e[1][0]||e[0][0]!==e[4][0]||e[2][0]!==e[3][0]||e[0][1]!==e[3][1]||e[0][1]!==e[4][1]||e[1][1]!==e[2][1])return!1}return!0}return!1}},"64Oa":function(t,e,i){"use strict";i.r(e);var r=i("srIe"),n=i("6S2I"),s=i("zlDU"),o=i("9MzC"),a=i("KLE9"),l=i("kYAx"),u=i("xk++"),c=i("1Rg/"),f=i("q7ja"),h=i("DJok");const d=n.a.getLogger("esri.views.2d.layers.features.support.whereUtils"),m={getAttribute:(t,e)=>t.field(e)},p=n.a.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter");e.default=class{constructor(t){this._geometryBounds=Object(l.d)(),this._idToVisibility=new Map,this._serviceInfo=t}get hash(){return this._hash}check(t){return this._applyFilter(t)}clear(){const t=this._resetAllHiddenIds();return this.update(),{show:t,hide:[]}}invalidate(){this._idToVisibility.forEach((t,e)=>{this._idToVisibility.set(e,0)})}setKnownIds(t){for(const e of t)this._idToVisibility.set(e,1)}setTrue(t){const e=[],i=[],r=new Set(t);return this._idToVisibility.forEach((t,n)=>{const s=!!(1&this._idToVisibility.get(n)),o=r.has(n);!s&&o?e.push(n):s&&!o&&i.push(n),this._idToVisibility.set(n,o?3:0)}),{show:e,hide:i}}createQuery(){const{geometry:t,spatialRel:e,where:i,timeExtent:r,objectIds:n}=this;return u.a.fromJSON({geometry:t,spatialRel:e,where:i,timeExtent:r,objectIds:n})}async update(t,e){this._hash=JSON.stringify(t);const i=await Object(c.h)(t,null,e);await Object(o.b)([this._setGeometryFilter(i),this._setIdFilter(i),this._setAttributeFilter(i),this._setTimeFilter(i)])}async _setAttributeFilter(t){if(!t||!t.where)return this._clause=null,void(this.where=null);this._clause=await async function(t,e){const r=await i.e(6).then(i.bind(null,"ZqIb"));try{const i=r.WhereClause.create(t,e);if(!i.isStandardized){const t=new s.a("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",i);d.error(t)}return t=>{const e=t.readArcadeFeature();return i.testFeature(e,m)}}catch(n){return d.warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",t),t=>!0}}(t.where,this._serviceInfo.fieldsIndex),this.where=t.where}_setIdFilter(t){this._idsToShow=t&&t.objectIds&&new Set(t.objectIds),this._idsToHide=t&&t.hiddenIds&&new Set(t.hiddenIds),this.objectIds=t&&t.objectIds}async _setGeometryFilter(t){if(!t||!t.geometry)return this._spatialQueryOperator=null,this.geometry=null,void(this.spatialRel=null);const e=t.geometry,i=t.spatialRel||"esriSpatialRelIntersects",r=await Object(c.g)(i,e,this._serviceInfo.geometryType,this._serviceInfo.hasZ,this._serviceInfo.hasM);Object(a.a)(this._geometryBounds,e),this._spatialQueryOperator=r,this.geometry=e,this.spatialRel=i}_setTimeFilter(t){if(this.timeExtent=this._timeOperator=null,t&&t.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=t.timeExtent,this._timeOperator=Object(f.b)(this._serviceInfo.timeInfo,t.timeExtent,h.b);else{const e=new s.a("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",t.timeExtent);p.error(e)}}_applyFilter(t){return this._filterByGeometry(t)&&this._filterById(t)&&this._filterByTime(t)&&this._filterByExpression(t)}_filterByExpression(t){return!this.where||this._clause(t)}_filterById(t){return(!this._idsToHide||!this._idsToHide.size||!this._idsToHide.has(t.getObjectId()))&&(!this._idsToShow||!this._idsToShow.size||this._idsToShow.has(t.getObjectId()))}_filterByGeometry(t){if(!this.geometry)return!0;const e=t.readHydratedGeometry();return!!e&&this._spatialQueryOperator(e)}_filterByTime(t){return!Object(r.h)(this._timeOperator)||this._timeOperator(t)}_resetAllHiddenIds(){const t=[];return this._idToVisibility.forEach((e,i)=>{1&e||(this._idToVisibility.set(i,1),t.push(i))}),t}}},QmHG:function(t,e,i){"use strict";i.d(e,"a",function(){return b}),i.d(e,"b",function(){return n}),i.d(e,"c",function(){return d}),i.d(e,"d",function(){return y}),i.d(e,"e",function(){return o}),i.d(e,"f",function(){return l}),i.d(e,"g",function(){return a}),i.d(e,"h",function(){return m}),i.d(e,"i",function(){return s}),i.d(e,"j",function(){return h}),i.d(e,"k",function(){return f}),i.d(e,"l",function(){return c}),i.d(e,"m",function(){return u});var r=i("srIe");function n(t=g){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function s(t,e,i,r,s,o,a=n()){return a[0]=t,a[1]=e,a[2]=i,a[3]=r,a[4]=s,a[5]=o,a}function o(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function a(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function l(t,e,i){const r=e.length;let n=t[0],s=t[1],o=t[2],a=t[3],l=t[4],u=t[5];if(i)for(let c=0;c<r;c++){const t=e[c];n=Math.min(n,t[0]),s=Math.min(s,t[1]),o=Math.min(o,t[2]),a=Math.max(a,t[0]),l=Math.max(l,t[1]),u=Math.max(u,t[2])}else for(let c=0;c<r;c++){const t=e[c];n=Math.min(n,t[0]),s=Math.min(s,t[1]),a=Math.max(a,t[0]),l=Math.max(l,t[1])}t[0]=n,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function u(t,e=[0,0,0]){return e[0]=function(t){return t[0]>=t[3]?0:t[3]-t[0]}(t),e[1]=function(t){return t[1]>=t[4]?0:t[4]-t[1]}(t),e[2]=function(t){return t[2]>=t[5]?0:t[5]-t[2]}(t),e}function c(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function f(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function h(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function d(t){return t?h(t,b):n(b)}function m(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function p(t){return 6===t.length}function y(t,e,i){if(Object(r.g)(t)||Object(r.g)(e))return t===e;if(!p(t)||!p(e))return!1;if(i){for(let r=0;r<t.length;r++)if(!i(t[r],e[r]))return!1}else for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}i("OvF4"),i("kYAx");const b=[1/0,1/0,1/0,-1/0,-1/0,-1/0],g=[0,0,0,0,0,0];n()},q7ja:function(t,e,i){"use strict";function r(t,e){if(!t)return null;const i=e.featureAdapter,{startTimeField:r,endTimeField:n}=t;let s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(r&&n)e.forEach(t=>{const e=i.getAttribute(t,r),a=i.getAttribute(t,n);null==e||isNaN(e)||(s=Math.min(s,e)),null==a||isNaN(a)||(o=Math.max(o,a))});else{const t=r||n;e.forEach(e=>{const r=i.getAttribute(e,t);null==r||isNaN(r)||(s=Math.min(s,r),o=Math.max(o,r))})}return{start:s,end:o}}function n(t,e,i){if(!e||!t)return null;const{startTimeField:r,endTimeField:n}=t;if(!r&&!n)return null;const{start:s,end:o}=e;return null===s&&null===o?null:void 0===s&&void 0===o?()=>!1:r&&n?function(t,e,i,r,n){return null!=r&&null!=n?s=>{const o=t.getAttribute(s,e),a=t.getAttribute(s,i);return(null==o||o<=n)&&(null==a||a>=r)}:null!=r?e=>{const n=t.getAttribute(e,i);return null==n||n>=r}:null!=n?i=>{const r=t.getAttribute(i,e);return null==r||r<=n}:void 0}(i,r,n,s,o):function(t,e,i,r){return null!=i&&null!=r&&i===r?r=>t.getAttribute(r,e)===i:null!=i&&null!=r?n=>{const s=t.getAttribute(n,e);return s>=i&&s<=r}:null!=i?r=>t.getAttribute(r,e)>=i:null!=r?i=>t.getAttribute(i,e)<=r:void 0}(i,r||n,s,o)}i.d(e,"a",function(){return r}),i.d(e,"b",function(){return n})}}]);