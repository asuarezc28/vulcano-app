(window.webpackJsonp=window.webpackJsonp||[]).push([[148],{mL23:function(e,t,r){"use strict";r.r(t);var s=r("pO5D"),o=(r("wSAH"),r("6S2I"),r("zqDF"),r("WbKI")),a=r("04ZG"),i=(r("4EHJ"),r("ju1D"),r("9AIY"),r("9MzC")),n=r("Lqtk"),l=r("qNUd"),p=r("kglp"),u=r("o6Le"),c=r("OvWd"),b=r("r88o"),y=r("ag7Y"),d=r("jWBI"),h=r("8prj"),O=r("54nt"),m=r("eKLr");let f=class extends y.a{constructor(e){super(e),this.directions=null,this.route=null,this.routeName=null,this.stops=null}};Object(s.a)([Object(o.b)({type:m.a,json:{write:!0}})],f.prototype,"directions",void 0),Object(s.a)([Object(o.b)({type:d.a,json:{write:!0}})],f.prototype,"route",void 0),Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],f.prototype,"routeName",void 0),Object(s.a)([Object(o.b)({type:[d.a],json:{write:!0}})],f.prototype,"stops",void 0),f=Object(s.a)([Object(a.a)("esri.tasks.support.RouteResult")],f);var j=f;function B(e){return e&&h.default.fromJSON(e).features.map(e=>e)}let g=class extends y.a{constructor(e){super(e),this.barriers=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routeResults=null}readPointBarriers(e,t){return B(t.barriers||t.pointBarriers)}readPolylineBarriers(e){return B(e)}readPolygonBarriers(e){return B(e)}};Object(s.a)([Object(o.b)({aliasOf:"pointBarriers"})],g.prototype,"barriers",void 0),Object(s.a)([Object(o.b)({type:[O.a]})],g.prototype,"messages",void 0),Object(s.a)([Object(o.b)({type:[d.a]})],g.prototype,"pointBarriers",void 0),Object(s.a)([Object(b.a)("pointBarriers",["barriers","pointBarriers"])],g.prototype,"readPointBarriers",null),Object(s.a)([Object(o.b)({type:[d.a]})],g.prototype,"polylineBarriers",void 0),Object(s.a)([Object(b.a)("polylineBarriers")],g.prototype,"readPolylineBarriers",null),Object(s.a)([Object(o.b)({type:[d.a]})],g.prototype,"polygonBarriers",void 0),Object(s.a)([Object(b.a)("polygonBarriers")],g.prototype,"readPolygonBarriers",null),Object(s.a)([Object(o.b)({type:[j]})],g.prototype,"routeResults",void 0),g=Object(s.a)([Object(a.a)("esri.tasks.support.RouteResultsContainer")],g);var R=g;const v=Object(u.a)({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},stops:!0,travelMode:!0});let N=class extends(Object(c.a)(p.a)){constructor(e){super(e)}solve(e,t){const r=[],s=[],o={},a={};return e.stops&&e.stops.features&&this._collectGeometries(e.stops.features,s,"stops.features",o),e.pointBarriers&&e.pointBarriers.features&&this._collectGeometries(e.pointBarriers.features,s,"pointBarriers.features",o),e.polylineBarriers&&e.polylineBarriers.features&&this._collectGeometries(e.polylineBarriers.features,s,"polylineBarriers.features",o),e.polygonBarriers&&e.polygonBarriers.features&&this._collectGeometries(e.polygonBarriers.features,s,"polygonBarriers.features",o),Object(l.a)(s).then(e=>{for(const t in o){const s=o[t];r.push(t),a[t]=e.slice(s[0],s[1])}return this._isInputGeometryZAware(a,r)?this.getServiceDescription():Object(i.u)({dontCheck:!0})}).then(s=>{("dontCheck"in s?s.dontCheck:s.hasZ)||this._dropZValuesOffInputGeometry(a,r);for(const t in a)a[t].forEach((r,s)=>{e.get(t)[s].geometry=r});let o={query:{...this.parsedUrl.query,f:"json",...v.toQueryParams(e)}};(this.requestOptions||t)&&(o={...this.requestOptions,...t,...o});const{path:i}=this.parsedUrl,l="/solve",p=i.endsWith(l)?i:i+l;return Object(n.default)(p,o)}).then(e=>this._handleSolveResponse(e))}_collectGeometries(e,t,r,s){s[r]=[t.length,t.length+e.length],e.forEach(e=>{t.push(e.geometry)})}_handleSolveResponse(e){const t=[],r=[],{directions:s=[],routes:{features:o=[],spatialReference:a=null}={},stops:{features:i=[],spatialReference:n=null}={},barriers:l,polygonBarriers:p,polylineBarriers:u,messages:c}=e.data,b="esri.tasks.RouteTask.NULL_ROUTE_NAME";let y,d,h=!0;const O=o&&a||i&&n||l&&l.spatialReference||p&&p.spatialReference||u&&u.spatialReference;s.forEach(e=>{t.push(y=e.routeName),r[y]={directions:e}}),o.forEach(e=>{-1===t.indexOf(y=e.attributes.Name)&&(t.push(y),r[y]={}),e.geometry&&(e.geometry.spatialReference=O),r[y].route=e}),i.forEach(e=>{d=e.attributes,-1===t.indexOf(y=d.RouteName||b)&&(t.push(y),r[y]={}),y!==b&&(h=!1),e.geometry&&(e.geometry.spatialReference=O),null==r[y].stops&&(r[y].stops=[]),r[y].stops.push(e)}),i.length>0&&!0===h&&(r[t[0]].stops=r[b].stops,delete r[b],t.splice(t.indexOf(b),1));const m=t.map(e=>(r[e].routeName=e===b?null:e,r[e]));return R.fromJSON({routeResults:m,pointBarriers:l,polygonBarriers:p,polylineBarriers:u,messages:c})}};N=Object(s.a)([Object(a.a)("esri.tasks.RouteTask")],N),t.default=N}}]);